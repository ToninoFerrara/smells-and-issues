repository,state,title,label,body
ukanth/afwall,open,No internet for dual apps with island,[],"Hi,

I am having an issue in that my dual apps that I create with Island do not have access to the internet. Both Island and the dual apps are allowed access to the internet.

Please help!

Michal"
ukanth/afwall,closed,Can't open/parse apk,[],"I installed 3.0.1 successfully on my Asus Zenpad tablet last week. (Lollipop.)  But when I tried to install it on my LG 15 smartphone today, (Kitkat) I got ""could not parse"" error at install of the apk. (Update: Same with my Nook HD+ running CM10.1, an Android 4.x variant.)

I tried the download twice, thinking perhaps a corrupted file? (Haven't tried to sideload yet.) 

I installed 2.9.9 on my LG 15 and that installed okay.

Update: I just now noticed a note a bug report on 3.0.0 that it dropped support for Android 4.x devices. Don't know if that's a statement - like, AFWall will not work on Android 4.x anymore - or a report of a bug.

If it's the former, then I suggest the statement about dropping support be moved to the Features section. (As opposed to the Bugs section.)"
ukanth/afwall,closed,Application stuck at start (checking root access),[],"Application simply refuses to start with a checking root status waiting screen.  Refuses to request access from SuperSU.

Currently running SuperSU Pro v2.82 under Android 6."
ukanth/afwall,closed,AFWall blocking access to the Download Manager for whitelisted apps (even when disabled),[],"Hi,

I am having an issue in that the firewall is blocking access to the Download Manager for the Tecarta Bible app. This is happening regardless of the firewall being enable or disabled. I have tried whitelisting the app for all connection types. I have the download manager whitelisted.

The following message is appearing on my screen when I try downloading anything through the app.
![screenshot_20181121-094710_bible](https://user-images.githubusercontent.com/45242728/48863991-82004580-edcb-11e8-9851-bad65ba59a61.png)

Please help. :)"
ukanth/afwall,open,Tidal blocked even when whitelisted,[],"Hi there,

I've been using the firewall for a few weeks now and generally love it. I've moved to the donate version. :)

I am having an issue with Tidal being blocked even though I whitelist it for the VPN connection type that I use for all the apps. I have tried whitelisting it for all the connection types as well, but that did not help.

I have found out in the FAQs that the Media Server has to be allowed as well so I have tried whitelisting it just for VPN and also other connection types, but this did not change anything.

The issue is strange in that Tidal CAN access internet as it is showing albums, playlists and everything else. It just cannot stream music. It can even download music so that it should be available offline, but fails to play it showing the same error message - that there is no connection (!!!).

The only workaround is to disable the firewall completely, which, of course, is not ideal.

Any help would be greatly appreciated."
ukanth/afwall,open,CRITICAL BUG:  Several Versions of AFWall+ Are Not Starting! ,[],"```System Specs:```
OnePlus 5T 
OxygenOS 5.1.7 - Oreo 8.1.0

AFWall+ 3.0.0
AFWall+ 3.0.1
AFWall+ 2.9.9

```There is something seriously wrong here with AFWall+ and the latest version of OxygenOS 5.1.7, I did not have this problem at all with OxygenOS 5.1.5```

When I restart the phone, I do not see the overhead notification saying the firewall is enabled, I'm assuming this is suppose to always be displayed when the firewall is running? Because if I go to the App Drawer and tap on the icon the notification then appears in the overhead.

I'm only using the ```Allow selected``` and I did not have ```Google Play Store``` allowed, and I connected online with the Play Store and I was able to download an app.

This is very disturbing that AFWall+ will not start on a system start, and that I have to manually start it.

I've attached two screen shots, one the overhead notification, again, I should always see this when the firewall is running? 

Also a screen shot of the notifications, which I could of sworn had 3 options under the ```Categories``` section when I was running OxygenOS 5.1.5, now I only see 2. So is a notification category missing?

```I'm attaching a logcat``` from 3.0.1, I hope you can figure out why AFWall+ is not starting...

I've also attached the RULES from 3.0.1, but this is when I start AFWall+ after rebooting, not sure how to get the rules without starting.

![1](https://user-images.githubusercontent.com/36190223/48750849-39387780-ec79-11e8-9c13-9fcb995e2855.jpg)


![2](https://user-images.githubusercontent.com/36190223/48750870-4bb2b100-ec79-11e8-961e-299a8b5c2338.jpg)


```LOGCAT```
[logcat.txt](https://github.com/ukanth/afwall/files/2598025/logcat.txt)

```RULES```
[IPv4rules.log](https://github.com/ukanth/afwall/files/2598181/IPv4rules.log)
"
ukanth/afwall,open,Security :: Enable FP Protection,[],"AFWall+ 3.0.1

I cannot unlock it with FP that easily if I try to open the UI many times randomly,  unless I do this: press the power button to sleep the phone, then press the power button again to wake up the phone, enter PIN, unlock the phone, place my finger to unlock afwall, then it let me in) I have to repeat that once afwall is stopped to respond to the FP thing.. 
"
ukanth/afwall,open,Toasts keeps the screen on/phone awake,[],"AFWall+ 3.0.1

Turn on log services -> On
- No issue (Screen will turn off as usual after x of inactivity)

Enable show toasts -> On
- A minor issue here (It keeps the screen on forever if the user forgot to press the power button)

"
ukanth/afwall,open,3.0.1 - App Drawer Notification Icon Dot Doesn't Disappear,[],"In the latest 3.0.x versions the App Drawer Notification Icon Dot hasn't been Disappearing.

Nothing seems to make it go away, other then simply disabling it.

As long as it's enabled the Dot always appears on the icon.

Hmm"
ukanth/afwall,open,Suggest: Both Allow AND Block checkbox states.,[],"Currently we can only specify apps to Allow or apps to Block, but not both. You can set up one of the two states before making your selections, but you cannot maintain two sets of selections.

I have three types of apps on my devices. Apps I do Trust and Want to have consistent use of the Internet.  Apps I neither necessarily trust or desire to have regular Internet access. And apps I absolutely Never want to lick the Internet ever, not even once, because they will download adds or steal my contacts if given the chance.

I cannot reasonably disable AFwall+ for this reason (the third group), but sometimes it is necessary to be more generous and let all system apps go through to figure out why something isn't synching or working properly, to narrow down what exactly needs network access. I have to first uninstall all UnTrustworthy apps before I let the firewall down temporarily.

I want to be able to switch into Block Only X mode and have those evil apps checkmarked without having to first clear all my existing checkmarks -- and lose my settings."
ukanth/afwall,open,Can't download apps with Yalp/Aurora Store,"[Label(name=""Bug""), Label(name=""Low"")]","Hi,

I can't download apps with Yalp/Aurora Store however these two stores are granted in AFWall.
When download starting, an error message occurs: 

> AFWall+ denied access to Download Manager for package

Connection to the Yalp (anonymous) account is also capricious: works once in three.
I've no issue with all my others apps and I did't have much issue before reflash ROM on my two smarphones. I've tried on several days apart and on two versions of the ROM.

![screenshot_afwall _20181104-113423](https://user-images.githubusercontent.com/43678844/48023820-241efd00-e13f-11e8-9376-e50a2de176d2.png)
![screenshot_afwall _20181104-113428](https://user-images.githubusercontent.com/43678844/48023821-241efd00-e13f-11e8-82eb-3cd14c84e0da.png)
![screenshot_afwall _20181104-113441](https://user-images.githubusercontent.com/43678844/48023823-24b79380-e13f-11e8-9920-d32b3308bc21.png)
![screenshot_aurora_store_20181024-195130](https://user-images.githubusercontent.com/43678844/48023824-24b79380-e13f-11e8-8428-5387f0819165.png)
![screenshot_aurora_store_20181104-155531](https://user-images.githubusercontent.com/43678844/48023825-24b79380-e13f-11e8-9b6c-05f294c3507a.png)
![screenshot_yalp_store_20181105-195210](https://user-images.githubusercontent.com/43678844/48023826-25502a00-e13f-11e8-8d63-ecacc6e98826.png)
![screenshot_yalp_store_20181105-195236](https://user-images.githubusercontent.com/43678844/48023827-25502a00-e13f-11e8-97fd-39a99c4b0225.png)

Yalp Store v0.45 + v0.43: https://f-droid.org/en/packages/com.github.yeriomin.yalpstore/
Aurora Store v2.0.5 + v2.0.3: https://f-droid.org/fr/packages/com.dragons.aurora/
F-Droid AFWall+ v3.0.1 + v3.0.0 + v2.9.9
Xposed v90.1 beta 3 (SDK27), via Magisk v17.1
Xiaomi Redmi Note 5 Pro (whyred)
- RR-O-v6.1.0-20180827-whyred-Official (Android 8.1.0)
- RR-O-v6.2.0-20180911-whyred-Final (Android 8.1.0)

Xiaomi Redmi 3S Pro (land)
- RR-O-v6.1.0-20180816-land-Official (Android 8.1.0)
- RR-O-v6.2.0-20180913-land-Final (Android 8.1.0)
"
ukanth/afwall,open,When filter is set to USER and sort is BY INSTALL DATE apps are not removed from list after they are uninstalled.,"[Label(name=""Review"")]","When filter is set to USER and sort is BY INSTALL DATE apps are not removed from list after they are uninstalled.  As soon as you change the Sort method the uninstalled app is removed.
I believe this is related to issue #871 (which also happens on my device regularly), as it occurs concurrently.  

Xiomi Redmi Note 4
Slimrom Nougat 7.1.2 mido
Latest release of Afwall (donate)
Did not occur prior to latest version"
ukanth/afwall,closed,Disable background service when active rules are disabled,"[Label(name=""Wont-Fix"")]","If I understand it correctly the background service is there to listen for connectivity changes. Is it necessary to listen for connectivity changes when active rules are disabled? If not, could one disable the background service when active rules are disabled? That would hide the Android Oreo permanent notification."
ukanth/afwall,closed,"always shows ""AFWall+ is running"" notification message (not the icon)","[Label(name=""Question"")]","AFWall+ always causes an notification message (not the icon).

If I switch off  ```Preferences > UI Preferences > Show notification icon```, the actual icon disappears after restarting AFWall+. But the notification message ```AFWall+\nFirewall enabled``` is just being replaced by ```AFWall+ is running\nTap for more information or to stop the app.```

This behavior didn't appear before version 3.0.0 or 3.0.1.
Is this change intended?

AFWall+: 3.0.1 (F-Droid)
OS: LineageOS 14.1-20180808-NIGHTLY
Device: Fairphone 2"
ukanth/afwall,open,Language -> System always sets English,"[Label(name=""Bug""), Label(name=""Low"")]","When setting ```Preferences > Languages/Plugins > Change Language``` to ```System```, AFWall+ is always in English (my Android system language is der to German/Germany). Even after force stopping and restarting AFWall+ it's still in english.

Workaround: Set ```Change Language``` to German.

AFWall+: 3.0.1 (F-Droid)
OS: LineageOS 14.1-20180808-NIGHTLY
Device: Fairphone 2"
ukanth/afwall,open,"Internet connectivity detection, addition request to FAQ",[],"I had problems with my mobile detecting if there is a valid internet connection over wifi.
You can just ignore the message and everything works as intended.
I didnt want to give too many sysapp a firewall bypass, because of privacy so i let it be that way

BUT

Sync services on 8.1 (omni-rom) do not start (not even when triggered manually) if there is no internet connection detected. After allowing pid 1000 (Android-System,etc) the internet connection was detected and Davdroid, Firefox, etc started syncing imediately.

So i think this should be reflected in the FAQ as a side effect of blocking pid 1000 Android System,etc...

Other people seem to have this problem as well (it's where i got the solution from):
https://forums.bitfire.at/topic/1816/android-one-8-1-doesn-t-sync-calendar/11"
ukanth/afwall,closed,version differences between frdroid and yalpstore afwall,[],"hello
it alwys takes a while until the newest afwall version reaches fdroid, but thats probably normal i tihnk. but what i noticed since last update is, when i finally got afwall v3 on fdroid,  my yalpstore still said there is an update for afwall. it said 16400 --> 16500.
so does it mean after v3 another update for afwall came out, or is there some problem with versioning between the fdroid and the googleplay/yalpstore version of afwall?
currently yalpstore is telling me, that there is an update from 3.0.0 to 3.0.1 but a few days before that, it was 16400 to 16500. that kind confused me."
ukanth/afwall,open,Rules not applicable with v3.01 on Pixel C,"[Label(name=""Bug"")]","Rules are not applicable anymore after upgrade to v3.0.1.

Assumption was: 
> Seems like nat rule was added as part of tor integration (even though you didn't enable tor integration) and that's causing issue with pixel C ( due to kernel ). 

Latest ruleset after fresh installation of 3.0.1 any applying rules once.
[IPv4rules3.log](https://github.com/ukanth/afwall/files/2507110/IPv4rules3.log)
"
ukanth/afwall,closed,Store and apply iptables rules without root,"[Label(name=""Wont-Fix"")]","Thanks for this app. It is a real life saver in today's times.

I prefer to use my phone without root for some reasons. I also have a number of apps, which have been the same for a long while (I don't install new stuff anymore as I don't need to). Is it possible to use `iptables-save` to save the rules created by afwall in a text file, and then use a `/etc/init.d` script to apply them using `iptables-restore` on reboot. Or does the blocking procedure require the afwall app in other ways?

I use mobile data exclusively, so I don't need to switch to wifi (and hence don't need afwall's functionality to reapply rules on connection change).

Hence, I would be able to keep afwall (albeit disabled) but the iptables still present, even without root. 

I should mention that when I try it, I get the following error.
```sh
$ iptables-restore < /data/firewall-ip4.conf                            
iptables-restore v1.6.1: quota2: option ""--name"" cannot be inverted.

Error occurred at line: 265
Try `iptables-restore -h' or 'iptables-restore --help' for more information.
```

Line 265 of the file (generated by `iptables-save` after using afwall to apply rules) has the following.
```sh
-A bw_INPUT -m quota2 ! --name globalAlert  --quota 2097152
```"
ukanth/afwall,closed,"Android notification ""AFWall+ uses battery""",[],"First of all, thanks a lot for continuing to work on AFWall+. Now with the latest update 3.0.1 I have a new persistent notification shown from Android System that says ""AFWall+ uses battery""... was there any significant change?

(this is only happening when the option ""Show notification icon"" is false)"
ukanth/afwall,closed,System log fetch method is not working,[],"Under preferences/log/log fetch method, the system method isn't working but the busybox method is.
Issue found on latest v3.0.0, previously the issue wasn't present on v2.9.9.
Using Carbon ROM (8.1.0) official on lenovo zuk z2.
Magisk version - 17.2
Busybox version - 1.29.3 by osm0sis
"
ukanth/afwall,closed,No Persistent Notification,[],"*Please* make the new persistent notification optional. I want the old behavior back, where AFWall+ only gives a notification, when a new app is installed.   Personally I always find persisting nofications a bad design, which makes it harder to manage urgent notifications."
ukanth/afwall,closed,fdroid build fails,[],fdroid cannot build version 3.0.0 see here: https://f-droid.org/wiki/page/dev.ukanth.ufirewall/lastbuild_16400
ukanth/afwall,open,Feature request: lan/vpn/etc control with active rules disabled.,"[Label(name=""Low""), Label(name=""Wont-Fix"")]","I find myself reconnecting to my home wifi every so often, either when the signal drops out or while changing around connection settings, and then unable to go online while afwall+ reloads its rules. Please enable a way to use LAN control (specifically) and possibly vpn control without refreshing all rules on every reconnect."
ukanth/afwall,closed,Hide service related notification icon from status bar,[],"I think these options will hide the the notification icon from the status bar ([link](https://github.com/M66B/open-source-email/blob/acf3cfadd47da518d095c611ec8300debace92f0/app/src/main/java/eu/faircode/email/ServiceSynchronize.java#L343)) and make the status bar more clean 😌:
```
.setPriority(Notification.PRIORITY_MIN)
.setCategory(Notification.CATEGORY_STATUS)
.setVisibility(Notification.VISIBILITY_SECRET);
```

It might to be added as an option if you don't prefer it as global setting.
Thanks

"
ukanth/afwall,closed,Duplicate items on apps list,[],"Some times when I open the app it will shows the apps list like this, pull to refresh or re-opening the app will fix it but it's a little bit annoying. I faced it on latest stable (2.9.9) and beta version (3.0.0).
I'm on Lineage 14.1 (Latest Nightly) for Honor 5x.

![screenshot_20181014-185925](https://user-images.githubusercontent.com/13608702/46918984-5b3d3b00-cfe5-11e8-8133-4f8cd2fe7b7b.png)
"
ukanth/afwall,closed,App does not block traffic on Android 9 Pie ,"[Label(name=""Duplicate"")]","Im using Afwall version 2.9.9 on my Pixel Phone with the newest Android 9 build PPR2.181005.003

I used the app with Android 8 and everything worked fine nur after the Update to 9 the App cannot block my Connection for the Apps. I activate ipv6 but without any difference all Apps still have internet connection.

Is there a way to fix this?"
ukanth/afwall,open,changing font size and input field in custom scripts,"[Label(name=""Feature""), Label(name=""Low"")]","1) can you add the ability to make font size changes in custom scripts?
2) changing the size of the input field for a script. move below if the active ""on"" the script. move above if the active ""off"" the script. see pic:
[https://i.postimg.cc/TwC9KFwS/image.png](https://i.postimg.cc/TwC9KFwS/image.png)
[![image.png](https://i.postimg.cc/TwC9KFwS/image.png)](https://postimg.cc/Q9K5P6ck)"
ukanth/afwall,closed,Bug. Unnecessary rules iptables,"[Label(name=""Question"")]","I see that there are Unnecessary lines in the rules:

-A afwall-wifi-postcustom -m owner --uid-owner 1014 -j RETURN
-A afwall-wifi-postcustom -m owner --uid-owner 1010 -j RETURN


I don't have an app with these numbers. that this is a bug or a backdoor?
the old versions did not have these lines."
ukanth/afwall,open,Request: Color/Themes?,"[Label(name=""Feature""), Label(name=""Low"")]","@ukanth

Can you please add the ability to change the color/look of AFwall?

I'm not asking that you include a lot of code to make for many changes, but just the ability to make the background white with black text and the green trim along the top, with the ability to just change this to one or several colors, I personally would like this in blue.

White background > black text > blue trim on top

Thanks"
ukanth/afwall,open,Firewalled apps can still send data over a bluetooth shared internet connection.,[],"Hi,

First off - thank you for this amazing app.  I have the free AFWall v2.9.8 with root provided by Magisk v17. 

This app has made me feel safer - but I am still worried when I try to use my phone with an internet connection shared by Win 10 over bluetooth. 

Apologies if this has been reported before; on searching I did not find any similar issue listed here.

Steps to recreate:
1) Install AFWall and block a given app for mobile data, wifi, roaming, LAN by unchecking all the boxes for the app in ""Whitelist"" mode.
2) Connect to Wifi and verify that the app is indeed blocked (app should not be able to log in and/or connect  and should show some sort of  ""no data connection"" / error message / retry screen. (this confirms that the app is firewalled.)
3) Disconnect Wifi.
4) Pair your phone with a Windows 10 machine having wifi and a wired LAN connection.
5) Enable the mobile hotspot over bluetooth. Share the wired LAN connection over bluetooth.
6) Connect the phone to the Windows 10 bluetooth and enable internet access over bluetooth on the phone.
7) Use the blocked app again - and it will be able to connect to the internet and to use data.

Would it be possible to also have a ""bluetooth"" section alongwith the Wifi, LAN, VPN, Roaming etc. controls? Unfortunately I am quite unaware of the way data traffic flows over the bluetooth radio, but since the phone does get an IP address assigned by the PC and uses the Bluetooth MAC address, wouldn't data over bluetooth also be possible to filter via iptables in principle?

Also, if you are able to recreate this issue, please can it be added to the limitations section so that folks are aware of possible data leaks when using AFWall over a bluetooth data connection?

Thanks for your attention to this issue,

Regards,
H"
ukanth/afwall,closed,Target API to Oreo (26),[],"* Foreground service changes
* New Tiles option
* Adaptive icon support

etc.,"
ukanth/afwall,closed,Automatic change of default policies?,[],"I have a custom script with the following default policies:
```
$IPTABLES -P INPUT DROP
$IPTABLES -P FORWARD DROP
$IPTABLES -P OUTPUT DROP
```
After activating the firewall I checked the rules by **$ adb shell su iptables -vnL** getting:
```
Chain INPUT (policy DROP 0 packets, 0 bytes)
Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
```
After activating WLAN the following resulted:
`Chain INPUT (policy ACCEPT 0 packets, 0 bytes)`
Why have changed the default policies of the OUTPUT and of the INPUT chain?
Thanks for help!

Samsung SII, LOS 14.1, AFWall+2.9.9"
ukanth/afwall,closed,AFWall - AliExpress,"[Label(name=""NoInfo"")]","Hi, I found out that Aliexpress app has internet access thrue mobile data when this is disabled in AFWall. May be this app uses some other method /app for optain data.
[Xiaomi Note 4 - mido, Los 15.1 - android 8.1, Magisk root] "
ukanth/afwall,closed,Translation fix,[],"Really, ""Nucleo"" is a punch to the belly. Not all technical words are translated into Italian."
ukanth/afwall,open,"Show Filters - ""User"" Apps Appeared Twice","[Label(name=""non-reproduce"")]","My Specs:
--------------
OnePlus 5T
Oxygen OS 5.1.5 - Oreo 8.1.0
Magisk 17.2
AFWall+ 2.9.9 (From F-Droid)
Xposed 3.1.5 - AFwall+ Module
--------------

I wish I had more to go on, I wasn't really paying attention to what exactly triggered this. I went back and have been playing with the various settings, but I have not been able to replicate it.

When I first enabled the ""Show filter"" and one point, when I had it on ""Users"" all the apps appeared twice in the menu.

Hopefully the logcat I have attached will give you information over the problem, as to why they appeared twice.

Keep up the great work, thanks! :+1: 

[logcat.txt](https://github.com/ukanth/afwall/files/2433463/logcat.txt)
"
ukanth/afwall,closed,AFWall Crashed While Changing Settings,[],"Hi,

My Specs:
--------------
OnePlus 5T
Oxygen OS 5.1.5 - Oreo 8.1.0
Magisk 17.2
AFWall+ 2.9.9 (From F-Droid)
Xposed 3.1.5 - AFwall+ Module
--------------

Experimental > Startup directory path for script - I had to mkdir init.d on Oxygen OS it only has init. I was having a previous issue, with the Main window showing the ""User"" apps listed twice, so I was trying to replicate this bug playing with various options. 

I clicked on ""Startup directory path for script"" it then showed two /paths;
/system/etc/init.d
/etc/init.d

I clicked back and forth on both of the paths a few times, and then I got a popup message saying AFWall+ stopped.

I've attached a logcat, hopefully this will show you the problem why it crashed/stopped.

Thanks

[logcat.txt](https://github.com/ukanth/afwall/files/2433453/logcat.txt)
"
ukanth/afwall,open,sheltered app cant be found,"[Label(name=""Feature""), Label(name=""Low"")]","hi there

i noticed a strange bug. i activated dual app and multiuser support in the experimental settings in afwall+.
so far, everything worked fine. im using the shelter app by PeterCxy. that app creates an isolated profile.
you can clone existing apps into that shelter, or you can directly install apps into that shelter.

so what error i occured is, that if i have an app only in the shelter, afwall+ doesnt list it. so i cant give wifi permission for that app. so in other words, unless i dont have an app installed on both, the main phne profile and the isolated shelter profile, i cant see the cloned one in the list.

but as you can already guess, it makes no sense to have all apps double installed. some apps shall be only in the isolated profile, and others only in the main profile.

is there a way to make afwall+ find apps which are only installed in the shelter?"
ukanth/afwall,closed,Captive Portal Check Service?,"[Label(name=""Duplicate"")]","What exactly does block the Captive Portal Check in AFWall?
I did disable captive_portal_detection to get rid of the exclamation mark. But what if you are on a vacation and in a hotel? Nobody wants to go to the terminal on vacation...

So is there a simple way to turn this stuff on and off so that for example the hotel login page works?
Or does that work anyway and has nothing to do with the Android check?

I also never had that exclamation mark problem on my 4.x.x devices. Had it the first time on 6 and now 7.
Does 4 not have this check?"
ukanth/afwall,closed,DNS via Linux Kernel UID blocked in Android 9,[],"Phone: Pixel 2 XL.
Root: Magisk 17.1

I've always had my profile set to Allow Selected and then whitelisted various apps, including Apps running as root (UID 0).
After upgrading to Android 9, this no longer works though. Every DNS request (except for Chrome browser) is filtered, with the log listing occuring under the ""Apps running as root(0)'. This effectively prevents internet access.
If I reverse the defaults though by selecting ""Block selected"" and inverting the selected apps, then DNS will work fine again.

I have tried the NetD options (auto, enable, disable) but they don't seem to change anything.
Attached ipv4rules when DNS doens't work. Weird that no UID 0 DNS is being matched.

How can I diagnose this further?

[IPv4rules.log](https://github.com/ukanth/afwall/files/2412942/IPv4rules.log)

"
ukanth/afwall,closed,API 26 Related Issues ,"[Label(name=""High"")]","All issues related to API 26 level changes introduced.

APK:
[BETA] https://drive.google.com/open?id=19g5P9VgPHM6PrmrswnQtHyWISq0MyPAV
"
ukanth/afwall,closed,SMS app blocked?,"[Label(name=""Question"")]","Hi,

A long-time user of afwall (thanks for it by the way!!!), I was surprised to see afwall+ blocked several communications from the SMS/MMS application (ID 10068). The following IP address were blocked, all on port 443
216.58.213.142
216.58.215.46
172.217.19.238
172.217.18.206
These IP belongs to google hosting, have self-signed certificate (and redirect to google.com if blindly via https://[theip] ).

My phone runs lineage os 15, updated on Sept 4th. It is rooted, runs microg, fdroid and xposed (xprivacylua, minminguard), and has very few apps on it. 

Is there any chance that it is not the SMS/MMS app but another one (and so the log would be wrong)? Else, does anybody know why Lineageos' stock SMS app would open communications to external servers? Is that legitimate or... ?

Thank you!"
ukanth/afwall,closed,"Google Play Store: Not downloading via Wifi, but Mobile works",[],"I experience a wierd issue on my Huawei P10:

I am using Afwall Donate 2.9.9 running on Android 8.0 (EMUI 8 from Huawei). Of course, i have whitelisted Afwall in the stupid Huawei battery mangers etc.

Issue:

I use blacklist mode. DNS over netd is disabled, Play store, Play services and Download Manager are whitelisted. I've also blacklisted UID 1000.

What is expected:

Downloading apps from the Play store.

What happens:

Browsing Play store works. Downloading apps is stuck forever via wifi. Downloading apps works flawlessly via mobile network.

Log does not show anything. Strange...

Do you have any idea?"
ukanth/afwall,closed,Sync,[],
ukanth/afwall,closed,Multicast not working,"[Label(name=""General"")]","On my Xiaomi Mi 8, MIUI10, AFWall+ 2.99 incl. Donation key multicast is not working.
My Onkyo Remote App and Spotify Connect is not working.

If i disable the Firewall both is working directly without any waiting time.
I have LAN control enabled and both apps have access to WIFI and LAN (i am in WIFI)

If i disable the Firewall i can see these addresses in network log
239.255.255.255:1900
255.255.255.255:60128
224.0.0.22:0
224.0.0.251:5353

i tried several rules in my custom script and read all the available issues here - nothing helped.

what would be the correct custom script entry for allowing these adresses?

not even
$IPTABLES -A ""afwall-wifi"" --destination ""192.0.0.0/2"" -J ""afwall-wifi-lan"" 
worked - which should allow everything between 192.0.0.1 - 255.255.255.255


after a long online search i think this is a common issue when using afwall..."
ukanth/afwall,closed,UID Process 10074 Google GMS Service Missing,"[Label(name=""General""), Label(name=""Wont-Fix"")]","This particular service does not show up on app list, commonly known as com.google.android.gms.setup on system. Can anyone provide an input? Am I doing something wrong?

Thank you for this app!
"
ukanth/afwall,closed,Translatable strings have not shipped in a while.,[],"The translatable strings on Crowdin still draw from ""master"", whereas ""beta"" is the branch wherein fixes are present. If this is a ""when will the next version be out"", feel free to close."
ukanth/afwall,closed,Most apps have multiple entries,"[Label(name=""NoInfo"")]","On Android 8.0 my AFWall+ 2.9.9 with profiles enabled shows multiple entries for most apps. Some apps appear up to 8 times. If I whitelist an app I always check all checkboxes, if I then apply the changes it creates only 1 new rule for all checked entries. So I guess the rules file is working fine but Afwall is somewhat messed up. Any idea what causes this multiple entries or would you like a screenshot? "
ukanth/afwall,closed,afwall not always on the top of OUTPUT chain.,"[Label(name=""NoInfo"")]","sometime afwall is the first rule of OUTPUT chain,
``Chain OUTPUT (policy ACCEPT 21 packets, 1772 bytes)``
 ``pkts bytes target     prot opt in     out     source               destination         ``
  ``782 94683 afwall     all  --  *      *       0.0.0.0/0            0.0.0.0/0           ``
  ``191 24147 wmsctrl_OUTPUT  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0          `` 
 ``1222  123K oem_out    all  --  *      *       0.0.0.0/0            0.0.0.0/0           ``
`` 1222  123K fw_OUTPUT  all  --  *      *       0.0.0.0/0            0.0.0.0/0           ``
sometime its not,
`` Chain OUTPUT (policy ACCEPT 289 packets, 25204 bytes)`` 
``  pkts bytes target     prot opt in     out     source               destination         `` 
``   282 17707 wmsctrl_OUTPUT  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           `` 
``  1279  111K afwall     all  --  *      *       0.0.0.0/0            0.0.0.0/0           `` 
``   865 86943 oem_out    all  --  *      *       0.0.0.0/0            0.0.0.0/0           `` 
its jump to
``Chain wmsctrl_OUTPUT (1 references)``
`` pkts bytes target     prot opt in     out     source               destination     ``    
``    0     0 NFQUEUE    tcp  --  *      *       0.0.0.0/0            127.0.0.1            tcp dpt:53889 STRING match  ""GET"" ALGO name bm FROM 40 TO 200 NFQUEUE num 20 bypass``
seems a suspicious process:
``tcp        0      0 ::ffff:127.0.0.1:53889  :::*                    LISTEN      6271/com.miui.wmsvc``
my device:``xiaomi redmi5 Version: V9.6.3.0.NDAMIFD (MIUI9) Global  android 7.x``
how to make afwll always on the top?
non native english,sorry."
ukanth/afwall,open,Support App name changes,"[Label(name=""Bug""), Label(name=""Low"")]","Currently app shows old name for an app:
![](https://i.imgur.com/usV2nFH.png)
The app was in alpha stage so a lot of changes were being made.
Now it is called Fair Email,
![](https://i.imgur.com/cbZIKcJ.png)
But, AFwall still displaying safe email, as shown above.

Pull to refresh should reload/refresh app list with proper app names. This is not the case, and old names remain."
ukanth/afwall,closed,"[Enhancement] Auto-delete old logs, keep per-app log totals.","[Label(name=""Feature"")]","Hello ukanth! Amazing program. 

But i wonder for how long logs are stored? If i won't clear them manually for years, will i run out of space? So i propose an option in log settings: how long to keep logs (in days, or smth). Since you show recent log details first, you likely have means of quickly sorting them by date (maybe you store them in sqlite?), so deleting old logs should not be an issue i hope.

Also, when old logs are deleted (manually or automatically), maybe it's worth not to reset per-app totals (""N seconds/.../days ago"", ""Denied: M times""), and append ""old logs are deleted on <time>"" line at the bottom of log details screen (after oldest record). Not sure if such behaviour would suit everyone, maybe checkbox option in log settings, too."
ukanth/afwall,open,[Enhancement] Be able to register custom/unknown UID (fake app),"[Label(name=""Feature"")]","Tigthly related to #344 #718

If app could add a ""fake"" app entry, then its uid can be easily filtered via UI.
This will open the door to reduce maintenance and better support changes on new Android versions or custom ROMs.

_Parallel question: how can I append new rules without affect current rules neither recreate a complete custom script?_"
ukanth/afwall,closed,Error Applying Rules,"[Label(name=""Question""), Label(name=""Wont-Fix"")]","Hi there

I've been tinkering around with custom rules and I have created a general ruleset and a a specific one for VPNs. When I just apply the general ruleset it all works fine. But when I want to add also the vpn one, I get said error:

https://images.sjau.ch/img/ba337d93.png

In this screenshot you can see how I call the custom scripts (they are added after the log below):

https://images.sjau.ch/img/675dbc35.png

Here's the log:

```
==========
IPv4 Rules
==========

Chain INPUT (policy DROP 0 packets, 0 bytes)
pkts bytes target     prot opt in     out     source               destination        
    0     0 ACCEPT     all  --  lo     *       0.0.0.0/0            0.0.0.0/0          
    0     0 ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 0
    0     0 ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8
    0     0 ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 3
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            state RELATED,ESTABLISHED
    0     0 REJECT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            reject-with tcp-reset
    0     0 REJECT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable

Chain FORWARD (policy DROP 0 packets, 0 bytes)
pkts bytes target     prot opt in     out     source               destination        
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0          

Chain OUTPUT (policy DROP 0 packets, 0 bytes)
pkts bytes target     prot opt in     out     source               destination        
    0     0 afwall     all  --  *      *       0.0.0.0/0            0.0.0.0/0          

Chain afwall (1 references)
pkts bytes target     prot opt in     out     source               destination        
    0     0 ACCEPT     all  --  *      lo      0.0.0.0/0            0.0.0.0/0          

Chain afwall-3g (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-3g-fork (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-3g-home (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-3g-postcustom (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-3g-roam (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-3g-tether (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-reject (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-vpn (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-wifi (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-wifi-fork (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-wifi-lan (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-wifi-postcustom (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-wifi-tether (0 references)
pkts bytes target     prot opt in     out     source               destination        

Chain afwall-wifi-wan (0 references)
pkts bytes target     prot opt in     out     source               destination        


==================
Network interfaces
==================

rmnet_data1
rmnet_data0
rmnet_data4
rmnet_data2
rmnet_data3
rmnet_data7
rmnet_data5
rmnet_data6
r_rmnet_data1
r_rmnet_data2
r_rmnet_data0
r_rmnet_data4
r_rmnet_data3
r_rmnet_data7
r_rmnet_data5
r_rmnet_data6
r_rmnet_data8
dummy0
usb0
tun0
sit0
lo
rmnet_usb0
wlan0

========
ifconfig
========

dummy0    Link encap:Ethernet  HWaddr 8A:2A:31:71:1C:28 
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1321 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:463268 (452.4 KiB)

lo        Link encap:Local Loopback 
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:36972 errors:0 dropped:0 overruns:0 frame:0
          TX packets:36972 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:7392678 (7.0 MiB)  TX bytes:7392678 (7.0 MiB)

r_rmnet_data0 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

r_rmnet_data1 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

r_rmnet_data2 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

r_rmnet_data3 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

r_rmnet_data4 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

r_rmnet_data5 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

r_rmnet_data6 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

r_rmnet_data7 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

r_rmnet_data8 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

rmnet_data0 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          inet addr:10.138.124.205  Mask:255.255.255.252
          UP RUNNING  MTU:1500  Metric:1
          RX packets:1312887 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1930767 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:1041171893 (992.9 MiB)  TX bytes:2029137696 (1.8 GiB)

rmnet_data1 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

rmnet_data2 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

rmnet_data3 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

rmnet_data4 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

rmnet_data5 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

rmnet_data6 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

rmnet_data7 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

rmnet_usb0 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          UP RUNNING  MTU:2000  Metric:1
          RX packets:690136 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1930767 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:1049199764 (1000.5 MiB)  TX bytes:2029137696 (1.8 GiB)

sit0      Link encap:UNSPEC  HWaddr 00-00-00-00-01-00-00-00-00-00-00-00-00-00-00-00 
          NOARP  MTU:1480  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

tun0      Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 
          inet addr:10.200.0.118  P-t-P:10.200.0.118  Mask:255.255.255.255
          UP POINTOPOINT RUNNING  MTU:1280  Metric:1
          RX packets:920690 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1678534 errors:0 dropped:1369 overruns:0 carrier:0
          collisions:0 txqueuelen:500
          RX bytes:848849489 (809.5 MiB)  TX bytes:1667012366 (1.5 GiB)

usb0      Link encap:Ethernet  HWaddr BA:DF:1D:28:31:C2 
          BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

wlan0     Link encap:Ethernet  HWaddr 14:1A:A3:88:7A:73 
          inet addr:192.168.43.1  Bcast:192.168.43.255  Mask:255.255.255.0
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:253301 errors:0 dropped:276 overruns:0 frame:0
          TX packets:185802 errors:0 dropped:506 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:250635011 (239.0 MiB)  TX bytes:95498051 (91.0 MiB)

===========
System info
===========

Android version: 7.1.2
Manufacturer: motorola
Model: Nexus 6
Build: lineage_shamu-userdebug 7.1.2 NJH47F e6b03d5c38
Active interface: mobile
Tether status: no
Roam status: no
IPv4 subnet:
IPv6 subnet:
/system/bin/su: 112568 bytes
/system/xbin/su: 112568 bytes
/data/magisk/magisk: not present
/system/app/Superuser.apk: not present
Superuser: none found

===========
Preferences
===========

NewDBNotification: true
activeNotification: true
activeRules: true
appVersion: 15992
applyOnSwitchProfiles: true
block_filter_app:
controlIPv6: false
disableIcons: false
enableIPv6: false
enableLAN: true
enableLogService: true
enableMultiProfile: true
enableRoam: false
enableVPN: false
forward_chain: true
forward_chain_v6: true
hasRoot: true
input_chain: true
input_chain_v6: true
ipurchaseddonatekey: false
logDmesg: OS
logTarget: NFLOG
notification_priority: 0
notifyAppInstall: true
oldLogView: false
output_chain: true
output_chain_v6: true
profilesmigrated: true
runNotification: true
showFilter: false
showHostName: false
showLogToasts: false
showUid: true
storedPid: []
storedProfile: AFWallProfile1
sysColor: -10432
toast_pos: bottom
Profile Mode : whitelist
Status : Enabled

======
Logcat
======

09:46:34 Selected Profile: AFWallProfile1
09:46:34 Restarting RootShell...
09:46:34 Received cmds: #1
09:46:34 Starting root shell...
09:46:34 Starting Log Service: echo $$ & /data/user/0/dev.ukanth.ufirewall/app_bin/nflog  40 for LogTarget: NFLOG
09:46:34 rootSession is not Null
09:46:34 Cleanup session
09:46:34 Restarting LogService
09:46:34 Starting Log Service: echo $$ & /data/user/0/dev.ukanth.ufirewall/app_bin/nflog  40 for LogTarget: NFLOG
09:46:34 rootSession is not Null
09:46:34 Cleanup session
09:46:35 Root shell is open
09:46:35 Start processing next state
09:46:35 Total commamds: #1
09:46:38 Received cmds: #1
09:46:38 Start processing next state
09:46:38 Total commamds: #1
09:46:38 Selected Profile: AFWallProfile1
09:46:45 Selected Profile: AFWallPrefs
09:46:45 Selected Profile: AFWallPrefs
09:46:45 Using applySavedIptablesRules
09:46:45 Setting OUTPUT to Drop
09:46:45 isWifiApEnabled is false
09:46:45 No ipaddress found for LAN
09:46:45 Setting OUTPUT to Accept State
09:46:45 Received cmds: #248
09:46:45 Start processing next state
09:46:45 Total commamds: #248
09:46:53 command 'iptables -A afwall-wifi-lan -m owner --uid-owner 10029 -j RETURN' exited with status 4, retrying (attempt 1/10)
09:52:15 Selected Profile: AFWallPrefs
09:52:19 Selected Profile: AFWallProfile1
09:52:19 Selected Profile: AFWallProfile1
09:52:23 Using applySavedIptablesRules
09:52:23 Setting OUTPUT to Drop
09:52:23 No ipaddress found for LAN
09:52:23 Setting OUTPUT to Accept State
09:52:23 Received cmds: #249
09:52:23 Start processing next state
09:52:23 Total commamds: #249
09:52:28 command '. /storage/emulated/0/Syncthing/Shows/Diverses/AFWallVPNAllRoute.sh' exited with status 2

Output:
RTNETLINK answers: File exists
RTNETLINK answers: File exists
RTNETLINK answers: File exists

09:52:58 Selected Profile: AFWallProfile1
09:53:03 Ended Loading: 1535010783937
09:53:08 Ended Loading: 1535010788186
09:53:09 Selected Profile: AFWallProfile1
09:53:11 Received cmds: #1
09:53:11 Start processing next state
09:53:11 Total commamds: #1
09:53:11 Received cmds: #1
09:53:11 Start processing next state
09:53:11 Total commamds: #1
09:53:11 Received cmds: #1
09:53:11 Start processing next state
09:53:11 Total commamds: #1
09:53:16 State of rootShell: READY
09:53:16 State of rootShell: READY
09:53:17 Received cmds: #2
09:53:17 Start processing next state
09:53:17 Total commamds: #2
09:53:17 Received cmds: #1
09:53:17 Start processing next state
09:53:17 Total commamds: #1
09:53:17 Received cmds: #1
09:53:17 Start processing next state
09:53:17 Total commamds: #1
09:53:17 Received cmds: #1
09:53:17 Start processing next state
09:53:17 Total commamds: #1
09:53:19 Selected Profile: AFWallProfile1
09:53:22 State of rootShell: READY
09:53:22 State of rootShell: READY
09:53:22 State of rootShell: READY
09:53:27 Selected Profile: AFWallPrefs
09:53:27 Selected Profile: AFWallPrefs
09:53:27 Using applySavedIptablesRules
09:53:27 Setting OUTPUT to Drop
09:53:27 No ipaddress found for LAN
09:53:27 Setting OUTPUT to Accept State
09:53:27 Received cmds: #248
09:53:27 Start processing next state
09:53:27 Total commamds: #248
09:53:45 Received cmds: #1
09:53:45 Start processing next state
09:53:45 Total commamds: #1
09:53:46 Received cmds: #1
09:53:46 Start processing next state
09:53:46 Total commamds: #1
09:53:46 Received cmds: #1
09:53:46 Start processing next state
09:53:46 Total commamds: #1
09:53:50 Received cmds: #2
09:53:50 Start processing next state
09:53:50 Total commamds: #2
09:53:50 Received cmds: #1
09:53:50 Start processing next state
09:53:50 Total commamds: #1
09:53:50 Received cmds: #1
09:53:50 Start processing next state
09:53:50 Total commamds: #1
09:53:50 Received cmds: #1
09:53:50 Start processing next state
09:53:50 Total commamds: #1
09:53:51 State of rootShell: READY
09:53:51 State of rootShell: READY
09:53:52 Selected Profile: AFWallPrefs
09:53:55 State of rootShell: READY
09:53:55 State of rootShell: READY
09:53:55 State of rootShell: READY
09:53:57 Selected Profile: AFWallProfile1
09:53:57 Selected Profile: AFWallProfile1
09:54:02 Using applySavedIptablesRules
09:54:02 Setting OUTPUT to Drop
09:54:02 No ipaddress found for LAN
09:54:02 Setting OUTPUT to Accept State
09:54:02 Received cmds: #249
09:54:02 Start processing next state
09:54:02 Total commamds: #249
09:54:07 command '. /storage/emulated/0/Syncthing/Shows/Diverses/AFWallVPNAllRoute.sh' exited with status 2

Output:
RTNETLINK answers: File exists
RTNETLINK answers: File exists
RTNETLINK answers: File exists

09:54:11 Received cmds: #1
09:54:11 Start processing next state
09:54:11 Total commamds: #1
09:54:11 Received cmds: #1
09:54:11 Start processing next state
09:54:11 Total commamds: #1
09:54:11 Received cmds: #1
09:54:11 Start processing next state
09:54:11 Total commamds: #1
```

Here's the content of the AFWallVPNAllRoute.sh script:

```
$IPTABLES -t filter -F FORWARD
$IPTABLES -t nat -F POSTROUTING
$IPTABLES -t filter -I FORWARD -j ACCEPT
$IPTABLES -t nat -I POSTROUTING -j MASQUERADE
ip rule add from 192.168.43.0/24 lookup 61
ip route add default dev tun0 scope link table 61
ip route add 192.168.43.0/24 dev wlan0 scope link table 61
ip route add broadcast 255.255.255.255 dev wlan0 scope link table 61
```
Here's the content of the AFWallStart.sh script:

```
## iptables_on.sh
## AFWall+ Custom-Script & some tweaks
## Mike Kuketz
## www.kuketz-blog.de
## Changes: 15.01.2018
##
## iptables -L
## iptables -S
## iptables -L -t nat

####################
# Tweaks #
####################
## Kernel
# Disable IPv6
echo 0 > /proc/sys/net/ipv6/conf/wlan0/accept_ra
echo 1 > /proc/sys/net/ipv6/conf/all/disable_ipv6
echo 1 > /proc/sys/net/ipv6/conf/default/disable_ipv6
# Privacy IPv6 Address
echo 2 > /proc/sys/net/ipv6/conf/all/use_tempaddr
echo 2 > /proc/sys/net/ipv6/conf/default/use_tempaddr
## System
# Disable Captive Portal (Connect to http://clients3.google.com via UID 1000)
settings put global captive_portal_mode 0
# Disable Global NTP Server
settings put global ntp_server 127.0.0.1

####################
# iptables #
####################
IPTABLES=/system/bin/iptables
IP6TABLES=/system/bin/ip6tables

####################
# Purge/Flush #
####################
# All 'afwall' rules/chains gets flushed automatically, before the custom script is executed
# Flush/Purge all rules except OUTPUT
$IPTABLES -F INPUT
$IPTABLES -F FORWARD
$IPTABLES -t nat -F
$IPTABLES -t mangle -F
$IP6TABLES -F INPUT
$IP6TABLES -F FORWARD
$IP6TABLES -t nat -F
$IP6TABLES -t mangle -F

# Flush/Purge all chains
$IPTABLES -X
$IPTABLES -t nat -X
$IPTABLES -t mangle -X
$IP6TABLES -X
$IP6TABLES -t nat -X
$IP6TABLES -t mangle -X

####################
# Defaults #
####################
# IPv4 connections
$IPTABLES -P INPUT DROP
$IPTABLES -P FORWARD DROP
$IPTABLES -P OUTPUT DROP

# IPv6 connections
$IP6TABLES -P INPUT DROP
$IP6TABLES -P FORWARD DROP
$IP6TABLES -P OUTPUT DROP

#####################
# Special Rules #
#####################
# Allow loopback interface lo
$IPTABLES -A INPUT -i lo -j ACCEPT
$IPTABLES -A ""afwall"" -o lo -j ACCEPT

# Set a specific dns server for all networks except home WiFi (192.168.150.0/24)
#$IPTABLES -t nat -I OUTPUT ! -s 192.168.150.0/24 -p tcp --dport 53 -j DNAT --to-destination 85.214.20.141:53
#$IPTABLES -t nat -I OUTPUT ! -s 192.168.150.0/24 -p udp --dport 53 -j DNAT --to-destination 85.214.20.141:53

# Force a specific NTP (ntp0.fau.de), Location: University Erlangen-Nuernberg
#$IPTABLES -t nat -A OUTPUT -p tcp --dport 123 -j DNAT --to-destination 131.188.3.222:123
#$IPTABLES -t nat -A OUTPUT -p udp --dport 123 -j DNAT --to-destination 131.188.3.222:123

#####################
# Incoming Traffic #
#####################
# Allow ICMP packets
$IPTABLES -A INPUT -p icmp -m icmp --icmp-type echo-reply -j ACCEPT
$IPTABLES -A INPUT -p icmp -m icmp --icmp-type echo-request -j ACCEPT
$IPTABLES -A INPUT -p icmp -m icmp --icmp-type destination-unreachable -j ACCEPT

# Allow all traffic from an established connection
$IPTABLES -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Alle Pakete ordentlich zurückweisen
$IPTABLES -A INPUT -p tcp -j REJECT --reject-with tcp-reset
$IPTABLES -A INPUT -j REJECT --reject-with icmp-port-unreachable
```

And  here's the content for the AFWallStop.sh script:

```
## iptables_off.sh
## AFWall+ shutdown actions
## Mike Kuketz
## www.kuketz-blog.de

####################
# iptables         #
####################
IPTABLES=/system/bin/iptables
IP6TABLES=/system/bin/ip6tables 

####################
# Purge/Flush      #
####################
# Flush/Purge all rules
$IPTABLES -F
$IPTABLES -t nat -F
$IPTABLES -t mangle -F
$IP6TABLES -F
$IP6TABLES -t nat -F
$IP6TABLES -t mangle -F

# Flush/Purge all chains
$IPTABLES -X 
$IPTABLES -t nat -X
$IPTABLES -t mangle -X
$IP6TABLES -X 
$IP6TABLES -t nat -X
$IP6TABLES -t mangle -X

####################
# Defaults         #
####################
# Allow IPv4 connections 
$IPTABLES -P INPUT ACCEPT
$IPTABLES -P FORWARD ACCEPT  
$IPTABLES -P OUTPUT ACCEPT

# Deny IPv6 connections  
$IP6TABLES -P INPUT DROP  
$IP6TABLES -P FORWARD DROP  
$IP6TABLES -P OUTPUT DROP
```
"
ukanth/afwall,closed,Network connections being allowed even when set to deny,"[Label(name=""NoInfo"")]","In the AFWall configuration I have ""Allowed selected"" configuration mode. For AlarmDroid I have not selected any permissions. Given this, it should be completely denied internet. However, using netmonitor I can see that AlarmDroid is making a connection to facebook.

Other considerations is that I have a VPN enabled (orbot). Of course AlarmDroid does not have VPN connection permissions. I have tested other apps like the browser and it does stop the connection so the firewall rules appear to work.

Also, I check netstat at startup and AlarmDroid is not lsited. So, it is not that alarmdroid is started before AFWall and therefore strated before rules are applied.

Any ideas?
"
ukanth/afwall,open,No Internet after switching connection type (wifi - > mobile and around) ,"[Label(name=""Review"")]","I am using afwall donate on my Mi8, running Miui 10 under Android 8.1 rooted with Magisk 16.0 stable. Init.d is working and fix boot data leak is working as well (I think so - made the test with 00test)
For logging I am using Busybox. 

Afwall+ is not working great at this time. 
If I am switching from wifi to mobile data (or the way around) everything is blocked and I need to reboot my phone, than it is working. By applying the rules by hand (even turning firewall off and on again) there is still no connection.

I don't know if I should write it here - the logs are stopping all the time, I need to turn logs off and on for having logs again.

And one side question: by choosing to apply the rules after a certain amount of time after start, within this time everything is blocked, right? I didn't find any description for this feature 




[IPv4rules.log](https://github.com/ukanth/afwall/files/2300208/IPv4rules.log)"
ukanth/afwall,closed,AFWall don't autostart and apply rules,[],"If ""Turn on log service"" is off, then AFWall do not start&apply rules after reboot phone."
ukanth/afwall,closed,Problems after Update to Android 9,"[Label(name=""Bug""), Label(name=""Critical"")]","I have updated my Pixel 2 to Android 9. After updating I have rooted with/over Magisk 16.7.
But now after a few houres AFWall v2.9.9 (donate) is blocking all all kind of media downloads (youtube, google play, image and video downloads via whatsapp), If I reinstall AFWall+ it works again a few houres.
Before updating to Android 9 it worked perfectly. Does anybody have the same issue? 


Rules:
https://pastebin.com/ZvgqHCfd

Edit:
Exactly the same issue I have:
https://forum.xda-developers.com/showpost.php?p=77302832&postcount=4612"
ukanth/afwall,open,Blocking root UID even when it is whitelisted,[],"Similar to #475 and #809
When root (UID 0) it's whitelisted it is still blocked by AfWall.
I want to whitelist root so I can get rid of netd. Thank you."
ukanth/afwall,open,Prevent apps from bypassing AFWall,[],"According to this [post](https://www.reddit.com/r/CopperheadOS/comments/7j57zd/gboard_privacy_and_security/dr5272t/) from the developer of CopperHeadOS, and this [one](https://www.reddit.com/r/CopperheadOS/comments/7j57zd/gboard_privacy_and_security/dr586zd/), apps can still _bypasss_ the firewall _""via APIs exposed from the base system or other apps ""_

These posts would seem to indicate that in certain cases, AFWall (or any other firewall, for that matter) will NOT block access.

Can you please provide feedback on this issue which seems to be critical?

Are there any ways to prevent the above, currently with AFWall? If not, any plans to address it?

Edit: I see there are a number of related tickets, e.g. #723"
ukanth/afwall,open,Apps installed inside island but not on mainland are not listed,"[Label(name=""Bug""), Label(name=""Low"")]","Hi,
When using Island, the Apps installed inside island but not on mainland are not listed in afwall.
Of course dual apps option is enabled. Apps installed on both or only mainland are listed."
ukanth/afwall,open,Creating a custom rule to whitelist an app of a different user,[],"I am using AFWall+ in whitelist mode and I have two user accounts:  
- A main account ""Owner"" that has all my apps (but WhatsApp)
- A second account ""WhatsAppSandbox"" that only has WhatsApp

On the main account WhatsApp doesn't show up in AFWall+ because it's on the other account. And because I'm using the whitelist mode, WhatsApp is now blocked.

I would like to add a custom rule/script to AFWall+ to whitelist WhatsApp on the other account. 

Can you tell me if this is possible and if so, how it can be done?"
ukanth/afwall,open,Logs should include timestamps,"[Label(name=""Feature""), Label(name=""Low"")]","I am trying to investigate unauthorized mobile data usage on my phone. I know that the phone generates traffic not at the same time, but in a defined time periods (I know it because my cellular provider has this feature where it blocks data when I'm not subscribed to any data package and notifies me by sms). In the current state of logging in AFWall I can see the blocked traffic but without the timestamps I am unable to make a conclusion whether this traffic could be the cause of cellular data leakage before or not.
I guess the way AFwall ""aggregates"" streams in the log at least it could provide start and end timestamps. Right now it has some timestamps in the ""new view"" but it's not clear if its the start or the end time, and the ""old view"" doesn't have timestamps at all.
"
ukanth/afwall,closed,FR: Trim logs,[],"HI

It would be great if the logs for the donation version trimmed regularly. These logs getsinsane!!!! It takes like 10 mins to open the log window :("
ukanth/afwall,open,Connection Confirm,"[Label(name=""Feature""), Label(name=""Low"")]","First of all thanx for a great app
I saw this on issue 269 where a new connection is passed to the user for conformation, this is possible to do with NFQUEUE with a chain that sends to the queue and that sends to the user for conformation. It would have to be with connection tracking because without it every packet will need to be given a ok. This was done for discowall (a bachelor thesis) by the compiling the libnetfilter_queue  library for android (it is native c of course) and making a front end to pass on the users decision I would also suggest that their be a option to always enable the app also thus minimizing the use of the queue which is slow. Since that doc nfqueue has uid support and can do multiple queues. I will try to help with what I can.
Applied protocol  "
ukanth/afwall,open,mnl_cb_run: Operation not permitted,"[Label(name=""Bug""), Label(name=""Low"")]","Log:
/data/user/0/dev.ukanth.ufirewall/app_bin/nflog 40
mnl_cb_run: Operation not permitted"
ukanth/afwall,closed,Version 2.9.9 log not identical ,"[Label(name=""NoInfo"")]",When I switch between the old view and new view of log viewer the items show identical. What I did before was clear log at old view and stay at old view without switch back to new view until when I notice toasts show up but no log info then I try switch back to new view can see the log. 
ukanth/afwall,open,Version 2.9.9 would active after restart,"[Label(name=""NoInfo"")]","Recently I notice it wouldn't block the traffics after restart. The settings show enabled but still able to access the internet on blocked app. After disable it and enable again or apply the settings again it back to normal. For log toasts notifications also not showing and log is empty, after I disable and enable it again it back to normal. "
ukanth/afwall,open,App restrictions are ignored?,"[Label(name=""NoInfo"")]","Hi

Yes I have a custom script and when I enable the custom script, app restrictions (ones done via the ui) are all ignored, like a limited app still able to connect to internet.

I can get the app restrictions back if I disable the custom script :( So I  messed up somewhere probably btu I do not know where.

Here is my custom script
https://paste.debian.net/hidden/4e022d2b/

I am using Afwall v2.9.9 donate version on Samsung phone Lollipop 5.1 with SuperSu with auto binaries.


thanks"
ukanth/afwall,closed,new error: package manager has died.,[],"Error:java.lang.RuntimeException: Package manager has died

Just started getting this in a toast. No idea why. It's from afwall donate latest version."
ukanth/afwall,open,Duplicate rules with Custom Scripts and IPv6 enabled,[],"What I've seen is that adding lines to the ""Set custom script"" box that don't use the $IPTABLES variable (because of different IPs for v4 vs v6, for example, which would otherwise cause an error) seems to run the line twice.
This can be observed by keeping track of the number of rules before and after adding the line.

As far as I can tell this isn't normally an issue since duplicate iptables rules don't seem to actually be created. However, I'm also using it a bit as a convenient place for a Wireguard-related ""ip rule add"" command; That _is_ duplicated, and requires a duplicate shutdown script line to actually get rid of it.

I'm not sure what the easiest way to change this would be; adding an extra box for commands that don't use $IPTABLES might work.
I don't know if this is an issue for when a script file is loaded or not."
ukanth/afwall,closed,[WIP] Transparent Torification support,[],"I'm not familiar with the codebase or Android development in general, but this seems to work. I copypasted the VPN implementation to add a new checkbox that pushes traffic through Orbot. Works on my phone.

Is this a viable feature to be added? If so I'll clean it up."
ukanth/afwall,open,Unknown process in the log,[],"Hi

I have been getting this ""Unknown(1000)"" process in the log (paid user here) since the last update. I do not remember this unknown thing before, and I cant see some of my individual app logs, I believe they are bundloed in this uknown process for a while.
'
I am using Lollipop 5.1 with Afwall 2.9.9


thanks"
ukanth/afwall,open,Use /dev/kmsg instead of dmesg for logging if possible,[],"Since most `dmesg` implementations don't offer a `--follow` you are currently repeatedly calling `dmesg -c` as a sort of workaround.

This obviously works, but has a few issues:
* every single second new `dmesg` and `sleep` processes are spawned
* if you want to use `dmesg` for debugging, you're kind of screwed since you'll find it to be empty

Obviously you'd only want it as an additional option, maybe not even the default:
* it's Linux 3.5+ [(doc)](https://github.com/torvalds/linux/blob/master/Documentation/ABI/testing/dev-kmsg#L3)

As a proof of concept that it, in fact, works:
```diff
diff --git a/aFWall/src/main/java/dev/ukanth/ufirewall/service/LogService.java b/aFWall/src/main/java/dev/ukanth/ufirewall/service/LogService.java
index 58ce0f83..ac054b91 100644
--- a/aFWall/src/main/java/dev/ukanth/ufirewall/service/LogService.java
+++ b/aFWall/src/main/java/dev/ukanth/ufirewall/service/LogService.java
@@ -221,17 +221,7 @@ public class LogService extends Service {
                 }
                 switch (G.logTarget()) {
                     case ""LOG"":
-                        switch (G.logDmsg()) {
-                            case ""OS"":
-                                logPath = ""echo PID=$$ & while true; do dmesg -c ; sleep 1 ; done"";
-                                break;
-                            case ""BX"":
-                                logPath = ""echo PID=$$ & while true; do busybox dmesg -c ; sleep 1 ; done"";
-                                break;
-                            default:
-                                logPath = ""echo PID=$$ & while true; do dmesg -c ; sleep 1 ; done"";
-                        }
-
+                        logPath = ""echo PID=$$; exec awk 'BEGIN {FS=\"";\""} /^[^ ]/ {print \""[0.0]\"", $2}' < /dev/kmsg"";
                         break;
                     case ""NFLOG"":
                         logPath = Api.getNflogPath(getApplicationContext());
```
this uses `awk` to transform the `/dev/kmsg` format to something similar to what `dmesg` uses by:
* ignoring lines starting with "" "" [(doc)](https://github.com/torvalds/linux/blob/master/Documentation/ABI/testing/dev-kmsg#L74)
* splitting on "";""
* appending the second field to ""[0.0] "" and printing it (the time is ignored anyways, I think)

This kind of works at first on my Nexus 5x, LineageOS 15.1-20180528, Linux 3.10.73-g92a0599 (the toasts do show up), but I have a problem where:
* when I close AFWall+, ~2 more processes are spawned (`ps -A  | grep awk`)
* when I try to open it again, it sometimes crashes after using 100% CPU  and showing a gray screen for a few seconds
* if it does open again, it spawns even more processes upon closing
* e: oops, sh doesn't do job management (added `exec` to diff, still happens, though)

One concern I have is that this would conflict with [`clearLog()`](https://github.com/ukanth/afwall/blob/b86695b570e155d162d0401476b38cef8c629193/aFWall/src/main/java/dev/ukanth/ufirewall/Api.java#L1252) but it doesn't seem to be used anywhere so I don't know what it's actually for.

Implementation-wise:
* using `awk` in this kind of way is kind of a hack and the alternative would be a lot more complicated, so I don't think I could do it since I know neither the codebase nor java
* if `/dev/kmsg` exists, it should probably work
* reading `/dev/kmsg` needs root on my Nexus 5x
* it's what the coreutils `dmesg` uses instead of the `syslog(3)` syscall (busybox uses that one)
* only the stuff after the "";"" should be relevant for AFWall+
* it's guaranteed to block on reaching the end [(doc)](https://github.com/torvalds/linux/blob/master/Documentation/ABI/testing/dev-kmsg#L33)
* would you treat it as an additional option in 'Preferences > Log > Log fetch method' or as something separate?
* if you want to stick with this hack:
  * you could also use `sed -n 's_[^;]*;\(.*\)_[0.0] \1_p'` or maybe even `cut` somehow
  * you could still distinguish between system and busybox `awk`/`sed`
* i you don't, I guess you'd use `cat /dev/kmsg` in the su shell and process it in java
  * `cat` should be offered by the system, right?
* e2: killing and restarting it frequently would be suboptimal since it would start reading from the beginning every time and there's no easy way to `seek` [(doc)](https://github.com/torvalds/linux/blob/master/Documentation/ABI/testing/dev-kmsg#L50) in the shell

If you don't want to implement this, maybe you could answer some of those questions, so I could maybe still try it."
ukanth/afwall,closed,Version 2.9.9 notification filter list missing,"[Label(name=""Duplicate""), Label(name=""Question"")]",In notification filter settings it only listed 1 item mDNS all others processes not listed. And previously listed also not sort in order. 
ukanth/afwall,open,AFWALL DISABLED during sleep,"[Label(name=""Review"")]","When I wake up from sleep, i found AFWall **disabled**. This is a big leaks during sleep. I am sure my credentials is stolen and encryption key is stolen, and device ID and real IP address behind VPN is revealed and sent to bad people behind big company or Google servers. **Because AFWall so weak** and the developer are pro Google evil. AFWall should have Self-Protection! Mankind is more important than mutant.

AFWall: v2.9.9
OS: Oreo 8.1 LineageOS based"
ukanth/afwall,open,Android 8.1 Port Forwarding,[],"I have afwall configured to use the built-in iptables binary and I am trying to perform port forwarding using the custom script function. Here is the entire script:

```
$IPTABLES -I INPUT 1 -p udp --dport 67 -j ACCEPT
$IPTABLES -I INPUT 1 -p udp --dport 6700 -j ACCEPT
$IPTABLES -A PREROUTING -t nat -i ncm0 -p udp --dport 67 -j REDIRECT --to-port 6700
```
The idea is that any DHCP traffic coming from interface ncm0 should be port forwarded to 6700 so that an Android application listening on that port can intercept DHCP DISCOVERY requests (UDP broadcast). These rules appear at startup so it appears that afwall is executing the script.

I have the script installed at /data/local/afwall/afwall.sh, the group/owner is shell, with 755 permissions.

Any ideas on why the Android application can't receive traffic? The application receives the traffic if it comes in on port 6700, but the redirection from 67 to 6700 does not appear to work. 

Should I look into using the ""afwall-x"" chain(s)? If that's part of the solution, do I need to do something about ncm0? Most AOSP devices do not have this interface by default, I am enabling it via superuser shell execution via the Android USB gadget driver:

https://osmocom.org/projects/quectel-modems/wiki/Android_USB_Gadget


"
ukanth/afwall,closed,Fix Magisk init.d support: use real path instead of symlink due to ch…,[],"In Magisk 16.3 and above the symlink ""/magisk -> /sbin/.core/img"" got removed.
This replaces the symlink with the real path so the ""fix startup data leak"" feature in aFWall works with newer Magisk installations.
"
ukanth/afwall,open,"use system device protection must be on to to enforce ""disable confirmation"" on widget",[],"I can still disable the firewall with the widget when confirm firewall disable is on. Unless I have ""use system protection"" enabled. 
However when switching multiple profiles it only asks password when switching to first profile, not out of first profile to others."
ukanth/afwall,open,VPN control not working - AFWall+ doesn't block / blocks when it shouldn't,[],"**What I want to achieve:**
no Internet connection for any app when VPN is not connected

**My setup:**
Lineage OS 14.1, with integrated VPN client via Settings -> More -> VPN
AFWall+ in whitelist mode and enabled ""VPN control""
grant mobile access to ""(root) - Apps running as root"" and ""(vpn) - VPN networking"", with this I can connect to my VPN Server over mobile data

**Test 1:** grant vpn access to browser, connect to VPN 
_Expected behavior:_ browser has internet access over the VPN
_Actual behavior:_ browser doesn't have internet access

**Test 2:** disable vpn access to browser, grant mobile access to browser, connect to VPN
_Expected behavior:_ browser doesn't have internet access (because VPN is connected, and browser doesn't have vpn access, only mobile access)
_Actual behavior:_ browser has internet acces _over the VPN_ (verified by checking the IP adress - the browser uses the IP of the VPN Server, not the IP of the phone via mobile data).

**Summary**
AFWall+ blocks when it shouldn't (VPN access granted) and doesn't block when it should (mobile access granted but no vpn access granted) when VPN is connected.

Without VPN, AFWall+ works fine (blocks internet access when wlan/mobile access is not granted)
Maybe this is related to https://github.com/ukanth/afwall/issues/782 ?
My setup is more or less the same as in the screenshots from @Primokorn in https://github.com/ukanth/afwall/issues/782#issuecomment-350983603, except that I don't use OpenVPN, but the integrated VPN client of Android/LineageOS.

Any ideas, or is this a bug and AFWall+ doesn't work with the integrated VPN client?"
ukanth/afwall,closed,Notification channels ,"[Label(name=""Feature"")]","Please support [Android O's notification channels. ](https://developer.android.com/guide/topics/ui/notifiers/notifications.html#ManageChannels)

I'm glad there are settings for the notification types AFWall has, but the channels would give more flexibility, for example: 

- Hide (but have, for stability) the permanent notification 
- Use low priority for filter applying 
- Use highest priority for install notifications 

Also Android 8 [has a bug](https://issuetracker.google.com/issues/62907528) (fixed in P preview) where it doesn't let the user apply any priority changes to notifications if the app doesn't support separate channels, this would be a great fix for that too. "
ukanth/afwall,open,AFWall+ not working using android orio 8.1,"[Label(name=""NoInfo""), Label(name=""Review"")]",I am using AOSP Extended ROM 5.4 having android v 8.1.
ukanth/afwall,open,microG not in app list but blocked by Afwall+,"[Label(name=""Review"")]","Hello,

Afwall+ blocks internet access of microG but the application is not in the list of applications.
Due to this the app can not be unblocked and makes its usage impossible.

- Access denied recorded in ""Firewall Logs"" for the app
- ""Access Blocked"" message appears as toast message aswell
- App works fine if Afwall+ is disabled
- Triplle checked application list of Awall+, even used the search function
- ""Show filters"" disabled in the ""UI Preferences""

Firewall log entry name:
""com.google.android.gms (10118)""

Additional information:
- Application path: ""/system/priv-app/com.google.android.gms/base.apk""
- Original file: https://microg.org/fdroid/repo/com.google.android.gms-12221403.apk
- Device operating system ""OREO (8.0.0)""
- Device: ""Zuk Z2 Pro"" / Model: ""ZUK Z2121""

Any ideas how to solve this problem?"
ukanth/afwall,open,No Network after disabling firewall ,[],Disabling the firrwall and rebooting results in permanently disabled network connection
ukanth/afwall,closed,Afwall+ Donate does not see Simple Calendar,"[Label(name=""Duplicate""), Label(name=""Question"")]","Hi:  Afwall+ Donate does not see Simple Calendar.  It does not prompt for permissions on install, nor is it listed after install.  Nor is it blocked in any way.  This is a first for me, and not sure what to do.

I have not tried other ""Simple Apps"" to see if this is something that effects all their apps.

AFWall+ (Donate) v2.9.8
SlimROM 7.1.2 Nougat"
ukanth/afwall,closed,Youtube force closes when you firewall wifi or mobile data. ,[],"When I block wifi or mobile data for Youtube via afwall, youtube force closes. When I enable them again, the app works just fine. 

Huawei Nexus 6P 8.1.0 Rooted Magisk."
ukanth/afwall,open,init.d directory path needs updating for Magisk 16.3,[],"I'd swear that there used to be an entry in there for Magisk and/or SuperSU. I suspect the issue is that the /magisk symlink has been removed as of 16.3 and you have to use the /sbin/.core/img/ path instead.
"
ukanth/afwall,open,beta: notification filter is empty,[],I don't get a list of installed apps to choose from in the log notification filter.
ukanth/afwall,open,afwall not blocking when wireguard active,[],"I'm running wireguard as a VPN. It works fine (one exception, which I'll get to). Afwall works fine when wireguard isn't active. When it is active afwall doesn't block anything. Wireguard activates at boot, with a script in /sbin/.core/img/.core/service.d
It activates before afwall. If afwall is active, or if it was active and I disable it, bring down wireguard then try to being it back up I get an error ""RTNETLINK answers: Out of memory""
I have an attachment if I can figure out how to attach it :) contains ifconfig, rule dump, afwall settings.
Looks like I need desktop view.
(url
[afwall.zip](https://github.com/ukanth/afwall/files/1887954/afwall.zip)
)"
ukanth/afwall,open,Instant apps,[],"I can't use instant apps when afwall is on. In log I get deleted application. 
 https://imgur.com/a/2mPLB"
ukanth/afwall,open,rules not applying ,[],"I am having severe issues with the rules not being applied correctly or not at all. I have tried many combinations of rules (both for accept and reject) but it seems that, the only way for this to work is to have afwall open, then switch back and forth to wifi and cell data a few times until rules apply.
However, at reboot the problem is there again. These make the effort really a struggle and not usable. I have bought the support version, hoping that some of the options there could help (fix startup data leak ON), but they did not. I am sure there must be another way...

Could you please help? Maybe with settings and rules that actually work? I do not need to apply and re-apply the rules every time and I could live with ""apply rules on every connectivity change"" as disabled (which also would make the use of the app a much smoother experience imho).

Device is redmi 4x.

Thanks and hope to be able to actually use this great app."
ukanth/afwall,closed,Only one item ([1020] mDNS) in Notification filter list ,[],"Preferences > Log > Notification filter > [1020] mDNS

Lineage OS 14.1, Android 7.1.2, LOS SU, Afwall+ 2.9.9-BETA-1 installed on top of v2.9.8 with Unlocker 1.0.1.

Later I'll test a clean install without locker, then add locker.

[Afwall2018-04-01-22-04-58.txt](https://github.com/ukanth/afwall/files/1866912/Afwall2018-04-01-22-04-58.txt)
![screenshot_20180401-220337](https://user-images.githubusercontent.com/14972114/38180489-fc692622-35fa-11e8-8cf3-fa11be129f64.png)
"
ukanth/afwall,closed,AFWall+ is allowing connections via mobile data despite app being blocked.,[],"Ok, I've been using AFWall+ for 8 months now, but I didn't have to use mobile data frequently until a month ago. While checking data usage today, I noticed that apps that I've blocked with AFWall+ were using my data. 
https://i.imgur.com/IDc4ARb.png
I'm able to browse websites in Chrome even though I've blocked it with AFWall+. Yes, I clicked on ""Apply"" after checking Chrome. I enabled logging then & even though it shows blocked, Chrome is able to load websites.

Here's the log:
`
	---------
AppID :	10395
App Name:	Chrome
Total Packets Blocked:	6
[UDP]49.45.0.1:53(1)
[UDP]8.8.8.8:53(5)

	---------
`
 
AFWall+ v2.9.8
SlimROM 7.1.2 Nougat
One thing to note is that my phone is a dual SIM phone, not sure if that's causing this.
If further details are required, ask away."
ukanth/afwall,open,Default Rule For New App Installs?,[],"Not really an issue. More like an enhancement request...

Your app works great under most conditions I have tried so far. However, it seems that any time I install a new app I will have to go into your app and update the settings for that new app and apply them. I wonder if it is possible to do something to relieve this burden?

I was thinking that your app could listen for new installs (not needed/wanted for update installs) and, when they occur, automatically apply a default rule that the user specifies. In my case, by default I will want any new app to be granted access to wifi/lan but not to 3G/roaming. So I was thinking that at the bottom of the current display, beneath the final line (Any App) you could place a new line where the user can specify the default pattern to use.

I don't know yet what your app does if the user uninstalls an app that has had a rule set for it. One of my apps, Keyboard Master, listens for app uninstalls and removes any settings the user has made for that app (if any). It just seems like the suggestion above would go along with something like this."
ukanth/afwall,open,LAN WLAN Icons seem to be swapped,[],"Discovered that different devices on lineage 7/8 do support LAN over USB on the go.
Activated the LAN option, so that I can allow apps to access internet over LAN.
The but the symbols for LAN and WLAN seem to be swapped.
First row is LAN, then WLAN, then Mobile, then Roaming.
If I want to allow an App to use LAN I've to select it in the WLAN row.
This little bug should be fixed."
ukanth/afwall,closed,No apps in the list except AFWall+ itself,[],"AFWall+ installs fine, and seems to be working - I was able to block everything with it, but there are no apps in the list, so I cannot configure individual permissions for the apps.

I'm not really sure if it is an issue with AFWall+ or with my device, but here it is.

OS: MIUI 8.5.4
Root: Magisk

Any ideas of what should I check?
"
ukanth/afwall,closed,"Toaster popup reporting Linux Kernel blocked, when rules are set to allow.","[Label(name=""Bug""), Label(name=""Low"")]","Something very similar to issue #475 seems to have reappeared. Not sure if the messages are falsely reporting however - the destination addresses in the log for UID -11 resolve to typical analytics addresses like Google/Facebook/Amazon etc and also internal LAN IPs). Linux Kernel is whitelisted in the rules. 

Any idea what's happening here?"
ukanth/afwall,open,Big trouble with Android 5.1.1 (Lenovo K5),[],"A clean installation of latest afwall in a brand new Lenovo K5 Vibe (Android 5.1.1) with latest Magisk installed yielded the following problems:

1. Without ""fix startup data leak"", when phone boots, no firewall is applied. Every app in the phone can communicate with the internet freely. When applying firewall manually, things come to normal.

2. With ""fix startup data leak"" enabled, when phone boots, no app can communicate with the internet (good) but when I activate cellular data, still no app can communicate with the internet. Same problem if the phone starts with cellular data enabled. If I apply the firewall manually, things come to normal.

3. Regardless of (1) or (2), when I re-apply the firewall for any reason, there is a big chance that it will stop blocking irreversibly. Only wayout out of this is to restart the phone.

4. In the preferences, when I try to change the sliders for ipv4 outgoing and forward, afwall crashes and immediately re-starts with the slider in the correct position. However, when I try to change the incoming slider, afwal does not let me at all (no crash this time). When I try to change the corresponding ipv6 sliders, I can't. Whatever I try, they remain disabled. Interestingly, when I instruct afwall to use my system's ip(6)tables and busybox, all ipv4 and ipv6 sliders now can be set or re-set without problems.

5. When using my system's busybox and afwall's ip(6)tables binary (or the reverse, I can't precisely remember), when applying the firewall results in an endless loop where firewall rules are enumerated again and again and the only solution is to kill the app.

My safe conclusions are:
a. Afwall is able to receive and process the boot_complete. However it appears to be missing/misprocessing the network_state_changed and does not apply correctly. Thus I need to apply it by hand when a network iface changes state.
b. Afwall exhibits sensitivities to the binaries used, in a degree that renders some of it's funcionalities unstable or even forces the entire program to crash.

For reference, I used the latest version from f-droid and also from github. Even tried with one version before the latest, still problems.

I ask you to look at these issues. In between, have you got any sort of graphic representation/schematic of the firewall you create with afwall, so I can replicate this with shell script? I can listen to netd directly if I want."
ukanth/afwall,closed,"Add ""System default"" to the list of languages","[Label(name=""Wont-Fix"")]","When I start AFWall+ on device with non-English language in the first time, it starts in English. It's not comfortable to change it manually (especially for those who doesn't know it).
Could you add ""System default"" to the list of languages and set it on by default?"
ukanth/afwall,closed,"Small usability enhancement request: New Column ""Enable Notification Filter""","[Label(name=""Feature""), Label(name=""Low"")]","Good evening
thanks a lot for this great firewall!, it's really a useful work.

**I have a small proposal:
The notification filter is very useful, but the handling is unnecessarily complicated:** 

1. Open Settings
2. Guess where to find the notification Filter (hint: Preferences)
3. Guess where to find the notification Filter (hint: Log)
4. Select Notification filter
5. Scroll up and down and try to find the application

**I suggest that afwall offers an additional column on the main screen** (optional, if applicable): ""Enable Notification Filter""

Icon | LAN | WLAN | Notification filter | …
------------ | ------------- | ------------- | ------------- | -------------
:-) | x | o | x | [ 1011 ] (ADB) - …
:-( | x | x | x | [ -11 ] (Kernel) - …

if we could display such a column, the handling would be much easier.

kind regards, Thomas

"
ukanth/afwall,closed,FR: Adaptive icon,"[Label(name=""Feature""), Label(name=""Low"")]","Api 26 introduced adaptive icons where background and foreground are two different images.
https://developer.android.com/guide/practices/ui_guidelines/icon_design_adaptive.html"
ukanth/afwall,closed,Reliabiltiy of status bar notification?,"[Label(name=""Bug""), Label(name=""Low"")]","After flashing an LOS update I forgot to re-root my device. Starting AFWall leads to the correct warning, that the firewall won't work on an unrooted phone. If you choose the ""Continue"" button, nevertheless the status bar notification will be launched immediately telling you the ""Firewall is activated"" though no rule can be applied at all. Same behavior, if you cancel the dialog and select ""Apply"" in the menu. Again the notification is talking about an activated firewall.
The trigger for the notification seems to be just the click but not the successful application of rules. "
ukanth/afwall,open,VPN connection PPTP type,[],"As #236 , Need add Manual Configuration of VPN connection PPTP type in Options to add other vpn Setting."
ukanth/afwall,closed,Thank you,[],"### A small piece of software you might easily forget

Sometimes the apps you most use are the ones you most easily forget. I mean, that is not even a bad thing. Such apps should just act like ""install & forget"". One just installs it and you may get some notification then or now and that's it. But that's how they should work.

And that is how AFWall+ works. It works flawlessly, I've never had a problem with it and it's just a great small piece of app, you have running any time, but only think about for one day in a year or so. And if that should be this day, so be it.

Let's that be a reminder of how many great small pieces of software we have running, but never think about.

Best regards,
rugk

(at #ilovefs day also published at [thankyouopensource](https://www.thankyouopensource.com/letter/272/A-small-piece-of-software-you-might-easily-forget/))"
ukanth/afwall,closed,security pattern bypass,"[Label(name=""Bug"")]","in nova launcher (or possibly others too) when you long press app icon you can choose preferences/logs/rules. even with security pattern set up, you can enter those and change anything, including flushing rules without pattern. "
ukanth/afwall,closed,Error while applying the basic ruleset and some other small things,[],"Since I switched to Android 8.1 Oreo, I always get an error after applying 33/x rules of the basic ruleset (I just installed the app and enabled it). I checked the logs and that's what afwall writes down there:
```
command 'iptables -A afwall-reject -j REJECT' exited with status 1'
Output:
iptables: no chain/target/match by that name
```
Something else I encountered: While enabling log service from within the app, I get a toast message telling me, that my kernel does not support NFLOG, but when checking `/proc/net/ip_tables_targets` NFLOG and LOG are present, so it should be supported.

Besides that I noticed a typo in some log output:
`Total commamds: #xx` should be `Total commands: #xx`


I hope someone has an idea what the culprit of my main issue could be :)
Regards Shadowghost

PS: If you need more logs or anything else, just tell me."
ukanth/afwall,open,unable view the allowed IPs,"[Label(name=""Feature"")]","Thanks for the great work @ukanth 
We are able to view only the blocked  apps traffic ,
As a Firewall it has to show which IPs are being allowed to connect.
With this we can block certain ips completely , then it well become a complete firewall, which just allows what we want to"
ukanth/afwall,closed,integrate notification filter into main app rules list,"[Label(name=""Duplicate"")]","I think it makes no sense to have the notification filter as a separate view.
Please integrate the notification filter into the main app rules list by simply adding a logging checkbox to each list entry.
Thanks in advance."
ukanth/afwall,open,k9mail leak report bug,[],"I have a note 4 on marshmallow with the exposed module running.
I switched my phone into airplane mode (k9 mail had mobile network access and no app has Wi-Fi or lan access) then switched on Wi-Fi. After 10 minutes I then switched my firewall rules to lan only(where k9 mail has no internet access granted and no app has mobile network access) and did a few things on Wi-Fi for about 45 minutes. I then turned off Wi-Fi and turned off airplane mode.  10 minutes later I switched my firewall profile to mobile access where k9 has access.
The next time k9 checked my mail I had Google's someone tried to access your account that I always get if I try to get my mail anywhere but my mobile network.

So some where k9 mail accessed the internet on Wi-Fi when it never had Wi-Fi access from the firewall..

Unless there is another explanation I don't know.
And I have 10 email address getting checked and they all reported the access.so it was not a tiny leak."
ukanth/afwall,closed,Afwall has a Problem with SuperSu,"[Label(name=""Review"")]","Hello,

my rootet Android-Phone (Miui 9 7.11.16 with afwall 2.9.8) with SuperSu has a Problem to execute the rules sometimes. I have Wifi-Matic installed, who disabled the wlan if i go outside from my known wlans. This seems to happen when I have a change in connection (e.g. from wifi to cell) and it is reapplying the rules independently from wifi-matic. But even when I'm at home, afwall has a problem taking over the rules. Afwall is install on the internal storage only. I have often cleared the app-cache and i have convert the app to a system-app. But it dont help. Who can help me? Any Tips? The log says:

```
==========
IPv4 Rules
==========


==================
Network interfaces
==================


==================
Network interfaces
==================


========
ifconfig
========


========
ifconfig
========


===========
System info
===========

Android version: 6.0.1
Manufacturer: Xiaomi
Model: Redmi 3S
Build: MMB29M
Active interface: wifi
Tether status: no
Roam status: no
IPv4 subnet: 192.168.178.23/24
IPv6 subnet: 
/system/bin/su: not present
/system/xbin/su: not present
/data/magisk/magisk: not present
/system/app/Superuser.apk: not present
Superuser: eu.chainfire.supersu v2.82-SR5

===========
Preferences
===========

activeNotification: false
activeRules: true
appVersion: 15980
bb_path: builtin
controlIPv6: false
disableIcons: false
disableTaskerToast: false
dns_value: disable
enableDeviceCheck: false
enableIPv6: false
enableLAN: true
enableRoam: false
enableVPN: false
fixDownloadManagerLeak: false
forward_chain: false
forward_chain_v6: true
hasRoot: true
input_chain: false
input_chain_v6: false
ip_path: auto
ipurchaseddonatekey: false
locale: de
notification_priority: 0
notifyAppInstall: true
output_chain: false
output_chain_v6: false
passSetting: p0
patternMax: 3
runNotification: true
showFilter: true
showUid: true
sysColor: -10432
Profile Mode : whitelist
Status : Enabled

======
Logcat
======

22:19:50 Selected Profile: AFWallPrefs
22:19:50 Received cmds: #1
22:19:50 Starting root shell...
22:19:50 Selected Profile: AFWallPrefs
22:19:50 Restarting RootShell...
22:19:50 Received cmds: #1
22:19:50 Root shell is open
22:19:50 Start processing next state
22:19:50 Total commamds: #1
22:19:50 Start processing next state
22:19:50 Total commamds: #1
22:19:52 Received cmds: #19
22:19:52 Start processing next state
22:19:52 Total commamds: #19
22:19:55 State of rootShellREADY
22:19:57 Using applySavedIptablesRules
22:19:57 Setting OUTPUT to Drop
22:19:57 isWifiApEnabled is false
22:19:57 Setting OUTPUT to Accept State
22:19:57 Received cmds: #208
22:19:57 Start processing next state
22:19:57 Total commamds: #208
22:20:04 libsuperuser error -1 on command '. /storage/emulated/0/afwallscripts/iptables_on.sh'
22:20:49 Selected Profile: AFWallPrefs
22:20:54 Received cmds: #19
22:20:54 Starting root shell...
22:21:02 Using applySavedIptablesRules
22:21:02 Setting OUTPUT to Drop
22:21:02 Setting OUTPUT to Accept State
22:21:02 Received cmds: #208
22:21:07 State of rootShellBUSY
22:21:07 Forcefully changing the state BUSY
22:21:07 Start processing next state
22:21:07 Total commamds: #19
22:21:07 libsuperuser error -2 on command 'iptables -F afwall'
22:21:07 Start processing next state
22:21:23 Received cmds: #19
22:21:23 Starting root shell...
22:21:38 Using applySavedIptablesRules
22:21:38 Setting OUTPUT to Drop
22:21:38 Setting OUTPUT to Accept State
22:21:38 Received cmds: #208
22:21:43 State of rootShellBUSY
22:21:43 Forcefully changing the state BUSY
22:21:43 Start processing next state
22:21:43 Total commamds: #19
22:21:43 libsuperuser error -2 on command 'iptables -F afwall'
22:21:43 Start processing next state
22:21:51 Selected Profile: AFWallPrefs
22:21:53 Received cmds: #1
22:21:53 Starting root shell...
22:21:56 Received cmds: #1
22:22:01 State of rootShellBUSY
22:22:01 Forcefully changing the state BUSY
22:22:01 Start processing next state
22:22:01 Total commamds: #1
22:22:01 Received cmds: #1
22:22:01 libsuperuser error -2 on command 'iptables -n -v -L'
22:22:01 Start processing next state
22:22:01 Received cmds: #1
22:22:01 Start processing next state
22:22:01 Received cmds: #1
22:22:01 Start processing next state
22:22:01 Received cmds: #1
22:22:01 Start processing next state

===========
System info
===========

Android version: 6.0.1
Manufacturer: Xiaomi
Model: Redmi 3S
Build: MMB29M
Active interface: wifi
Tether status: no
Roam status: no
IPv4 subnet: 192.168.178.23/24
IPv6 subnet: 
/system/bin/su: not present
/system/xbin/su: not present
/data/magisk/magisk: not present
/system/app/Superuser.apk: not present
Superuser: eu.chainfire.supersu v2.82-SR5

===========
Preferences
===========

activeNotification: false
activeRules: true
appVersion: 15980
bb_path: builtin
controlIPv6: false
disableIcons: false
disableTaskerToast: false
dns_value: disable
enableDeviceCheck: false
enableIPv6: false
enableLAN: true
enableRoam: false
enableVPN: false
fixDownloadManagerLeak: false
forward_chain: false
forward_chain_v6: true
hasRoot: true
input_chain: false
input_chain_v6: false
ip_path: auto
ipurchaseddonatekey: false
locale: de
notification_priority: 0
notifyAppInstall: true
output_chain: false
output_chain_v6: false
passSetting: p0
patternMax: 3
runNotification: true
showFilter: true
showUid: true
sysColor: -10432
Profile Mode : whitelist
Status : Enabled

======
Logcat
======

22:19:50 Selected Profile: AFWallPrefs
22:19:50 Received cmds: #1
22:19:50 Starting root shell...
22:19:50 Selected Profile: AFWallPrefs
22:19:50 Restarting RootShell...
22:19:50 Received cmds: #1
22:19:50 Root shell is open
22:19:50 Start processing next state
22:19:50 Total commamds: #1
22:19:50 Start processing next state
22:19:50 Total commamds: #1
22:19:52 Received cmds: #19
22:19:52 Start processing next state
22:19:52 Total commamds: #19
22:19:55 State of rootShellREADY
22:19:57 Using applySavedIptablesRules
22:19:57 Setting OUTPUT to Drop
22:19:57 isWifiApEnabled is false
22:19:57 Setting OUTPUT to Accept State
22:19:57 Received cmds: #208
22:19:57 Start processing next state
22:19:57 Total commamds: #208
22:20:04 libsuperuser error -1 on command '. /storage/emulated/0/afwallscripts/iptables_on.sh'
22:20:49 Selected Profile: AFWallPrefs
22:20:54 Received cmds: #19
22:20:54 Starting root shell...
22:21:02 Using applySavedIptablesRules
22:21:02 Setting OUTPUT to Drop
22:21:02 Setting OUTPUT to Accept State
22:21:02 Received cmds: #208
22:21:07 State of rootShellBUSY
22:21:07 Forcefully changing the state BUSY
22:21:07 Start processing next state
22:21:07 Total commamds: #19
22:21:07 libsuperuser error -2 on command 'iptables -F afwall'
22:21:07 Start processing next state
22:21:23 Received cmds: #19
22:21:23 Starting root shell...
22:21:38 Using applySavedIptablesRules
22:21:38 Setting OUTPUT to Drop
22:21:38 Setting OUTPUT to Accept State
22:21:38 Received cmds: #208
22:21:43 State of rootShellBUSY
22:21:43 Forcefully changing the state BUSY
22:21:43 Start processing next state
22:21:43 Total commamds: #19
22:21:43 libsuperuser error -2 on command 'iptables -F afwall'
22:21:43 Start processing next state
22:21:51 Selected Profile: AFWallPrefs
22:21:53 Received cmds: #1
22:21:53 Starting root shell...
22:21:56 Received cmds: #1
22:22:01 State of rootShellBUSY
22:22:01 Forcefully changing the state BUSY
22:22:01 Start processing next state
22:22:01 Total commamds: #1
22:22:01 Received cmds: #1
22:22:01 libsuperuser error -2 on command 'iptables -n -v -L'
22:22:01 Start processing next state
22:22:01 Received cmds: #1
22:22:01 Start processing next state
22:22:01 Received cmds: #1
22:22:01 Start processing next state
22:22:01 Received cmds: #1
22:22:01 Start processing next state
22:22:06 State of rootShellFAIL
22:22:06 Start processing next state
```"
ukanth/afwall,closed,widget bypasses firewall disable confirmation,"[Label(name=""Bug""), Label(name=""Low"")]",Using the widget allows disabling the firewall with out confirmation regardless of the settings.
ukanth/afwall,open,Phone locks up every 20 mins,"[Label(name=""Review"")]","With AFWall+ enabled, my phone completely locks up after 20 minutes, then automatically reboots. If I have AFWall+ disabled, there is no problem. If I enable AFWall+ after the system is running, the problem happens 20 minutes after enabling AFWall+.

Other than this, AFWall+ seems to be working fine.

I'm using a Moto X4 with Android 8.0.0, kernel 4.4.78. I'm not seeing any useful info in logcat (probably because the crash happens before logging output can be written)."
ukanth/afwall,open,"""Apply"" very slow",[],"Hi,
we don't need to see every number when applying, it's enough an update every half second!
This will speed up a lot :)
Now with 304 rules I've to wait 13 seconds (Moto G5 Plus).
Thanks 
         N
"
ukanth/afwall,open,"roaming loopback to local network, leaking network usage while roaming","[Label(name=""Review"")]","
[IPv4rules.log](https://github.com/ukanth/afwall/files/1629502/IPv4rules.log)
while roaming on my samsung note 8, apps which are given local network access are able to access internet. attached log. am using dual sim with the second card used for data roaming."
ukanth/afwall,closed,Nevermind,[],"Hi there,

nevermind.

Closed"
ukanth/afwall,open,com.android.providers.downloads logcat spam,"[Label(name=""Bug"")]","I get lot of messages in logcat:

```
01-07 10:25:57.716   225   225 W afwallstart: type=1400 audit(0.0:741): avc: denied { getattr } for path=""/data/data/com.android.providers.downloads"" dev=""mmcblk0p23"" ino=114494 scontext=u:r:sysinit:s0 tcontext=u:object_r:app_data_file:s0:c512,c768 tclass=dir permissive=0
```
I get this multiple times per second.

I tried to kill the app and I even disabled it (`pm disable com.android.providers.downloads`).
But I still get the logcat messages.

Any ideas what the messages mean and why I am getting them?

My device:
Lineage OS 13
Android 7
Nvidia Shield Tablet
Afwall 2.9.7
  "
ukanth/afwall,closed,"Clearer documentation about ""Chains"" options in ""Connectivity settings""",[],"Hi, thanks for writing and maintaining this.

I'm trying to block everything on my device (dumpling) by using the ""allow selected"" mode. However in ""Preferences -> Rules/Connectivity"" there is another section called ""IPv4 Chains"" with toggle-options {INPUT,OUTPUT,FORWARD} chain.

It's unclear how these interact with ""allow selected"" mode. Do I need to be in ""allow selected"" mode as well as switching these three options OFF, to actually block everything? The thing is, the options automatically switch themselves back to ON for some reason I haven't figured out yet. (Also this phone has 2 SIM card slots, I'm not sure if that would keep triggering spurious ""network changed"" events that might be the cause of that.)
"
ukanth/afwall,closed,"Android 8.1 Oreo / 9.0 Pie  ""Error applying iptable rules""",[],"Hello, i just switched to android 8.1 and i'm getting an error while activating the firewall.
Whenever i press activate firewall it starts counting the rules and then responds with
""Error applying iptable rules""
"
ukanth/afwall,closed,Fix #786,[],"Fix #786 , now object ‘ctx’ will not be null any more. I found that we may need much effort on changing “`android.preference.PreferenceFragment`” to “`android.support.v7.PreferenceFragmentCompat`”, here is a simpler way to fix the issue.

We add deprecated function ‘`onAttach(Activity)`’ back, since it is guarantee to execute in all version. In API level 23 or above, ‘`onAttach(Activity)`’ will execute in ’`super.onAttach(Context)`’, so we check API level to make sure ‘`onAttach`’ will always execute and execute only once.

To test (My emulator did not root):
1. Create an emulator with API level 22 or below.
2. Choose “Preference”
3. Choose “Rules/Connectivity”
4. Before this fix, the new Fragement open normally without any hints.
5. After this fix, the new Fragment open normally with a toast “error applying iptables rules”."
ukanth/afwall,closed,Potential Compatibility Issue,[],"Hi, I notice in class `RulesPreferenceFragment.java` you have used function `onAttach(Context)`, which is added in API version =  23. However, `onAttach(Context)` will not execute in API version < 23 (See this [link](https://stackoverflow.com/questions/32083053/android-fragment-onattach-deprecated)).

Class `RulesPreferenceFragment` directly extends `android.preference.PreferenceFragment`. As the official document of Android shows, `android.preference.PreferenceFragment` directly extends `android.app.Fragment`, unfortunately in practice `onAttach(Context)` will not executed if one use `android.app.Fragment`. If you put some important operation into this function, the program may not execute normally in API<23.

My suggestion is simply changing `android.preference.PreferenceFragment` to `android.support.v7.preference.PreferenceFragmentCompat`, which have the same function as `android.preference.PreferenceFragment`, but does not have this potential compatibility issue. "
ukanth/afwall,closed,Can't switch language,"[Label(name=""Bug""), Label(name=""Low"")]",When selecting a different language in settings and restarting the app it's still using the default language.
ukanth/afwall,open,Global domains/IPs filter,[],"I started net monitor recently and I found that some of my app connects to facebook/google without any particular reason.

It would be great to have an option to provide list of domains/IPs that should be blocked globally for all apps. This would have two benefits:
* we could block unwanted traffic
* we could find apps that makes unexpected connection with log and toast notifications"
ukanth/afwall,open,Apps goes through AFWall+,"[Label(name=""NoInfo""), Label(name=""Review"")]","How i can fix that . I have block them through afwall but they still keep using the internet pinging adresses . Any idea what i can do? Im looking for a good uninstaller/freezer too .
4 adresses . (SSL Server Rating PENDING) com.xiaomi.discover runs  ... (7 unecrypted connections http/tcp6) and 2 UIDs (10012 + 1000 ) app.anroid.unkown a lot pending unsucesful and unecrypted connections
 Thank you"
ukanth/afwall,open,"VPN ""on"" Afwall+ allows all apps to access the internet.",[],"Hi,
I am using Afwall+ since many years. I am faceing the following problem. The firewall works perfectly while using it without vpn. But as soon as I switch on the native vpn client “settings, More networks, VPN”, Afwall+ allows every app to access the internet. I have the vpn control box in the Afwall+ menu enabled. 
My phone runs Android 6.0.1.
Any idea why Afwall+ allows all apps to access the internet with vpn “on”? 
"
ukanth/afwall,open,MI-UI of xiaomi devices - dual apps not shown on afwall,[],"MI-UI has a feature called Dual Apps.
This clones the apps for example whatsapp is clonned and can be used as multiple instances on dualsim devices.
Clonned app (dual app) are implicitly blocket by afwall and they are not shown on the app list in afwall.
So there is no way to allow them internet access."
ukanth/afwall,closed,Translations not appearing,[],"As I understand it norwegian (nb) was added to AFWall+ in v2.9.7, but the translated strings don't appear in the app. But there are strangely? an exception with the filters in the main view. All, Core, System, User with the radio buttons in front are in the translated form (not absolutely sure about 'System' because that's the same word in both english and norwegian). Else I cannot see any translated strings.

In the preferences where you can change language, norwegian is not on the list of languages!"
ukanth/afwall,open,AFWall sometimes fails to get root on connection change,[],"I'm having a problem where sometimes AFWall is not granted root status and it fails to apply iptables rules. This is on a Pixel 2, rooted with Magisk. I don't know for sure if this is an AFWall issue or might be a Magisk issue. But Magisk is showing no errors in catlog and I have no problem with other root apps.

This seems to happen when I have a change in connection (e.g. from wifi to cell) and AFWall is reapplying the rules (I have the ""Active rules"" setting enabled in preferences). But it only happens somtimes, not on every connection change. I get a notification saying AFWall could not apply rules and when I open AFWall an error from AFWall saying that it was unable to get root and my device needs to be rooted. If I move AFWall out of the recents menu and restart it that solves the problem (I can then manually apply rules with success and other automatic applications of the rules on connection changes seem to work). Most of the time AFWall works fine.

Attached are some logs, captured right after this happened, from the system through Catlog.

The only clear errors I see there are from the AFWall entries in catlog:

E/AFWall  (22459): libsuperuser error -2 on command 'iptables -P OUTPUT DROP'

and:

E/AFWall  (21817): CONNECTIVITY_CHANGE: applySavedIptablesRules() returned an error


[afwall.catlog.txt](https://github.com/ukanth/afwall/files/1528786/afwall.catlog.txt)
[magisk.catlog.txt](https://github.com/ukanth/afwall/files/1528815/magisk.catlog.txt)


Perhaps my issue is the same as this one (but almost no information is provided there): https://github.com/ukanth/afwall/issues/776"
ukanth/afwall,closed,[Playstore] Confusion about different versions,[],"There are currently three versions of AFWall in Google Play: Free, Paid, Donate. As a lot of users, I'd actually like to support development, but I also like the additional features (quick apply). With two paid options available, I got none so far.

Any chance you could remove one of the paid options from the store so we know exactly which one to get? Maybe even better to make the donation an IAP, cause that way we wouldn't have to export / import our ruleset when switching / upgrading.

Also... could you maybe provide a way of testing the quick apply feature before the purchase / donation?"
ukanth/afwall,open,[Feature request] Global rules,[],"This may be a problem of the documentation (of the documentation and me, actually), too, cause I see there is an ""active rules"" setting that can be disabled, but Idk what exactly that does.

Anyways, there are Android devices that do not provide mobile data and are limited to wifi. Even for those, we need to set one rule for mobile data and one rule for wifi. Any chance we could disable the mobile rule, leaving us only with one global rule for each app?"
ukanth/afwall,open,Error applying firewall rules: click here to open settings,[],"This happens overnight, and I see the error in the morning. My phone also seems to be disconnecting from wifi and reconnecting quite often. Once I apply rules again, the message goes away until I wake up again the next day. 

I can send the rules log (but rather not post publicly), where do I send it to?"
ukanth/afwall,open,Q: Are these necessary for custom script?,[],"HI

I am sorry that I am using the issues for question stuff.

Are these necesary for proper  custom script? What I am wondering is this. Am I supposed to place my custom stuff between the top and and bottom portions (based on the Wiki) given that Afwall also applies some rulez via the ui selections.


thanks


```

IP6TABLES=/system/bin/ip6tables
IPTABLES=/system/bin/iptables

# Flush/Purge all rules except OUTPUT
$IPTABLES -F INPUT
$IPTABLES -F FORWARD
$IPTABLES -t nat -F
$IPTABLES -t mangle -F
$IP6TABLES -F INPUT
$IP6TABLES -F FORWARD
$IP6TABLES -t nat -F
$IP6TABLES -t mangle -F

# Flush/Purge/resetting all rules
$IPTABLES -F
$IPTABLES -X
$IPTABLES -t nat -F
$IPTABLES -t nat -X
$IPTABLES -t mangle -F
$IPTABLES -t mangle -X
$IPTABLES -t raw -F
$IPTABLES -t raw -X
$IPTABLES -t security -F
$IPTABLES -t security -X
$IPTABLES -P INPUT ACCEPT
$IPTABLES -P FORWARD ACCEPT
$IPTABLES -P OUTPUT ACCEPT

# Allow loopback communication (necessary on IPv6)
$IP6TABLES -A INPUT -i lo -j ACCEPT
$IP6TABLES -A OUTPUT -o lo -j ACCEPT

$IPTABLES -A INPUT -i lo -j ACCEPT
$IPTABLES -A OUTPUT -o lo -j ACCEPT


MY CUSTOM SCRIPT BLOCKS AND ALLOWS
MY CUSTOM SCRIPT BLOCKS AND ALLOWS
MY CUSTOM SCRIPT BLOCKS AND ALLOWS
MY CUSTOM SCRIPT BLOCKS AND ALLOWS
MY CUSTOM SCRIPT BLOCKS AND ALLOWS
MY CUSTOM SCRIPT BLOCKS AND ALLOWS



# Restore policies
$IPTABLES -P INPUT ACCEPT
$IPTABLES -P FORWARD ACCEPT

# Drop all but outbound
$IPTABLES -P INPUT DROP
$IPTABLES -P FORWARD DROP
```

"
ukanth/afwall,closed,Accessing only a single IP ,[],"Hi

I am trying to make an app to access a single ip and block its access to everything else.

The app does not have permissions in the ui of Afwall.

This is what I have i my custom script

iptables -A OUTPUT -m owner --uid-owner 10762 -s $IP -p tcp  -j ACCEPT
iptables -A INPUT -m owner --uid-owner 10762 -s $IP -p tcp  -j ACCEPT"
ukanth/afwall,open,Blacklist specific app,[],"I am in whitelist mode, but I want to blacklist one specific app sometimes - how can I achieve this with a script - is there a suitable example that I can examine?

"
ukanth/afwall,open,"a simple ""save"" option without applying the whole profile",[],"I have 4 profiles. When I install an new app, I have to click into each profile, check allow the new app, apply the profile to save the new change. And then repeat 3 more times to save the new rule for this new app in each profile, which takes some time as each ""apply"" takes like 15-20 seconds (over 300 rules).

It would be great if there's a simple ""save"" option so the profile is updated but not necessarily applied. "
ukanth/afwall,open,"After update from F-Droid, notification ""Applying Afwall rules"" flashes too often.",[],"When the network is flaky (underground train), it constantly annoys with a short-lived ""AFWall: Applying rules"" notification. Sometimes there are multiple per second.

It wasn't so before recent update from F-Droid.

Either it should apply rules only when needed or there should be setting to disable this notification.

Unchecking ""Enable notifications"" does not help. Enabling ""Show notification icon"" also does not help.

Version is ""AFWall+ (v2.9.7)"""
ukanth/afwall,open,pass/pin/finger on widget toggle.,[],"hi, a nice  feature was to have to be asked  pass/pin\finger on widget toggle!  what happens now is, if you have any kind of protection on afwall app, the toggle wont work. is reports that have a protection.

thanks 
"
ukanth/afwall,open,[Request] Quick rules,[],"I have some suggestions concerning the app.

1. New app installed. Display pop-up. Contains a drop-down menu. Select profile, current profile selected by default. Two or three buttons depending on connections ""allow/deny"". Button changes color ""red/green"" on click. Bottom of pop-up menu ""Ok/later"" buttons.

2. Allow macrodroid and tasker to allow/deny app rules. When application installed, action prompted. User is presented with features mentioned above.

3. Quick apply options made available from notification (when application installed). *might be difficult when many profiles present. 

4. When click on notification, filter list and jump right to new app."
ukanth/afwall,open,LAN blocked when using VPN - Feature?,[],"For the life of me i cannot find a way to allow LAN traffic when connected via WiFi while connected to VPN.   If this is something easy to allow within the configurations then please tell me how?
Ive tried allowing LAN access to a specific app but it cannot access the LAN.

How to allow access to LAN globally while VPN is connected??

if there is no configuration for this. Is it possible you can add an option to enable global LAN throughput while VPN is connected?"
ukanth/afwall,open,[Question] Reason to use iptables directly instead of ndc,[],"What is the reason AFWall+ uses iptables directly instead of the ndc commands?
According to the code of ndc https://android.googlesource.com/platform/system/netd/+/master/server/FirewallController.cpp
ndc does a similar (maybe even the same) thing to iptables as AFWall.

I already wondered where the fw_* chains come from.
Isn't it problematic to have to another way of setting Firewall chains?
For example if the fw_* chain allows a connection with ACCEPT my afwall chain is ignored if it is later in the chain.

Second question:
has a chain nm_mdmpxy_doze_mode_skip and some unmatched interfaces like dummy0.
where does this chain come from and do I need to add those unmatched interfaces to the firewall too?"
ukanth/afwall,closed,[Request] Automatically switch profile if wifi/rmnet changes,[],"Hi!

While it's not possible to set different dns servers without apps on Android, it would be nice to solve this by afwall itself. 

For wlan I force DNS server over ipfire but the custom afwall script which sets DNS server leads to no connection. Well it's meant to get blocked by the router. So an option to automatically change the profile would be great. So we could use different scripts with different DNS server rules.

I know tasker but I refuse to install apps outside F-Droid that aren't open"
ukanth/afwall,open,[suggestion] Allow local subnet (optional),[],"Allow an option in the GUI to define subnet mask (eg. 192.168.1.0/24) that will add a rule like this:
$IPTABLES -I ""afwall"" --destination ""192.168.1.0/24"" -j RETURN

This might help people not familiar with custom scripts to allow traffic between devices in the defined (home) subnet without granting apps external internet access. 
"
ukanth/afwall,open,Crashes switching default IPtables rules.,[],"I assume these are global rules for the chain, ie outgoing, incoming, forward. So I tried to block all IP6 by setting the sliders to off.

When I change from off to on or vice versa afwall force closes and restarts. The setting does stay however.
```

E/AndroidRuntime( 8347): FATAL EXCEPTION: main
E/AndroidRuntime( 8347): Process: dev.ukanth.ufirewall, PID: 8347
E/AndroidRuntime( 8347): java.lang.NullPointerException
E/AndroidRuntime( 8347):        at dev.ukanth.ufirewall.Api.setBinaryPath(Api.ja
va:305)
E/AndroidRuntime( 8347):        at dev.ukanth.ufirewall.Api.applyRule(Api.java:1
507)
E/AndroidRuntime( 8347):        at dev.ukanth.ufirewall.preferences.RulesPrefere
nceFragment.onSharedPreferenceChanged(RulesPreferenceFragment.java:216)
E/AndroidRuntime( 8347):        at android.app.SharedPreferencesImpl$EditorImpl.
notifyListeners(SharedPreferencesImpl.java:477)
E/AndroidRuntime( 8347):        at android.app.SharedPreferencesImpl$EditorImpl.
apply(SharedPreferencesImpl.java:385)
E/AndroidRuntime( 8347):        at android.preference.Preference.tryCommit(Prefe
rence.java:1380)
E/AndroidRuntime( 8347):        at android.preference.Preference.persistBoolean(
Preference.java:1646)
E/AndroidRuntime( 8347):        at android.preference.TwoStatePreference.setChec
ked(TwoStatePreference.java:84)
E/AndroidRuntime( 8347):        at android.preference.SwitchPreference$Listener.
onCheckedChanged(SwitchPreference.java:54)
E/AndroidRuntime( 8347):        at android.widget.CompoundButton.setChecked(Comp
oundButton.java:127)
E/AndroidRuntime( 8347):        at android.widget.Switch.setChecked(Switch.java:
666)
E/AndroidRuntime( 8347):        at android.widget.Switch.animateThumbToCheckedSt
ate(Switch.java:645)
E/AndroidRuntime( 8347):        at android.widget.Switch.stopDrag(Switch.java:63
5)
E/AndroidRuntime( 8347):        at android.widget.Switch.onTouchEvent(Switch.jav
a:595)
E/AndroidRuntime( 8347):        at android.view.View.dispatchTouchEvent(View.jav
a:7706)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTransformedTou
chEvent(ViewGroup.java:2216)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:1959)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTransformedTou
chEvent(ViewGroup.java:2216)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:1959)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTransformedTou
chEvent(ViewGroup.java:2216)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:1959)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTransformedTou
chEvent(ViewGroup.java:2216)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:1959)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTransformedTou
chEvent(ViewGroup.java:2216)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:1959)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTransformedTou
chEvent(ViewGroup.java:2216)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:1959)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTransformedTou
chEvent(ViewGroup.java:2216)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:1959)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTransformedTou
chEvent(ViewGroup.java:2216)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:1959)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTransformedTou
chEvent(ViewGroup.java:2216)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:1959)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTransformedTou
chEvent(ViewGroup.java:2216)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:1959)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTransformedTou
chEvent(ViewGroup.java:2216)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:1959)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTransformedTou
chEvent(ViewGroup.java:2216)
E/AndroidRuntime( 8347):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:1959)
E/AndroidRuntime( 8347):        at com.android.internal.policy.impl.PhoneWindow$
DecorView.superDispatchTouchEvent(PhoneWindow.java:2339)
E/AndroidRuntime( 8347):        at com.android.internal.policy.impl.PhoneWindow.
superDispatchTouchEvent(PhoneWindow.java:1568)
E/AndroidRuntime( 8347):        at android.app.Activity.dispatchTouchEvent(Activ
ity.java:2475)
E/AndroidRuntime( 8347):        at com.android.internal.policy.impl.PhoneWindow$
DecorView.dispatchTouchEvent(PhoneWindow.java:2286)
E/AndroidRuntime( 8347):        at android.view.View.dispatchPointerEvent(View.j
ava:7886)
E/AndroidRuntime( 8347):        at android.view.ViewRootImpl$ViewPostImeInputSta
ge.processPointerEvent(ViewRootImpl.java:3947)
E/AndroidRuntime( 8347):        at android.view.ViewRootImpl$ViewPostImeInputSta
ge.onProcess(ViewRootImpl.java:3826)
E/AndroidRuntime( 8347):        at android.view.ViewRootImpl$InputStage.deliver(
ViewRootImpl.java:3392)
E/AndroidRuntime( 8347):        at android.view.ViewRootImpl$InputStage.onDelive
rToNext(ViewRootImpl.java:3442)
E/AndroidRuntime( 8347):        at android.view.ViewRootImpl$InputStage.forward(
ViewRootImpl.java:3411)
E/AndroidRuntime( 8347):        at android.view.ViewRootImpl$AsyncInputStage.for
ward(ViewRootImpl.java:3518)
E/AndroidRuntime( 8347):        at android.view.ViewRootImpl$InputStage.apply(Vi
ewRootImpl.java:3419)
E/AndroidRuntime( 8347):        at android.view.ViewRootImpl$AsyncInputStage.app
ly(ViewRootImpl.java:3575)
E/AndroidRuntime( 8347):        at android.view.ViewRootImpl$InputStage.deliver(
ViewRootImpl.java:3392)
E/AndroidRuntime( 8347):        at and
W/ActivityManager( 7406):   Force finishing activity dev.ukanth.ufirewall/.prefe
rences.PreferencesActivity
```"
ukanth/afwall,closed,AFWall crashes when applying rules,[],"Device: Nvidia Shield Table (2014 LTE version)
ROM: Lineage 14.1 (Android 7.1.2)
AFWall+ 2.9.6.1 with license
Xposed v88.1-sdk25 with AFWall+ fix enabled
Xprivacy v3.6.19 (481) is installed, but not set up to restrict AFWall+ in any way.

When I click ""Apply"" from the menu, AFWall+ crashes. Any ideas what could be causing this?  

I times the crash to happen at exactly: 11-01 21:20:00  
Here is the logcat:
```
11-01 21:20:00.591   239   239 D Raydium_ts_main: ## Report rate in 10 seconds =2
11-01 21:20:00.715  7588  7588 I AFWall  : applySavedIptablesRules invoked
11-01 21:20:00.716  7588  7588 I AFWall  : Setting OUTPUT to Drop
11-01 21:20:00.722  7588  7588 I XPrivacy/XConnectivityManager: Get client 10069/Connectivity.getActiveNetworkInfo(null;null) internet=!restricted 1 ms
11-01 21:20:00.723  7588  7588 I XPrivacy/XNetworkInfo: Get client 10069/NetworkInfo.isConnected(null;null) internet=!restricted 1 ms
11-01 21:20:00.726  7588  7588 D AFWall  : isWifiApEnabled is false
11-01 21:20:00.727  7588  7588 F libc    : Fatal signal 11 (SIGSEGV), code 1, fault addr 0x0 in tid 7588 (kanth.ufirewall)
11-01 21:20:00.727   179   179 W         : debuggerd: handling request: pid=7588 uid=10069 gid=10069 tid=7588
11-01 21:20:00.799  7672  7672 F DEBUG   : *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
11-01 21:20:00.800  7672  7672 F DEBUG   : LineageOS Version: '14.1-20171027-NIGHTLY-shieldtablet'
11-01 21:20:00.800  7672  7672 F DEBUG   : Build fingerprint: 'nvidia/wx_un_do/shieldtablet:7.0/NRD90M/1928188_841.9637:user/release-keys'
11-01 21:20:00.800  7672  7672 F DEBUG   : Revision: '0'
11-01 21:20:00.800  7672  7672 F DEBUG   : ABI: 'arm'
11-01 21:20:00.800  7672  7672 F DEBUG   : pid: 7588, tid: 7588, name: kanth.ufirewall  >>> dev.ukanth.ufirewall <<<
11-01 21:20:00.800  7672  7672 F DEBUG   : signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x0
11-01 21:20:00.801  7672  7672 F DEBUG   :     r0 00000000  r1 00000000  r2 e5030b04  r3 be93b3a0
11-01 21:20:00.801  7672  7672 F DEBUG   :     r4 6fbe5cfc  r5 33333333  r6 727c8b97  r7 00000000
11-01 21:20:00.801  7672  7672 F DEBUG   :     r8 ad805400  r9 ad805400  sl 6fc53b8c  fp 0000000a
11-01 21:20:00.801  7672  7672 F DEBUG   :     ip be93b33c  sp be93b168  lr ad3c243b  pc ad69386e  cpsr 600f0030
11-01 21:20:00.800   226   226 W afwallstart: type=1400 audit(0.0:2890): avc: denied { getattr } for path=""/data/data/com.android.providers.downloads"" dev=""mmcblk0p23"" ino=114494 scontext=u:r:sysinit:s0 tcontext=u:object_r:app_data_file:s0:c512,c768 tclass=dir permissive=0
11-01 21:20:00.831  7672  7672 F DEBUG   :
11-01 21:20:00.831  7672  7672 F DEBUG   : backtrace:
11-01 21:20:00.832  7672  7672 F DEBUG   :     #00 pc 0038386e  /system/lib/libart.so (_ZN3art25GetCalleeSaveMethodCallerEPPNS_9ArtMethodENS_7Runtime14CalleeSaveTypeEb+181)
11-01 21:20:00.832  7672  7672 F DEBUG   :     #01 pc 003f741d  /system/lib/libart.so (artQuickResolutionTrampoline+528)
11-01 21:20:00.832  7672  7672 F DEBUG   :     #02 pc 000af293  /system/lib/libart.so (art_quick_resolution_trampoline+34)
11-01 21:20:00.832  7672  7672 F DEBUG   :     #03 pc 727c8b95  /data/dalvik-cache/arm/system@framework@boot.oat (offset 0x27fc000)
11-01 21:20:01.092   672  7677 W ActivityManager:   Force finishing activity dev.ukanth.ufirewall/.MainActivity
11-01 21:20:01.092   672   703 I BootReceiver: Copying /data/tombstones/tombstone_07 to DropBox (SYSTEM_TOMBSTONE)
11-01 21:20:01.095   179   179 W         : debuggerd: resuming target 7588
11-01 21:20:01.109  7631  7631 D su      : Finishing su operation for app [uid:10069, pkgName: dev.ukanth.ufirewall]
11-01 21:20:01.113   672   784 W InputDispatcher: channel '983bd03 dev.ukanth.ufirewall/dev.ukanth.ufirewall.MainActivity (server)' ~ Consumer closed input channel or an error occurred.  events=0x9
11-01 21:20:01.113   672   784 E InputDispatcher: channel '983bd03 dev.ukanth.ufirewall/dev.ukanth.ufirewall.MainActivity (server)' ~ Channel is unrecoverably broken and will be disposed!
11-01 21:20:01.113   672   784 W InputDispatcher: channel '928d45e PopupWindow:9a34408 (server)' ~ Consumer closed input channel or an error occurred.  events=0x9
11-01 21:20:01.113   672   784 E InputDispatcher: channel '928d45e PopupWindow:9a34408 (server)' ~ Channel is unrecoverably broken and will be disposed!
11-01 21:20:01.113   672   784 W InputDispatcher: channel '4d7bd0c dev.ukanth.ufirewall/dev.ukanth.ufirewall.MainActivity (server)' ~ Consumer closed input channel or an error occurred.  events=0x9
11-01 21:20:01.113   672   784 E InputDispatcher: channel '4d7bd0c dev.ukanth.ufirewall/dev.ukanth.ufirewall.MainActivity (server)' ~ Channel is unrecoverably broken and will be disposed!
11-01 21:20:01.118   240   240 I Zygote  : Process 7588 exited due to signal (11)
11-01 21:20:01.121   672   969 I WindowManager: WIN DEATH: Window{928d45e u0 PopupWindow:9a34408}
11-01 21:20:01.121   672   969 W InputDispatcher: Attempted to unregister already unregistered input channel '928d45e PopupWindow:9a34408 (server)'
11-01 21:20:01.122   672  1747 D GraphicsStats: Buffer count: 10
11-01 21:20:01.122   672  4281 I ActivityManager: Process dev.ukanth.ufirewall (pid 7588) has died
11-01 21:20:01.122   672  4281 D ActivityManager: cleanUpApplicationRecord -- 7588
11-01 21:20:01.123   672  4281 W ActivityManager: Scheduling restart of crashed service dev.ukanth.ufirewall/.service.RootShellService in 1000ms
11-01 21:20:01.123   672   701 I libprocessgroup: Killing pid 7622 in uid 10069 as part of process group 7588
11-01 21:20:01.124   672   701 I libprocessgroup: Killing pid 7627 in uid 10069 as part of process group 7588
11-01 21:20:01.133   672  4283 I WindowManager: WIN DEATH: Window{4d7bd0c u0 dev.ukanth.ufirewall/dev.ukanth.ufirewall.MainActivity}
11-01 21:20:01.133   672  4283 W InputDispatcher: Attempted to unregister already unregistered input channel '4d7bd0c dev.ukanth.ufirewall/dev.ukanth.ufirewall.MainActivity (server)'
11-01 21:20:01.136  7631  7631 W IPCThreadState: Calling IPCThreadState::self() during shutdown is dangerous, expect a crash.
11-01 21:20:01.136  7631  7631 W IPCThreadState: Calling IPCThreadState::self() during shutdown is dangerous, expect a crash.
11-01 21:20:01.137   672   966 I WindowManager: WIN DEATH: Window{983bd03 u0 dev.ukanth.ufirewall/dev.ukanth.ufirewall.MainActivity}
11-01 21:20:01.137   672   966 W InputDispatcher: Attempted to unregister already unregistered input channel '983bd03 dev.ukanth.ufirewall/dev.ukanth.ufirewall.MainActivity (server)'
11-01 21:20:01.139  7629  7629 D su      : sending code
11-01 21:20:01.139  7629  7629 D su      : child exited
11-01 21:20:01.170   882   882 I SuControllerImpl: Got change
11-01 21:20:01.200   672  2717 I OpenGLRenderer: Initialized EGL, version 1.4
11-01 21:20:01.201   672  2717 D OpenGLRenderer: Swap behavior 2
11-01 21:20:01.699  1616  1841 W OpenGLRenderer: Incorrectly called buildLayer on View: ShortcutAndWidgetContainer, destroying layer...
11-01 21:20:01.801   226   226 W afwallstart: type=1400 audit(0.0:2891): avc: denied { getattr } for path=""/data/data/com.android.providers.downloads"" dev=""mmcblk0p23"" ino=114494 scontext=u:r:sysinit:s0 tcontext=u:object_r:app_data_file:s0:c512,c768 tclass=dir permissive=0
11-01 21:20:02.149   672   699 I ActivityManager: Start proc 7679:dev.ukanth.ufirewall/u0a69 for service dev.ukanth.ufirewall/.service.RootShellService
11-01 21:20:02.183  7679  7679 I art     : Starting a blocking GC AddRemoveAppImageSpace
11-01 21:20:02.186  7679  7679 W System  : ClassLoader referenced unknown path: /data/app/dev.ukanth.ufirewall-1/lib/arm
11-01 21:20:02.190  7679  7679 I AFWallXPosed: Matched Package and now hooking: dev.ukanth.ufirewall
11-01 21:20:02.196  7679  7679 I XPrivacy/XResources: Get client 10069/Configuration.MCC(null;null) phone=!restricted 2 ms
11-01 21:20:02.197  7679  7679 I XPrivacy/XResources: Get client 10069/Configuration.MNC(null;null) phone=!restricted 0 ms
11-01 21:20:02.197  7679  7679 I XPrivacy/XResources: Get client 10069/Configuration.MCC(null;null) phone=!restricted (cached) 0 ms
11-01 21:20:02.197  7679  7679 I XPrivacy/XResources: Get client 10069/Configuration.MNC(null;null) phone=!restricted (cached) 0 ms
11-01 21:20:02.204  7679  7679 D AFWallXPosed: Loading Profile: AFWallPrefs
11-01 21:20:02.204  7679  7679 D AFWallXPosed: Reloaded preferences from AFWall
11-01 21:20:02.221  7679  7679 W XPrivacy: Hooking package=dev.ukanth.ufirewall
11-01 21:20:02.222  7679  7679 I XPrivacy: Get client 10069/SERIAL(null;null) identification=!restricted 0 ms
11-01 21:20:02.232  7679  7679 I XPrivacy/XResources: Get client 10069/Configuration.MCC(null;null) phone=!restricted (cached) 0 ms
11-01 21:20:02.232  7679  7679 I XPrivacy/XResources: Get client 10069/Configuration.MNC(null;null) phone=!restricted (cached) 0 ms
11-01 21:20:02.260  7679  7679 I AFWall  : Selected Profile: AFWallPrefs
11-01 21:20:02.262  7679  7679 I AFWall  : Restarting RootShell
11-01 21:20:02.262  7679  7679 D AFWall  : Starting root shell...
11-01 21:20:02.263  7679  7679 I AFWall  : [libsuperuser] [SU%] START
```"
ukanth/afwall,open,Issue? Afwall blocking a dest:port for one app,[],"Every now and again I get a blocked notification from afwall saying it's blocking access from connectbot to localhost:5353
That the port dnscrypt is running on. I'm using connectbot as a transparent http proxy. Here's the iptables rules I'm using for connect bot

iptables -t nat -A OUTPUT -p tcp --dport 80 -m owner ! --uid-owner 10136 -j ACCEPT
iptables -t nat -A OUTPUT -p tcp --dport 80 -m owner ! --uid-owner 10136 -j REDIRECT --to-port 8118
iptables -A INPUT -p tcp -m tcp --dport 8118 -m state --state ESTABLISHED,RELATED -j ACCEPT

Here are the rules for dnscrypt
iptables -t nat -I OUTPUT -p udp --dport 53 -j DNAT --to-destination 127.0.0.1:5353
iptables -t nat -I OUTPUT -p tcp --dport 53 -j DNAT --to-destination 127.0.0.1:5353

Is it something I need to add to the proxy config? Iptables?
What to do?"
ukanth/afwall,closed,"Wifi ""connected, but no internet"" on Android N 7.1","[Label(name=""General"")]","As a follow-up to #618 I did some digging and it looks like `captive_portal_detection_enabled` is deprecated: https://github.com/aosp-mirror/platform_frameworks_base/blob/master/core/java/android/provider/Settings.java

I would like to share some things that I changed in order to stay connected to WiFi networks,getting rid of the exclamation mark on the WiFi icon and the ""no Internet"" message, **without** allowing specific (system) apps to access the Internet. I also changed some settings to get rid of potential google home-phoning.

For the following steps you need root access: 
Install a terminal emulator such as Termux and enter `su` to get into a root shell.  
Alternatively you can do this using adb. (If you have adb set up you can run `adb shell` and then `su` to get into a root shell. To get adb to work you'll need to enable usb debugging and potentially install drivers and other things on your computer. Search the Internet for a tutorial.)

- Run `settings put global captive_portal_mode 0` 
- Run `settings put global captive_portal_detection_enabled 0` (deprecated, but can't hurt)
- Run `settings put global wifi_watchdog_on 0`
- Run `settings put global wifi_watchdog_background_check_enabled 0` (deprecated, but can't hurt)
- I also uninstalled WiFi Privacy Police (it caused massive WiFi drop problems on my Android 7.1 device)

For me this is also a privacy concern and as a second layer of security I replaced the google servers with my own server. 
- Run `settings put global captive_portal_server example.com` 
- Run `settings put global captive_portal_https_server ""https://example.com""` 
- Run `settings put global captive_portal_http_server ""http://example.com""` 

(Technically the server that you enter would have to respond with a 204 status code to HTTP requests. But since we have disabled captive portal detection it doesn't really matter.)


You can now confirm your changes by checking if the output of the following commands matches:

- Run `settings get global captive_portal_mode` (should show `0`)
- Run `settings get global captive_portal_detection_enabled` (should show `0`)
- Run `settings get global wifi_watchdog_on` (should show `0`)
- Run `settings get global wifi_watchdog_background_check_enabled` (should show `0`)
- Run `settings get global captive_portal_server` (should show `example.com`) 
- Run `settings get global captive_portal_https_server` (should show `https://example.com`) 
- Run `settings get global captive_portal_http_server` (should show `http://example.com`)


**_More information:_**

**wifi_watchdog_background_check_enabled**  

> Whether the Wi-Fi watchdog is enabled for background checking even
> after it thinks the user has connected to a good access point.
> (deprecated)

**wifi_watchdog_on**

> This is the replacement for the deprecated `wifi_watchdog_background_check_enabled`

**captive_portal_detection_enabled**

> This setting can be used to turn off captive portal detection.
> (deprecated)

**captive_portal_mode**

> The replacement for the deprecated `captive_portal_detection_enabled`. 
> 0 = CAPTIVE_PORTAL_MODE_IGNORE
> (Don't attempt to detect captive portals.)
> 1 = CAPTIVE_PORTAL_MODE_PROMPT
> (When detecting a captive portal, display a notification that prompts the user to sign in.)
> 2 = CAPTIVE_PORTAL_MODE_AVOID
> (When detecting a captive portal, immediately disconnect from the network and do not reconnect to that network in the future.)

**captive_portal_server**

> The server used for captive portal detection upon a new conection. A 204 response code from the server is used for validation.

**captive_portal_https_server**

> The URL used for HTTPS captive portal detection upon a new connection. A 204 response code from the server is used for validation.

**captive_portal_http_server**

> The URL used for HTTP captive portal detection upon a new connection. A 204 response code from the server is used for validation.


**_Some info about my device and software:_**

Device: Nvidia Shield Table (2014 LTE version)
ROM: Lineage 14.1 (Android 7.1.2)
AFWall+ 2.9.6.1 with license
Xposed v88.1-sdk25 with AFWall+ fix enabled
No system apps/components besides my browser are are allowed to connect to the Internet in AFWall+.


I hope this information is useful to some people. It would be nice if someone would take the time to add this information to a wiki page, readme or so where people would actually be more likely to find it."
ukanth/afwall,open,[FR] Better notification filter,[],"Hi,

Regarding #428, I thought of two more improvements to the notification filter drop-down list :

1. Diplay backlisted apps at the top of the list, then whitelisted ones (= the contrary of the current situation) : I for one need to filter notifactions for blocked apps, not authorized ones. Having blacklisted apps on top of the list would make them quicker to find, instead of having to first scroll down all the whitelisted ones.

2. Add the app icon along with ID and name for quicker identification."
ukanth/afwall,open,'Fix startup data leak' gets reset after rom update,[],"The 'Fix startup data leak' option gets reset to disabled after a rom update, probably because the file in /system/etc/init.d gets deleted. Since the state of this option should be stored in AFWall's settings is it possible to restore the file if it's missing (e.g. during boot) if the setting is enabled?"
ukanth/afwall,closed,Unable to check 'Fix startup data leak',[],When trying to check that box it just automatically uncheck itself. I'm running LineageOS with BusyBox installed and init.d supported.
ukanth/afwall,open,Won't start after deleting an active profile,[],"I've deleted an active profile respectively.
After this the app won't start. It crashes after start without an displayed error message.
Preventing to delete an ""active"" profile should help ;)

Workaround: Deleting the App Data and import backuped rules (if exist^^)"
ukanth/afwall,closed,Reworked strings,[],
ukanth/afwall,closed,NewPipe not blocked,[],"Just installed NewPipe on OmniRom 7.1.2 and it have full Internet access. 

![screenshot_20171011-231356](https://user-images.githubusercontent.com/16372405/31467809-98860338-aedb-11e7-97d5-d9fec67ee45a.png)

No idea what log could be useful for this issue so I confirmed afwall+ was working with Fennec (Firefox fork): untick the box Fennec have no internet anymore, tick the box, internet is back. 

Maybe it is related to https://github.com/ukanth/afwall/issues/750 ?"
ukanth/afwall,open,Some services starting significantly earlier than AFWall+. (Tasker for example),[],"After a reboot, I just noticed that the Tasker service started almost 10 seconds before the AFWall+ service. And this happens even though I'm using the startup leak fix and the xposed module. 

10 seconds is more than enough to leak significant amounts of data. "
ukanth/afwall,open,Question: may the WhatsApp Wiki page be outdated?,[],"Hi.

First of all, thank you for providing us a HowTo block WhatsApp, but I think it is now outdated.

I'm talking about [this page](https://github.com/ukanth/afwall/wiki/HOWTO-blocking-WhatsApp)

Here I've found a list that seems to be valid for me: https://myip.ms/view/ip_owners/90500/Whatsapp_Inc.html

Best regards.

EDIT: I blocked all the 20 CIDR listed but I'm still able to use WhatsApp so I finally solved blocking the domain `whatsapp.com` on the meraki console. 🙆‍♂️ "
ukanth/afwall,open,Playstore - Free & Donate Compatiblity are Different,[],"On Google Playstore, the Free version does not show up as compatible for my smartphone, but the Donate version shows as compatible. Is this intended? They both appear to be the same version# so I'd expect them both to be either compatible or incompatible, but not different.
On my tablet they both appear compatible. It is only on my smartphone that they appear different.
My smartphone is a Samsung Galaxy Light SGH-T399 running Android 4.2.2 (rooted)
I am currently using the Firewall in Avast Antivirus and the firewall is working, but I'd like to try the Free version of afwall+ before buying the Donate version (especially if it's not really compatible.)
Thanks =)"
ukanth/afwall,open,SD card install,[],Please allow to install the app to SD card.
ukanth/afwall,open,Rules not applying on Android 8.0.,[],"Hello,

Running OPR6.170623.012 8.0.0 on Pixel XL.
Device has been rooted with SuperSu using Systemless root.
AFWall is 2.9.6.1

App in question is Newpipe.  I have Newpipe configured to access LAN, and WiFi.  

I have Newpipe download a video and let the screen shut off.  I find that Newpipe has been able to download over the mobile connection.  

Is there a method to prevent this application from accessing the mobile connection on 8.0?

Thanks"
ukanth/afwall,open,[suggestion] storing iptables rules,[],"Hi and sorry for ban english

Is it possible to export iptables rules in some file, and then import this rules by `/system/etc/init.d/afwallstart` script instead of using this ?
```
iptables -w -P INPUT DROP
iptables -w -P OUTPUT DROP
iptables -w -P FORWARD
```

Thanks"
ukanth/afwall,open,/system/etc/init.d/afwallstart script double issue,[],"Hi and sorry for bad english.

First problem is in this line
`export PATH=/system/bin`

My android has ho ""head"" and ""cut"" binaries (or toolbox applets) in /system/bin directory, so I got `not found` for both.

Simple solution is change ""export PATH"" like this
`export PATH=/sbin:/system/sbin:/system/bin:/system/xbin`

Second problem is endless cycle when rinning from init.d (I add -x key to see everything, no more changes)
```
+ export 'PATH=/system/bin'
+ head -n 1 /proc/uptime
./afwallstart[5]: head: not found
+ cut -d . -f 1
./afwallstart[5]: cut: not found
+ startDt= 
+ :
+ '[' -d /data/data/com.android.providers.downloads ']'
+ sleep 1
+ :
+ '[' -d /data/data/com.android.providers.downloads ']'
+ sleep 1
+ :
+ '[' -d /data/data/com.android.providers.downloads ']'
+ sleep 1
+ :
+ '[' -d /data/data/com.android.providers.downloads ']'
+ sleep 1
+ :
+ '[' -d /data/data/com.android.providers.downloads ']'
+ sleep 1
+ :
+ '[' -d /data/data/com.android.providers.downloads ']'
+ sleep 1
+ :

and so on
```

Thanks
"
ukanth/afwall,closed,Skype for Business does not sign in,[],"Skype for Business (formerly known as ""Lync"") is unable to sign in and receive calls with afwall+ enabled. I allowed incoming connections and enabled Skype for Business and ""Exchange Services"" in the afwall settings, but still cannot sign in with the firewall enabled."
ukanth/afwall,open,Connexion issue,[],"Hi, 

I don't know if this
 is an issue, or a bad configuration :
Sometimes i can't access internet with all my allowed apps in AF+ firewall.
I have to apply rules with out any change to cet internet back.
Any idea ? 

Thx you in advance :D"
ukanth/afwall,open,Conflicting documentation for changing DNS,[],"I noticed a conflict in the documentation when attempting to change the default DNS.

The [DNS](https://github.com/ukanth/afwall/wiki/DNS#changing-default-dns) section says:
```
$IPTABLES -t nat -A OUTPUT -p tcp --dport 53 -j DNAT --to-destination 208.67.222.222:53 || true
$IPTABLES -t nat -A OUTPUT -p udp --dport 53 -j DNAT --to-destination 208.67.222.222:53 || true
```

While the [Custom Scripts](https://github.com/ukanth/afwall/wiki/CustomScripts) section says:
```
# First two lines delete current DNS settings
$IPTABLES -t nat -D OUTPUT -p tcp --dport 53 -j DNAT --to-destination 208.67.222.222:53 || true
$IPTABLES -t nat -D OUTPUT -p udp --dport 53 -j DNAT --to-destination 208.67.222.222:53 || true

# This two new lines set our new DNS to OpenDNS
$IPTABLES -t nat -I OUTPUT -p tcp --dport 53 -j DNAT --to-destination 208.67.222.222:53
$IPTABLES -t nat -I OUTPUT -p udp --dport 53 -j DNAT --to-destination 208.67.222.222:53
```
The main difference seems to be the **A**, **I**, **D** options. A quick read of the man pages says **A** is addition while **I** is insertion, through I am not sure what the difference is. The **D** is, of course, deletion.

A DNS change guide on [XDA](https://forum.xda-developers.com/general/xda-university/guide-how-to-change-dns-android-device-t3273769) suggests you do all three:
```
iptables -t nat -A OUTPUT -p tcp --dport 53 -j DNAT --to-destination 8.8.8.8:53
iptables -t nat -A OUTPUT -p udp --dport 53 -j DNAT --to-destination 8.8.8.8:53
iptables -t nat -D OUTPUT -p tcp --dport 53 -j DNAT --to-destination 8.8.8.8:53 || true
iptables -t nat -D OUTPUT -p udp --dport 53 -j DNAT --to-destination 8.8.8.8:53 || true
iptables -t nat -I OUTPUT -p tcp --dport 53 -j DNAT --to-destination 8.8.8.8:53
iptables -t nat -I OUTPUT -p udp --dport 53 -j DNAT --to-destination 8.8.8.8:53
```

Additionally, I was wondering if it was possible to set multiple DNS providers using this method?
All the examples so far have been for a single provider.

Anyways, great program! Slick interface and very stable!"
ukanth/afwall,closed,Latest version not available as APK/F-Droid?,[],"[Version 2.9.6.1](https://f-droid.org/packages/dev.ukanth.ufirewall/) is not available as APK via GitHub and not via F-Droid unlike previous releases, making the Play Store the only option to get the latest version.

Any info on why this is the case? Will ask about the F-Droid issue in their forum but it is currently offline:
https://forum.f-droid.org/

Will update once it is back online."
ukanth/afwall,open,Startup delay option seems not working at all (in current latest version),[],"In the current latest version (v2.9.6.1), the startup delay option does not work at all. I have set the delay to 160s and the app shows failure on applying the rules right after when the device boots (usually it takes 90 sec at most). Setting it to 9999999 shows the same results, fails instantly when the device finished booting, indicating the setting does not actually add any delay on applying rules.

The startup data leak option also does not work

Noticed, if I turn off data/wifi connection before reboot (or airplane mode can work aswell), reboot the device, apply rules, then enable back data/wifi, it works without any problem. 
These mentioned failing options could be fixed with the this workaround.

Please remediate, thanks,
xel
"
ukanth/afwall,open,[Question] Purchasing on Fdroid,[],"The Fdroid repository merely states that that a donation version is advertised in the app. This suggests that the app is the free version, and Fdroid users are unable to acquire the paid version. I was unable to find any previous issues about this.

I have already purchased the Donate version from the Google Play Store (the more expensive single app version which is vastly superior to an in-app purchase or adding a key app). I am looking to migrate away from the Google Play Store for a multitude of reasons, but I would like to be able to use the paid features of the app.

Does the Fdroid version include donation features? If not, is it possible for me to acquire the donation version outside of the Google Play Store? I've had other apps provide me an apk to side-load after providing my purchase information; is something similar possible here?

"
ukanth/afwall,open,Possible conflation of packet reject logging?,"[Label(name=""Bug"")]","I recently experienced a weird issue wherein the open-source app Kore was reported by AFWall+ to be sending pings to sites like walmart.com, among others: https://github.com/xbmc/Kore/issues/434

Here's a screenshot showing the toast:
![screenshot_20170822-145412](https://user-images.githubusercontent.com/195073/29566426-292b5ac8-874a-11e7-857e-07db3902edfb.png)

The log has this instead:

    [ICMP]185.228.81.107:0(4726)

And this had me really stoked, especially since the target IP address would vary daily: from AT&T to walmart.com to the one above that's unassigned according to RIPE. Very strange.

Digging deeper, however, I found that `iptables -m owner --uid-owner 10188` at the top of the `afwall` chain actually doesn't see any such packet. Furthermore, I then tried the following rule at the top of the `afwall` chain:

    -d 185.228.81.107/32 -j LOG --log-prefix ""[Kore unassigned] "" --log-tcp-options --log-ip-options --log-uid

but this matches no packets, `dmesg` has nothing on this, while AFWall+ happily logs traffic _to this IP_ it apparently rejects.

So now I am obviously wondering why AFWall+ thinks it needs to log nonexistent ICMP packets to random IP addresses under the UID Kore runs as.

Could it be that AFWall+ reads too much off the `netlink` socket receiving the `NFLOG` output? Or somehow other gets confused presenting the data it does get?

Because it seems that the toasts only show up along with others about legitimately rejected packets from the same app/UID.

Or do you have any other ideas how I could track this down?

Thanks,
-m"
ukanth/afwall,open,Default to disabling all traffic,[],"Every now and then due to a variety of reasons, AFWall+ fails to apply the ruleset. Using `iptables-save`, I then either find a completely unprotected phone, or one with the ruleset partially applied.

IMHO, in case there's an error, AFWall+ should revert to a secure mode, e.g. using `DROP` as the `OUTPUT` chain policy. In fact, that should be the default anyway, for all chains.

In order to ensure that the ruleset gets fully applied in a transactional way, wouldn't it be better to compile the ruleset to a file to feed to `iptables-restore` anyway?

Thanks for your consideration,
-m"
ukanth/afwall,open,LAN allowed app being blocked in device wifi hotspot,[],"lineageos 13, running system wifi hotspot, an ap with only lan allowed being blocked connecting to other device at   192.168.43.2 (android is at 192.168.43.1). "
ukanth/afwall,open,[request] visual enhancement?,[],"so i have been using afwall for about 3 years now. i mostly got it to block all the huawei bloat ware that was installed in my mate 7. its the best firewall available for android. its the first app i recommend once someone roots their devices. having said that, the ui is a bit outdated. is there any chance of an update? even tasker updated recently so why not afwall?"
ukanth/afwall,open,Feature Request Shortcut System,[],"Hi ukanth, 
I have a little request on app development. Can you please add a shortcut system to afwall+ with Homescreen shortcuts to activate Firewall , deactivate Firewall , Profile 1 to profile 4.?

Why I'm requesting this.? Well That's quite simple. I want to automate profile switching when connected to specific ssid with apps like Macrodroid or Tasker. 
I know you will say there's already a Locale/Tasker plugin implemented, but i have to reply that the plugin isn't behaving correctly on Android Nougat 7.1.2.  I have tested a lot on latest Ressurection Remix build and the plugin does what it wants. Instead of switching to a specific profile it deactivates the Firewall. 

Having Homescreen Shortcuts which the most automation apps can trigger directly would be a lot more stable on all Android versions, Roms and Devices. 

Jtschohl already had implemented a shortcut system to his app ""Android Firewall"" but he stopped development since lolipop came out and removed his app and account from playstore because of differences with Google. So afwall+ is the only remaining really good iptables based Firewall for Android which is developed further. 

Just think about it. I would really appreciate such a feature in afwall+. Maybe jtschohl would left you his code for implementation if you ask him. If i can help you contacting him,just leave me a message 

I just found a link to the code of the last version of Android Firewall on github. So here it is. 

https://github.com/skullone/android_firewall


"
ukanth/afwall,closed,F-Droid suddenly started offering me to upgrade to beta versions?,[],"I'm still running 2.9.4. But a while ago an update appeared called 2.9.5-Beta and now 2.9.6-Beta. I feel very uncomfortable ""upgrading"" AFWall to a beta version, as even the 2.9.4 version is crashing from time to time. 

Could anyone enlighten me why we're suddenly seeing beta versions in F-Droid? Wouldn't it make much more sense to have the Beta as a separate app in F-Droid?"
ukanth/afwall,closed,Version 2.9.6 not available via F-Droid,[],"The current version (2.9.6) of AFWall+ is not available on F-Droid. Instead there's just version 2.9.5-BETA (15950): https://f-droid.org/packages/dev.ukanth.ufirewall/

It doesn't look like there have been any recent build attempts for the current version on the F-Droid server: https://f-droid.org/wiki/page/dev.ukanth.ufirewall"
ukanth/afwall,open,[Feature Request] AFwall profiles?,[],"i currently use afwall at home, work, and school. with each location i have to enable disable different apps because my use changes with these locations. is there any chance of adding a profiles feature? this would help out alot and would be a really worthwhile feature."
ukanth/afwall,closed,[Feature Request] AFwall Quick Tile,"[Label(name=""Feature"")]",any chance you could add a afwall enable/disable quick tile?? thanks.
ukanth/afwall,open, Xposed DownloadManager leak fix blocking apps allowed to use VPN only,[],"May be related to #619 

I'm using OpenVPN and use AFWall 2.9.4 to allow access to WiFi for only few apps including OpenVPN itself, then most other apps is enabled to use only VPN but not WiFi. I've noticed Xposed Installer is unable to use DownloadManager to get new modules when AFWall allow only VPN access for Xposed Installer, but it works ok if AFWall allow both WiFi and VPN access for Xposed Installer. Of course, I've VPN working at this time, moreover Download Manager itself is allowed to use VPN only.

So, it looks like AFWall decides some app is allowed to use Download Manager only if that app is allowed to use ALL available networks. I believe it makes more sense to check is it allowed to use ANY of available networks."
ukanth/afwall,open,Is a step-by-step manual available to change the DNS server using a custom script?,[],"Is there a step-by-step manual to use a custom script under LineageOS 14.x

I could not get it working using different devices to change the DNS or to block address ranges.

The result was that AFWall+ did not start or the Internet connection was blocked.

I am aware that encoding can be problematic So I used a text editor directly on the phone.
I am aware that the path can be a problem (to tell AFWall+ where to find the script).
I used scripts like https://www.kuketz-blog.de/f-droid-und-afwall-android-ohne-google-teil4/#more-43847
I am aware that some configurations for IPv6 in AFWall+ can be a problem along with custom scripts."
ukanth/afwall,closed,Automatically block Internet access of newly-installed apps.,[],"I hope it's possible to automatically block apps when they are installed because most of the time, I open afwall after installing an app to block its Internet access.
I see two possible ways this can be implemented:
1. Prompt
afwall will prompt the user to block a newly-installed app much like Xprivacy and SuperSU. If the user configured a password, they will be prompted to enter it. Wrong password = automatically blocked Internet access.
2. Auto-block
afwall will automatically block Internet access to newly-installed apps without giving prompts or popups. This is faster. A toast notification, however, will be shown to inform which app was blocked.

Another minor request:
Please update the icons for LAN, switch and clear. Minor and purely aesthetic, however, will be greatly appreciated if implemented.

Thank you for your great work!"
ukanth/afwall,closed,Potential fix for issue #709,[],"ukanth,

After much investigating and debugging of my data leak problem, it looks like it's caused by a change in Android 7.x.  Network connectivity change broadcasts now need a broadcast receiver created in code, declaring a receiver in the manifest no longer works.  See [https://developer.android.com/reference/android/net/ConnectivityManager.html#CONNECTIVITY_ACTION](url).

My fix does this with a service, although I'm not 100% sure if we really need one dedicated just to this.  Please have a look.  This pull also includes a small bit of code cleanup in a related file.

Thanks, -Cal"
ukanth/afwall,open,[feature] sim1 sim 2 network access restriction,[],"dual sim phones are able to connect to sim1 or sim2 networks. (some phone permits simultaneous connections, others don't). 
It would be very useful that afwall divided the mobile internet column into 2, for sim1 and sim2 networks, allowing users to determine which network apps can access."
ukanth/afwall,open,admob,[],am i allowed to add admob ads then upload it to my google play
ukanth/afwall,open,DownloadManager Leak Fix (Xposed) doesn't work,[],"I'm using AFWall 2.9.5 on CM13 (Xposed v87, AFWall ticked) with OpenVPN.

Tested it with QuickDic. It uses the integrated download manager to download dictionaries. It works even though it doesn't have internet access. Absolutely no check mark is set. I did a reboot to verify, still the same.
"
ukanth/afwall,closed,Split up iptables(8) options in init script.,[],"Split up the 'w' and 'P' options passed to the iptables binaries
in our init script, otherwise the programs try to interpret 'P'
as a timeout value for 'w'.

Signed-off-by: Cal Peake <cp@absolutedigital.net>"
ukanth/afwall,open,Generation of iptables is too slow,[],"After i apply rules takes ~30 seconds to finish the operation. 
I don't know why it is happening. I have 120 apps. 
If you need logs or something just ask. 

LOS 14.1, MagiskSU and SuperSU (i tried both). "
ukanth/afwall,open,Setup rules for installed app via notification,[],"AFWall has an option to show notification after new app installation. Its good and can be even better. What if you will add buttons to that notification like:
√ Wifi √ Mobile √ VPN   APPLY
If user will press on the button AFWall will remember the choice and will apply new settings (after Apply button will be pressed, of course). 

If you don't like buttons it can be checkboxes:)
What do you think?"
ukanth/afwall,open,Must allow root apps access on android 6?,[],"Steps to reproduce:

1. Install Afwall, allow nothing.
2. Give individual app internet access
3. Can't connect

I really don't wish to give all root apps access, is this a bug?"
ukanth/afwall,open,Tethering/Hotpsot being blocked randomly ,[],"Hello,
I'm on xiaomi's MIUI os and sometimes, wifi hotspot is being blocked. I'm using the ""allow selected"" method and allowed (tethering)- DHCP+DNS services through all rules(this the only one white-listed and all other including applications running as root is bloocked). The problem is, it's not blocking the connection all the time. Sometimes it allows the connection and sometimes, suddenly  it stops, without even doing anything on the device. Then I have to disable AF wall + and re enabling the firewall will sometimes allow the connection again and sometimes it won't and I have to disable firewall entirely. This happens in random and when this happen, i'm seeing something like ""AF wall blocked unknown(9999) something like that. Since the issue is not a permanent one, looks like it's a bug.


```
==========
IPv4 Rules
==========

Chain INPUT (policy ACCEPT 85 packets, 8328 bytes)
pkts bytes target     prot opt in     out     source               destination         
19715 1913K bw_INPUT   all  --  *      *       0.0.0.0/0            0.0.0.0/0           
19715 1913K fw_INPUT   all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain FORWARD (policy ACCEPT 1393 packets, 445K bytes)
pkts bytes target     prot opt in     out     source               destination         
828K  582M oem_fwd    all  --  *      *       0.0.0.0/0            0.0.0.0/0           
828K  582M fw_FORWARD  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
828K  582M bw_FORWARD  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
828K  582M natctrl_FORWARD  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain OUTPUT (policy ACCEPT 62 packets, 6303 bytes)
pkts bytes target     prot opt in     out     source               destination         
  623 59004 afwall     all  --  *      *       0.0.0.0/0            0.0.0.0/0           
17114 1536K DPM_FIN_CHAIN  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 DROP       udp  --  *      rmnet_data7  0.0.0.0/0            0.0.0.0/0            udp dpt:1900 /* Drop SSDP on WWAN */
    0     0 DROP       udp  --  *      rmnet_data6  0.0.0.0/0            0.0.0.0/0            udp dpt:1900 /* Drop SSDP on WWAN */
    0     0 DROP       udp  --  *      rmnet_data5  0.0.0.0/0            0.0.0.0/0            udp dpt:1900 /* Drop SSDP on WWAN */
    0     0 DROP       udp  --  *      rmnet_data4  0.0.0.0/0            0.0.0.0/0            udp dpt:1900 /* Drop SSDP on WWAN */
    0     0 DROP       udp  --  *      rmnet_data3  0.0.0.0/0            0.0.0.0/0            udp dpt:1900 /* Drop SSDP on WWAN */
    0     0 DROP       udp  --  *      rmnet_data2  0.0.0.0/0            0.0.0.0/0            udp dpt:1900 /* Drop SSDP on WWAN */
    0     0 DROP       udp  --  *      rmnet_data1  0.0.0.0/0            0.0.0.0/0            udp dpt:1900 /* Drop SSDP on WWAN */
    0     0 DROP       udp  --  *      rmnet_data0  0.0.0.0/0            0.0.0.0/0            udp dpt:1900 /* Drop SSDP on WWAN */
16654 1509K oem_out    all  --  *      *       0.0.0.0/0            0.0.0.0/0           
16654 1509K fw_OUTPUT  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
16584 1501K st_OUTPUT  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
16584 1501K bw_OUTPUT  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain DPM_FIN_CHAIN (1 references)
pkts bytes target     prot opt in     out     source               destination         
Chain afwall (1 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 afwall-vpn  all  --  *      tun+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-vpn  all  --  *      ppp+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-vpn  all  --  *      tap+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-vpn  all  --  *      *       0.0.0.0/0            0.0.0.0/0           [goto]  mark match 0x3c/0xfffc
    0     0 afwall-vpn  all  --  *      *       0.0.0.0/0            0.0.0.0/0           [goto]  mark match 0x40/0xfff8
    0     0 afwall-wifi  all  --  *      eth+    0.0.0.0/0            0.0.0.0/0           
  202 27757 afwall-wifi  all  --  *      wlan+   0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-wifi  all  --  *      tiwlan+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-wifi  all  --  *      ra+     0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-wifi  all  --  *      bnep+   0.0.0.0/0            0.0.0.0/0           
  409 30288 afwall-3g  all  --  *      rmnet+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      pdp+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      uwbr+   0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      wimax+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      vsnet+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      rmnet_sdio+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      ccmni+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      qmi+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      svnet0+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      ccemni+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      wwan+   0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      cdma_rmnet+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      usb+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      rmnet_usb+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      clat4+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      cc2mni+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      bond1+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      rmnet_smux+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      ccinet+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      v4-rmnet+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      seth_w+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      v4-rmnet_data+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      rmnet_ipa+  0.0.0.0/0            0.0.0.0/0           
  366 24637 afwall-3g  all  --  *      rmnet_data+  0.0.0.0/0            0.0.0.0/0           
Chain afwall-3g (24 references)
pkts bytes target     prot opt in     out     source               destination         
  775 54925 afwall-3g-postcustom  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-3g-fork (1 references)
pkts bytes target     prot opt in     out     source               destination         
   43  5651 afwall-3g-home  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-3g-home (1 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 RETURN     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:53 owner UID match 0
   43  5651 afwall-reject  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-3g-postcustom (1 references)
pkts bytes target     prot opt in     out     source               destination         
  775 54925 afwall-3g-tether  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-3g-roam (0 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 RETURN     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:53 owner UID match 0
    0     0 afwall-reject  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-3g-tether (1 references)
pkts bytes target     prot opt in     out     source               destination         
   82  5930 RETURN     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 0 udp dpt:53
  650 43344 RETURN     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 9999 udp dpt:53
    0     0 RETURN     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 0 tcp dpt:53
    0     0 RETURN     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 9999 tcp dpt:53
   43  5651 afwall-3g-fork  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-reject (5 references)
pkts bytes target     prot opt in     out     source               destination         
   31  4241 NFLOG      all  --  *      *       0.0.0.0/0            0.0.0.0/0            nflog-prefix  ""{AFL}"" nflog-group 40
   31  4241 REJECT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable
Chain afwall-vpn (5 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 RETURN     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:53 owner UID match 0
    0     0 afwall-reject  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-wifi (5 references)
pkts bytes target     prot opt in     out     source               destination         
  202 27757 afwall-wifi-postcustom  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-wifi-fork (1 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 afwall-wifi-wan  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-wifi-lan (0 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 RETURN     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:53
    0     0 RETURN     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:53 owner UID match 0
    0     0 afwall-reject  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-wifi-postcustom (1 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 1014
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 1010
  202 27757 afwall-wifi-tether  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-wifi-tether (1 references)
pkts bytes target     prot opt in     out     source               destination         
    8  2681 RETURN     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 0 udp spt:67 dpt:68
    0     0 RETURN     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 9999 udp spt:67 dpt:68
    0     0 RETURN     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 0 udp spt:53
  192 24877 RETURN     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 9999 udp spt:53
    0     0 RETURN     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 0 tcp spt:53
    0     0 RETURN     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 9999 tcp spt:53
    0     0 afwall-wifi-fork  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-wifi-wan (1 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 RETURN     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:53 owner UID match 0
    0     0 afwall-reject  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain bw_FORWARD (1 references)
pkts bytes target     prot opt in     out     source               destination         
7940 2705K            all  --  *      *       0.0.0.0/0            0.0.0.0/0            ! quota globalAlert: 131072 bytes 
Chain bw_INPUT (1 references)
pkts bytes target     prot opt in     out     source               destination         
15702 1492K            all  --  *      *       0.0.0.0/0            0.0.0.0/0            ! quota globalAlert: 2097152 bytes 
  223 29905 bw_costly_rmnet_data0  all  --  rmnet_data0 *       0.0.0.0/0            0.0.0.0/0           
15939 1607K            all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner socket exists
Chain bw_OUTPUT (1 references)
pkts bytes target     prot opt in     out     source               destination         
12217 1126K            all  --  *      *       0.0.0.0/0            0.0.0.0/0            ! quota globalAlert: 2097152 bytes 
  299 20163 bw_costly_rmnet_data0  all  --  *      rmnet_data0  0.0.0.0/0            0.0.0.0/0           
16582 1501K            all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner socket exists
Chain bw_costly_rmnet_data0 (2 references)
pkts bytes target     prot opt in     out     source               destination         
  522 50068 bw_penalty_box  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 REJECT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ! quota rmnet_data0: 9223372036854775807 bytes  reject-with icmp-port-unreachable
Chain bw_costly_shared (0 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 bw_penalty_box  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain bw_happy_box (0 references)
pkts bytes target     prot opt in     out     source               destination         
Chain bw_penalty_box (2 references)
pkts bytes target     prot opt in     out     source               destination         
Chain fw_FORWARD (1 references)
pkts bytes target     prot opt in     out     source               destination         
Chain fw_INPUT (1 references)
pkts bytes target     prot opt in     out     source               destination         
8316  775K fw_standby  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain fw_OUTPUT (1 references)
pkts bytes target     prot opt in     out     source               destination         
6892  616K fw_standby  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain fw_dozable (0 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 1001
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 9810
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10000
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10001
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10002
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10003
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10004
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10005
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10006
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10007
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10008
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10009
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10011
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10012
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10013
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10014
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10015
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10016
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10017
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10018
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10019
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10020
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10021
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10022
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10024
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10025
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10026
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10027
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10028
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10029
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10030
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10031
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10033
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10034
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10037
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10038
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10040
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10041
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10042
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10043
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10044
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10046
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10047
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10049
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10050
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10051
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10052
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10053
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10055
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10056
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10057
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10058
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10059
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10060
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10061
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10062
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10064
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10065
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10066
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10067
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10068
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10069
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10070
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10071
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10072
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10073
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10074
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10075
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10076
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10077
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10079
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10080
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10081
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10083
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10084
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10085
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10086
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10087
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10088
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10089
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10092
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10093
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10094
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10095
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10096
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10097
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10098
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10103
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10126
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10127
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10128
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10130
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10131
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10132
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10133
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10134
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10135
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10137
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10138
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10139
5137  548K RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 0-9999
  529 46711 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain fw_standby (2 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10123
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10144
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10101
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10140
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10036
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10104
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10124
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10148
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10141
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10114
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10010
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10149
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10146
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10125
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10120
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10117
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10122
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10039
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10105
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10244
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10225
    1    52 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10032
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10216
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10100
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10116
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10115
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10250
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10119
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10270
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10302
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10107
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10304
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10118
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10121
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10110
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10136
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10063
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10260
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10309
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10310
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10311
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10315
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10337
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10339
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10340
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10341
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10342
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10343
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10344
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10346
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10347
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10348
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10349
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10350
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10351
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10352
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10353
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10354
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10355
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10356
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10357
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10358
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10359
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10360
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10362
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10364
Chain natctrl_FORWARD (1 references)
pkts bytes target     prot opt in     out     source               destination         
4043 2252K natctrl_tether_counters  all  --  rmnet_data0 wlan0   0.0.0.0/0            0.0.0.0/0           [goto]  state RELATED,ESTABLISHED
    7   539 DROP       all  --  wlan0  rmnet_data0  0.0.0.0/0            0.0.0.0/0            state INVALID
4275  576K natctrl_tether_counters  all  --  wlan0  rmnet_data0  0.0.0.0/0            0.0.0.0/0           [goto] 
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain natctrl_tether_counters (2 references)
pkts bytes target     prot opt in     out     source               destination         
382K   31M RETURN     all  --  wlan0  rmnet_data0  0.0.0.0/0            0.0.0.0/0           
446K  551M RETURN     all  --  rmnet_data0 wlan0   0.0.0.0/0            0.0.0.0/0           
Chain oem_fwd (1 references)
pkts bytes target     prot opt in     out     source               destination         
Chain oem_out (1 references)
pkts bytes target     prot opt in     out     source               destination         
Chain st_OUTPUT (1 references)
pkts bytes target     prot opt in     out     source               destination         
Chain st_clear_caught (2 references)
pkts bytes target     prot opt in     out     source               destination         
Chain st_clear_detect (0 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 REJECT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            connmark match  0x2000000/0x2000000 reject-with icmp-port-unreachable
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            connmark match  0x1000000/0x1000000
    0     0 CONNMARK   tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            u32 ""0x0>>0x16&0x3c@0xc>>0x1a&0x3c@0x0&0xffff0000=0x16030000&&0x0>>0x16&0x3c@0xc>>0x1a&0x3c@0x4&0xff0000=0x10000"" CONNMARK or 0x1000000
    0     0 CONNMARK   udp  --  *      *       0.0.0.0/0            0.0.0.0/0            u32 ""0x0>>0x16&0x3c@0x8&0xffff0000=0x16fe0000&&0x0>>0x16&0x3c@0x14&0xff0000=0x10000"" CONNMARK or 0x1000000
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            connmark match  0x1000000/0x1000000
    0     0 st_clear_caught  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            state ESTABLISHED u32 ""0x0>>0x16&0x3c@0xc>>0x1a&0x3c@0x0&0x0=0x0""
    0     0 st_clear_caught  udp  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain st_penalty_log (0 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK or 0x1000000
    0     0 NFLOG      all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain st_penalty_reject (0 references)
pkts bytes target     prot opt in     out     source               destination         
    0     0 CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK or 0x2000000
    0     0 NFLOG      all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 REJECT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable

==================
Network interfaces
==================

r_rmnet_data3
r_rmnet_data4
r_rmnet_data0
r_rmnet_data2
r_rmnet_data1
r_rmnet_data8
r_rmnet_data6
r_rmnet_data5
r_rmnet_data7
rmnet0
rmnet_data3
rmnet_data2
rmnet_data4
rmnet_data0
rmnet_data1
rmnet_data6
rmnet_data5
rmnet_data7
sit0
lo
wlan0
dummy0

========
ifconfig
========

dummy0    Link encap:Ethernet  HWaddr 2A:5C:C8:9C:52:10  
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:210 (210.0 B)
lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:3240 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3240 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:301406 (294.3 KiB)  TX bytes:301406 (294.3 KiB)
r_rmnet_data0 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
r_rmnet_data1 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
r_rmnet_data2 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
r_rmnet_data3 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
r_rmnet_data4 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
r_rmnet_data5 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
r_rmnet_data6 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
r_rmnet_data7 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
r_rmnet_data8 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
rmnet0    Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          UP RUNNING  MTU:2000  Metric:1
          RX packets:531226 errors:0 dropped:0 overruns:0 frame:0
          TX packets:388026 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:559531024 (533.6 MiB)  TX bytes:36527848 (34.8 MiB)
rmnet_data0 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          inet addr:10.91.83.197  Mask:255.255.255.252
          UP RUNNING PROMISC ALLMULTI  MTU:1300  Metric:1
          RX packets:531209 errors:0 dropped:0 overruns:0 frame:0
          TX packets:388014 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:555148119 (529.4 MiB)  TX bytes:36526920 (34.8 MiB)
rmnet_data1 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
rmnet_data2 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
rmnet_data3 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
rmnet_data4 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
rmnet_data5 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
rmnet_data6 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
rmnet_data7 Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          [NO FLAGS]  MTU:1500  Metric:1
          RX packets:7 errors:0 dropped:0 overruns:0 frame:0
          TX packets:12 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:580 (580.0 B)  TX bytes:928 (928.0 B)
sit0      Link encap:UNSPEC  HWaddr 00-00-00-00-01-00-00-00-00-00-00-00-00-00-00-00  
          NOARP  MTU:1480  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
wlan0     Link encap:Ethernet  HWaddr AC:C1:EE:6A:AE:09  
          inet addr:192.168.43.1  Bcast:192.168.43.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:71251 errors:0 dropped:67 overruns:0 frame:0
          TX packets:74161 errors:0 dropped:9 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:8229317 (7.8 MiB)  TX bytes:48676526 (46.4 MiB)

===========
System info
===========

Android version: 6.0.1
Manufacturer: Xiaomi
Model: Redmi 3S
Build: MMB29M
Active interface: mobile
Tether status: yes
Roam status: no
IPv4 subnet: 
IPv6 subnet: 
/system/bin/su: not present
/system/xbin/su: not present
/system/app/Superuser.apk: not present
Superuser: eu.chainfire.supersu v2.82

===========
Preferences
===========

activeNotification: false
activeRules: true
appVersion: 15950
blockIPv6: false
block_filter_app: -12
disableIcons: false
enableAdmin: false
enableDeviceCheck: false
enableIPv6: true
enableLAN: true
enableLogService: true
enableRoam: true
enableVPN: true
hasRoot: true
ipurchaseddonatekey: false
logDmesg: BX
logPingTime: 10
logTarget: NFLOG
notification_priority: 0
notifyAppInstall: true
passSetting: p0
patternMax: 3
showFilter: false
showLogToasts: true
sysColor: -10432
toast_pos: bottom
widgetX: 720
widgetY: 1280
Profile Mode : whitelist
Status : Enabled

======
Logcat
======

22:39:10 Selected Profile: AFWallPrefs
22:39:10 Starting root shell...
22:39:10 Selected Profile: AFWallPrefs
22:39:10 [libsuperuser] [SU%] START
22:39:10 Root shell is open
22:39:10 isWifiApEnabled is true
22:39:10 Error fetching network interface list
22:39:10 Now assuming 3G connection (tethered)
22:39:10 Selected Profile: AFWallPrefs
22:39:10 applySavedIptablesRules invoked
22:39:10 Setting OUTPUT to Drop
22:39:10 Setting OUTPUT to Accept
22:39:10 Setting OUTPUT to Drop
22:39:10 Setting OUTPUT to Accept
22:39:16 CONNECTIVITY_CHANGE: applied rules at 1498410556354
22:39:47 Selected Profile: AFWallPrefs
22:39:50 applySavedIptablesRules invoked
22:39:50 Setting OUTPUT to Drop
22:39:50 Setting OUTPUT to Accept
22:39:50 Setting OUTPUT to Drop
22:39:50 Setting OUTPUT to Accept
22:40:28 Now assuming NO connection (all interfaces down)
22:40:28 Selected Profile: AFWallPrefs
22:40:28 Using fastApply
22:40:28 Setting OUTPUT chain to DROP
22:40:28 Setting OUTPUT chain to ACCEPT
22:40:28 Setting OUTPUT chain to DROP
22:40:28 Setting OUTPUT chain to ACCEPT
22:40:28 command 'iptables -P OUTPUT ACCEPT' exited with status 4, retrying (attempt 1/10)
22:40:28 CONNECTIVITY_CHANGE: applied rules at 1498410628928
22:40:30 isWifiApEnabled is true
22:40:30 Error fetching network interface list
22:40:30 Now assuming 3G connection (tethered)
22:40:30 Selected Profile: AFWallPrefs
22:40:30 Using fastApply
22:40:30 Setting OUTPUT chain to DROP
22:40:30 Setting OUTPUT chain to ACCEPT
22:40:30 Setting OUTPUT chain to DROP
22:40:30 Setting OUTPUT chain to ACCEPT
22:40:31 CONNECTIVITY_CHANGE: applied rules at 1498410631724
22:58:17 OS reported AP state change: 13 -> 10
22:58:17 OS reported AP state change: 13 -> 10
22:58:17 Now assuming NO connection (all interfaces down)
22:58:17 Selected Profile: AFWallPrefs
22:58:17 Using fastApply
22:58:17 Setting OUTPUT chain to DROP
22:58:17 Setting OUTPUT chain to ACCEPT
22:58:17 Setting OUTPUT chain to DROP
22:58:17 Setting OUTPUT chain to ACCEPT
22:58:17 command 'iptables -A afwall-wifi-postcustom -m owner --uid-owner 1014 -j RETURN' exited with status 4, retrying (attempt 1/10)
22:58:18 CONNECTIVITY_CHANGE: applied rules at 1498411698158
22:58:19 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
22:58:20 OS reported AP state change: 10 -> 11
22:58:20 OS reported AP state change: 10 -> 11
22:58:20 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
06:05:58 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
06:06:02 OS reported AP state change: 11 -> 12
06:06:02 OS reported AP state change: 11 -> 12
06:06:02 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
06:06:03 OS reported AP state change: 12 -> 13
06:06:03 OS reported AP state change: 12 -> 13
06:06:03 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
06:06:25 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
06:06:25 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
06:06:29 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
06:06:56 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
06:06:57 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
06:06:59 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
06:10:35 Selected Profile: AFWallPrefs
06:10:35 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
06:10:47 applySavedIptablesRules invoked
06:10:47 Setting OUTPUT to Drop
06:10:47 Setting OUTPUT to Accept
06:10:47 Setting OUTPUT to Drop
06:10:47 Setting OUTPUT to Accept
06:11:09 applySavedIptablesRules invoked
06:11:09 Setting OUTPUT to Drop
06:11:09 Setting OUTPUT to Accept
06:11:09 Setting OUTPUT to Drop
06:11:09 Setting OUTPUT to Accept
06:13:41 Selected Profile: AFWallPrefs
06:14:01 applySavedIptablesRules invoked
06:14:01 Setting OUTPUT to Drop
06:14:01 Setting OUTPUT to Accept
06:14:01 Setting OUTPUT to Drop
06:14:01 Setting OUTPUT to Accept
06:25:55 Selected Profile: AFWallPrefs
06:25:56 isWifiApEnabled is true
06:25:56 Error fetching network interface list
06:25:56 Now assuming 3G connection (tethered)
06:25:56 Selected Profile: AFWallPrefs
06:25:56 Using fastApply
06:25:56 Setting OUTPUT chain to DROP
06:25:56 Setting OUTPUT chain to ACCEPT
06:25:56 Setting OUTPUT chain to DROP
06:25:56 Setting OUTPUT chain to ACCEPT
06:25:56 command 'iptables -F afwall-3g-postcustom' exited with status 4, retrying (attempt 1/10)
06:25:57 CONNECTIVITY_CHANGE: applied rules at 1498438557231
09:49:06 Selected Profile: AFWallPrefs
09:49:09 applySavedIptablesRules invoked
09:49:09 Setting OUTPUT to Drop
09:49:09 Setting OUTPUT to Accept
09:49:09 Setting OUTPUT to Drop
09:49:09 Setting OUTPUT to Accept
09:49:55 applySavedIptablesRules invoked
09:49:55 Setting OUTPUT to Drop
09:49:55 Setting OUTPUT to Accept
09:49:55 Setting OUTPUT to Drop
09:49:55 Setting OUTPUT to Accept
09:50:57 Selected Profile: AFWallPrefs
09:51:55 Now assuming NO connection (all interfaces down)
09:51:55 Selected Profile: AFWallPrefs
09:51:55 Using fastApply
09:51:55 Setting OUTPUT chain to DROP
09:51:55 Setting OUTPUT chain to ACCEPT
09:51:55 Setting OUTPUT chain to DROP
09:51:55 Setting OUTPUT chain to ACCEPT
09:51:56 CONNECTIVITY_CHANGE: applied rules at 1498450916373
09:51:58 isWifiApEnabled is true
09:51:58 Error fetching network interface list
09:51:58 Now assuming 3G connection (tethered)
09:51:58 Selected Profile: AFWallPrefs
09:51:58 Using fastApply
09:51:58 Setting OUTPUT chain to DROP
09:51:58 Setting OUTPUT chain to ACCEPT
09:51:58 Setting OUTPUT chain to DROP
09:51:58 Setting OUTPUT chain to ACCEPT
09:51:59 CONNECTIVITY_CHANGE: applied rules at 1498450919038
09:52:19 Selected Profile: AFWallPrefs
09:52:21 applySavedIptablesRules invoked
09:52:21 Setting OUTPUT to Drop
09:52:21 Setting OUTPUT to Accept
09:52:21 Setting OUTPUT to Drop
09:52:21 Setting OUTPUT to Accept
09:53:31 isWifiApEnabled is true
09:53:31 Error fetching network interface list
09:53:31 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
09:53:31 isWifiApEnabled is true
09:53:31 Error fetching network interface list
09:53:31 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
09:57:02 Selected Profile: AFWallPrefs
09:57:04 applySavedIptablesRules invoked
09:57:04 Setting OUTPUT to Drop
09:57:04 Setting OUTPUT to Accept
09:57:04 Setting OUTPUT to Drop
09:57:04 Setting OUTPUT to Accept
09:57:23 Ended Loading: 1498451243136
09:58:06 Selected Profile: AFWallPrefs
09:58:22 Starting Log Service: echo $$ & /data/user/0/dev.ukanth.ufirewall/app_bin/nflog ; 40 for LogTarget: NFLOG
09:58:22 rootSession is not Null
09:58:22 [libsuperuser] [SU%] START
09:58:22 Cleanup session
09:58:54 Cleanup session
09:58:56 Starting Log Service: echo $$ & /data/user/0/dev.ukanth.ufirewall/app_bin/nflog ; 40 for LogTarget: NFLOG
09:58:56 rootSession is not Null
09:58:56 [libsuperuser] [SU%] START
09:58:56 Cleanup session
09:59:44 isWifiApEnabled is true
09:59:44 Error fetching network interface list
09:59:44 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
09:59:44 isWifiApEnabled is true
09:59:44 Error fetching network interface list
09:59:44 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
10:00:36 Cleanup session
10:00:36 Starting Log Service: echo $$ & /data/user/0/dev.ukanth.ufirewall/app_bin/nflog ; 40 for LogTarget: NFLOG
10:00:36 rootSession is not Null
10:00:36 [libsuperuser] [SU%] START
10:00:36 Cleanup session
10:02:39 Cleanup session
10:02:42 Starting Log Service: echo $$ & /data/user/0/dev.ukanth.ufirewall/app_bin/nflog ; 40 for LogTarget: NFLOG
10:02:42 rootSession is not Null
10:02:42 [libsuperuser] [SU%] START
10:02:42 Cleanup session
10:14:26 Selected Profile: AFWallPrefs
```"
ukanth/afwall,open,Tasker plugin does not work,[],"After updating to v 2.9.5 and migrating profiles Tasker plugin does not work correctly.
When I run a task in Tasker, AFWall+ randomly switches profiles or enables/disables firewall with complete disregard to configuration selected in Tasker plugin.
My setup is: CM13 with Magisk root v13, AFWall+ Donate v2.9.5, Tasker v4.9u4."
ukanth/afwall,open,Wrong icons in the log,[],"Hi,
As the title says:
* Example: Titanium Backup icon on Substratum's line
* Swiftkey Keyboard appears twice with 2 different UID

![screenshot_20170621-080450](https://user-images.githubusercontent.com/5938828/27372173-f1edebd2-5663-11e7-8a5a-ab054a498d0a.png)

AFWall 2.9.5 - Android 7.1.2 - Magisk 12"
ukanth/afwall,open,Trouble with KingRoot!,"[Label(name=""Feature""), Label(name=""Low"")]","KingRoot will change iptables and there should be a service reapplying afwall rules every x second so preventing kingroot...

There might be a better solution but the point is to fight with kingroot without killing her :)

Good luck"
ukanth/afwall,open,Magisk constantly telling me AfWall requested root,[],I think this started when after I bought the donation version of the app but I'm not sure.
ukanth/afwall,open,VPN Configuration,[],"Is there a way to configure the following behavior:

- if the VPN is connected via WIFI or LAN then allow all apps to go through it, but if the VPN is connected using Mobile Data then only allow specific apps???

Thanks in advance.
"
ukanth/afwall,closed,ClockSync app issues,[],"Hello all,

I'd like to use this http://amip.tools-for.net/wiki/android/clocksync  to sync with an NTP server I specify from within the app.

I'm currently using server ntp.derekgordon.com. There are several addresses mapped to it so I want to know if its possible to use an iptables rule to allow all of them incoming and outgoing (this is standard NTP protocol correct?), as it seems the NTP server queried interchanges with every new sync attempt, or is this an overkill method? Should i just narrow it down to a single IP address outgoing and incoming? But what about if that server is temporaily down during the query? So allow all of them, correct?

using nslookup for the derekgordon address shows 10 mapped ip's, so I'm thinking a custom script iptables -t-nat -A OUTPUT -p udp/tcp --dport 123 --to-destination IP address:123 for all 10 should do the trick.

here's a log, afwall denied an address mapped to one of the ntp.derekgordon.com addresses.
[iptables.txt](https://github.com/ukanth/afwall/files/1057814/iptables.txt)
"
ukanth/afwall,open,Wrong traffic details,[],"Hi,
It seems traffic details are not accurate. Here are the steps to reproduce the issue.  
The screenshots are related to the system component UID 1000. AFWall+'s app data have been cleared from the App info screen before these tests.

1. [First screenshot, taken at 08:52 am](https://forum.xda-developers.com/attachment.php?attachmentid=4153480&d=1495092120) // **no downloaded/uploaded data**  
2. [2nd screenshot after a reboot, taken at 08:54 am](https://forum.xda-developers.com/attachment.php?attachmentid=4153481&d=1495092120) // **=> no downloaded/uploaded data**  
3. [New reboot, new screenshot taken at 09:02 am](https://forum.xda-developers.com/attachment.php?attachmentid=4153475&d=1495091780) // **=> here we have downloaded/uploaded data**
4. [New reboot, new screenshot taken at 09:05 am](https://forum.xda-developers.com/attachment.php?attachmentid=4153476&d=1495091780) // **=> no downloaded/uploaded data**

Such an UID includes several packages (OnePlusPocketMode, System Settings, ANT HAL Service, Fused Location, Dev Tools...) but I guess the uploaded/downloaded data should always be the same.
**How could I have downloaded/uploaded data on the 3rd screenshot and nothing a few minutes later?** 

Thanks.
AFWall+ 2.9.4 - Android 7.1.2 - MagiskSU v12."
ukanth/afwall,open,Have to press hardware search button twice to activate search ,[],No response with the first press 
ukanth/afwall,open,Bug: Data being leaked,"[Label(name=""Review"")]","I am not sure what is going on but Chrome and Firefox allows several sites through on by Nexus 6 (shamu) on Android 7.0 stock and rooted, despite being both being disabled. Websites including Google, Cnn and Wikipedia all go through but most others don't. Snapchat also goes through desptite being blocked. I have logging enabled and it says all the apps I mentioned are being blocked despite everything going through."
ukanth/afwall,closed,Add more profiles,[],"4 profiles are not enough, please add at least 2 or 4."
ukanth/afwall,open,log improves,"[Label(name=""Review"")]","1) Option to hide duplicates 
2) Export
3) Ability to log not-blocked apps from list"
ukanth/afwall,open,"Manifest prevents ""adb backup"" from backing up AFWall data","[Label(name=""Review"")]","Is there any reason why AFWall is excluded from ""adb backup""? It i disabled in manifest It specifies `android:allowBackup=""false""`, but I don't really see good reason to exclude it. Can we enable back? I could make a PR, but it is literally one line change.

Relevant part of the Manifest
https://github.com/ukanth/afwall/blob/109a9f1b8846f78d04e9be67132af819a930bf40/aFWall/src/main/AndroidManifest.xml#L81"
ukanth/afwall,open,Notifications,"[Label(name=""Review"")]","One minor thing:
When permanently activated notifications, there is the wrong description"
ukanth/afwall,open,[Discussion/Help] Improving the custom scripts documentation ,"[Label(name=""Review"")]","1.
Theres are some sections there where it doesnt use $IPTABLES and instead has iptables:

* How do I block a subnet
And the follow two below that.

This brings me to my first question.


2.
What is the difference in using each?


3.
My next question is which way is the script read for order priority?

I have two(rulesets?), well four rules for example:

`# Block ALL inbound traffic`
`$IPTABLES -P INPUT DROP`

`# Stateful Inspection`
`$IPTABLES -A INPUT -m state –state ESTABLISHED,RELATED -j ACCEPT`
`$IPTABLES -A FORWARD -m state –state ESTABLISHED,RELATED -j ACCEPT`
`$IPTABLES -A OUTPUT -m state –state ESTABLISHED,RELATED -j ACCEPT`


I havent used Linux enough to know which order they should be listed in on the script so that stateful inspection takes precedence over the blanket rule.

This concept of priority isn't mentioned on the page."
ukanth/afwall,open,App force closes when trying to buy,"[Label(name=""Review"")]","Im on LineageOS, AFWall is running as root through MagiskSU.
Every process is blocked from network activity except AFWall. AFWall is also a device admin.


I get the ""AFWall has stopped"" click to restart when clicking ""Buy donate version or donate key"".

V2.9.4 

Android 7.1.2 LineageOS without GApps or Play services.

SELinux is in Enforcing mode.

I would really like to see logs so is there in alternative method of payment while this gets fixed?


* AFWall+ Mode (whitelist [default enabled]/blacklist)
* [your text/file or link]
* Android ROM + exactly versions number
* [your text/file or link]
* What steps will reproduce the problem?
* [your text/file or link]
* Additional security software installed (like XPrivacy/Avast)? Is it really deactivated?!
* Magisk and Netguard, This problem happens even when offline.
* What is the expected output? What do you see instead?
* [your text/file or link]
* Attach your rules.log (IPv4 + IPv6)
* [your text/file or link]
* iptables -v -n -L
* [your text/file or link]
* ip rule list
* Not loaded
* ip route show table (number)
* [your text/file or link]
* iptables -L -t mangle (only on VPN)
* No VPN
* Type 'adb bugreport' via ADB (only necessary if there is a crash)
* Will get around to this by tomorrow.
* Please provide any additional information below (e.g. logcat).
* I dunno, I see ""Adreno"" a lot in logcat.
* Which binaries are used for BusyBox/IPTables?
* Auto IPTables and built in Busybox
* Which DNS-proxy option is in usage?
* This even happens in aeroplane mode
* Are the experimental options enabled/disabled?!
* No and there is no init.d support currently.
"
ukanth/afwall,closed,Permanent notification - NOT AN  ISSUE,"[Label(name=""Feature""), Label(name=""Low"")]","AFWall+ (Donate)

Sorry because this is not an issue, but I don´t find other way to ask you about.

Actually I love this app and his functionality. I use it for controll mobile data and I have a question about the permanent notification

I turn the permanent notification option on

![1](https://cloud.githubusercontent.com/assets/28064662/25451736/c5566790-2a88-11e7-943c-a00b50a0452c.png)

![2](https://cloud.githubusercontent.com/assets/28064662/25451767/d8440f88-2a88-11e7-8429-034414055e9f.png)

And it works fine but I want to know if its posible to show it as the others ""persistent notification"" because I want to check if the service is running but not to see it on my notification bar every time.

I mean something like this...

![3](https://cloud.githubusercontent.com/assets/28064662/25451785/e6f4842c-2a88-11e7-93fc-0ab97ab59baa.png)

And hidden the icon

![4](https://cloud.githubusercontent.com/assets/28064662/25452369/113628ce-2a8b-11e7-95af-fac2f247dffc.png)

Thanks for your attention"
ukanth/afwall,open,"At boot: ""Error applying firewall rules"" and ""Firewall enabled"" Notification (5X MM 6.0.1)","[Label(name=""Review"")]","For some time now (maybe since the prior stable release), I receive two Notif messages every boot: 
1) ""Error applying firewall rules. Click to open settings."" before the passcode screen; and 
2) ""Firewall enabled"" a min or so later
My tests show AFWall+ is not working. 

Once the phone is stable, I open AFWall+ and the GUI shows enabled. So I disable, then re-enable, but the ""Working .. Applying iptables rules"" window never goes away and must be closed. AFWall+ is still not working. 

A work-a-round ... disable firewall before rebooting and enable after. Works every time.

Note: I often forget to disable AFWall+ before rebooting ... and ~10% of the time it enables correctly.
Note2: Experimental feature start-up delay does not help

This may be related to issue #699 and #700 ... can't tell for sure"
ukanth/afwall,open,AFWall+ not working after reboot,"[Label(name=""Review"")]","Hello,

I recently opened https://github.com/ukanth/afwall/issues/699 but it seems that actually the problem is another: I uninstalled and reinstalled AFWall+ and bought the license and had an empty setup. In this everything was okay, i.e., all apps were blocked - also VPN based.

Yet, after an immediate reboot of the phone (AICP based on LineageOS, Android 7.1, device HTC10) I noticed that beside the fact that no app was selected for traffic (i.e., all should still be blocked) internet traffic was flowing normally. The browser could access any page, Google Play was working, etc.

So it seems that after a device reboot AFWall+ does not get activated again though it says that it is active."
ukanth/afwall,open,OpenVPN and AFWall+,"[Label(name=""Review"")]","Hello,

I think this is related to https://github.com/ukanth/afwall/issues/51. I am using AFWall+ on LineageOS 14.1 (Android 7.1) and am facing the fact that all blocked app are able to bypass the firewall when the VPN is active.

I might need to say that the VPN runs over TCP on port 443 instead of 1194/UDP.

Do you have a suggestion of how to fix this and get the apps blocked on VPN as well?"
ukanth/afwall,open,Mobile Data not being blocked (Pixel / Project Fi),"[Label(name=""Review"")]",
ukanth/afwall,open,Roaming not automatically detected,"[Label(name=""NoInfo""), Label(name=""Review"")]","I live in Belgium and work in The Netherlands.

I use AFWall to avoid roaming for some apps in The Netherlands, while I still want to allow some other apps to roam.

When I cross the border and my phone starts roaming, AFWall does not seem to detect this. All apps still have access to the internet until I reapply the rules, after that, roaming rules are applied correct.

I have to repeat this process when coming back to Belgium after work."
ukanth/afwall,closed,No updates on F-Droid since 2.9.1,[],"Hi,

I'm using AFWall from F-Droid repository, but it seems there are no updates since 2.9.1 (2016-12-15).
Did something happen with the process of publishing the updates on F-Droid?

https://f-droid.org/repository/browse/?fdid=dev.ukanth.ufirewall"
ukanth/afwall,closed,[Feature Request] Add Tor support,"[Label(name=""Feature"")]","Just like you have the option for Roaming support, can we add a automatic torification toggle.
Currently I am adding these rules by hand via custom rules section.

It just needs to add the following rules. Change $app to the uid of the application you want to torify.
```
$IPTABLES -t filter -A OUTPUT -m owner --uid-owner $app -o lo -j ACCEPT 
$IPTABLES -t nat -A OUTPUT -p tcp ! -o lo ! -d 127.0.0.1 ! -s 127.0.0.1 -m owner --uid-owner $app -m tcp --syn -j REDIRECT --to-ports 9040 
$IPTABLES -t nat -A OUTPUT -p udp -m owner --uid-owner $app -m udp --dport 53 -j REDIRECT --to-ports 5400 
$IPTABLES -t filter -A OUTPUT -m owner --uid-owner $app ! -o lo ! -d 127.0.0.1 ! -s 127.0.0.1 -j REJECT
```"
ukanth/afwall,closed,AFWall+ Permanently Disables Mobile Data connection even after Uninstall,[],"I installed AFWall+ so that I could use it alongside OpenVPN. It works fine on WiFi, but it disables my Mobile Data while on WiFi, and then doesn't switch it back on once WiFi is turned off. Even manually cycling the Mobile Data Connection on and off doesn't do anything. It's like AFWall+ messed with some setting which disables the Mobile Data connection completely, with no option of getting it back. I had to uninstall AFWall+ completely, reboot, and then did a bunch of random tweaking in ADB like flushing iptables and things like that in order to get the connection back. Then... I reinstalled AFWall+ and the exact same problem happened again. It happens whether or not I have the Xposed module enabled and whether or not I have AFWall+ set as a Device Administrator. It just completely kills my Mobile Data connection. I don't even have access to anything on any network when WiFi is off now. I'm on Stock Marshmallow 6.0.1 Moto G4 rooted with Xposed. What can I do?"
ukanth/afwall,open,[feature] Any way of limit 3g data independently of 4g?,"[Label(name=""Review"")]","My current Internet plan allows 2gb for 3g surfing and 20gb for 4g LTE surfing. 
Any way of limit 3g data independently of 4g?

In Attachment file I have dual sim. but in the test I just change betwen 3g and 4g in only sim 1.
[IPv4_Rules_AChain.txt](https://github.com/ukanth/afwall/files/875923/IPv4_Rules_AChain.txt)

See also https://forum.xda-developers.com/showpost.php?p=71622150&postcount=3724

Thanks in advance. "
ukanth/afwall,open,"[v2.9.5] Rules are not being applied, Manually Applying them again needed","[Label(name=""Review"")]","Magisk Manager got notification of new update although not enabled in whitelist.
After applying rules again, MM cannot check for internet anymore.
![](https://s16.postimg.org/4wkq0fh2t/Screenshot_20170324-093021.png)
Somehow rules are not being forced. Or are not being applied over time, reboot, ?

MxPlayer was also able to check for new update even though it is not on whitelist:
![](https://s15.postimg.org/my365bgl7/Screenshot_20170331-195215.png)"
ukanth/afwall,open,why have you removed x86 support in latest version.,[],"i know there are many x86 based Android devices out there, so why have you removed there support in version 2.9.2. i think this is a grate step backwards to the ruine..."
ukanth/afwall,open,Protokoll Filter funktioniert nicht,"[Label(name=""Review"")]","Ich möchte gerne einige Meldungen deaktivieren. Wenn ich den Haken setze, aus der APP raus und wieder rein gehe, dann ist der Haken weg. Es wird nichts gefiltert.

Transate: I would like to disable some messages. If I put the hook, from the APP raus and go again, then the hook is gone. Nothing is filtered."
ukanth/afwall,open,I need to enable all connections to access the local lan,"[Label(name=""Review"")]","Hi

I do not remember this being an issue in the past but I just realized that the latest version does not let me connect to local network as long as I do not give full acess to the apps. Full access meaning that I have to enable Lan/Connection/Vpn (maybe vpn is not needed). 

I am talking about accessing devices that are in the same router not like trying to access another chained one. 

I have VPN/Lan/Connection (and with ip6 support). I am using 2.9.1  also inbound connections is enabled. Firewall is fuly functional except that the local lan access is not avail as long as I do not give internet access to the devices.

I tried this on Marshmallow and Nougat (lineage os) and I have the same issues with these devices however another Lollipop device does not seem to suffer from it."
ukanth/afwall,closed,Disable afwall+ from TWRP / shell,[],"Hello, 
i have xiaomi redmi 3s and i blocked internet connection for process ""activation mi account""(or something like that). After restart is my phone locked and i can´t unlock. I can use TWRP file manager and terminal.
I need disable Afwall+ from TWRP terminal. It is possible? or i must flash android.

thanks."
ukanth/afwall,open,afwall-wifi-lan sometimes not referenced,"[Label(name=""Review"")]","The last days I had the problem that my apps with only wifi-lan permissions could not communicate. I looked at the afwall+ rules and found this line: `Chain afwall-wifi-lan (0 references)`
So I tried to gather information for this issue, changed the permissions of another app and suddenly the chain is referenced: `Chain afwall-wifi-lan (1 references)`.
So right now, my apps can communicate to the LAN, which they weren't able to, before.

As soon as the problem reoccurs, I will upload my rules.

I'm running afwall+ 2.9.1 from F-Droid."
ukanth/afwall,open,use iptable binding libraries?,"[Label(name=""Review"")]","Hi, 
Is afwall using any iptabls binding lib like https://github.com/ldx/python-iptables (Its not java, I know. but that's not the point here. the great java must have sth alike, right?)
I feel afwall is acting so slow sometimes when turning on/off firewall, applying rules.
espcially one cant change and apply indivisual rule. thus i am guessing its commandline parsing based? i see there are many customized rule related ticket. this will make them a lot more robust and easier.

(sorry, should be iptables)"
ukanth/afwall,open,"special considerations, OpenVPN apps","[Label(name=""Review"")]","Some privacy vpn services most notably TorGuard.net and privateinternetaccess.com  use some magic to prevent non-vpn traffic if disconnected from vpn.

if this magic is iptables which app wins?"
ukanth/afwall,open,"denied su for ""afwall+ [UID], endless crashing until reboot","[Label(name=""Review"")]","one match to my issue

https://github.com/ukanth/afwall/issues/583#issuecomment-254146423

What is in quotes is exactly what appeared.  First time seen last night since more than a year of use.

Should i be worried? "
ukanth/afwall,open,Can't block some apps.,"[Label(name=""NoInfo"")]","Hi and thanks for your efforts in creating and mantaining AFWall.

Recently i discovered that some apps i denied are still able to transmit and receive data.
One example is Lara Croft Go. (LCGO)
I opened better battery stats (BBS) and discovered that it generates about 500KB of traffic per launch (BBS doesn't tell me if it is up or down).
I double checked and it s not allowed to generate any traffic in afwall, nothing shows in the log anyway.
The only way i've to block it, is to use xprivacy xposed addition and explicitely negate internet access to it.
I think that maybe LCGO is using another application to access the internet, and iptables is unaware of it, but since i'm unable to find a way to log successfull connection attempts (only denied) i cannot be sure.

Any hint?"
ukanth/afwall,closed,Disable logging per app,"[Label(name=""Review"")]","I log the apps that are denied,  but some of them just don't give up and keep showing toasts. I'd like more granularity -disable (or enable) logging per app."
ukanth/afwall,closed,X86 support ,"[Label(name=""Question"")]","What is exactly the purpose of pushing an update to x86 users when the change log says you are dropping support for x86 ? Break app's function on purpose for people trusting you that kept auto update on ? If at some point you drop support for an architecture, don't make the update that drop support available for users of that architecture."
ukanth/afwall,closed,[Feature Request] Need HW search key to activate search button,"[Label(name=""Feature"")]",
ukanth/afwall,closed,Add Separator Outgoing and Incoming Connections,[],"Please add a separator feature to block the outgoing and incoming connections, like LightningWall

![screenshot_2017-02-18-08-22-47-654_de defim apk lightningwall](https://cloud.githubusercontent.com/assets/25722966/23089102/9e613036-f5b6-11e6-95f7-3b0e28a1c9ce.png)
![img_20170218_082437](https://cloud.githubusercontent.com/assets/25722966/23089108/a8714c50-f5b6-11e6-849e-4fb63b410a19.jpg)
"
ukanth/afwall,closed,Feature Suggestion - Screen on/off  rules,[],I have seen some other non-root firewall that can control the data traffic for screen on/off separately. Can your app also add this feature?
ukanth/afwall,open,Search function for notification filter dialog [Feature Request],"[Label(name=""Feature"")]","It is really annoying to scrolle through the long applications list in the notification filter dialog. 
It would be nice to have a search function in the notification filter dialog or a possibility to add an app to the notification filter from the main apps list."
ukanth/afwall,closed,"Revert ""Added localnet multicast-adresses to wifi-lan chain""",[],Reverts ukanth/afwall#620
ukanth/afwall,closed,Android 7 is using UID 0 more than before. What to do?,"[Label(name=""Review"")]","I know that you do not recommend to block UID 0 (kernel). But since I use Android 7, more apps seem to use this UID than before. 
E.g. Signal cannot transfer media anymore when kernel uid is blocked (On Android 6, I could retrieve images with having uid 0 blocked),
k9 tries to retrieve emails on port 993 via kernel uid 0 (but works even if it is blocked).
Some other apps (need to verify which again) trigger Amazon cloud services via kernel UID 0.

What are these developers doing differently than those where the uid of the app itself is chosen?
If apps can circumvent your firewall just by using kernel uid 0 to access some cloud services, it is an attack to AFwall's core functionality.
"
ukanth/afwall,closed,information for custom scripts leads to empty page,[],"Selwcting ""set ciustom script"" offers ""for Information about custom scripts, clicke here"" and guides to https://github.com/ukanth/afwall/wiki/CustomScripts
But this leads to an empty ""create new page"" page on github.
I remember that this existed in the past. What has changed here?"
ukanth/afwall,closed,AFWall+ doesn't work,[],Applications gain access to internet even if it is not allowed in AFWall!
ukanth/afwall,closed,Fully Integrated Dns_crypt works well with Afwall on both WIFI and Data,[],"I have successfully integrated Dnscrypt into a Lollipop rom and it fully works with Afwall.  You only need to white-list (allow internet access) to apps running as root. Tested with Opendns on both WIFI and Data.

I used the following CM commits: https://review.cyanogenmod.org/#/q/dnscrypt

P.S. This is not an Issue, but rather information, since Dnscrypt issue is closed"
ukanth/afwall,open,UPNP broadcast blocked if LAN access is given,"[Label(name=""Review"")]","I have a couple of apps that I only want to use in my LAN. I use them to control my home devices (lilke IP radio, Hifi receiver etc), but I don't want to have them ""talking home"" via the internet.

I have an app that tries to send UDP packets to 255.255.255.255:1900 which is SSDP via UPNP.
These packets are blocked by AFWall+ 2.9.1 as I can see from the log view.
The app has granted access to the LAN, but neither to Wifi internet nor to mobile internet.

255.255.255.255 should be opened in such a case.
"
ukanth/afwall,closed,v2.9.1 lan control does not work on Android 7,"[Label(name=""Review"")]","Hi there,

I'm using Afwall+ a long time already and I know this worked before.
Now I switched to Android 7 and use v2.9.1 and the lan control seems to block lan internal packets.
For example two Apps I'd like to give access to internal lan only:
 - ES Datei Explorer to access some NAS via samba
 - Yatse to access kodi remotely

If I just activate internal lan access for these apps I had access in the past, but now the apps are blocked. I also see in the log that the packets are blocked. My internal IPs are 192.148.158.*.
The log lists for
Yatse: blocked TCP 192.148.158.12:2500(16)    (THIS IS MY INTERNAL LAN)
ES Datei Explorer: blocked TCP 112.80.248.60:80  (THIS IS OK)
                           blocked TCP 192.148.158.16:445  (THIS IS MY INTERNAL LAN)
                           blocked TCP 192.148.158.16:139  (THIS IS MY INTERNAL LAN)

If I enable the WLAN access both apps work. It really seems to be a problem with the lan access setting :-(

Do others also run into this problem? Is this a bug in the current version or could anyone give me a hint what might be the problem?

Thanks"
ukanth/afwall,closed,All apps aren't listed.,"[Label(name=""Wont-Fix"")]","I have the Red Moon (F-Droid) app installed and AFWall+ doesn't list the app. I assume block by default is securing this app.

> root@t03g:/ # cat /proc/12082/cmdline
> com.jmstudios.redmoon"
ukanth/afwall,open,Automatic Error Reporter [Feature Request],"[Label(name=""Feature""), Label(name=""Low"")]","Hi,
The users of this application are increasing every single day, which may be associated with the lack of full error report for every single issue happened to many users in specific time frame.  I'm looking for a best quality that we can get from afWall.
So, I  suggest that we add a [Crashlytic from Fabric](https://get.fabric.io) which is library which should be bundled with app to report any unhandled exception from all users.
Even so,  it would be [integrated with GitHub](http://stackoverflow.com/questions/28220573/how-to-integrate-crashlytics-with-github) to create a new issue with every exception.
How wonderful of that? :)"
ukanth/afwall,closed,Add networking menu options for Log details,"[Label(name=""Feature"")]","Hi, 

@davedavis has requested this feature in [issue 655](https://github.com/ukanth/afwall/issues/655), and I liked the idea of course. 💯 
So, I made it, and it is available now for donated version only when user tab one time over log details row.

Hope you like it guys, Thanks.

![alt tag](http://vzool.net/img/AfWall+log_details_options.png)"
ukanth/afwall,closed,Fix null pointer issue,[],"Hi,
While I'm discover and test the code, I found Null pointer exception.

Thanks"
ukanth/afwall,closed,Patch 9,[],"Hi,
While I'm discover and test the code, I found Null pointer exception.

Thanks"
ukanth/afwall,closed,Add Fingerprint protection - clean branch,[],"Hi, I have clean it, and it does work very well now.

Thanks

![alt tag](http://vzool.net/img/AFWall+Fingerprint2.png)"
ukanth/afwall,open,changelog for 2.9.1 missing,[],"i see a new version 2.9.1 but cant find a change log Entry for that, please fix that.

thanks"
ukanth/afwall,open,com.android.providers.downloads denied,"[Label(name=""Bug""), Label(name=""Low"")]","When I launch adb logcat I observe that it gets spammed with the following messages from AFWall+ v2.9.1:
>[ 01-11 09:08:17.626 403: 403 W/afwallstart ]
type=1400 audit(0.0:296): avc: denied { getattr } for path=""/data/data/com.android.providers.downloads"" dev=""dm-0"" ino=65425 scontext=u:r:sysinit:s0 tcontext=ubject_r:app_data_file:s0:c512,c768 tclass=dir permissive=0

>[ 01-11 09:08:18.626 403: 403 W/afwallstart ]
type=1400 audit(0.0:297): avc: denied { getattr } for path=""/data/data/com.android.providers.downloads"" dev=""dm-0"" ino=65425 scontext=u:r:sysinit:s0 tcontext=ubject_r:app_data_file:s0:c512,c768 tclass=dir permissive=0

>[ 01-11 09:08:19.630 403: 403 W/afwallstart ]
type=1400 audit(0.0:298): avc: denied { getattr } for path=""/data/data/com.android.providers.downloads"" dev=""dm-0"" ino=65425 scontext=u:r:sysinit:s0 tcontext=ubject_r:app_data_file:s0:c512,c768 tclass=dir permissive=0

This goes on indefinitely. Is this normal behaviour or is there some issue? 

I use AFWall+ v2.9.1 on an encrypted LG G4 with LineageOS 13.0. The xposed framework and GAPPS are not installed.

**Update:**
The comment from ElwOOd_CbGp on the XDA forum might be a clue about the cause of this issue:
>Just a guess but it looks like it may have something to do with the init script trying to access (avc: denied { getattr } for path=""/data/data/com.android.providers.downloads"" dev=""dm-0"") a new feature that was introduced one or two versions ago. If you have xposed framework installed, AFWall has the ability to block apps from using the system download manager. If you don't have xposed installed, that might be the reason for the warning message. I'm not a dev or involved with the development of AFWall so don't quote me. Just looking at the log entries, that's what I see. 
([source](https://forum.xda-developers.com/showpost.php?p=70566871&postcount=3584))

**Update 2:**
If I disable the ""Fix startup data leak"" option, the above log entries do not appear anymore."
ukanth/afwall,closed,Unexpected Behavior with Work Profile Apps,[],"My device [work profile](https://support.google.com/work/android/answer/6191949?hl=en) apps are not working under Allow Mode even after checking (allowing) all list apps (core, system, user). It only work when allowing -10 (Any app) which supposed to be same as selecting all apps.

From the firewall log I can see that work profile apps are using same normal apps UID plus 11 added at the beginning. E.g. com.google.android.gm(10069) normal Gmail App, com.google.android.gm(1110069) work profile Gmail App.

I'm using Nexus 5X, Android 7.1.1 updated to latest security patch level January 5, 2017."
ukanth/afwall,closed,Feature Request: split data rules 3g and 4g,"[Label(name=""Wont-Fix"")]",4g sometimes get big portion from provider but 2g/3g have a small portion. Its nice if 3g and 4g splitted to have its own column.
ukanth/afwall,open,Feature Request: include IPset,"[Label(name=""Feature""), Label(name=""Low"")]","Sometimes we need to block IPs in a big list. I'm not sure if android can handle this but its a big jump for afwall, I believe you already heard about a tool called ipset.."
ukanth/afwall,open,Apps bypass firewall if a proxy used in the wireless settings,"[Label(name=""NoInfo"")]","Hi

I accidentally foud  out that if I set a proxy in the Android  wireless control settings, Afwal is not able to block apps traffic. I am not sure if this is by design or a bug.

thanks"
ukanth/afwall,closed,Add Fingerprint protection,[],"Hi...

I have added this feature for Marshmallow or newer versions of Android and I've tested in some different environments:
- OnePlus 3 (6.0.1) official Rooted ROM.
- Galaxy Note II(4.4.4) custom ROM by **Cyngenmod**.
- Galaxy Note 3(4.4.4) in Emulator by **Genymotion**.

I'm not sure if this right place to pull this request in **stable** branch, because I don't see any instructions about which pull requests should goes to which branch in [contribution section](https://github.com/ukanth/afwall#contributing).

I think that I can change the same pull request into different branch, so tell me if you want that.

Hope you like it, Thanks

![alt tag](http://vzool.net/img/AFWall+Fingerprint2.png)"
ukanth/afwall,open,VPN fine grain control ,"[Label(name=""Review"")]","Since a VPN connection runs over WiFi /LAN/data/roaming, it would be nice to have options to further control app inet access depending on which connection the VPN is running on.  

My proposal is the following:
Option ""VPN fine-grain control"" INACTIVE:
-The VPN filters works just as they do now. 

Option ""VPN fine-grain control"" ACTIVE:
-Have a further option ""VPN inherit underlying connection"" which, if active, when a VPN is on, an app will be allowed or blocked according to what is set for that app in the connection type the current VPN is running on. 
-If the option ""VPN inherit underlying connection"" is INACTIVE,  then it should be possible to manually select access for ""VPN over LAN"", ""VPN over WiFi "",""VPN over Data"",""VPN over Roaming"". 

I understand this is not a trivial request, and alternative proposals may be better, but I guess I made my point. In any case, keep up the good work! "
ukanth/afwall,open,[Feature Request] Resolve IP address option for logs. ,"[Label(name=""Feature"")]","In the log section, blocked requests are shown nicely. It would be great if there was an option to show these IP addresses' names resolved. 

I understand that some log categories can have hundreds of thousands of entries, so perhaps a long tap on an entry to resolve might work without having to have a separate option and warning? 

Would be cool to see the specific package/activity or system process that's making the request if it's possible too. "
ukanth/afwall,closed,Traffic details are always zero ,"[Label(name=""Bug"")]","i use AFWall and seems pretty efficient dealing with IPTables (Android 7.1.1) , but i have a small problem which is all my traffic details are always zero in both upload and download for all applications "
ukanth/afwall,closed,Notification filter options aren't saved (Google Pixel XL) ,[],"On latest AFWALL+ (Donate)  2.9.1,  Notification Filter options are never saved. This is a Google Pixel XL stock ROM 7.1.1 NMF26O. Supersu 2.79RC2. ElementalX P 1.02. I'm using built-in Busybox / iptables. However, I've already tried using system versions as well.

Notification Filter options are working fine on Nexus 6P and a Galaxy Nexus. 

Let me know if you need any further information or any tests. "
ukanth/afwall,closed,No buttons on Notification filter selection screen ,"[Label(name=""Bug"")]","Current market versions of AFWall+, Android 7.1.1 on Nexus 6P

Preferences > Logs > Notification Filter screen shows the list of installed apps, but not the OK button, making it impossible to update the selection. See attached screenshot. I just updated from Android 7.0.0 to 7.1.1. I didn't have this problem the last time I used the notification filter, so it might have been a system change.

![screenshot_20170107-132538](https://cloud.githubusercontent.com/assets/6742702/21744230/a3e16820-d4df-11e6-9767-c09bd9327991.png)
"
ukanth/afwall,closed,Multiple system apps in one item,"[Label(name=""Wont-Fix"")]","![untitled](https://cloud.githubusercontent.com/assets/2804472/21686212/8c6b226c-d39f-11e6-8e9f-84a7771df0d7.png)

As shown in the photo, multiple system apps are combined into a single item. I cant really know if the blocking is working for this but it is working properly for other apps.

Device: OnePlus 3T running stock Android 7.0
AFWall+ Version: 2.9.1"
ukanth/afwall,open,"""Fix startup data leak"" checkbox not available (magisk+)","[Label(name=""Feature"")]","If the ""Fix startup data leak"" checkbox is dimmed so that it cannot be enabled (checked), please reply to this issue so we can figure it out.

Please supply the AFWall+ version, Android version, `su` app, `su` app version, whether or not the Xposed Framework is installed, and whether or not AFWall+ is enabled in Xposed.  Here is a template:

**AFWall+ version:** 2.9.1
**Android version:** KitKat
**su:** SuperSU by chainfire
**su version:** 2.79
**Xposed installed:** Yes
**AFWall+ enabled in Xposed:** Yes"
ukanth/afwall,open,Method to auto compare current iptables with AFWall iptables?,"[Label(name=""Feature""), Label(name=""Low"")]","In order to solve any issue with other apps overwriting the iptables, in future, can AFWall compare the current iptables with the firewall saved ones and display some alarm or red dot if they do not match?  This can also help avoid manually re-applying iptables again if the iptables match, so no need to re-apply perhaps."
ukanth/afwall,closed,Visual glitch with the modern widget,"[Label(name=""Question""), Label(name=""Wont-Fix"")]","Hi,
Anywhere I put the widget icon on my homescreen, the related features are always available at the same place and the right is cut.
Thanks.

Nexus 5 - Resurrection Remix 7.1.1 - AFWall+ 2.9.1 15902 - Nova launcher - 400 dpi instead of 480

Widget: https://osine.cozycloud.cc/public/photos/photos/05f8a94e24653dbedefd1a942a00aae6.jpg

As you can see, the widget icon is too big compared to other app icons."
ukanth/afwall,closed,Rules are not applying after boot,[],"I have several rules defined, e. g. Instagram is not blocked when roaming, NVR viewer is blocked everywhere except LAN, etc. But these rules are applied only when I hit Apply manually - otherwise they are not effective. So after each reboot I have to re-apply them again. Tried switching on startup delay, didn't help. What coukd be the problem?

Device is Motorola Nexus 6 with latest Android 7.0 image from Google."
ukanth/afwall,open,Can it run without root in COSU mode?,"[Label(name=""Review"")]","Hi,
We are looking to deploy a few Android devices with kiosk mode firewall using Android COSU . 
https://codelabs.developers.google.com/codelabs/cosu/index.html?index=..%2F..%2Findex#0

https://developer.android.com/work/cosu.html

We are trying to get internet in places with poor people who don't necessarily can afford it. 

We are willing to fund some amount of this is possible (atleast cover cost of any additional 6.0 devices)."
ukanth/afwall,closed,Enhance clarity of empty log string,[],
ukanth/afwall,closed,"Improve confusing string, consistency correction",[],
ukanth/afwall,closed,inspect contents of blocked packets,[],"I'm curious if it's possible within the existing program (or if perhaps it would be easily modifiable) to enable inspection of blocked packets.

Essentially, the log feature shows me that certain programs (that I didn't expect to) were trying to use the internet.  I can see the IP, port, protocol that they were trying to use, but now I'd like to see what data they were trying to send.

Thanks!!"
ukanth/afwall,closed,conflict with newer CM13,"[Label(name=""NoInfo""), Label(name=""Review"")]","ref: https://jira.cyanogenmod.org/browse/NIGHTLIES-3547
Since 4/Dec/16 I find my tablet unable to use internet. Disabling and re-enabling AFWall+ brings internet back. I dumped iptables and found ""Chain OUTPUT (policy DROP)"" (See the diff)

I guess CM introduced some firewall but that broke AFWall+ compatibility.
P.S. AFWall+ also started to hang on opening in 50% 

May I suggest AFWall+ stop relying on the default policy and set explicit
ACCEPT any any ?"
ukanth/afwall,closed,Firewall disables internet access for all apps intermittently,"[Label(name=""NoInfo"")]","Even with the experimental startup box unchecked, eventually network access is restricted for all apps. Disabling and then Enabling the firewall makes the internet work again."
ukanth/afwall,closed,Firewall is not activating,"[Label(name=""NoInfo"")]","I have AfWall+ 2.9.0 and want to activate it. But if I click on ""Enable firewall"" nothing happens. Nothing is blocked and the Button is still named ""Enable firewall"". I have a Wiki Lenny 2 with Android 5.1 who is rooted with KingRoot."
ukanth/afwall,closed,Disable remote control,[],"Hi! Please, add:
- the ability to disable these services to keep others from gaining access to the device via a remote terminal: SSH, SSHD, Telnet NC (net cat), Ping

- the ability to disable Package Manager, so that no apps can be installed remotely to the device. 

- the ability to disable ADBD."
ukanth/afwall,closed,"Donate version source, etc","[Label(name=""Question"")]","Hi there,

I'm interested in the donate version:

1) how/where to donate without using play store; bitcoin?
2) how/where to review source code for donate version/build instructions?

Cheers!"
ukanth/afwall,closed,Possible to block mobile data after a particular date ?,[],"Is it possible to block mobile data access after a particular date ?  In our country (and in many others I assume),  on a Pay As You Go tariff, I can get unlimited data for eur20 for 30 days access.  However, on day 31, it will start taking eur1 per mb.

Therefore, if I forget to top up again, or forget the anniversary date, I can easily end up being fleeced for a few mb of background data"
ukanth/afwall,open,Blocks all wifi on Galaxy Note 2,"[Label(name=""Review"")]","The app used to work very good until a recent update. 
When I enable the firewall it blocks all my Internet connection, when I disable it the Internet connection is back again. 
I checked the apps, they aren't blocked in the firewall settings "
ukanth/afwall,closed,Text changes size on device rotation ,"[Label(name=""Feature""), Label(name=""Low"")]","When I perform this sequence of events, the text changes its size:

Sequence 1:
1. Click on More Options
2. Click on View Log
3. Click on More Options
4. Click on +
5. Orientation change

Sequence 2:
1. Click on More Options
2. Click on Show Rules
3. Click on More Options
4. Click on +
5. Orientation change"
ukanth/afwall,open,Modal dialogs disappear on device rotation,"[Label(name=""Bug""), Label(name=""Low"")]","When I perform these sequences of events, the dialog on screen disappears:

Sequence 1:
1. Click on ""..."" (More Options)
2. Click on Preferences
3. Click on Profiles
4. Click on Manage Profiles
5. Click on Add Profile
6. Orientation Change

Sequence 2:
1. Click on ""..."" (More Options)
2. Click on Preferences
3. Click on Profiles
4. Click on Manage Profiles
5. Long Click on profile item in list
6. Orientation Change

Sequence 3:
1. Click on More Options
2. Click on Show Rules
3. Click on More Options
4. Click on Flush Rules
5. Orientation change"
ukanth/afwall,closed,Action Overflow Menu Disappear on device rotation,[],"When I perform these sequences of events, the menu on screen disappears:

Sequence 1:
1. Click on More Options
2. Click on: 
a. Show Rules
b. View Log
3. Click on More Options
4. Orientation Change
"
ukanth/afwall,closed,Scrollable View changes position on Device Rotation,[],"When I perform this sequence of events, the scrollable view on screen goes back to the top:

1. Click on ""..."" More Options
2. Click on Firewall Rules
3. Scroll Down
4. Orientation Change"
ukanth/afwall,closed,Change default of disable prompt to true,[],Important that users do not accidentally disable the firewall.
ukanth/afwall,closed,Enable IPv6 support by default,[],"IPv6 is now commonplace.  Does the benefit of enabling this outweigh the downside of keeping it disabled by default?  If so, this patch will enable it by default."
ukanth/afwall,closed,[Feature Request] Long-press on app to launch it,"[Label(name=""Feature""), Label(name=""Wont-Fix"")]","Within the rules list, long-press on an app to launch it.  Would be very useful for testing."
ukanth/afwall,open,Active rules really needed for LAN control?,"[Label(name=""Question"")]","Without *Active rules* enabled, the user can specify different rules for WiFi vs. mobile data.

The UI currently requires *Active rules* to be enabled to specify different rules for LAN.  Is this necessary?"
ukanth/afwall,closed,Comprehensive review of strings (with updates),[],
ukanth/afwall,closed,README Overhaul,[],"Major README overhaul  Bug in GitHub preventing preview, so hopefully everything is formatted correctly."
ukanth/afwall,closed,Multiple enhancements,[],
ukanth/afwall,closed,Added Availability Section,[],
ukanth/afwall,closed,2.9.0 hanging at boot and not applying AFWall rules,[],"System information (software):
OmniROM 6.0.1 20161123
SuperSU 2.78 SR4
Xposed v87
AFWall+ 2.9.0 (Donate)

Problem seen on (hardware):
Nexus 5 (hammerhead)
Nexus 4X (bullhead)
Nexus 10 (manta)

Symptoms:
1. Reboot system
2. Wait a long while for the boot to fully complete
3. Launch root shell (adb/Terminal)
4. Check that the iptables rules have not been applied. (iptables -L doesn't show the afwall chains)
5. Launch the AFWall app.
6. Using the three dots menu, start ""Apply""
7. AFWall displays the popup ""Applying iptables rules""
8. AFWall stays stuck there forever (killed it after 10 minutes)

Expected behavior:
At step 4, I'd expect to see the afwall iptables rules.
At step 8, AFWall should complete the iptables set-up and allow interacting with the app again.

Additional notes:
The problem seems to happen only randomly.  Out of 7 boots, 3 of them ended up with a stuck AFWall.

Logcat:
This logcat may have missed early boot.
```
11-27 10:57:28.594 10264 16232 D AFWall  : Applying rules on connectivity change
11-27 10:57:28.627 10264 16232 D AFWall  : isWifiApEnabled is false
11-27 10:57:29.019 10264 16232 I AFWall  : Now assuming 3G connection (non-tethered)
11-27 10:57:29.020 10264 16232 I AFWall  : Using fastApply
11-27 10:57:29.268 10264 16232 I AFWall  : Setting OUTPUT chain to DROP
11-27 10:57:29.269 10264 16232 I AFWall  : Setting OUTPUT chain to ACCEPT
11-27 10:57:29.398 10264 16232 I AFWall  : Setting OUTPUT chain to DROP
11-27 10:57:29.398 10264 16232 I AFWall  : Setting OUTPUT chain to ACCEPT
11-27 10:57:29.406 10264 10264 D AFWall  : Received request to kill logservice
11-27 10:57:29.407 10264 10264 I AFWall  : [libsuperuser] [SU%] START
11-27 10:57:29.428 10264 16232 D AFWall  : Applying rules on connectivity change
11-27 10:57:29.434 10264 16232 D AFWall  : isWifiApEnabled is false
11-27 10:57:29.480 10264 10264 I AFWall  : Cleaning up previous uid: 15655
11-27 10:57:29.499 10264 10264 I AFWall  : Starting Log Service: echo PID=$$ & while true; do dmesg -c ; sleep 1 ; done for LogTarget: LOG
11-27 10:57:29.500 10264 10264 I AFWall  : rootSession is not Null
11-27 10:57:29.500 10264 10264 I AFWall  : [libsuperuser] [SU%] START
11-27 10:57:29.594 10264 16232 D AFWall  : CONNECTIVITY_CHANGE: interface state has not changed, ignoring
11-27 10:57:29.607 10264 10264 D AFWall  : Received request to kill logservice
11-27 10:57:29.614 10264 10264 I AFWall  : Starting Log Service: echo PID=$$ & while true; do dmesg -c ; sleep 1 ; done for LogTarget: LOG
11-27 10:57:29.614 10264 10264 I AFWall  : rootSession is not Null
11-27 10:57:29.615 10264 10264 I AFWall  : [libsuperuser] [SU%] START
11-27 10:57:37.485 10264 16621 D AFWall  : Applying rules on connectivity change
11-27 10:57:37.512 10264 16621 D AFWall  : isWifiApEnabled is false
11-27 10:57:37.778 10264 16621 I AFWall  : Now assuming wifi connection
11-27 10:57:37.778 10264 16621 I AFWall  : IPv4 LAN netmask on wlan0: 172.17.2.5/27
11-27 10:57:37.778 10264 16621 I AFWall  : IPv6 LAN netmask on wlan0: fe80::66bc:cff:fe51:35fb/64
11-27 10:57:37.779 10264 16621 I AFWall  : Using fastApply
11-27 10:57:37.985 10264 16621 I AFWall  : Setting OUTPUT chain to DROP
11-27 10:57:37.986 10264 16621 I AFWall  : Setting OUTPUT chain to ACCEPT
11-27 10:57:38.115 10264 16621 I AFWall  : Setting OUTPUT chain to DROP
11-27 10:57:38.116 10264 16621 I AFWall  : Setting OUTPUT chain to ACCEPT
11-27 10:57:38.124 10264 10264 D AFWall  : Received request to kill logservice
11-27 10:57:38.125 10264 10264 I AFWall  : [libsuperuser] [SU%] START
11-27 10:57:38.144 10264 16621 D AFWall  : Applying rules on connectivity change
11-27 10:57:38.150 10264 16621 D AFWall  : isWifiApEnabled is false
11-27 10:57:38.183 10264 10264 I AFWall  : Cleaning up previous uid: 16338
11-27 10:57:38.201 10264 10264 I AFWall  : Starting Log Service: echo PID=$$ & while true; do dmesg -c ; sleep 1 ; done for LogTarget: LOG
11-27 10:57:38.201 10264 10264 I AFWall  : rootSession is not Null
11-27 10:57:38.202 10264 10264 I AFWall  : [libsuperuser] [SU%] START
11-27 10:57:38.245 10264 16621 D AFWall  : CONNECTIVITY_CHANGE: interface state has not changed, ignoring
11-27 10:57:38.258 10264 10264 D AFWall  : Received request to kill logservice
11-27 10:57:38.260 10264 10264 I AFWall  : Starting Log Service: echo PID=$$ & while true; do dmesg -c ; sleep 1 ; done for LogTarget: LOG
11-27 10:57:38.260 10264 10264 I AFWall  : rootSession is not Null
11-27 10:57:38.261 10264 10264 I AFWall  : [libsuperuser] [SU%] START
```
At this point, the iptables rules are unset:
`iptables -L OUTPUT` does not show an `afwall` rule.
I then try to apply the rules through the app's Apply button:
```
11-27 11:01:50.279 10264 10264 I AFWall  : applySavedIptablesRules invoked
11-27 11:01:50.388 10264 10264 I AFWall  : Setting OUTPUT to Drop
11-27 11:01:50.390 10264 10264 I AFWall  : Setting OUTPUT to Accept
11-27 11:01:50.547 10264 10264 I AFWall  : Setting OUTPUT to Drop
11-27 11:01:50.550 10264 10264 I AFWall  : Setting OUTPUT to Accept
```
And then it's hung.
AFWall keeps emitting messages though:
```
11-27 11:03:13.915 10264 21896 D AFWall  : Applying rules on connectivity change
11-27 11:03:13.922 10264 21896 D AFWall  : isWifiApEnabled is false
11-27 11:03:13.956 10264 21896 I AFWall  : Now assuming 3G connection (non-tethered)
11-27 11:03:13.957 10264 21896 I AFWall  : Using fastApply
11-27 11:03:14.469 10264 21896 I AFWall  : Setting OUTPUT chain to DROP
11-27 11:03:14.469 10264 21896 I AFWall  : Setting OUTPUT chain to ACCEPT
11-27 11:03:14.732 10264 21896 I AFWall  : Setting OUTPUT chain to DROP
11-27 11:03:14.732 10264 21896 I AFWall  : Setting OUTPUT chain to ACCEPT
11-27 11:03:14.745 10264 10264 D AFWall  : Received request to kill logservice
11-27 11:03:14.746 10264 10264 I AFWall  : [libsuperuser] [SU%] START
11-27 11:03:14.779 10264 10264 I AFWall  : Cleaning up previous uid: 16702
11-27 11:03:14.801 10264 10264 I AFWall  : Starting Log Service: echo PID=$$ & while true; do dmesg -c ; sleep 1 ; done for LogTarget: LOG
11-27 11:03:14.802 10264 10264 I AFWall  : rootSession is not Null
11-27 11:03:14.803 10264 10264 I AFWall  : [libsuperuser] [SU%] START
11-27 11:03:16.307 10264 22086 D AFWall  : Applying rules on connectivity change
11-27 11:03:16.310 10264 22086 D AFWall  : isWifiApEnabled is false
11-27 11:03:16.339 10264 22086 I AFWall  : Now assuming 3G connection (non-tethered)
11-27 11:03:16.347 10264 22086 I AFWall  : IPv6 LAN netmask on wlan0: fe80::66bc:cff:fe51:35fb/64
11-27 11:03:16.347 10264 22086 I AFWall  : Using fastApply
11-27 11:03:17.030 10264 22086 I AFWall  : Setting OUTPUT chain to DROP
11-27 11:03:17.030 10264 22086 I AFWall  : Setting OUTPUT chain to ACCEPT
11-27 11:03:17.429 10264 22086 I AFWall  : Setting OUTPUT chain to DROP
11-27 11:03:17.429 10264 22086 I AFWall  : Setting OUTPUT chain to ACCEPT
11-27 11:03:17.457 10264 10264 D AFWall  : Received request to kill logservice
11-27 11:03:17.457 10264 10264 I AFWall  : [libsuperuser] [SU%] START
11-27 11:03:17.488 10264 10264 I AFWall  : Cleaning up previous uid: 21988
11-27 11:03:17.510 10264 10264 I AFWall  : Starting Log Service: echo PID=$$ & while true; do dmesg -c ; sleep 1 ; done for LogTarget: LOG
11-27 11:03:17.510 10264 10264 I AFWall  : rootSession is not Null
11-27 11:03:17.511 10264 10264 I AFWall  : [libsuperuser] [SU%] START
11-27 11:03:18.657 10264 22342 D AFWall  : Applying rules on connectivity change
11-27 11:03:18.661 10264 22342 D AFWall  : isWifiApEnabled is false
11-27 11:03:18.691 10264 22342 I AFWall  : Now assuming wifi connection
11-27 11:03:18.696 10264 22342 I AFWall  : IPv4 LAN netmask on wlan0: 172.17.2.5/27
11-27 11:03:18.697 10264 22342 I AFWall  : IPv6 LAN netmask on wlan0: fe80::66bc:cff:fe51:35fb/64
11-27 11:03:18.697 10264 22342 I AFWall  : Using fastApply
11-27 11:03:19.211 10264 22342 I AFWall  : Setting OUTPUT chain to DROP
11-27 11:03:19.211 10264 22342 I AFWall  : Setting OUTPUT chain to ACCEPT
11-27 11:03:19.433 10264 22342 I AFWall  : Setting OUTPUT chain to DROP
11-27 11:03:19.434 10264 22342 I AFWall  : Setting OUTPUT chain to ACCEPT
11-27 11:03:19.444 10264 22342 D AFWall  : Applying rules on connectivity change
11-27 11:03:19.448 10264 22342 D AFWall  : isWifiApEnabled is false
11-27 11:03:19.457 10264 10264 D AFWall  : Received request to kill logservice
11-27 11:03:19.458 10264 10264 I AFWall  : [libsuperuser] [SU%] START
11-27 11:03:19.492 10264 10264 I AFWall  : Cleaning up previous uid: 22200
11-27 11:03:19.505 10264 10264 I AFWall  : Starting Log Service: echo PID=$$ & while true; do dmesg -c ; sleep 1 ; done for LogTarget: LOG
11-27 11:03:19.506 10264 10264 I AFWall  : rootSession is not Null
11-27 11:03:19.506 10264 10264 I AFWall  : [libsuperuser] [SU%] START
11-27 11:03:19.523 10264 22342 D AFWall  : CONNECTIVITY_CHANGE: interface state has not changed, ignoring
11-27 11:03:19.536 10264 10264 D AFWall  : Received request to kill logservice
11-27 11:03:19.538 10264 10264 I AFWall  : Starting Log Service: echo PID=$$ & while true; do dmesg -c ; sleep 1 ; done for LogTarget: LOG
11-27 11:03:19.538 10264 10264 I AFWall  : rootSession is not Null
11-27 11:03:19.539 10264 10264 I AFWall  : [libsuperuser] [SU%] START
```
At this point, AFWall was still showing ""Applyting iptables rules"", iptables were still unset.
"
ukanth/afwall,closed,Release 2.9.0,[],
ukanth/afwall,closed,Fix Startup Leak - Grayed Out with Magisk v9 + Phh's SuperUser,"[Label(name=""Feature"")]","Hi there, 

I've used your donator version for some time now, until recently (two updates ago?) suddenly Fix Startup Leak had de-selected and became un-selectable/grayed out. 

http://forum.xda-developers.com/apps/magisk/magisk-phh-s-superuser-android-pay-t3435921 says ""su.d support (place scripts in /magisk/phh/su.d)"" 

Is it possible for you to fix this issue? I don't know if this has already been asked or addressed on builds other than the donator version. (If so, could we have the option to enable beta participation like the regular afwall?)

Thanks for this great app and your time."
ukanth/afwall,closed,Added localnet multicast-adresses to wifi-lan chain,[],224.0.0.0/24 and ffx2::/16 belong to the local net....
ukanth/afwall,open,Xposed DownloadManager leak fix blocking for all apps on wifi,"[Label(name=""Review"")]","I run afwall+ in Whitelist mode, and have the all apps option checked for wifi, however, when I turn on the Fix DownloadManager Leak Xposed integration, no apps that use the download manager can download files on wifi, even though the All Apps option should allow them to.

EDIT: Running CM13.1 Nightlies with AFwall+ v2.8.0"
ukanth/afwall,closed,"Wifi ""connected, but no internet"" issue with AFWall v2.8.0",[],"I think this might be similar as #603 or #612 still persistent in v2.8.0
When I leaf Wifi and later am connected to Wifi I get ""connected, but no internet"". And the Wifi symbol has an exclamation mark. I didn't recognize this as a AFWall problem for a long time and thought it would be CM13 Nightlys fault (and later switched to SlimRom to get the same issue). So I tested this on Samsung Glaxay S4 and S5. Both with CM13 and S4 with SlimRom.

I tried to pinpoint the problem, but it's confusing. Despite I get the message of ""no internet"" via wifi I sometimes still can surf the net. But sometimes I get no connection at all, even if I disable Wifi, then the mobile network sign also got this exclamation mark. In this case I need to disable AFWall and restart the phone."
ukanth/afwall,closed,donate candy apk,"[Label(name=""Question"")]","I have donated in the past.  I would like to donate again for some candy as apk.  I cannot use GAPPS, no market, no framework.

How can I donate for extra logging powers?

"
ukanth/afwall,closed,Constantly requesting root,"[Label(name=""Duplicate"")]","Since updating AFWall, the root icon is always present in the upper right corner (I'm using cyanogenmod). If I open AFWall and exit it, the icon temporarily disappears, but soon reappears.

In older version this behavior could be averted by disabling Active rules, but I still had to open and exit the app after booting.

I think the app should relinquish its root rights after doing what it needs them for."
ukanth/afwall,closed,Release 2.8.0,[],Merge with Stable.
ukanth/afwall,closed,Merge v2.8.0 to stable,[],To let F-Droid correctly show changelog for 2.8.0.
ukanth/afwall,closed,Essentially  just  stopped Working. ,"[Label(name=""Review"")]",Ive ran this app for sometime now and all of sudden it just stopped working all together. It blocks nothing now. I've tried the obvious enable/disable. Uninstall/reinstall. Nothing seems to work. Nexus 6P 6.0.1 HELP! 
ukanth/afwall,closed,blocks all traffic until applied,"[Label(name=""Bug"")]","I don't know if it's a bug, but afwall often blocks all traffic unless I manually reapply the iptables."
ukanth/afwall,closed,v2.7.0 not in F-droid??,"[Label(name=""Question"")]","I cannot see the latest version being in F-droid.. why is this?
can you please update the repo ?"
ukanth/afwall,closed,Updates including URLs,[],Many updates and improvements to keep current.
ukanth/afwall,closed,"Philosophical issue with ""donation features"" ","[Label(name=""General"")]","Doesn't keeping ""donation features"" closed source break the whole point of using an open-source firewall? I really want to donate, but getting a piece of closed-source code for this kinda feels wrong, 'cuz then it's not really a donation, but rather a purchase, don't you think?"
ukanth/afwall,closed,Update from BETA 2.7.0,[],
ukanth/afwall,closed,Log not working after turning it off and on again,"[Label(name=""Question"")]","Heya,

the log feature stopped working.
It worked perfectly fine, then I installed an app that was rather annoying requesting a lot of connections so I temporarily disabled the log/toasts.
After removing that app I enabled the log again, but no toast are displayed and the log shows as empty.
Other than that the firewall is working fine.
I try to uninstall and reinstall it, but that didn't help at all.
Any ideas how to fix it? What can I do to help solve this, any other logfiles I should provide?

Best regards"
ukanth/afwall,closed,No internet connection after reboot on android 7 Nougat,[],"After reboot I don't have internet access. Once I flush iptables rules, and then reapply them, internet connection works again. 

Tried both on CM14 based Tugapower and Slim7 roms on Oneplus One. Afwall 2.6.0 from Fdroid. 
"
ukanth/afwall,closed,Mask device informations?,"[Label(name=""General"")]","Hi! Given the extreme versatility of the app, I would propose to add another function (I hope it is not a idiotic thing or not relevant for the operations of the app): the ability to change (Root?) Or mask the identity device (Xposed module?) .. and, therefore, MAC Address, IMEI, Model ... in short, all the details available in the Settings + anything else useful to identify the device.

As I wrote, it might be idiotic or useless thing .. but I wanted to offer it the same because the app would become further polyvalent (and necessary!)
"
ukanth/afwall,closed,iptables replaced by nftables,"[Label(name=""General"")]","Hi,
XDA is down so I'll ask you here:
Is nftables possible/interesting for AFWall+?

Redhat post: [What comes after ‘iptables’? It’s successor, of course: `nftables`](http://developers.redhat.com/blog/2016/10/28/what-comes-after-iptables-its-successor-of-course-nftables/)

Thanks.
"
ukanth/afwall,closed,cm13 sometimes no connection after connectivity switch,"[Label(name=""Bug"")]","Sometimes the afwall hangs by applying IP-table rules and I need manually to reapply the rules.

current google play version: 2.6.0.1
"
ukanth/afwall,open,Support for Right-to-left Languages ( Persian ) ,"[Label(name=""Feature""), Label(name=""Low"")]","the problem is when your language phone is Persian
then you want use english version of app the control of ui  show right to left like Persian
not as Usual app that remain left to right 
"
ukanth/afwall,closed,afwall doesnt always apply ip table rules after phone restart - actually its gotten worse with android 6.01,"[Label(name=""Bug"")]","Using android 6.0.1
Most times after phone restarts, or switching between data and wifi, iptable rules tries to apply but doesnt complete, as my internet is stuck being offline.  Then i disable firewall and re-enable and then everything works again (very seldom), but most times i have to reboot my phone a couple of times to get it working. 
"
ukanth/afwall,closed,Toggling *Active rules* setting causes LAN control error,"[Label(name=""Bug"")]","Steps to reproduce issue:
1. Open AFWall+
2. Open Preferences->User Interface
3. Enable _Active rules_
4. Enable _LAN control_
5. Exit Preferences
6. Select _Apply_ in AFWall+ menu
7. Notice that LAN column is displayed in main table
8. Open Preferences->User Interface
9. Disable _Active rules_
10. Enable _Active rules_
11. Notice that _LAN control_ is still enabled.
12. Exit Preferences
13. Notice that LAN column is no longer displayed in main table

Tested on AFWall+ v2.5.2
"
ukanth/afwall,closed,Data leak when enabling WiFi or cell data,"[Label(name=""Review"")]","First, I must apologize that I don't have more time to contribute to testing.  Hopefully contributing this bug report will be helpful.

I noticed that data is leaking past AFWall+ each time the user enables WiFi or cell data.

For example, if all connectivity is disabled in Android, and the user then enables WiFi, apps start sending packets almost immediately.  After about 5 seconds, AFWall+ finishes writing `iptables`.  As a result, for about 5 seconds, every app has free access to transmit/receive data from the internet.  At fast modern data speeds, much data gets transmitted in that time.

Tested on Android KitKat using AFWall+ v2.5.2 (v2.6.0.1 isn't working with WiFi).  _Active rules_ and _LAN control_ are enabled.
"
ukanth/afwall,closed,Error applying firewall rules: click here to open settings.,"[Label(name=""NoInfo""), Label(name=""Review"")]","Getting this error randomly, sometimes on reboot, other times whenever I reconnect to the Internet.
I just learned about logging, so I enabled it, will update here once I find something in the log viewer.
"
ukanth/afwall,closed,"""Unable to remove AFWall+ startup script"" message always displayed when disabling startup data leak fix","[Label(name=""Bug""), Label(name=""Low"")]","The ""Unable to remove AFWall+ startup script"" message is always displayed when disabling the fix for startup data leak (i.e. removing the afwallstart script). The script itself is removed successfully though.
I believe it has to do with 
`dev.ukanth.ufirewall.preferences.ExpPreferenceFragment.deleteFiles(Context ctx)`
always returning `false` ;)
"
ukanth/afwall,open,Donations via Bitcoin,"[Label(name=""Feature"")]","Please provide a bitcoin address on your f-droid page and your github page to allow donations via bitcoin.  I am ready to donate now.
It would be great if we could also purchase the Pro version via bitcoin.  I don't have a google account, and I will not get one.  I love AFwall and I want to buy the Pro(Donate) version!
"
ukanth/afwall,closed,Notification of new installed app,"[Label(name=""Bug""), Label(name=""Low"")]","Hi,
When I select the AFWall+ notification of a new installed app, the app is not listed at the top of the list (main screen).
With the previous version of AFWall+, it was not necessary to search the new app since it was on the first line.

Could you bring it back?
Thank you.
"
ukanth/afwall,open,Bluetooth theter stoped working,"[Label(name=""Bug""), Label(name=""Low"")]","The bluetooth tether was working, but 2 weeks past the tether stopped working, I have to disable afwall+ everytime I use theter.

Rules attached.

Android 6.0
Moto x 2014
[IPv4rules.txt](https://github.com/ukanth/afwall/files/518752/IPv4rules.txt)
"
ukanth/afwall,closed,"Not able to activate afwall, tested integrated and system tools.","[Label(name=""Review"")]","Not able to activate afwall, tested integrated and system tools.

> 10-05 22:47:40.224 W/TOAST   (3367): toast owner:eu.chainfire.supersu   toast msg is :AFWall+ wurden Superuser-Rechte gewährt für eine interaktive Eingabe
> 10-05 22:47:41.834 I/AFWall  (1763): Error applying rules during preference change
> 10-05 22:49:23.024 I/AFWall  (1763): command 'ip6tables -A afwall -m state --state ESTABLISHED -j RETURN' exited with status 1
> 10-05 22:47:41.834 I/AFWall  (1763): Output:
> 10-05 22:47:41.834 I/AFWall  (1763): ip6tables: Protocol wrong type for socket.
"
ukanth/afwall,closed,Google Play blocked,"[Label(name=""General"")]","When the FW is enabled I cannot download anything from Google Play nor updating anything.
Google play - allowed
Media server - allowed
VPN - allowed 
DHCP+DNS - allowed
What else?
"
ukanth/afwall,closed,Version 2.6.0 and 2.6.0.1 not allowing WiFi,"[Label(name=""Review"")]","Upgraded from v2.5.2 to v2.6.0 (F-Droid) on a KitKat device.  WiFi and cell data working as expected with v2.5.2.  With v2.6.0, cell data works perfectly, but WiFi gets no response.

Before I spend hours trying to figure it out (already spent 1 hour!), any idea why this would happen?  No other changes made beside upgrading F-Droid to v2.6.0 and rebooting.
"
ukanth/afwall,closed,String fixes,[],"Fix errors, improve consistency.
"
ukanth/afwall,closed,Missing words added,[],
ukanth/afwall,open,"Translatable ""About"" and ""FAQ""","[Label(name=""Low""), Label(name=""Question"")]","Hello! Could you make windows ""About"" and ""FAQ"" translatable? It would be useful for those who doesn't know English. I would help with translating.
![screenshot_2016-10-03-04-29-48](https://cloud.githubusercontent.com/assets/14265316/19025687/053a4a80-8925-11e6-9990-e2930f90d716.png)
![screenshot_2016-10-03-04-28-25](https://cloud.githubusercontent.com/assets/14265316/19025688/0a881e7c-8925-11e6-9f56-48a2f95beb26.png)
"
ukanth/afwall,closed,F-Droid at 2.5.2,"[Label(name=""General"")]","I'm guessing it's a downstream issue, but thought you would like to know that F-Droid is still at version 2.5.2: https://f-droid.org/repository/browse/?fdfilter=afwall&fdid=dev.ukanth.ufirewall
"
ukanth/afwall,closed,Expose color codes from layout folders,"[Label(name=""General""), Label(name=""Low"")]","Hi,
AFAIK a light theme is not planned, not a priority but please consider removing hard-coded values from layout folders.
I can't convert AFWall+ to a light UI due to those color codes: https://parli.eu/v/lfslt
Please use color codes from values > colors.xml instead

Thanks a lot!
"
ukanth/afwall,closed,Stable Version 2.6.0,[],
ukanth/afwall,closed,FC when trying to enter log settings in donate version.,"[Label(name=""Low"")]","I finally decided to donate and now i can't enter log settings any more - which is bit of a bummer, as detailed logging is supposed to be the main selling point of the donate version. Fresh install, than imported firewall rules from free version.

Logcat:
[2016-09-24_01-02-12.log.txt](https://github.com/ukanth/afwall/files/491277/2016-09-24_01-02-12.log.txt)
"
ukanth/afwall,closed,stale processes: constantly increasing number of su processes with every connection change,"[Label(name=""Bug"")]","I notice that the number of ""su"" processes created by afwall is increasing with every connection change (enabling Wifi, disabling mobile data etc.). It starts with 5 processes at every reboot of the phone and then increases to sometimes 50 or more until I reboot again.
My system:
Hardware: Fairphone 2
Operating System: FP OpenOS 16.08 based on Android 5.1
"
ukanth/afwall,open,Wiki: System Applications to block or allow,"[Label(name=""Question"")]","> (vpn) - VPN Networking
> 
> If blocked, will not be able to use a VPN over the connection types blocked
> 
> Rec: Block if not using a VPN, otherwise enable only for connection types > being used to connect to the VPN

Not sure if it's correct since I made several dns/ip leak tests with Firefox when I'm connected to my VPN app.
The VPN is working even if the UID ""VPN"" is not checked.

My profile allows Internet access to my VPN app and Firefox (mobile data + VPN).
"
ukanth/afwall,open,Cyanogenmod: change user -> connection refused,"[Label(name=""Review"")]","Hello,

My setup: AFWall+ v2.5.2 on my Cyanogenmod 13.0.20160920-NIGHTLY.

when I switch to another user and call the browser, connection gets refused. With ""owner"" account it works (I use ""allow selected"" and selected Browser with WIFI-Connection). If I disable AFWall+ it works fine.

Any idea how to solve this?

Regards,

Af0x
"
ukanth/afwall,open,Notification not removed if app uninstalled,"[Label(name=""Feature""), Label(name=""Low"")]","AFWall+ can provide a notification when a new app is installed.  Works well.  

If the notification is not cleared, and the newly installed app is then uninstalled, the notification is not removed.  

In contrast, XPrivacy successfully removes its notification when an app is installed and then uninstalled.  Perhaps looking at that code can help improve AFWall+.
"
ukanth/afwall,open,Active rules enabled - Custom rules ignored?,"[Label(name=""Review"")]","Since AFWall+ 2.5.2 I have problems when active rules are enabled. After switchting WLAN On/Off my Custom Script rules are ignored.

Here is my Custom Script:

```
##
####################
# Tweaks           #
####################
##

## Kernel
# Disable IPv6
echo 1 > /proc/sys/net/ipv6/conf/all/disable_ipv6
echo 1 > /proc/sys/net/ipv6/conf/default/disable_ipv6
# Privacy IPv6 Address
echo 2 > /proc/sys/net/ipv6/conf/all/use_tempaddr
echo 2 > /proc/sys/net/ipv6/conf/default/use_tempaddr
## System
# Disable Captive Portal (Connect to http://clients3.google.com via UID 1000) 
settings put global captive_portal_detection_enabled 0 
settings put global captive_portal_server localhost
# Disable Global NTP Server 
settings put global ntp_server 127.0.0.1

IPTABLES=/system/bin/iptables
IP6TABLES=/system/bin/ip6tables 

####################
# Purge/Flush      #
####################

# All 'afwall' rules/chains gets flushed automatically, before the custom script is executed
# Flush/Purge all rules expect OUTPUT
$IPTABLES -F INPUT
$IPTABLES -F FORWARD
$IPTABLES -t nat -F
$IPTABLES -t mangle -F
$IP6TABLES -F INPUT
$IP6TABLES -F FORWARD
$IP6TABLES -t nat -F
$IP6TABLES -t mangle -F

# Flush/Purge all chains  
$IPTABLES -X   
$IPTABLES -t nat -X  
$IPTABLES -t mangle -X  
$IP6TABLES -X   
$IP6TABLES -t nat -X  
$IP6TABLES -t mangle -X

####################
# Defaults         #
####################

# IPv4 connections
$IPTABLES -P INPUT   DROP
$IPTABLES -P FORWARD DROP
$IPTABLES -P OUTPUT  DROP

# IPv6 connections  
$IP6TABLES -P INPUT DROP  
$IP6TABLES -P FORWARD DROP  
$IP6TABLES -P OUTPUT DROP

#####################
# Special Rules     #
#####################

# Allow loopback interface lo 
$IPTABLES -A INPUT -i lo -j ACCEPT 
$IPTABLES -A ""afwall"" -o lo -j ACCEPT

# Force a specific NTP (ntp0.fau.de), Location: University Erlangen-Nuernberg
$IPTABLES -t nat -A OUTPUT -p tcp --dport 123 -j DNAT --to-destination 131.188.3.222:123
$IPTABLES -t nat -A OUTPUT -p udp --dport 123 -j DNAT --to-destination 131.188.3.222:123

#####################
# Incoming Traffic  #
#####################

# Allow ICMP packets
$IPTABLES -A INPUT -p icmp -m icmp --icmp-type echo-reply -j ACCEPT 
$IPTABLES -A INPUT -p icmp -m icmp --icmp-type echo-request -j ACCEPT 
$IPTABLES -A INPUT -p icmp -m icmp --icmp-type destination-unreachable -j ACCEPT

# Allow all traffic from an established connection
$IPTABLES -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

####################
# Outgoing Traffic #
####################

## Block Facebook ASN
$IPTABLES -A ""afwall"" -d 31.13.24.0/21 -j REJECT
$IPTABLES -A ""afwall"" -d 31.13.64.0/18 -j REJECT
$IPTABLES -A ""afwall"" -d 45.64.40.0/22 -j REJECT
$IPTABLES -A ""afwall"" -d 66.220.144.0/20 -j REJECT
$IPTABLES -A ""afwall"" -d 69.63.176.0/20 -j REJECT
$IPTABLES -A ""afwall"" -d 69.171.224.0/19 -j REJECT
$IPTABLES -A ""afwall"" -d 74.119.76.0/22 -j REJECT
$IPTABLES -A ""afwall"" -d 103.4.96.0/22 -j REJECT
$IPTABLES -A ""afwall"" -d 157.240.0.0/17 -j REJECT
$IPTABLES -A ""afwall"" -d 173.252.64.0/18 -j REJECT
$IPTABLES -A ""afwall"" -d 179.60.192.0/22 -j REJECT
$IPTABLES -A ""afwall"" -d 185.60.216.0/22 -j REJECT
$IPTABLES -A ""afwall"" -d 204.15.20.0/22 -j REJECT
```

So what happens? Well, when active rules are enabled I can surf to www.facebook.com after switching WLAN off and on again. After manually apply firewall rules Facebook gets blocked again. When I disable active rules, everything is working - even after switchting WLAN off and on again.

Ideas? Bug?
"
ukanth/afwall,open,Block single country,"[Label(name=""Review"")]","Add an ability to block, for the entire phone or for the single app, the access to determinate countries
"
ukanth/afwall,closed,Google Translate,[],"I have a problem with Google Translate: despite having blocked access to the internet (and has enabled the Xposed Module) continues to update and access as if the firewall mon existed.  solutions??
"
ukanth/afwall,closed,Pebble notification,"[Label(name=""Review"")]","Since last update I started to get notifications about applying rules on my Pebble smartwatch - is there a way to disable this behavior?
"
ukanth/afwall,open,Change IP routes for the Wifi interface,"[Label(name=""Feature""), Label(name=""UI-Usecase"")]","Add specific IP routes on Android to route the IP traffic. In particular, add the ability to set address, netmask, gateway and metric.
"
ukanth/afwall,closed,MIUI second space applications invisible for AFWall+,"[Label(name=""Feature"")]","Hi,

as you might know MIUI 8 comes with the abillity to clone apps so that you can run two instances of them. By this you could have e.g. multiple separate whatsapp accounts. Unfortunately the AFWall+ doesn't list the cloned app. Only within the log you could see that the cloned app is blocked.

Any idea how if this will be supported in the future? 
Or any workaround thinkable? Would I be able to allow it with donate version?

Thanks 
"
ukanth/afwall,open,Proxy support,"[Label(name=""Review"")]","Add a full integration with Orbot/I2P services
"
ukanth/afwall,open,Protection from DOS/MITM,"[Label(name=""Feature""), Label(name=""UI-Usecase"")]","Add the ability to detection of and protection against all kinds of ARP (adress resolution protocol) related attacks in WiFi Networks, like DOS (denial of services) or MITM (man in the middle). And, if detect an attack, the app turn off the WiFi
"
ukanth/afwall,closed,"Fix errors, add important links, improve code consistency",[],"The new links will help direct people to the right online resources.  Also fixed several errors, improved code consistency, and improved page appearance consistency (UX).
"
ukanth/afwall,closed,Pull recent improvements,[],
ukanth/afwall,open,EU roaming will not be roaming anymore: firewall roaming rules need an update,"[Label(name=""Feature""), Label(name=""Low"")]","Next year, the EU will abolish mobile roaming charges in the EU and EU-associated countries. For phone/text/data roaming purposes, the EU will be a single country. AfWall+ needs an update to deal with this change.

The main reason for blocking data roaming with AfWall+ is to avoid international data roaming fees. When those roaming fees cease to exist, AfWall+ should no longer assume that you are roaming if you're anywhere in the EU with a EU SIM card.

To prepare for the upcoming change, AfWall+ needs an option to let mobile data pass unhindered if the SimCountryIso and NetworkCountyIso are both for EU countries, even if the codes are different. Something along the lines of:

> If SimCountryIso=NetworkCountyIso then roaming=no
> If SimCountryIso is in (list of EU country codes) and NetworkCountyIso is in (list of EU country codes) then roaming=no
> Else roaming=yes

AfWall+ already has permission to read SimCountryIso and NetworkCountyIso, so all it takes is 1) a few lines of code, 2) a list of EU country codes, and 3) an on/off switch in the settings to tell AfWall+ if it should see the EU as one country for firewalling purposes.
"
ukanth/afwall,closed,Connection allowed while screen ON / foreground,"[Label(name=""Duplicate"")]","I think it would be useful adding the ability to allow connections only when screen is turned on (or even the app in foreground) for selectable apps.
"
ukanth/afwall,open,Connections' permissions sorting & filtering,"[Label(name=""Review"")]","This app is great, but I miss a lot being able to find easily which apps are allowed (or blocked) for a certain connection (wifi, data, roaming....)

Don't you think it would be even more great if you add any (or both!) of these?
- sorting option: per type or number of connection permissions
- filtering option: show only those kind of connection types chosen (wifi, data, roaming...)
"
ukanth/afwall,closed,Improve changelog,[],"Significant clean-up work, fixed some errors, made improvements.
"
ukanth/afwall,closed,Update changelog.md,"[Label(name=""General"")]","The changelog needs an update! :-)
"
ukanth/afwall,closed,xposed modul reboots,"[Label(name=""Review"")]","Hi,

I just upgraded to 2.5.1 from afwall and activated the xposed modul.

After the first activation, the screen was black, only a hard reboot could restart the device.

Now the device is rebooting sometimes, I will keep watching 

Installed is CM13 with Xposed and Xprivacy.

Can I activate the afwall modul and use xprivacy simultaneously?

Thanks.
"
ukanth/afwall,closed,AFwall+ 2.5.x hangs during connection change when logging is enabled,"[Label(name=""Bug"")]","**Device:** Motorola X 2014 (XT1092)
**OS:** CyanogenMod 12.1-20151117 Stable, Android 5.1.1

**Problem:** Since AFwall+ 2.5 I recognized connection problems after connection changes (activating WiFi, switch from WiFi to mobile data or vice versa, etc.). The LAN and Internet was not available from the phone. I had to wait for one or two minutes or sometimes restart the phone to solve the connection issue. After some researchs I found out, that AFwall+ hangs in such situations. It shows only its green window bar without any content (rules or menue). I removed the app and reinstallt it. I didn't import the old settings, but the problem is still present. After some more researchs I found out, that this problem only occurs, when logging is active in AFwall+. When I disable it, everything works fine. When I enable it e.g. during a Wifi connection, it shows also log entrys. But as soon as I change the connection AFwall hangs.
Everything worked fine on this device until the new log in AFwall+ 2.5
Find attached the logcat file.

[AFwall_Log_Failure.txt](https://github.com/ukanth/afwall/files/415392/AFwall_Log_Failure.txt)
"
ukanth/afwall,open,Allow/Block Webview per app,"[Label(name=""Feature"")]","Since version 2.5.0:
""Webview filter(applist) - Another possible way apps can use webview to access internet. So now there is a separate system level application for webviews. Please whitelist/blocklist this app accordingly.""

Being able to block Webview is a nice improvement but it breaks a lot of apps. For example, I can no longer download a [png file](https://upload.wikimedia.org/wikipedia/commons/thumb/6/66/Android_robot.png/504px-Android_robot.png) with my web brower (Atlas which is based off Webview).

Feature request: allow Webview for apps that already have Internet access and block Webview for apps that have no Internet access to avoid data leaks.

Thank you.
"
ukanth/afwall,closed,App hangs in retrieving log data,"[Label(name=""Bug"")]","When you select view log from menu app hangs and becomes unresponsive:
![Image of Yaktocat](https://s10.postimg.org/kqvbz0dk9/Screenshot_20160810_225808.png)

[ http://hastebin.com/ofoqexidel.vbs ]
"
ukanth/afwall,open,"Profiles need some love: Better management, fix sort.","[Label(name=""Feature"")]","They are an awesome, but under-used/under-rated feature.
This request is basically to make profiles into that awesome feature they could be.

What would be awesome:
- Enable them by default.
- Add a way to copy the ""current profile"" (=Applied ruleset) to a new one.
- Add a way to remove all profiles (But Default). (Currently one can create more new empty profiles, but one cannot delete the first 3 profiles)
- Fix sort of apps in non-Default profile. (Currently the Default profile will sort enabled items above all others while all other profiles wont move enabled items out of their ""category"")
"
ukanth/afwall,closed,"Bring back ""old"" Firewall log.","[Label(name=""Low"")]","Its more relevant to see what ip,port,proto was denied than the apps icon.

Dont dumb down the app. People that want dumbed down, fancy apps will most likely go with other ""great"" firewall apps anyway.
"
ukanth/afwall,closed,lockscreen on non android rom,"[Label(name=""Review""), Label(name=""Wont-Fix"")]","referring to: 
https://github.com/ukanth/afwall/commit/782078327258a2922069b4f90f512f90c34fd124

what about **CM roms** they have such thing like:
- device policy override 

![https- 2f 2fpicload org 2fimage 2fwpoglrl 2fdeleteme](https://cloud.githubusercontent.com/assets/10565704/17501430/1f3671b6-5dce-11e6-98a9-53dec8d9a478.jpg)

btw android has such thing like **trust agents** :) for things you want to achieve 
- one of them is a trust profile provider 

deep dive into lockscreen :)
"
ukanth/afwall,closed,Version of afwall is older in F-Droid than the one in Google Play,"[Label(name=""Question"")]","As the title says, the F-Droid version is older than the one in Google Play. Why is this? 
"
ukanth/afwall,closed,pattern unlock problem,"[Label(name=""Review"")]","when go to afwall use pattern then i get:
then need go second time and its fine when i use pattern 

![screenshot_20160805-175201](https://cloud.githubusercontent.com/assets/10565704/17453891/efdbbe0e-5b74-11e6-823f-b41a54effa78.png)

could be related to log entry 

```
5529-5529/dev.ukanth.ufirewall I/ListPopupWindow: Could not find method setEpicenterBounds(Rect) on PopupWindow. Oh well.
5529-5529/dev.ukanth.ufirewall W/art: Before Android 4.1, method int android.support.v7.widget.ListViewCompat.lookForSelectablePosition(int, boolean) would have incorrectly overridden the package-private method in android.widget.ListView

```

  or    <<<<<<<<

```
25776-25788/dev.ukanth.ufirewall W/MessageQueue: Handler (android.os.Handler) {23d9b8e} sending message to a Handler on a dead thread
                                                 java.lang.IllegalStateException: Handler (android.os.Handler) {23d9b8e} sending message to a Handler on a dead thread
                                                     at android.os.MessageQueue.enqueueMessage(MessageQueue.java:543)
                                                     at android.os.Handler.enqueueMessage(Handler.java:631)
                                                     at android.os.Handler.sendMessageAtTime(Handler.java:600)
                                                     at android.os.Handler.sendMessageDelayed(Handler.java:570)
                                                     at android.os.Handler.post(Handler.java:326)
                                                     at android.widget.Toast$TN.hide(Toast.java:393)
                                                     at android.app.ITransientNotification$Stub.onTransact(ITransientNotification.java:55)
                                                     at android.os.Binder.execTransact(Binder.java:453)
```
"
ukanth/afwall,closed, A/libc: Fatal signal 13 (SIGPIPE),"[Label(name=""Bug"")]","#551 reopening as i got this when i close afwall window

```
6807-6807/dev.ukanth.ufirewall I/art: System.exit called, status: 0
6807-6807/dev.ukanth.ufirewall I/AndroidRuntime: VM exiting with result code 0, cleanup skipped.
763-1003/? D/GraphicsStats: Buffer count: 7
763-1003/? I/WindowState: WIN DEATH: Window{7e6602 u0 dev.ukanth.ufirewall/dev.ukanth.ufirewall.MainActivity}
763-778/? I/libprocessgroup: Killing pid 6840 in uid 10068 as part of process group 6807
763-778/? I/libprocessgroup: Killing pid 7566 in uid 10068 as part of process group 6807
763-778/? I/ActivityManager: Process dev.ukanth.ufirewall (pid 6807) has died
763-778/? W/ActivityManager: Scheduling restart of crashed service dev.ukanth.ufirewall/.service.RootShell in 1000ms
763-778/? W/ActivityManager: Scheduling restart of crashed service dev.ukanth.ufirewall/.log.LogService in 11000ms
763-1003/? W/InputMethodManagerService: Got RemoteException sending setActive(false) notification to pid 6807 uid 10068
10060-10060/? A/libc: Fatal signal 13 (SIGPIPE), code 0 in tid 10060 (dmesg)
333-333/? I/DEBUG: property debug.db.uid not set; NOT waiting for gdb.
333-333/? I/DEBUG: HINT: adb shell setprop debug.db.uid 100000
333-333/? I/DEBUG: HINT: adb forward tcp:5039 tcp:5039
333-333/? A/DEBUG: *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
333-333/? A/DEBUG: CM Version: '13.0-20160803-UNOFFICIAL-temasek-hlte'
333-333/? A/DEBUG: Build fingerprint: 'samsung/hltexx/hlte:5.0/LRX21V/N9005XXUGBOK6:user/release-keys'
333-333/? A/DEBUG: Revision: '0'
333-333/? A/DEBUG: ABI: 'arm'
333-333/? A/DEBUG: pid: 10060, tid: 10060, name: dmesg  >>> dmesg <<<
333-333/? A/DEBUG: signal 13 (SIGPIPE), code 0 (SI_USER), fault addr --------
333-333/? A/DEBUG:     r0 ffffffe0  r1 b6c40000  r2 00000283  r3 b6c4023f
333-333/? A/DEBUG:     r4 00000283  r5 b6c40000  r6 00000001  r7 00000004
333-333/? A/DEBUG:     r8 b6f98568  r9 00000000  sl 00000000  fp be8a1a3c
333-333/? A/DEBUG:     ip 00000000  sp be8a1988  lr b6f41ca9  pc b6e7de0c  cpsr 20060010
763-971/? W/NativeCrashListener: Couldn't find ProcessRecord for pid 10060
333-333/? A/DEBUG: backtrace:
333-333/? E/DEBUG: AM write failed: Broken pipe
333-333/? A/DEBUG:     #00 pc 00041e0c  /system/lib/libc.so (write+12)
333-333/? A/DEBUG:     #01 pc 00007ca5  /system/bin/toybox
333-333/? A/DEBUG:     #02 pc 00009a5d  /system/bin/toybox
333-333/? A/DEBUG:     #03 pc 0000a851  /system/bin/toybox
333-333/? A/DEBUG:     #04 pc 0000711d  /system/bin/toybox
333-333/? A/DEBUG:     #05 pc 00006d01  /system/bin/toybox
333-333/? A/DEBUG:     #06 pc 00007167  /system/bin/toybox
333-333/? A/DEBUG:     #07 pc 000173bd  /system/lib/libc.so (__libc_init+44)
333-333/? A/DEBUG:     #08 pc 00006c10  /system/bin/toybox
333-333/? A/DEBUG: Tombstone written to: /data/tombstones/tombstone_08
763-797/? I/BootReceiver: Copying /data/tombstones/tombstone_08 to DropBox (SYSTEM_TOMBSTONE)
763-899/? I/TemperatureHumiditySensor: Accuracy has been changed to 3
763-791/? I/ActivityManager: Start proc 10061:dev.ukanth.ufirewall/u0a68 for service dev.ukanth.ufirewall/.service.RootShell
10061-10061/? I/art: Late-enabling -Xcheck:jni
10061-10061/dev.ukanth.ufirewall W/System: ClassLoader referenced unknown path: /data/app/dev.ukanth.ufirewall-1/lib/arm
10061-10061/dev.ukanth.ufirewall I/AFWall: Starting Log Service: while true; do dmesg -c ; sleep 1 ; done for LogTarget: LOG
10061-10061/dev.ukanth.ufirewall I/AFWall: rootSession is not Null
10061-10061/dev.ukanth.ufirewall D/AFWall: logservice shell started
10102-10102/? D/AndroidRuntime: >>>>>> START com.android.internal.os.RuntimeInit uid 0 <<<<<<
10102-10102/? D/AndroidRuntime: CheckJNI is OFF
16661-16661/? D/ICU: No timezone override file found: /data/misc/zoneinfo/current/icu/icu_tzdata.dat
16661-16661/? I/Radio-JNI: register_android_hardware_Radio DONE
16661-16661/? D/AndroidRuntime: Calling main entry com.android.commands.am.Am
16661-16661/? D/AndroidRuntime: Shutting down VM
```
"
ukanth/afwall,closed,E/BandwidthController runIptablesCmd &  E/NetworkPolicy  throwing exc  ,"[Label(name=""NoInfo"")]","```
327-885/? E/BandwidthController: Updating quota globalAlert failed (No such file or directory)
327-885/? I/ip6tables: ip6tables: Index of insertion too big.
327-885/? I/ip6tables: ip6tables terminated by exit(1)
327-885/? E/BandwidthController: runIptablesCmd(): res=1 status=256 failed /system/bin/ip6tables -w -I bw_FORWARD 2 -i rmnet0 --jump bw_costly_rmnet0
763-904/? E/QCOM PowerHAL: Failed to acquire lock.
327-885/? E/BandwidthController: Failed set quota rule
327-885/? E/BandwidthController: No such iface rmnet0 to delete
763-912/? E/NetworkPolicy: problem setting interface quota
                           java.lang.IllegalStateException: command '67 bandwidth setiquota rmnet0 9223372036854775807' failed with '400 67 Bandwidth command failed'
                               at com.android.server.NetworkManagementService.setInterfaceQuota(NetworkManagementService.java:1707)
                               at com.android.server.net.NetworkPolicyManagerService.setInterfaceQuota(NetworkPolicyManagerService.java:2556)
                               at com.android.server.net.NetworkPolicyManagerService.updateNetworkRulesLocked(NetworkPolicyManagerService.java:1314)
                               at com.android.server.net.NetworkPolicyManagerService$14.onReceive(NetworkPolicyManagerService.java:1138)
                               at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:882)
                               at android.os.Handler.handleCallback(Handler.java:739)
                               at android.os.Handler.dispatchMessage(Handler.java:95)
                               at android.os.Looper.loop(Looper.java:148)
                               at android.os.HandlerThread.run(HandlerThread.java:61)
                            Caused by: com.android.server.NativeDaemonConnector$NativeDaemonFailureException: command '67 bandwidth setiquota rmnet0 9223372036854775807' failed with '400 67 Bandwidth command failed'
                               at com.android.server.NativeDaemonConnector.executeForList(NativeDaemonConnector.java:444)
                               at com.android.server.NativeDaemonConnector.execute(NativeDaemonConnector.java:345)
                               at com.android.server.NativeDaemonConnector.execute(NativeDaemonConnector.java:340)
                               at com.android.server.NetworkManagementService.setInterfaceQuota(NetworkManagementService.java:1704)
                               at com.android.server.net.NetworkPolicyManagerService.setInterfaceQuota(NetworkPolicyManagerService.java:2556) 
                               at com.android.server.net.NetworkPolicyManagerService.updateNetworkRulesLocked(NetworkPolicyManagerService.java:1314) 
                               at com.android.server.net.NetworkPolicyManagerService$14.onReceive(NetworkPolicyManagerService.java:1138) 
                               at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:882) 
                               at android.os.Handler.handleCallback(Handler.java:739) 
                               at android.os.Handler.dispatchMessage(Handler.java:95) 
                               at android.os.Looper.loop(Looper.java:148) 
                               at android.os.HandlerThread.run(HandlerThread.java:61) 
```
"
ukanth/afwall,closed,afwall leaks traffic when switching between interfaces,"[Label(name=""Question"")]","Hi,
As I did not find a clean way to root my device I installed KingRoot.
I am aware KingRoot is doing some bad stuff, and it is a temporary solution for me.
To prevent it from leaking my personal data I installed afwall and wrote the following custom script:

```
#!/bin/bash

IP6TABLES=/system/bin/ip6tables
IPTABLES=/system/bin/iptables

KRUID=10079

${IPTABLES} -A OUTPUT -m owner --uid-owner ${KRUID} -j DROP
${IP6TABLES} -A OUTPUT -m owner --uid-owner ${KRUID} -j DROP
```

KingRoot traffic is blocked except in the following cases:
- just after booting and entering the PIN code - I know this is an Android issue, and a work around is to enable air plane mode and unlock the phone before entering the PIN code
- when switching between network interfaces - this looks like an afwall issue to me
"
ukanth/afwall,closed,"On FP2 Open OS, klogripper crashes consistently",[],"Hi,
just for your information (don't know whether this may be the ROM's fault):

```
--------- beginning of crash
F/libc    ( 5434): Fatal signal 13 (SIGPIPE), code 0 in tid 5434 (klogripper)
I/DEBUG   ( 1962): *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
I/DEBUG   ( 1962): Build fingerprint: 'Fairphone/FP2/FP2:5.1/FP2/fp2-sibon-16.06.0:userdebug/release-keys'
I/DEBUG   ( 1962): Revision: '0'
I/DEBUG   ( 1962): ABI: 'arm'
I/DEBUG   ( 1962): pid: 5434, tid: 5434, name: klogripper  >>> /data/data/dev.ukanth.ufirewall/app_bin/klogripper <<<
I/DEBUG   ( 1962): signal 13 (SIGPIPE), code 0 (SI_USER), fault addr --------
I/DEBUG   ( 1962):     r0 ffffffe0  r1 b6490000  r2 00001000  r3 44000000
I/DEBUG   ( 1962):     r4 b6edb460  r5 b6490000  r6 00001000  r7 00000004
I/DEBUG   ( 1962):     r8 be91734c  r9 00000888  sl 00000061  fp b646f000
I/DEBUG   ( 1962):     ip be9173a8  sp be917248  lr b6ea2fd1  pc b6eab048  cpsr 000e0010
I/DEBUG   ( 1962): 
I/DEBUG   ( 1962): backtrace:
I/DEBUG   ( 1962):     #00 pc 00038048  /system/lib/libc.so (write+12)
I/DEBUG   ( 1962):     #01 pc 0002ffcf  /system/lib/libc.so (__sflush+50)
I/DEBUG   ( 1962):     #02 pc 00030b17  /system/lib/libc.so (__sfvwrite+328)
I/DEBUG   ( 1962):     #03 pc 00031c49  /system/lib/libc.so (__sprint+12)
I/DEBUG   ( 1962):     #04 pc 000331a7  /system/lib/libc.so (__vfprintf+5454)
I/DEBUG   ( 1962):     #05 pc 0003326f  /system/lib/libc.so (vfprintf+18)
I/DEBUG   ( 1962):     #06 pc 00031215  /system/lib/libc.so (printf+24)
I/DEBUG   ( 1962):     #07 pc 00000f87  /data/data/dev.ukanth.ufirewall/app_bin/klogripper
```
"
ukanth/afwall,closed,logs flooding by  A/libc: Fatal signal 13 (SIGPIPE) on temasek cm13.1 build ,[],"my logs are flooding by exception 

```
 A/libc: Fatal signal 13 (SIGPIPE)
```

pleas see for full logs 
https://github.com/temasek/Changelogs/issues/10#issuecomment-233733126
"
ukanth/afwall,open,[Feature Request] Internet allow timer,"[Label(name=""Feature""), Label(name=""Low"")]","Pleasse add the possibillity to add an option which allow some apps to give them Internet for a specific time.
"
ukanth/afwall,closed, Display toast blog notifications at top of sreen instead of bottom,"[Label(name=""Feature""), Label(name=""Low"")]","Toast bloc notifications are displayed at bottom of screen witch is very disturbing in case you write an SMS because Toast notifications are displayed over the keyboard.

I think it would be more appropriate to display them at top of screen witch is less used.

Thanks 

Best...
"
ukanth/afwall,closed,"Possible knockoff on Play Store ""ADFirewall""",[],"I wasn't sure if this qualifies as an issue, but there appears to be a direct knockoff named ""ADFirewall"" on the Google Play store.

https://play.google.com/store/apps/details?id=dev.duyhoang.androidfirewall&hl=en

I'm not sure what the full story is, why it exists, or if it is safe to try, but thought it should be brought up.
"
ukanth/afwall,closed,Afwall no longer compiles. Errors downloading dependencies,"[Label(name=""General""), Label(name=""Question"")]","It appears some http addresses should be corrected.

Logcat:

FAILURE: Build failed with an exception.
- What went wrong:
  A problem occurred configuring project ':aFWall'.
  > Could not resolve all dependencies for configuration ':aFWall:_debugCompile'.
  > Could not resolve org.bitbucket.ukanth:android-lockpattern:7.0.0.
   Required by:
       afwall:aFWall:unspecified
    > Could not resolve org.bitbucket.ukanth:android-lockpattern:7.0.0.
       > Could not get resource 'https://jitpack.io/org/bitbucket/ukanth/android-lockpattern/7.0.0/android-lockpattern-7.0.0.pom'.
          > Could not GET 'https://jitpack.io/org/bitbucket/ukanth/android-lockpattern/7.0.0/android-lockpattern-7.0.0.pom'.
             > peer not authenticated
  > Could not resolve com.afollestad.material-dialogs:core:0.8.5.8.
   Required by:
       afwall:aFWall:unspecified
    > Could not resolve com.afollestad.material-dialogs:core:0.8.5.8.
       > Could not get resource 'https://jitpack.io/com/afollestad/material-dialogs/core/0.8.5.8/core-0.8.5.8.pom'.
          > Could not GET 'https://jitpack.io/com/afollestad/material-dialogs/core/0.8.5.8/core-0.8.5.8.pom'.
             > peer not authenticated
  > Could not resolve com.afollestad.material-dialogs:commons:0.8.5.8.
   Required by:
       afwall:aFWall:unspecified
    > Could not resolve com.afollestad.material-dialogs:commons:0.8.5.8.
       > Could not get resource 'https://jitpack.io/com/afollestad/material-dialogs/commons/0.8.5.8/commons-0.8.5.8.pom'.
          > Could not GET 'https://jitpack.io/com/afollestad/material-dialogs/commons/0.8.5.8/commons-0.8.5.8.pom'.
             > peer not authenticated
  > Could not resolve com.github.Raizlabs.DBFlow:dbflow-core:3.0.1.
   Required by:
       afwall:aFWall:unspecified
    > Could not resolve com.github.Raizlabs.DBFlow:dbflow-core:3.0.1.
       > Could not get resource 'https://jitpack.io/com/github/Raizlabs/DBFlow/dbflow-core/3.0.1/dbflow-core-3.0.1.pom'.
          > Could not GET 'https://jitpack.io/com/github/Raizlabs/DBFlow/dbflow-core/3.0.1/dbflow-core-3.0.1.pom'.
             > peer not authenticated
  > Could not resolve com.github.Raizlabs.DBFlow:dbflow:3.0.1.
   Required by:
       afwall:aFWall:unspecified
    > Could not resolve com.github.Raizlabs.DBFlow:dbflow:3.0.1.
       > Could not get resource 'https://jitpack.io/com/github/Raizlabs/DBFlow/dbflow/3.0.1/dbflow-3.0.1.pom'.
          > Could not GET 'https://jitpack.io/com/github/Raizlabs/DBFlow/dbflow/3.0.1/dbflow-3.0.1.pom'.
             > peer not authenticated
"
ukanth/afwall,open,Game requires allowing 0:(root) in order to log in.,"[Label(name=""DNS""), Label(name=""Low"")]","UID 10215:Champions (Marvel Contest of Champions)
On wifi it works ok but on 3g it doesn't connect unless:
a) firewall is disabled
b) 0:(root) is given internet permission.
Tried to use custom rules but seems it doesn't work?
I have a Galaxy S5 (SM-G900T) with 6.0.1 Android besides root it's stock and no anti-virus.

```
Error Log:
AppID : -1
Application's Name: (Kernel) - Linux kernel
Total Packets Blocked:  48
[TCP]2a03:2880:f011:0001:face:b00c:0000:0001:443(13)
[TCP]2a03:2880:f011:001e:face:b00c:0000:25de:443(34)
[TCP]2a03:2880:f000:0001:face:b00c:0000:0001:443(1)

    ---------
AppID : 0
Application's Name: (root) - Applications running as root
Total Packets Blocked:  25
[TCP]2607:7700:0000:0017:0000:0000:3416:97be:443(2)
[TCP]2607:7700:0000:0017:0000:0000:1f0d:4124:443(2)
[TCP]2607:7700:0000:0017:0000:0000:36e6:5369:443(21)
```
"
ukanth/afwall,open,DNS wont resolv on bluetooth thetering [ FIX SUGGESTION ],"[Label(name=""DNS""), Label(name=""Low"")]","When i connect my laptop to my android phone using bluetooth thetering, my laptop is unable to surf because the DNS server ( 192.168.44.1 ) is refusing connections.

After a little debugging, i found that the rule

36  2575 RETURN     udp  --  \*      \*       0.0.0.0/0            0.0.0.0/0            udp dpt:53 owner UID match 0
was not matching when using bt theter.

So i started to dig and noticed that the userid when bt-thetering is NOBODY.

IN= OUT=rmnet0 SRC=179.196.177.78 DST=8.8.8.8 LEN=60 TOS=0x00 PREC=0x00 TTL=64 ID=0 DF PROTO=UDP SPT=34334 DPT=53 LEN=40 **UID=9999** GID=9999 MARK=0xf0065

Could you please add the rule to match udp 53 for **nobody** when the user allows (thetering) DHCP+ DNS services.

Thanks!

Thanks!
"
ukanth/afwall,open,Custom script rules appear twice after reboot,"[Label(name=""Bug"")]","According to custom scripts 'tutorial':
afwall-3g - This chain will only receive OUTPUT packets for the cellular network interface (no matter >if it is 2G, 3G, 4G, etc).
Please note that all those chains are **guaranteed** to be cleared before the custom script is executed, so you don't need to worry about rules cleanup on your script IF you are using those chains.

Well, i have a very simple rule added as a custom script 

$IPTABLES -I afwall-3g  -p udp --dport 53 -j ACCEPT ( needed to dns resolv work with bt thetering)

If i disable the firewall, and reenable it , i will see (correctly this):

Chain afwall-3g (21 references)
 pkts bytes target     prot opt in     out     source               destination  
  270 18181 ACCEPT     udp  --  \*      \*       0.0.0.0/0            8.8.8.8              udp dpt:53
30296 2481K afwall-3g-postcustom  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0           

After rebooting , i am seeing this:
Chain afwall-3g (21 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 ACCEPT     udp  --  \*      \*       0.0.0.0/0            8.8.8.8              udp dpt:53
    0     0 ACCEPT     udp  --  \*      \*       0.0.0.0/0            8.8.8.8              udp dpt:53
   37  4625 afwall-3g-postcustom  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0           

I supposed the afwall script is being called without flushing in somepoint after reboot.
"
ukanth/afwall,closed,klogripper broken pipe ,"[Label(name=""Bug""), Label(name=""Wont-Fix"")]","```
A/libc: Fatal signal 13 (SIGPIPE), code 0 in tid 4257 (klogripper)
06-24 11:30:26.622 A/DEBUG: *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
06-24 11:30:26.622 A/DEBUG: CM Version: '13.0-20160621-UNOFFICIAL-temasek-hlte'
06-24 11:30:26.622 A/DEBUG: Build fingerprint: 'samsung/hltexx/hlte:5.0/LRX21V/N9005XXUGBOK6:user/release-keys'
06-24 11:30:26.622 A/DEBUG: Revision: '0'
06-24 11:30:26.622 A/DEBUG: ABI: 'arm'
06-24 11:30:26.622 A/DEBUG: pid: 4257, tid: 4257, name: klogripper  >>> /data/user/0/dev.ukanth.ufirewall/app_bin/klogripper <<<
06-24 11:30:26.622 A/DEBUG: signal 13 (SIGPIPE), code 0 (SI_USER), fault addr --------
06-24 11:30:26.625 A/DEBUG:     r0 ffffffe0  r1 b6d0b000  r2 00001000  r3 b6e9ac81
06-24 11:30:26.625 E/DEBUG: AM write failed: Broken pipe
06-24 11:30:26.625 A/DEBUG:     r4 00001000  r5 b6d0b000  r6 b6ed63d0  r7 00000004
06-24 11:30:26.625 A/DEBUG:     r8 bec4641c  r9 b6ed63d0  sl 000002d0  fp 00000001
06-24 11:30:26.625 A/DEBUG:     ip 000002c5  sp bec46288  lr b6e9acc1  pc b6e93b94  cpsr 40070010
06-24 11:30:26.639 A/DEBUG: backtrace:
06-24 11:30:26.639 A/DEBUG:     #00 pc 00048b94  /system/lib/libc.so (write+12)
06-24 11:30:26.639 A/DEBUG:     #01 pc 0004fcbd  /system/lib/libc.so (__swrite+60)
06-24 11:30:26.639 A/DEBUG:     #02 pc 0003bbb1  /system/lib/libc.so (__sflush+52)
06-24 11:30:26.639 A/DEBUG:     #03 pc 0003cc3b  /system/lib/libc.so (__sfvwrite+322)
06-24 11:30:26.639 A/DEBUG:     #04 pc 0003fc53  /system/lib/libc.so (__vfprintf+6214)
06-24 11:30:26.639 A/DEBUG:     #05 pc 0003e3f5  /system/lib/libc.so (vfprintf+28)
06-24 11:30:26.640 A/DEBUG:     #06 pc 0003d855  /system/lib/libc.so (printf+32)
06-24 11:30:26.640 A/DEBUG:     #07 pc 00000f87  /data/data/dev.ukanth.ufirewall/app_bin/klogripper (main+170)
06-24 11:30:26.640 A/DEBUG:     #08 pc 00016315  /system/lib/libc.so (__libc_init+52)
06-24 11:30:26.640 A/DEBUG:     #09 pc 0000101c  /data/data/dev.ukanth.ufirewall/app_bin/klogripper
06-24 11:30:26.663 A/DEBUG: Tombstone written to: /data/tombstones/tombstone_03

```
"
ukanth/afwall,closed,Status notification is not updated when changing profile from Tasker/etc,"[Label(name=""Bug""), Label(name=""Low"")]","I am using Tasker-like app to change profiles depending on WiFi network I am connencted to.
There is a status notification with the text like ""Firewall is runnign (ProfileName)"" and it shows an old profile name but not the new one applied by taskes-plugin. Only by calling the AFWall+ app, I can see/check that the new profile was actually applied.
"
ukanth/afwall,closed,"Fix error, add missing reference to string",[],"There was an extra end-square-bracket in the code.  Removed it.

A reference to the summary string for UI element was missing.  Added it.
"
ukanth/afwall,closed,Status of the code,"[Label(name=""General""), Label(name=""Question"")]","I noticed that the README states:

> The original codebase was derived from DroidWall by Rodrigo Rosauro. DroidWall was sold to AVAST in December 2011, and is no longer actively maintained.

It also states:

> AFWall+ is under the GNU General Public License v3.0.

What is status of this code?  If DroidWall was sold to AVAST, is this project still covered by the GNU Public License v3.0?  How does that work?
"
ukanth/afwall,open,UX/UI: Enabling and Disabling the Firewall,"[Label(name=""Question"")]","For a majority of users, AFWall+ will be enabled most, if not all, of the time.  For this use case, `Disable firewall` is currently the **first** menu item.  This is not good, as it is the most dangerous menu item.  It is also directly above `Apply`, which is probably the most commonly used menu item.

Initially, I thought of making edits to  `afwall/aFWall/src/main/res/menu/menu_bar.xml` in order to simply move `Disable firewall` near the bottom of the menu.  But when the firewall is disabled, that menu item turns into `Enable firewall`, which, in that situation, is now the most important menu item.

So what to do?

Here are my UX/UI recommendations:

First, how about we remove the `Apply` menu item, and make it an icon on the main title bar?  Doing so makes this common action more accessible, as the user will no longer have to open the menu or completely back out of AFWall+ to apply changes.

Second, how about we remove the `Enable firewall` menu item altogether.  If the firewall isn't enabled, we should make this **_absolutely clear**_.  So, in this case, instead of the `Enable firewall` menu item, how about we add a large green button just below the title bar that allows the user to enable the firewall?  This makes it more clear that the firewall is disabled while simultaneously making it obvious how to enable it.

So how does the user disable the firewall now?  Simple: We move the existing `Disable firewall` menu item directly above the `Help` menu item.
"
ukanth/afwall,closed,README improvements,[],"README cleanup and minor error fixes.
"
ukanth/afwall,closed,Many improvements to in-app FAQ,[],"- Remove [possibly racist terms](http://garysaid.com/are-the-terms-whitelist-and-blacklist-racist/), simplify language, enhance clarity, improve consistency, and fix errors.
- Improve the FAQ so it actually includes questions!
- Convert from the great Chef's Germanglish to English ;-)
"
ukanth/afwall,closed,Many updates to UI strings,[],"Remove [possibly racist terms](http://garysaid.com/are-the-terms-whitelist-and-blacklist-racist/), simplify language, enhance clarity, improve consistency, and fix errors.
"
ukanth/afwall,closed,Multi user hell ;(,"[Label(name=""Feature"")]","Hi

I created a second user on my tablet (CM12) now none of my users have internet access on the same tablet.

What is the procedure to make sure the connections are firewalled and the net access is enabled for selected apps?

Am I supposed to install afwall on bot users?I did that and did not do anything. 

I cant find info on the wiki.

thanks
"
ukanth/afwall,open,Add an addon.d for the init.d startup data leak in order for it to survive system updates,"[Label(name=""Feature""), Label(name=""Low"")]","This could kind of fix #522.
"
ukanth/afwall,closed,Applying rules require a reboot,"[Label(name=""Bug""), Label(name=""Low"")]","Issue occurs on Z3Compact running on rooted stock 5.1.1, AFWall+ 2.2.3 with default configuration.

So, I made myself a nice whitelist which I wanted to start using. Enabled the firewall, but the whitelisted app are not able to get internet connection. After disabling the firewall still no internet connection - reboot helped.

After some digging it looks I have to reboot the phone after:
- enabling the firewall
- disabling the firewal
- modyfing the rules

If I dont reboot the phone all of my apps are unable to maintain internet connection - what can I do to fix this issue?

Thanks.
"
ukanth/afwall,open,DNS should be allowed through TCP too,"[Label(name=""DNS""), Label(name=""Low"")]","Hi,

In some cases, my DNS requests were blocked. After digging, I noticed that you put some custom rules for DNS using UID 0 (understood, it’s for netd that run as root), but only for UDP traffic :
https://github.com/ukanth/afwall/blob/58a6711b09e616af183eb313832a26f395ac738f/aFWall/src/main/java/dev/ukanth/ufirewall/Api.java#L435

But sometimes, when DNS packets are too big for UDP, which is usually limited to 512 bytes for DNS (for example, it’s often the case with DNSSEC), the DNS requests are sent using TCP => blocked.

The current workaround is to add a custom rule to allow TCP 53 for UID 0.
It would be nice to add the DNS rule exception for TCP too, just like you did with UPD.
"
ukanth/afwall,closed,Why is init.d needed to prevent startup data leak?,"[Label(name=""Question"")]","AFWall+ includes an option, _Fix Startup Data Leak_, to ""prevent data leaks during system startup"".

Why is this needed?  Is the existing _iptables_ (from the previous session) not used during startup?
"
ukanth/afwall,open,Important Feature which can be added to the next update,"[Label(name=""Feature""), Label(name=""Low"")]","Sir,

AFWall+ is one of the greatest apps I have come through and I appreciate your efforts. My only concern is that whenever a new application is installed it asks me whether to give wifi/data access to the app.  If you could provide the feature where I can set that the newly installed app by default gets WiFi access but not data access or vice versa or gets access to both in the whitelist mode, I will be very grateful. This is one of the most important feature and I hope that you will provide this feature to set the default access for the newly installed app in your next update.

Thanks 
"
ukanth/afwall,closed,VPN can't connect,[],"Hi. 
VPN troubles in Lenovo P70, stock KitKat, rooted. Can't connect to my PPTP VPN when I setup any Afwall rule for any app.

For example: if I deny only calculator in wifi, then VPN does not connect in wifi. If I allow all in wifi, and deny something in 3G: than VPN connect by wifi, but don't connect by 3G.

After unsuccessful VPN connect I can see only this message in Afwall log. Linux Kernel and everything else (expect calculator) are allowed in firewall.
AppID : -1
Application's Name: (Kernel) - Linux kernel
Total Packets Blocked: 21
[47]xxx.xxx.xxx.xxx:null(21)

It seems that problem in [47] - GRE protocol blocked by Afwall. Droidwall don't work too. 
# iptables:
# IPv4 Rules

```
Chain INPUT (policy ACCEPT 58 packets, 3858 bytes)
 pkts bytes target     prot opt in     out     source               destination         
Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
Chain OUTPUT (policy ACCEPT 49 packets, 3693 bytes)
 pkts bytes target     prot opt in     out     source               destination         
   70  4757 afwall     all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 afwall-wifi  all  --  *      eth+    0.0.0.0/0            0.0.0.0/0           
   45  2905 afwall-wifi  all  --  *      wlan+   0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-wifi  all  --  *      tiwlan+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-wifi  all  --  *      ra+     0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-wifi  all  --  *      bnep+   0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      rmnet+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      pdp+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      uwbr+   0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      wimax+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      vsnet+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      rmnet_sdio+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      ccmni+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      qmi+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      svnet0+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      ccemni+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      wwan+   0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      cdma_rmnet+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      usb+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      rmnet_usb+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      clat4+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      cc2mni+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      bond1+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      rmnet_smux+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      ccinet+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      v4-rmnet+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      seth_w+  0.0.0.0/0            0.0.0.0/0           
Chain afwall-3g (21 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 afwall-3g-postcustom  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-3g-fork (2 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 afwall-3g-home  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-3g-home (1 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-3g-postcustom (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 afwall-3g-fork  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-3g-roam (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-3g-tether (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 afwall-3g-fork  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-reject (1 references)
 pkts bytes target     prot opt in     out     source               destination         
   21  1064 NFLOG      all  --  *      *       0.0.0.0/0            0.0.0.0/0            nflog-prefix  ""{AFL}"" nflog-group 40
   21  1064 REJECT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable
Chain afwall-vpn (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-wifi (5 references)
 pkts bytes target     prot opt in     out     source               destination         
   45  2905 afwall-wifi-postcustom  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-wifi-fork (2 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 afwall-wifi-lan  all  --  *      *       0.0.0.0/0            192.168.0.0/24      
   45  2905 afwall-wifi-wan  all  --  *      *       0.0.0.0/0           !192.168.0.0/24      
Chain afwall-wifi-lan (1 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-wifi-postcustom (1 references)
 pkts bytes target     prot opt in     out     source               destination         
   45  2905 afwall-wifi-fork  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-wifi-tether (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 afwall-wifi-fork  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-wifi-wan (1 references)
 pkts bytes target     prot opt in     out     source               destination         
   21  1064 afwall-reject  all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 10175
Chain bw_FORWARD (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain bw_INPUT (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain bw_OUTPUT (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain bw_costly_shared (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain bw_happy_box (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain bw_penalty_box (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain firewall (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain fw_FORWARD (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain fw_INPUT (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain fw_OUTPUT (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain lesafe_fw (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain mobile (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain natctrl_FORWARD (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain natctrl_tether_counters (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain oem_fwd (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain oem_out (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain wifi (0 references)
 pkts bytes target     prot opt in     out     source               destination         

==================
Network interfaces
==================

ip6tnl0: unknown
ccmni0: 3G
ccmni1: 3G
ccmni2: 3G
tunl0: VPN
wlan0: wifi
lo: unknown
p2p0: unknown
ifb0: unknown
ifb1: unknown
sit0: unknown

========
ifconfig
========

ccmni0    Link encap:Ethernet  HWaddr 9E:63:38:D2:34:C3  
          NOARP  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
ccmni1    Link encap:Ethernet  HWaddr BA:13:D1:31:9F:17  
          NOARP  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
ccmni2    Link encap:Ethernet  HWaddr D6:B7:F0:8A:EC:EB  
          NOARP  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
ifb0      Link encap:Ethernet  HWaddr DE:3B:57:7C:E2:C5  
          BROADCAST NOARP  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:32
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
ifb1      Link encap:Ethernet  HWaddr 56:86:D4:AD:68:BE  
          BROADCAST NOARP  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:32
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
ip6tnl0   Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          NOARP  MTU:1452  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:165 errors:0 dropped:0 overruns:0 frame:0
          TX packets:165 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:10532 (10.2 KiB)  TX bytes:10532 (10.2 KiB)
p2p0      Link encap:Ethernet  HWaddr 56:27:58:86:F6:85  
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:90 (90.0 B)
sit0      Link encap:IPv6-in-IPv4  
          NOARP  MTU:1480  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
tunl0     Link encap:UNSPEC  HWaddr 00-00-00-00-35-00-00-00-00-00-00-00-00-00-00-00  
          NOARP  MTU:0  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
wlan0     Link encap:Ethernet  HWaddr 54:27:58:86:F6:85  
          inet addr:192.168.0.33  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::5627:58ff:fe86:f685/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:6596 errors:0 dropped:0 overruns:0 frame:0
          TX packets:6065 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:7623319 (7.2 MiB)  TX bytes:659372 (643.9 KiB)

===========
System info
===========

Android version: 4.4.4
Manufacturer: LENOVO
Model: Lenovo P70-A
Build: P70-A_S134_150729_16G_ROW
Active interface: wifi
Tether status: no
Roam status: no
IPv4 subnet: 192.168.0.33/24
IPv6 subnet: fe80::5627:58ff:fe86:f685/64
/system/bin/su: not present
/system/xbin/su: 75364 bytes
/system/app/Superuser.apk: 5904943 bytes
Superuser: eu.chainfire.supersu v2.65

===========
Preferences
===========

appVersion: 15223
enableLog: true
logTarget: NFLOG
showLogToasts: false
Profile Mode : blacklist
Status : Enabled

======
Logcat
======

23:14:01 Starting /data/data/dev.ukanth.ufirewall/app_bin/nflog
23:14:01 nflog shell started
23:14:43 Starting root shell...
23:14:43 [libsuperuser] [SU%] START
23:14:43 Root shell is open
23:15:06 isWifiApEnabled is false
```
"
ukanth/afwall,closed,include dnsfproxy2 binary in afwall,"[Label(name=""Feature""), Label(name=""Wont-Fix"")]","could you please include dnsproxy2 in afwall
I've been using dnsproxy2 to filter dnns requests,
but when switched to CM13 I got this error:
error: only position independent executables (PIE) are supported.

I've raised an issue in cernekee/dnsproxy2 but no answer so  far.

Anyway ability to filter dns traffic would be an important feature for afwall.
Thanks.
"
ukanth/afwall,closed,Binary not found,"[Label(name=""Wont-Fix"")]","Hi
/system/bin/iptables not found when using custom script. I tried internal and system iptables without any luck ;(

I even used the sample header described in the custom scripts without any luck.

When I type /system/bin/iptables as  super user on the terminal I see that the binary is there. So I am not sure whey it is not able to find binary. When I disable custom script, it I can enable the firewall properly.

THis is a Samsung phone with Android 5.1.1. The device is rooted with Supersu. 
"
ukanth/afwall,closed,Fixed Google Play logo link,[],
ukanth/afwall,closed,Blocking the LTE modem on Droid4/Razr/Bionic leads to kernel wakelock. Was: AFWall on CM 13.0 will keep phone awake 100% of the time,"[Label(name=""Wont-Fix"")]","I'm running AFWall+ 2.2.3 on CM 13.0-20160412 (Android 6.0.1).
When AFWall is installed, blocking traffic works as supposed, but my phone uses tons of battery because AFWall keeps the phone constantly awake (as one can see in the battery stats). Awake time is 100% even if the screen is off for hours.

Better Battery Stats shows the following kernel Wakelock:
MAPAL_LITE_SOCKET_RECEIVE all the time. As well as ""rx_wake"" for about half the time.
Wifi is on and I'm connected to a cell network.

I found out AFWall is causing this by uninstalling one app at a time. First time around I uninstalled ALL apps and nothing changed. Then I rebooted and suddenly the phone was not awake all the time anymore.
So second time around I uninstalled one app at a time, rebooted, checked, uninstalled another one, rebooted etc... Until I uninstalled AFWall and after a reboot the Wakelock problem is gone.

Any idea on what could be causing this? Or how to further debug this? Any other information I can supply?
"
ukanth/afwall,open,how to use native rooting in Marshmallow 6,"[Label(name=""Feature"")]","The new smartphones like Huawei 8 Mate with the Android Marshmallow have a natively implemented feature to delegate the root access to selected applications, Setting/More/Security/Device administrators.

Can we use the feature without the need to root the device?
The Afwall appeared in the list there, and I switched ""allow"", BUT the list of the root permission is empty and the app says the device isn't rooted yet.
"
ukanth/afwall,closed,Any need for root write request when turning off WiFi?,"[Label(name=""Question"")]","If I turn off WiFi, and cellular data is already disabled, _su_ will report that AFWall+ was given access to an interactive (root) shell. This makes perfect sense when switching from WiFi to cellular data (or vice versa); but if both mechanisms for data access are disabled, it seems unnecessary for AFWall+ to do anything.

Is there a bug or opportunity for streamlining?
"
ukanth/afwall,closed,Base data leak script enabled/disabled on whether it exists in the actual folder and not in some setting,"[Label(name=""Duplicate"")]","Basically, when I update my rom, it deletes the script but in the afwall+ settings, it says it's activated whether it's in the folder or not. It would be better to base that setting on whether the script exists and not whether it's activated.
"
ukanth/afwall,open,guard netfilter rules through auditd or via chattr +iu,"[Label(name=""Feature"")]","how now afwall guards rules ?

simple flush of rules on any table is not affecting afwall ...
have you consider simple using chattr +iu  on rules?  through auditd? https://android.googlesource.com/platform/system/core/+/master/logd/README.auditd

![b1](https://cloud.githubusercontent.com/assets/10565704/14067367/179ef550-f464-11e5-935c-e3436b98d392.png)
![b1_1](https://cloud.githubusercontent.com/assets/10565704/14067369/1cc6abf4-f464-11e5-94f7-45087709b971.png)
"
ukanth/afwall,closed,afwall rules not reapplying on network change to data?,"[Label(name=""Bug"")]","If I start my phone with wifi and data turned off and subsequently enable data, restricted apps can access data.

If I enable wifi, firewall seems to reapply without issue.

lg g3, vanilla CM12
"
ukanth/afwall,open,Feature request: distinguish between LAN via VPN and Internet via VPN,"[Label(name=""Feature"")]","There are usually two purposes of using a VPN:
- accessing your LAN from on the road
- encrypting traffic on public/untrusted hotspots

AFwall should somehow make it possible to distinguish between these two use cases.
Idea: add an option so that LAN traffic also includes LAN via VPN.
"
ukanth/afwall,open,[FAQ] System Applications to Block/Allow,"[Label(name=""General""), Label(name=""Howtos"")]","It will be useful to create a FAQ documenting which Android system applications must be allowed, and which can be blocked.  For each Android system application, any side-effects of blocking the application will be notated.

I'll get the ball rolling, and then others can make corrections and add to this.  Together, we can work towards an accurate document.
## **_Common System Apps**_

**(adb) - Android Debug Bridge**
- If blocked, ADB will not be able to communicate over the 
- Rec: Block if not using ADB over a wireless connection, otherwise enable only for connection type being used

**(drm) - Digital Rights Management service**
- If blocked, cannot view content that requires Android DRM
- Rec: Block if not viewing any content that requires Android DRM content, otherwise allow for connection type(s) being used

**(gps) - GPS**
- If blocked, GPS may not be able to receive AGPS data (needs to be verified)
- Rec: Research if AGPS data can still be obtained if blocked; if so, block

**(Kernel) - Linux Kernel**
- Cases where it needs to be enabled for all connection types (LAN, WiFi, Cell data)
- Rec: Allow for all connection types (including LAN)

**(media) - Media server**
- Need more info
- Rec: Until more info provided, allow for connection types except LAN

**(NTP) - Internet time servers**
- Cell network devices can still obtain current time/date from cell network even if this is blocked
- Rec: Block for cell devices, Allow for connection types except LAN for other devices

**(shell) - Linux shell**
- Cases where it needs to be enabled for connection types except LAN (WiFi, Cell data)
- Rec: Allow for connection types except LAN

**(Tethering) - DHCP+DNS services**
- If blocked, will not be able to tether over the connection types blocked
- Rec: Block if not tethering, otherwise enable only for connection types being used for tethering

**(vpn) - VPN Networking**
- If blocked, will not be able to use a VPN over the connection types blocked
- Rec: Block if not using a VPN, otherwise enable only for connection types being used to connect to the VPN

**ConfigUpdater**
- Function unclear
- Rec: Allow for WiFi, block for other connection types

**Downloads, Media Storage, Download Manager**
- Required to for apps to download content
- Rec: Allow for connection types except LAN

**DRM Service**
- If blocked, cannot view content that requires DRM
- Rec: Block if not viewing any DRM content, otherwise allow for connection type(s) being used

**GoogleAccount Manager, Google Play services, et al.**
- If blocked, cannot use Google apps
- Rec: Block if not using Google apps, otherwise allow for all connection types except LAN

**Google Partner Setup**
- No one seems to know what this does and what data it transmits/receives
- Rec: Block

**Google Play Store**
- If blocked, cannot use the Google Play store
- Rec: Block if not using the Google Play store, otherwise allow for all connection types except LAN

**Market Feedback Agent**
- If blocked, cannot use Google to submit feedback to app developers when apps crash
- Rec: Block if not using the Google Play store, otherwise allow for all connection types except LAN

**PacProcessor**
- Unclear what this does and what data it transmits/receives
- Rec: Block

**ProxyHandler**
- Function not completely clear
- Rec: Allow for all connection types except WiFi; might be good to block if not using any proxies

**Self Service**
- Unclear what this does and what data it transmits/receives
- Rec: Block

**Setup Wizard**
- Unclear what data this transmits/receives
- Rec: Block

**Smart Device Manager**
- Unclear exactly what this data this transmits/receives, but may be required for some tracking tools (finding lost device, for example)
- Rec: Block, unless determined that it is needed for any lost device finding tools
"
ukanth/afwall,closed,Wrong firewall status,[],"Since last update, there is an X on app icon, sugesting that firewall is disabled and there is option to enable firewall in app menu, but when clicked nothing happens.

But ip tables are applied since blocked apps actually can not access internet. 

Device: Huawei Ascend P7 (Kitkat 4.4.2), SuperSU 2.65

![bug](https://cloud.githubusercontent.com/assets/17744091/13900858/7ae82730-ee10-11e5-97f9-5473352ae440.jpg)
"
ukanth/afwall,closed,[FYI] F-Droid is behind one release,[],"Just FYI: F-Droid is at 2.2.2 while Play Store is at 2.2.3
"
ukanth/afwall,closed,Can't enable firewall with custom script,"[Label(name=""Bug"")]","Device: Sony Xperia Z1 (honami)
Firmware: CyanogenMod 12.1
Version: 2.2.2, 2.2.3
Custom script: $IPTABLES -A ""afwall"" --destination ""x.x.x.x"" -j RETURN
(x.x.x.x is IPv4)
"
ukanth/afwall,closed,AFWall requesting root access at random times,"[Label(name=""Bug"")]","When using AFWall v2.2.2 with SuperSU on Android KitKat, with SuperSU notifications enabled, SuperSU indicates that AFWall is requesting root access at random times.

AFWall needs root access to modify _iptables_ when the connection-type is changed, but SuperSU is also reporting that AFWall is requesting root access at other, seemingly random, times as well.

Is this expected, or is there a bug?
"
ukanth/afwall,open,drop /allow policy for ip ,"[Label(name=""Feature"")]","can u add options to maintain drop/allow  policy for ip:port ? as simple list 
it's base for any firewall and  afwall is lack of this future :)
"
ukanth/afwall,closed,[enhancement/bug] ability to keep app in the recently used apps menu,"[Label(name=""Feature"")]","Hi there, I recently purchased the Donator version of your app. Thanks very much.

I was hoping that you might add an option to allow afwall+ to appear in the recently used apps list, I haven't seen any other material based apps close them selves out of recently used before.

Apologies if this is already requested.

Also, someone mentioned to me that the donator version is not updated as frequently, I know it said the donator one was updates less frequently, but the other version didn't have a real explanation as to the differences between them.

Thanks!

Samsung Tab S2 8.0"" (Wifi) Black (SM-T710) 5.1.1 in case you're wondering. 
"
ukanth/afwall,open,"Init.d script does not block IPv6, does not work when encryption is on.","[Label(name=""Feature"")]","I found two issues with the init.d script that AFWall use when ""Fix Startup Data Leak"" is enabled:
[1] It does not block IPv6.
[2] On encrypted devices, the script fails to set the chains to DROP.
This is because at least on my system (OmniROM 6 / MM compatible), but I'd assume that's the same for everyone as the encryption code is hardly patched by custom ROMs, the /system/etc/init.d (and /su/su.d or /system/su.d) scripts are ran early in the boot sequence and /data is not yet mounted.  The script then assumes afwall is not installed and does not set the chain policy.

I use the attached /system/etc/init.d script (it also works for su.d).
[50iptables](https://github.com/ukanth/afwall/files/169692/50iptables.txt)
It works by waiting for the data directory for the Android Download Manager to show up.  This app has been carefully chosen as it is assumed to be always present in all ROMs, and is not present when Android runs its boot environment for inputing the /data encryption key.  Once that data directory shows up, we test for the presence of AFWall, and then proceed with setting the chains to DROP when AFWall is detected.

Note that it assumes that both IPv4 and IPv6 will be blocked, so it may break things for people that have IPv6 enabled yet only block IPv4.
To address that issue you may have to change the script dynamically when the IPv6 support button in AFWall is toggled.
Also, in the event that /data/data/com.android.providers.downloads does not show up, the script will run indefinitely, waking up every second.  Since it does not hold a wakelock, I doubt it would cause battery issues, but I also doubt that issue will arise very often.
"
ukanth/afwall,open,Stuck at applying iptables rules.,"[Label(name=""Bug"")]","Android v5.1.1 (Nexus6 so it's stock).
SuperSU v2.65 (logs show that AFWall+ requested root and it was granted)
Afwall+ v2.2.2 Donate

Upon startup, Afwall+ error (Error applying firewall rules.) message.

Entering the afwall shows it is enabled and if I have blocked something, it does appear that the rule is in effect to block it.

Disabling the firewall and reenabling it results in it hanging at the Working message (Applying iptables rules).

This problem only started in the last month or so, and I've left AFwall disabled since it showed up as I have been too busy to mess with it.
"
ukanth/afwall,closed,Meaning of icons is not obivous,"[Label(name=""Feature"")]","There are 3 icons to set the rules, but for me is the Funktion not obivous. For example which button disables the Internet via WLAN,which button disables the mobile Internet. 

Maybe is there an Option to show a short hint text?
"
ukanth/afwall,closed,"Block all but one app => still ""Android OS"" traffic","[Label(name=""Question"")]","I block all apps and whitelist one app. 

When I look up ""Data Usage"" I see that the app generated 1.4 MB traffic, but Android OS also used 60 KB.

Can I block Android OS. Or is this inevitable and related to the 1.4MB app traffic?
"
ukanth/afwall,closed, Preferences -> User Interface -> IPv6 Support : checkbox bug,"[Label(name=""Bug"")]","Little bug: Preferences -> User Interface -> IPv6 Support

This setting, after any phone reboot, returns, always, to unchecked state...
and so the ip6tables rules are not automatically applied.

Thanks
"
ukanth/afwall,closed,Micro G causes error message in AFWall+,"[Label(name=""Question"")]","I noticed an odd behaviour when microG (http://forum.xda-developers.com/android/apps-games/app-microg-gmscore-floss-play-services-t3217616) is combined with AFWall+. If the microG module GsfProxy.apk (version 0.1.0) is installed, but the two check boxes ""activate device check-in"" and ""activate google cloud messaging"" are left unchecked within microG settings (version 0.2.1), then there will be the following error message in AFWall (version 2.2.1) after booting the device: ""error applying firewall rules"". This error message does not appear, however, if the two check boxes are ticked or if GsfProxy.apk is not installed.

The same error message appears upon installation of NetworkLocation.apg version 1.6.2 (https://github.com/microg/android_packages_apps_UnifiedNlp/releases) instead of gsmcore. Since there aren't any relevant tick boxes in this app, only deletion of the app solves the problem.

I filed a bug report at the MicroG project page (https://github.com/microg/android_packages_apps_GmsCore/issues/103), but the developer suggested to file a bug report here.

I would be interested to know what possibly could cause the error message in AFWall+.

I am running Omnirom 5.1.1 on a Nexus 7 (2013) Wifi. 
"
ukanth/afwall,closed,afwall leaks Wi-Fi traffic for an blocked application for a short time,[],"I blocked Whatsapp for Wi-Fi and LAN and allowed it for mobile connections.
But when I reenable Wi-Fi the android connection manager and wireshark show me that some packets slip through the Wi-Fi device. (Enable Wi-Fi, disable Wi-Fi enable Wi-Fi)

Note: This only seems to happen for a short time when the connection was established. Because all traffic is blocked after that.
Android 4.4.4
Afwall log and wireshark analyisis:

```
AppID : 10108
Application's Name: WhatsApp
Total Packets Blocked:  5
[TCP]172.217.18.46(5)
```

![wireshark](https://cloud.githubusercontent.com/assets/6986141/13499168/6f0c820e-e15d-11e5-871e-1cf05446b7e9.jpg)
Afwall rules: https://gist.github.com/towlie/749f99f7b1cf9a402d75
"
ukanth/afwall,closed,Log History,"[Label(name=""Feature"")]","First all, this is a great app . And i have donated from 3 different accounts(my sons) because its best firewall i have seen for android.

But i think that is priority , like an app of security, have a log history of blacklist(blocked) and maybe of whitelist. Not only the last messages temporarily.

Congratulations one more time.
"
ukanth/afwall,closed,"""Fix startup data leak"" should support /su/su.d/",[],"This is that path used for su.d by SuperSU when installed in ""systemless"" root mode.  All the SuperSU stuff, including su.d directory, is inside an image stored on /data instead of written directly to /system.  That image is mounted rw, so afwall's script should be installable there.
"
ukanth/afwall,open,Identify and/or hide which apps are disabled in the list.,"[Label(name=""Feature"")]","http://stackoverflow.com/questions/25342883/check-if-app-is-enabled-or-disabled-using-package

Basically give us an option to hide or mark via color apps which are disabled in the list of apps. Makes it easier to discern which apps should have rules applied to them from a user stand point.

This is super low priority and is merely a feature request.
"
ukanth/afwall,closed,afwall leaks Wi-Fi traffic for an blocked application for a short time[kingroot issue],"[Label(name=""DNS""), Label(name=""Question"")]","I blocked Whatsapp for Wi-Fi and LAN and allowed it for mobile connections.
But when I reenable Wi-Fi the android connection manager shows me that some kbytes slip through the Wi-Fi device. (Enable Wi-Fi, disable Wi-Fi enable Wi-Fi)

Note: This only seems to happen for a short time when the connection was established. Because all traffic is blocked after that.
Android 4.4.4
"
ukanth/afwall,closed,Feature Request: Real Multiuser-Support,"[Label(name=""Feature"")]","currently Profiles exist but they are not linked to accounts

i have multiuser activated in android, but if i use the new user, everything seems to be blocked...in the main-account the apps are allowed (e.g. firefox, playstore,etc.), apps are shared using the app ""multiuser-app-share"" from googleplay.
nothing found related in log file of AFWall+ (main-user)

my current workaround is to set FW-Settings again for the new user (shared AFWall and supersu-app and activated multiuser-option in SuperSu) but i don't want root-access by all other accounts
"
ukanth/afwall,closed,Real Multiuser Support,[],"currently Profiles exist but they are not linked to accounts

i have multiuser activated in android, but if i use the new user, everything seems to be blocked...in the main-account the apps are allowed (e.g. firefox, playstore,etc.), apps are shared using the app ""multiuser-app-share"" from googleplay.
nothing found related in log file of AFWall+ (main-user)

my current workaround is to set FW-Settings again for the new user (shared AFWall and supersu-app and activated multiuser-option in SuperSu) but i don't want root-access by all other accounts
"
ukanth/afwall,closed,widget disables firewall without dialog even if confirmation required in settings,"[Label(name=""Wont-Fix"")]","widget disables firewall without dialog even if confirmation required in settings.
"
ukanth/afwall,closed,Added Select All option in overflow menu!,[],
ukanth/afwall,open,"Under loilipop, if i first allowed google and after blocked, google stays available","[Label(name=""General""), Label(name=""Question"")]","Hi guys
Please for help.
I use afwall for long time, now on my new mobile with google lollipop the blocking rules are not working proper...
For example, if I allow chrome the internet to use and I go to google search, afterwards google is still reachable don't matter if I block chrome or not! But only google the rest of the www is proper blocked?
Any ideas? Thank you for any help!
Lg ivi
"
ukanth/afwall,open,Feature request: manage donate version via a txt file,"[Label(name=""Feature"")]","Hi,
I bought AFWall+ donate several months ago but I don't use Google Play services anymore.
Could you implement a feature to manage the ""pro"" features through a txt file?

Here is an example with Titanium backup license:

```
# This is your license file for Titanium Backup.
# (Do not modify this file)
#
# Instructions:
# - Copy this file (TitaniumBackup_license.txt) to your SD card (not in a folder)
# - Start Titanium Backup and verify that your registration info is displayed
# - If not, please uninstall and then reinstall Titanium Backup
# - Optional: delete this file from your SD card
#
generation=1
keyId=edaf****63b4
#
customerName=My Name
customerEmail=my_email@gmail.com
#
signature=@@@116e14**56fa70028bdb8a1ba8d1dc3dde147a8472d4360c71de16ac07788dd61688a29d1fa4b50dd76b3e016ca9fa954***d07ca3607861799821030288835ccf6*****d5cbbf912ce636ee79766aac9e60a0ef********82ccb9356ccb44a326721d551db0231129f477529d733bade74a953fdda19ead****483c487d78ff00c6a9d3237bcae****f17b8d47d7e26f6001****5e6588eed2f4fa96f0b6585a1ba5e796ec4e094782f7a7b***7a123670a5ead3fa705a24e893b87d89c75fc18bddd1fafd30321b504028757085f1b0b855d850b0b9649ed35c04864f7a4825cfdf369c14aa06aa007fd1ba013724ed0f733a38e6e9de16cc31*558ee6****cc16@@@
```

Thank you.
"
ukanth/afwall,closed,misspelling at https://github.com/ukanth/afwall/wiki/Advertisements-blocking,[],"> hot to debug

should be 

> how to debug
"
ukanth/afwall,closed,Forgot password,[],"Hello. I used the option builded in the app to protect it by a password. But guess how stupid am I : I forgot the password. :\

What can I do?
Is it because of that I can't uninstall the app?

Thanks! 

Samsung Galaxy S5
Android 4.4.2
"
ukanth/afwall,open,Separated screen on/off rules support,"[Label(name=""Feature"")]","Could AFWall+ supports separated rules based on screen state (on/off)? That would be great since there're many apps I only want to have Internet connection when screen is on.
"
ukanth/afwall,closed,gui for ssh,[],"Request to add gui control for enable/disable ssh 
"
ukanth/afwall,open,CynogenMod 13 use ToyBox instead of BusyBox or Android's own toolbox,"[Label(name=""Feature""), Label(name=""Question"")]","As topic says the major issue with CybogenMod 13 aka M is that changes couldn't work while [it uses toybox](https://github.com/CyanogenMod/android_external_toybox) and we not support it (yet).

I highly recommed (yet again) to remove the binary option and only use our own iptables/BusyBox and just check (if not present or outdated) to install our own binaries which then is easier to track down in case a iptables/busybox related problem appears. As mentioned in my other thread I will upload the new busybox binaries which already working with CynagogenMods new architecture.  

I did not understand why (even after watching the [video](http://youtu.be/SGmtP5Lg_t0)] they using toybox but it needs to be changed (sadly). I still think BusyBox _is the best_ solution since it worked now for years very well for me. 
"
ukanth/afwall,closed,Get default DNS ,"[Label(name=""Howtos"")]","Since the DNS problems in AFWall+ are huge I might found a solution which gets the default DNS (in Android it's always 8.8.8.8 and can't be changed without root access). The sad thing is that there is [no API given](https://developer.android.com/reference/android/net/VpnService.Builder.html#addDnsServer%28java.lang.String%29) so we must write our own stuff from here.

``` JavaScript
#include <android/log.h>
#include <dlfcn.h>

#if (__ANDROID_API__ >= 21)
/*
   Android 'L' makes __system_property_get a non-global symbol.
   Here we provide a stub which loads the symbol from libc via dlsym.
   This return correct DNS for WiFi and Cellular Interfaces and can be verified with getprop. 
*/
typedef int (*PFN_SYSTEM_PROP_GET)(const char *, char *);
int __system_property_get(const char* name, char* value)
{
    static PFN_SYSTEM_PROP_GET __real_system_property_get = NULL;
    if (!__real_system_property_get) {
        // libc.so should already be open, get a handle to it.
        void *handle = dlopen(""libc.so"", RTLD_NOLOAD);
        if (!handle) {
            __android_log_print(ANDROID_LOG_ERROR, ""foobar"", ""Cannot dlopen libc.so: %s.\n"", dlerror());
        } else {
            __real_system_property_get = (PFN_SYSTEM_PROP_GET)dlsym(handle, ""__system_property_get"");
        }
        if (!__real_system_property_get) {
            __android_log_print(ANDROID_LOG_ERROR, ""foobar"", ""Cannot resolve __system_property_get(): %s.\n"", dlerror());
        }
    }
    return (*__real_system_property_get)(name, value);
} 
#endif // __ANDROID_API__ >= 21

// and within connectivityManager 
ConnectivityManager connectivityManager = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
Network[] networks = connectivityManager.getAllNetworks();
    for (Network network : networks) {
        LinkProperties lp = connectivityManager.getLinkProperties(network);
        Log.d(""DnsInfo"", ""iface = "" + lp.getInterfaceName());
        Log.d(""DnsInfo"", ""dns = "" + lp.getDnsServers());
    }
```

This is a big hacky but seems to do the trick, the problem is that [it requires to workaround with System.getProperty](http://rxwen.blogspot.de/2010/01/android-property-system.html) which isn't always available. 

I created this ticket in case someone found _a better solution_ but from what I know this is the best we can get to workaround the entire DNS issue which was reported here several times especially on VPN/WIFI/Cellular. 
"
ukanth/afwall,closed,transproxy problem,[],"After updating to newest orbot, v15.1, transproxy script doenst work in afwall. V2.1.3
"
ukanth/afwall,open,"Question: ""No data connection"" message","[Label(name=""Question"")]","Hello,

at first I need to say Thank You for the great firewall app. 
I used the Droidwall but there was many of issues which are solved in your app.
So I bought the paid version of AFW+ after trying of the free version and I've donated something too because the app price is low by my opinion.

But I have one problem with Android's internet connection checker which I'm not able to solve myself.
If I have whitelisted only the apps for which I can allow the internet access (and necessary services like a Google play for example), I get the ""No data connection"" message in message bar at times.
I have already read the light FAQ in app and the full FAQ on your Github pages too, I spend many of time by googling, but I still cannot find the solution.
Yes, I know that if the processes under UID 1000 will be allowed the issue will gone.
But there is too many services under this UID (and many of this is bloatware or spyware by my opinion) so I don't want allow all at once.

So I have the question to you if there is any other solution of this problem - or if I can write my own rule which will allow only the one right process for the internet connection checking.
Or (workaround) - how to suppress the message. I'm not able to do it by standard way.

Thank you 

Xiaomi Redmi 2 2GB RAM, Android 4.4.4, MIUI 5.12.31
"
ukanth/afwall,closed,main.c copyright corrections,[],"As discussed [over here](https://github.com/hartwork/klogripper/issues/1#issuecomment-172936440), I fixed the wrong copyright.
"
ukanth/afwall,closed,Wrong link fixed,[],"The link was wrong.
"
ukanth/afwall,closed,Busybox update v1.24.1,"[Label(name=""Wont-Fix"")]","I compiled all latest busybox binaries with pie and no pie support. It can be downloaded over [here](https://userscloud.com/11r4tfnf18po). Would be nice if you merge it ukanth. Sr for no pull request but I sent it over Android app. 
"
ukanth/afwall,closed,Afwall disables itself if an usb ethernet card is added to the device ,"[Label(name=""NoInfo"")]","HI

I have a tablet that accepts usb ethernet card via otg usb converter. The problem is that whenever I add it to my device, Afwall does not like it and it disables the firewall and  it cant enable the firewall. Removing the network card makes Afwall very happy. 
"
ukanth/afwall,closed,Readme update,[],"- Simplify compile instructions 
- Missing projects added (SimpleNoSQL & Material-Dialogs)
"
ukanth/afwall,closed,AFWall+ 2.1.3 auto disables,[],"Steps to reproduce:
1) Select apps to be allowed through as normally.
2) Save rules
3) Activate firewall
4) Wait
5) AfWall returns a notification that it is disabled.

Issue has not been present in version 2.1.1 originally but after downgrading the app occasionally stops working although it indicates it is active.

Device: Redmi Note 2
Chipset: Mediatek MT6795 Helio X10
CPU: Octa-core 2.0 GHz Cortex-A53
OS: MIUI 7
"
ukanth/afwall,closed,Does AFWall+ need to constantly run su/privileded-mode?,[],"Hello, I have started using AFWall+. So far so good, except CM13 displays a ""#"" sign on the notification bar which means something is running with root permissions.

I understand this is necessary when logging is enabled. But other than that, can't AFWall+ just use ""su"" when it needs to perform some occasional privileged operation (reading/writing the iptables), and not constantly all the time? I'm not very familiar with the app, but it'd seem a good practice to gain root privileges only when an operation requires them and not keep them constantly. Regards!
"
ukanth/afwall,closed,Application stuck at start (checking root access),[],"Hi,
The app was well working on my rooted smartphone (Xiaomi RedMi 1S) since more than a year. But since few months (I think 11/2015), it doesn't work anymore. 
The app keep stuck at the start with a never ending message : ""Status : Checking root access..."" (look at the screenshot). I can't cancel this message, so I can't access to the application.
I have tried those but issue is still there : 
- cleared the app cache, 
- re-rooting my phone,
- uninstalled then reinstalled the app,
- upgraded the smartphone ROM...
  I use AFWall+ v2.1.3 (last version).
  Do you have an idea?

![screenshot_2016-01-06-01-11-40_dev ukanth ufirewall](https://cloud.githubusercontent.com/assets/16567425/12131603/5a765c3c-b414-11e5-8a66-ecacbe42d73f.png)
![screenshot_2016-01-06-01-12-25_com android settings](https://cloud.githubusercontent.com/assets/16567425/12131605/5f659fbe-b414-11e5-8168-7b7673d3c32c.png)
"
ukanth/afwall,closed,Afwall 2.1.1 Widget unable to disable firewall,[],"Hi!

Putting the simple afwall widget onto the desktop says in a toast: Cannot disable firewall - password defined.

But, there is no password defined.
"
ukanth/afwall,closed,Missing Gradlew script and gradle/wrapper folder,[],"The latest cleanup took out some useful files resulting in a failure to build: gradlew script as well as the entire directory gradle/wrapper together with java files...
"
ukanth/afwall,closed,None of the links in the About screen are functional,"[Label(name=""Bug"")]","None of the links in the About screen are functional.

(The link to the FAQ in the FAQ page works as expected.)
"
ukanth/afwall,closed,Blocking linux kernel even when it is whitelisted,"[Label(name=""Bug"")]","I enabled AFWall+ logging and ""toasting"" of blocked connection attempts.  The following two toasts later appeared:

```
 AFWall+ Blocked : (Kernel) - Linux kernel (-11) -239.255.255.250:null
```

and

```
 AFWall+ Blocked : (Kernel) - Linux kernel (-11) -null:null
```

This would not be a problem, except that I have the following whitelisted for all network types:  

```
  -11: (Kernel) - Linux kernel
```

This appears to be a bug.  Is it?
"
ukanth/afwall,closed,afwall+ is being disabled after sometime when screen is off,"[Label(name=""Wont-Fix"")]","afwall+ version: 2.1.3
android: v4.2.2 (rooted+exposed installed)

My need: every app should have access to the internet while connected to the wifi and none when using mobile data except: Whatsapp and Google Play services(for gcm functionality)

my settings:
  Mode: White list
  'Core' section: all entries are checked to use wifi
  'System' section: only Google Play services set to use mobile data
  'User' section: only Whatsapp set to use mobile data

afwall+ is working just as I expected but if I turn off wifi and switch to mobile data, everything is again as expected but after sometime, when the screen is off, I don't know what happens that when I turn screen on again to use the phone, I can see that afwall+ is not working. (an app like firefox can access internet) (no notification or anything from afwall+)

I have greenify too but afwall+ is not set to be greenified.
"
ukanth/afwall,closed, Fixed: Applications not showing after search completed,[],"As submitted #472 here is the fix for this!
"
ukanth/afwall,closed,After search completed no applications are on the list!,[],
ukanth/afwall,closed,command 'iptables -A afwall-3g -j afwall-3g-postcustom' exited with status 2,"[Label(name=""Wont-Fix"")]","Hello,

I'm using AFWall+ 2.1.1 on Android 6.0.1 Nexus 7 (2012).
After disabling Custom Scripts AFWall+ will not load the custom rules. I fetched some info with logcat:

```
12-25 13:29:03.106  5284  5284 I AFWall  : command 'iptables -A afwall-3g -j afwall-3g-postcustom' exited with status 2
12-25 13:29:03.106  5284  5284 I AFWall  : Output:
12-25 13:29:03.106  5284  5284 I AFWall  : iptables v1.4.20: Couldn't find target `afwall-3g-postcustom'
12-25 13:29:03.106  5284  5284 I AFWall  : Try `iptables -h' or 'iptables --help' for more information.
```

In my ruleset there is nothing with 'iptables -A afwall-3g'. Just some drop rules with 'afwall' chain.
Maybe it's not working because Nexus 7 has not any 3g network interface.

After enabling:

```
12-25 13:41:48.484  5284  5284 D AFWall  : Starting root shell...
12-25 13:41:48.484  5284  5284 I AFWall  : [libsuperuser] [SU%] START
12-25 13:41:48.676  5284  5284 D AFWall  : Root shell is open
12-25 13:41:48.839  5284  5295 I art     : Background partial concurrent mark sweep GC freed 33605(2044KB) AllocSpace objects, 5(100KB) LOS objects, 24% free, 7MB/9MB, paused 1.085ms total 200.124ms
12-25 13:41:48.938  5284 19229 D OpenGLRenderer: endAllStagingAnimators on 0x5bb4c100 (ListPopupWindow$DropDownListView) with handle 0x5c1daeb0
12-25 13:41:50.219 27941 27941 D AndroidRuntime: >>>>>> START com.android.internal.os.RuntimeInit uid 0 <<<<<<
12-25 13:41:50.229 27941 27941 D AndroidRuntime: CheckJNI is OFF
12-25 13:41:50.233 27941 27941 W app_process32_o: type=1400 audit(0.0:9972): avc: denied { write } for name=""system@framework@boot.art"" dev=mmcblk0p9 ino=425157 scontext=u:r:shell:s0 tcontext=u:object_r:dalvikcache_data_file:s0 tclass=file permissive=0
12-25 13:41:50.350 27941 27941 D ICU     : No timezone override file found: /data/misc/zoneinfo/current/icu/icu_tzdata.dat
12-25 13:41:50.353 27941 27941 W main    : type=1400 audit(0.0:9973): avc: denied { write } for name=""arm"" dev=mmcblk0p9 ino=425155 scontext=u:r:shell:s0 tcontext=u:object_r:dalvikcache_data_file:s0 tclass=dir permissive=0
12-25 13:41:50.472 27941 27941 E memtrack: Couldn't load memtrack module (No such file or directory)
12-25 13:41:50.472 27941 27941 E android.os.Debug: failed to load memtrack module: -2
12-25 13:41:50.492 27941 27941 I Radio-JNI: register_android_hardware_Radio DONE
12-25 13:41:50.572 27941 27941 D AndroidRuntime: Calling main entry com.android.commands.am.Am
12-25 13:41:50.612 27941 27941 D AndroidRuntime: Shutting down VM
12-25 13:41:50.698  1187  1187 I art     : Waiting for a blocking GC DisableMovingGc
12-25 13:41:50.703  1187  1198 I art     : CollectorTransition marksweep + semispace GC freed 1283(47KB) AllocSpace objects, 0(0B) LOS objects, 24% free, 3MB/4MB, paused 48.728ms total 48.728ms
12-25 13:41:50.704  1187  1187 I art     : WaitForGcToComplete blocked for 5.860ms for cause DisableMovingGc
12-25 13:41:50.704  1187  1187 I art     : Starting a blocking GC DisableMovingGc
12-25 13:41:51.804 28011 28011 D AndroidRuntime: >>>>>> START com.android.internal.os.RuntimeInit uid 0 <<<<<<
12-25 13:41:51.821 28011 28011 D AndroidRuntime: CheckJNI is OFF
12-25 13:41:51.949 28011 28011 D ICU     : No timezone override file found: /data/misc/zoneinfo/current/icu/icu_tzdata.dat
12-25 13:41:52.048 28011 28011 E memtrack: Couldn't load memtrack module (No such file or directory)
12-25 13:41:52.048 28011 28011 E android.os.Debug: failed to load memtrack module: -2
12-25 13:41:52.061 28011 28011 I Radio-JNI: register_android_hardware_Radio DONE
12-25 13:41:52.121 28011 28011 D AndroidRuntime: Calling main entry com.android.commands.settings.SettingsCmd
12-25 13:41:52.128 28011 28011 D AndroidRuntime: Shutting down VM
12-25 13:41:53.506 28030 28030 D AndroidRuntime: >>>>>> START com.android.internal.os.RuntimeInit uid 0 <<<<<<
12-25 13:41:53.515 28030 28030 D AndroidRuntime: CheckJNI is OFF
12-25 13:41:53.634 28030 28030 D ICU     : No timezone override file found: /data/misc/zoneinfo/current/icu/icu_tzdata.dat
12-25 13:41:53.723 28030 28030 E memtrack: Couldn't load memtrack module (No such file or directory)
12-25 13:41:53.723 28030 28030 E android.os.Debug: failed to load memtrack module: -2
12-25 13:41:53.738 28030 28030 I Radio-JNI: register_android_hardware_Radio DONE
12-25 13:41:53.804 28030 28030 D AndroidRuntime: Calling main entry com.android.commands.settings.SettingsCmd
12-25 13:41:53.815 28030 28030 D AndroidRuntime: Shutting down VM
12-25 13:41:55.188 28040 28040 D AndroidRuntime: >>>>>> START com.android.internal.os.RuntimeInit uid 0 <<<<<<
12-25 13:41:55.197 28040 28040 D AndroidRuntime: CheckJNI is OFF
12-25 13:41:55.312 28040 28040 D ICU     : No timezone override file found: /data/misc/zoneinfo/current/icu/icu_tzdata.dat
12-25 13:41:55.409 28040 28040 E memtrack: Couldn't load memtrack module (No such file or directory)
12-25 13:41:55.409 28040 28040 E android.os.Debug: failed to load memtrack module: -2
12-25 13:41:55.425 28040 28040 I Radio-JNI: register_android_hardware_Radio DONE
12-25 13:41:55.491 28040 28040 D AndroidRuntime: Calling main entry com.android.commands.settings.SettingsCmd
12-25 13:41:55.504 28040 28040 D AndroidRuntime: Shutting down VM
12-25 13:41:56.520  5284 28010 I AFWall  : [libsuperuser] [SU%] WATCHDOG_EXIT
12-25 13:41:56.558  5284  5284 E AFWall  : libsuperuser error -1 on command '. /sdcard/Download/iptables.sh'
12-25 13:42:02.067  5284 12520 W MessageQueue: Handler (android.os.Handler) {9f0295f} sending message to a Handler on a dead thread
12-25 13:42:02.067  5284 12520 W MessageQueue: java.lang.IllegalStateException: Handler (android.os.Handler) {9f0295f} sending message to a Handler on a dead thread
12-25 13:42:02.067  5284 12520 W MessageQueue:  at android.os.MessageQueue.enqueueMessage(MessageQueue.java:543)
12-25 13:42:02.067  5284 12520 W MessageQueue:  at android.os.Handler.enqueueMessage(Handler.java:631)
12-25 13:42:02.067  5284 12520 W MessageQueue:  at android.os.Handler.sendMessageAtTime(Handler.java:600)
12-25 13:42:02.067  5284 12520 W MessageQueue:  at android.os.Handler.sendMessageDelayed(Handler.java:570)
12-25 13:42:02.067  5284 12520 W MessageQueue:  at android.os.Handler.post(Handler.java:326)
12-25 13:42:02.067  5284 12520 W MessageQueue:  at android.widget.Toast$TN.hide(Toast.java:388)
12-25 13:42:02.067  5284 12520 W MessageQueue:  at android.app.ITransientNotification$Stub.onTransact(ITransientNotification.java:55)
12-25 13:42:02.067  5284 12520 W MessageQueue:  at android.os.Binder.execTransact(Binder.java:453)
12-25 13:42:03.741   521   581 D WifiStateMachine: starting scan for ""WLAN@Home""WPA_PSK with 2462
12-25 13:42:22.103   133   502 E NetlinkEvent: NetlinkEvent::FindParam(): Parameter 'UID' not found
```

Problems with memtrack module? This seems ROM related.
"
ukanth/afwall,open,Question: how is chromecast penetrating my afwall?,"[Label(name=""Question"")]","I just installed google's chromecast app. Although i didn't allow the app to communicate with wLan, when i start the app my chromecast stick found. So there must be another open communication level  the android system, maybe through kernel?
"
ukanth/afwall,closed,Distributing AFWall+ on TorrApk AppStore,[],"Hoping to give a contribution to this app that I really love,
I put it on TorrApk, an alternative free Android AppStore that distributes free apps all over the world, in their .apk file format and can reach a lot of devices that have no access to Google Play.

This is the link of the app: https://www.torrapk.com/en/apps/30-rooted-phones/8187-AFWall-Android-Firewall

I'll try to keep it always updated with the latest release.
"
ukanth/afwall,closed,TunnelBear + AFWall+ = AFWall+ startup error where it's unable to apply rules.,[],"Android 5.1.1. Nexus6. No experimental settings are being used.

Install AFWall+, set up your rules how you like them. Install TunnelBear, make rules for it too.

Restart phone.

AFWall generates an error at startup saying it is unable to apply rules.

Enabling AFWall manually works fine. Rules apply fine.

Uninstalling TunnelBear resolves startup rule issues.

Have contacted TunnelBear support about this issue as well just before I typed this out. Letting both sides know in hopes that one is able to resolve it.
"
ukanth/afwall,open,Feature Request: Profile Inheritance,"[Label(name=""Feature"")]","I did not found this feature, but I would really like to be able to define some kind of ""default"" profile, where the other profiles are inheriting the rules.

For example: I have some core rules for apps, that should never have internet access (e.g. local statistics apps) or only wifi (e.g. Youtube). However, when at work, I'd like to ""mute"" all the messengers, but still keep the existing rules.

I currently use two profiles and switch between them. Nonetheless, I have to whitelist all my ""core"" apps in both lists, what is a little annoying. A very basic inheritance would allow to overwrite any setting by a second profile - so when whitelisting, all apps, that have not been whitelisted could be added. Or when blacklisting, all apps not yet blacklisted would be blocked.

Maybe I'll find some time over the holidays to look at the code myself, but I am not used to android development at the moment. So it might take a while and if someone else was interested and faster in development, I would appreciate it ;-)
"
ukanth/afwall,closed,Todo update,[],"Upgraded the todo roadmap to mention known problems and show what we already got fixed
"
ukanth/afwall,closed,Afwall+ not working on dependably on marshmallow with different root method,"[Label(name=""Bug"")]","I've got a nexus 6 running omnirom 6.0.1 that was rooted differently than Chainfire's method.  I'm using an opensource root method, detailed here: http://forum.xda-developers.com/nexus-6/general/root-t3231211

Afwall+ installs correctly.  I'm able to enable/disable firewall rules, and things work for a while.  However, after some time passes, things start to malfunction.  For example, apps that are allowed wifi access can no longer access the internet.  If I disable Afwall+ and then reenable it, the app's internet access starts working again.  This is happening with multiple apps.

I'm not sure if this is an Afwall+ issue, or a marshmallow issue, or something related to the root method I've used (but my other apps that require root are working fine).

Please let me know if I can offer any assistance.
Thanks.
"
ukanth/afwall,closed,vpn control ,"[Label(name=""NoInfo"")]","perhaps it should be noted somewhere that unless you explicitly enable vpn control - all apps are permitted by default to use vpn connection, even if only ""whitelisted are enabled"". 
example : app is enabled only for lan, but when vpn is enabled on wifi - it can reach google.com without problems. 

afwall 2.1.3
"
ukanth/afwall,closed,FTP clients failing to work with afwall enabled,"[Label(name=""NoInfo"")]","Hello!

Thank you for this great app!

I would like to share, that with afwall enabled (One plus one, latest rooted cyanogen os -- if that matters) ftp apps fail to work correctly. This happens when they are allowed to access the internet and the firewall is enabled.

I'm using this: https://f-droid.org/repository/browse/?fdid=be.ppareit.swiftp_free

Also tried this:
https://f-droid.org/repository/browse/?fdfilter=simple+ftp&fdid=org.primftpd

The symptoms are the following:
Login works, but file transfers behave weird, they are getting not 100% up/downloaded, or they are unable to  rename from ""foobar.part"" to ""foobar"".  Or random permission denied errors popping up.

With the firewall disabled all works fine. Strange uh?

So please check it out if you can, let me know if i can help in debugging!

Thank you very much!
"
ukanth/afwall,closed,"request - add possibility to set ""table & proxy traffic""","[Label(name=""NoInfo""), Label(name=""Wont-Fix"")]","add possibility to set proxy & possibility to select this proxy for app to use it or bypass :) 
"
ukanth/afwall,closed,IPv6 support is not adequate,"[Label(name=""Review"")]","Using F-Droid's version 2.1.1

If ""IPv6 support"" checkbox is checked,
- Policy of OUTPUT chain gets changed from ACCEPT to DROP without any accompanying ""ACCEPT"" rules;
- AWwall's ""awwall"" chain is empty in ip6tables
- ""Enable Firewall"" don't change to ""Disable Firewall"" whan I click it.
- No error messages are shown
- Maybe IPv4 support gets mangled along the way.

And a nitpick:
- ""IPv6 support"" checkbox is in ""User interface"" page, yet does not affect user interface in any way.

Related to #347?
"
ukanth/afwall,closed,2.1.2 on F-Droid?,"[Label(name=""General"")]","""We can't build this version: The build for this version was manually disabled. Reason: iptables C preprocessor /lib/cpp sanity check fails""
Version 2.1.2 will be on F-Droid?
"
ukanth/afwall,open,Reject to all except LAN,"[Label(name=""Question"")]","There is a rule, when you're excluding everything except private LAN
`afwall-wifi-wan all -- anywhere !192.168.86.0/24`
I'm wondering if your intention wasn't `!{192.160.0.0/16,10.0.0.0/8,172.16.0.0/12}` being the set of all possible private networks. 

Do you distinguish between:
1. ALLOW app123 when connected to **my** LAN (meaning my ip is 192.168._86_.0/_24_)
2. ALLOW app123 if _destination_ is **my** LAN (dest addr is in 192.168._86_.0/_24_)
3. ALLOW app123 if _destination_ is **any** LAN (dest addr is in 192.168.0.0/**16**, 10.0.0.0/8)
"
ukanth/afwall,open,Priv-app,"[Label(name=""Feature"")]","The root usage icon in cyonogenmod still annoyed me so I installed AFwall as a system app. But it's still using the standard root access instead of system privilleges (like playstore does for example)
Could you guys make a small patch so that it uses system privilleges instead of standard su when it's installed as a system app?
Or, you might want to use: su, apply rules, exit.
So that the icon only appears briefly instead of persistently. As it is now, it does: su, apply rules. And so it's still in su/root mode causing cyanogemmod to show a # icon (""root is being used"" so to say)

Actually, both would be great!
An option in settings to install itself as system/privilleged app like f-droid would be great as well. (Again make sure not to use the standard root acces from that point on)

Thanks!
"
ukanth/afwall,closed,AFWall+ dosn't work for mobile data,"[Label(name=""Bug"")]","Hi,

AFWall+ dosn't work for mobile data. No connection will be blocked. Rules for WiFi are working fine.
I'm using a Galaxy S3 Mini with Android 4.2.2

Rules log can be found here: http://pastebin.com/axpHriQ1
"
ukanth/afwall,open,rules in afwall,"[Label(name=""Feature"")]","proxydroid & fiddler 

whe i use proxydroid there is not enought to enable it in white-list i need also enable app with root so its granting acces for unwanted apps !

cant  u  create options for ip:port white-list ?
"
ukanth/afwall,closed,"How to disable the ""afwall+ blocked:..."" notifications ",[],"Hi, 
Before posting, I performed a search in the issues list, but couldn't find anything. 
Is there any way to disable the ""afwall+ blocked:..."" notifications? 
Because they happen too often, and are very intrusive. 
Thanks 
"
ukanth/afwall,closed,Block all apps when reboot and have to apply rules manually,"[Label(name=""NoInfo"")]","When I reboot my phone, AFWall+ icon show in notification with this ""Firewall is running""  but all apps are blocked from internet. I have to open AFWall and apply rules manually.
I can't enable Log too, is there any alterlative way to know what connections have been blocked. Thanks 

I'm using Zenfone 5, Android 5.0
"
ukanth/afwall,closed,CM 12.1 random reboot problems,"[Label(name=""Review"")]","Hi there,

i have with my Sony Z1 Compact reboots, at least once a day. I don't know it it really has to do with afwall. But at some point i have to start digging.

At the reboot there are no kernel last_kmsg created, but  several thombstones. As mentioned, i don't
know it afwall crashed, because the device rebootet or reboot the device because afwall crashes.
So i want you to take a look at the debug output.

https://gist.github.com/Micha-Btz/332384b905e94185c1a0
https://gist.github.com/Micha-Btz/4a0e715db50349d0e9ee
https://gist.github.com/Micha-Btz/3bbb1103af2828051189
https://gist.github.com/Micha-Btz/880dc69ee696cd924a3b

Would be great if you can take a look, maybe the busybox is guilty.

Thanks Micha
"
ukanth/afwall,closed,Error applying firewall rules: click here to open settings.,"[Label(name=""Bug"")]","I get the above error message on boot. I have to manually open up the app and select ""Enable firewall""

I'm using a Nexus 5 with Android 6 installed.
"
ukanth/afwall,closed,Use tag v2.1.2 instead of V2.1.2,[],"Hi,

all previous Tags had a small ""v"" where 2.1.2 is now using a capital ""V"". This makes it hard on f-droid to detect new released versions of the app. Could it be possible to change the tag to v2.1.2 again and stay with the small "" v"" or are you planning to use the capital ""V"" now?
"
ukanth/afwall,closed,Root acces,"[Label(name=""General""), Label(name=""Wont-Fix"")]","On Cyanogenmod, whenever root is being used a # symbol is visible on the notification bar.
Whenever an app performs a root action it should acces root, do it's thing and quit root acces again. 
Afwall however keeps root acces even after applying the rules. I need to manually close the app for the # symbol to dissapear.
Now, afwall also starts by itself every now and then aswell as on startup. 

Besides the fact that the 'root is beging used' # symbol is rather annoying to have permanently on the status bar. It shouldn't, after applying rules it should quit root access. (Perhaps for security reasons aswell)
"
ukanth/afwall,closed,AFwall on stock Gingerbread logging error + error applying iptables rules,"[Label(name=""Wont-Fix"")]","AFwall for Gingerbread versions 1.2.8 and 1.3.4.1 (which I understand was the last version to support GB),

I'm running stock Gingerbread 2.3.6 with the stock kernel 2.6.35.7 My device is rooted and AFwall has su permisions.

I've tried both the above versions of AFwall but neither are working properly:

(1) The (stock) kernel is reported as not supporting logging?
(2) There is an ""error applying iptables rules"" but without a log I can't investigate further; and
(3) ""something"" is happening because after the above error message, no apps are allowed to use my data connetion - it goes dead and my phone needs a restart.

Would it assist if I compled a version from source (have not done that before, but could give it a go).
"
ukanth/afwall,closed,Google Contacts & more,[],"Running Resurrection Remix 5.1.1 with the latest AFWall+ and SuperSU 2.49 (with granted access to AFWall+).
Couldn't find an issue representing mine, so there you go.

I can setup the filters for user apps just fine, but Google Contacts synching (which I want to allow) I cannot seem to setup right. I select it in the list, it gets shuffled upwards just fine, still showing selected (thus whitelisted). But if I refresh the list (drag down), the selection is gone again and Google Contacts remains blocked.

Edit (12:33): Seems to be all the yellow colored item I can't edit. Is this a rights/security issue?
"
ukanth/afwall,closed,"AFWall 2.1.1 - UI Preference, Active Rules toggle bug","[Label(name=""Review"")]","I'm on Android 5.1.1 (though android version probably doesn't matter on this UI bug)

Anyways, in AFWall+ 2.1.1, ...

Setup:
1) Head into Preferences > User Interface
2) If _Active Rules_ checkbox is not enabled, set to CHECKED
3) Set _LAN Control_ to CHECKED
4) Exit Preferences.
Result: 3 checkboxes show on main UI.

Reproduce bug:
1) Head into Preferences > User Interface
2) Uncheck _Active Rules_...  _Roaming Control, *LAN Control_, _VPN Control_ should grey out
3) Check _Active Rules_... whatever was previously checked should show checked
4) Exit Preferences
Result: only 2 checkboxes show on main UI.

If you head back into preferences, the remaining checkboxes are not selected under _Active Rules_

It appears that when toggling Active Rules, the displayed UI indicates the dependent checkboxes are checked, when in fact they are not checked.

This bug could apply to other dependent checkboxes, though I haven't verified yet.
"
ukanth/afwall,closed,About.html update to fix #443,[],"Fix links are not working
"
ukanth/afwall,closed,Update faq.html,[],"Small cosmetic change
"
ukanth/afwall,closed,frequent 'toast' messages from SuperSU,"[Label(name=""Duplicate"")]","I'm not sure whether I have V2.1.1 or V 2.1.2 

I did not notice previous versions generating 'toast' messages from SuperSU, but this version makes one every few minutes. 

I am using 3G & signal strength/quality seems to make little difference. 
"
ukanth/afwall,closed,'About' box links not working,[],"I'm not sure which version - 'About' & 'app backup & restore' report V2.1.1 but 'Play Store' reports V2.1.2 

The green links in the 'menu>Help>About' page do nothing. 
"
ukanth/afwall,closed,[INFO] Android 6.0 Marshmallow + SuperSU 2.50 - 2.52 Beta+ READ THIS FIRST!,[],"Chainfire just released a new SU version which official supports now the final Android 6 versions. This need some changes on the data partitions (if this was encrypted) and the boot.img. Ensure before you flash the new SU that you [read his post](http://forum.xda-developers.com/apps/supersu/wip-android-6-0-marshmellow-t3219344%5B/url). A basic root guide can be found over [here](http://www.theandroidsoul.com/mra58k-root-for-android-6-0-marshmallow-update-84711).

[Changelog](http://forum.xda-developers.com/showpost.php?p=23427824&postcount=3):

```
10.10.2015 - v2.52 - BETA
- Adjusted more policies for M
- Fixed an issue with reading logs on M
- Reworked --context/--cn parameter (testing, currently M only, 
should eventually move to all APIs)

08.10.2015 - v2.51 - BETA
- Add support for x86 PIE binaries

06.10.2015 - v2.50 - BETA
- Fixed tapjacking protection not working < 4.4.3 (AOSP issue 54193)
- Updated libsupol headers
- armv5/x86 binaries now NDK built instead of AOSP
- supolicy adjustments for Samsung 5.1.1
- Removed extra donation feature
- Toybox support
```

Rooting procedure:

```
- flash/upgrade to Marshmellow
- flash modified boot.img
- flash/boot TWRP and sideload latest v2.50+
- install AFWall+ and report back 
```

``` bash
# Pushes the sepilicies to tmp
adb push sepolicy /data/local/tmp/sepolicy
# Replace/Install and chmod the new sepolicy
adb shell su -c ""supolicy --file /data/local/tmp/sepolicy /data/local/tmp/sepolicy_out""
adb shell su -c ""chmod 0644 /data/local/tmp/sepolicy_out""
adb pull /data/local/tmp/sepolicy_out sepolicy_out
```

Official Download:
http://download.chainfire.eu/743/SuperSU/BETA-SuperSU-v2.52.zip

The boot images can be found on the mentioned post as attachment. 

Currently AFWall+ not official supports Android 6, so please if you like to report bugs do this over here and don't forget to provide as much information as possible. In my tests it seems to work very well with the original AOSP images and chainfires boot.img. 

Also note BusyBox is not yet read for 6 due several internal changes that must be done first. So it's possible that you will receive a lot of 'SU' spam. 

**If no one reported bigger troubles I will automatically close this issue.**
"
ukanth/afwall,closed,Mobile data connection icon dissappears unless a particular item containing many subcomponents is allowed.,"[Label(name=""Review"")]","Mobile data connection icon dissappears unless a particular item containing many subcomponents is allowed.. That item is

""Setup Wizard, Android System, CyanogenMod System, MotoDoze, Settings Storage, Input Devices, Phone, Key Chain, CM Settings Storage, Settings, FM Radio, Fused Location, Dev Tools""

![screenshot_2015-10-05-02-00-33](https://cloud.githubusercontent.com/assets/14972114/10273928/aabe0508-6b05-11e5-9359-ebb0c14b58d1.png)

NOTE: CANNOT ATTACH TEXT FILES - HAD TO RENAME LOG FILES WITH PNG EXTENSION.  RENAME ATTACHED LOG FILES WITH TXT EXTENSION

Log files LOG AFWallX01-2015-10-05-01-50-37 and LOG AFWallX01-iptables are from a mobile data connection made under whitelist mode with all items un-checked. Mobile data connection icon briefly appears then disappears. 

![log afwallx01-2015-10-05-01-50-37](https://cloud.githubusercontent.com/assets/14972114/10274085/a5530bac-6b07-11e5-9887-44b60ffaa6c4.png)

![log afwallx01-iptables](https://cloud.githubusercontent.com/assets/14972114/10274086/a89c375c-6b07-11e5-9889-fc2c929b0bf7.png)

Log file AFWallX02-2015-10-05-01-57-48 is from a a mobile data connection under whitelist with only the aforementioned mega-item checked. In this case the mobile data icon displays properly.

![log afwallx02-2015-10-05-01-57-48](https://cloud.githubusercontent.com/assets/14972114/10274128/232b8004-6b08-11e5-9ce4-e2a25494a80f.png)

RENAME ATTATCHED LOG FILES WITH TXT EXTENTION
"
ukanth/afwall,closed,connection not blocked,"[Label(name=""Review"")]","I've blocked all apps. After a reboot I'm seeing this in netstat.

```
 $ netstat
Proto Recv-Q Send-Q Local Address          Foreign Address        State
tcp6       0      0 ::ffff:192.168.1.2:39201 ::ffff:216.58.213.14:80 ESTABLISHED
```
"
ukanth/afwall,closed,[regression] White/black list mode isn't changed on profile switching,"[Label(name=""Bug"")]","Just installed 2.1.1 from F-Droid.
I found that on profile change the Mode doesn't change visually.
I.e. I have one profile in White list mode and another in Black list mode. So they aren't changed on Profile switch. Although if I hide then show the AFW, it shows the mode correctly. And firewall works correctly.
"
ukanth/afwall,open,Failure reasons?,"[Label(name=""Feature""), Label(name=""High"")]","On devices that don't support ipv6, it fails if ipv6 is enabled. When a failure occurs, please give a reason if it's possible to do so; I had ipv6 enabled for several months with no problems, then either Cyanogenmod or afwall+ got updated and it stopped working (or maybe stopped silently falling, since I never actually tested it)

In any case, rather than just showing a generic toast when it fails to set rules, it would be nice for the toast to say which part failed.

Probably-irrelevant-details: I'm on cm12 nightlies, with beta version of afwall+ (via g+ group), nexus 7 2013/flo.
"
ukanth/afwall,closed,Merge changes to Master.,[],
ukanth/afwall,closed,Expand LAN control to specify multiple ranges.,"[Label(name=""Duplicate"")]","Need the ability to specify multiple IP ranges to be defined as ""LAN"". I'm a weird niche case that has a phone on one vlan and would like to interact with it from a different vlan. Would be nice to have this ability.
"
ukanth/afwall,closed,Zoom level not saved,"[Label(name=""Feature""), Label(name=""Low"")]","Changing zoom level falls back to standard size once the view has been left. The app should store the users setting instead. 
Even better would be a simple option (font size) in preferences menu for log/rules font size.
"
ukanth/afwall,closed,Update README.md,[],"Fix for c24a3ff3abb34eac24942684ed3093bf1d721f5d
"
ukanth/afwall,open,AFWall+ cracked apk's and donations key leaked on the web,"[Label(name=""General"")]","I just wanted everyone to know that there are several 'cracked' AFWall+ releases on _popular_ warez sites available. **I also reported 1502 warez site to Google, Microsoft, Spamhaus, various domain registrars and Apple, with links, IP's, host names and other records so that they can't just create sub-domains if you get the shutdown.** - because I know crackers monitoring Github, you'll be warned! 

If you accidentally downloaded or used such apk's please remove it. To use security products which may be infected or manipulated isn't a good idea. Of course it's also _bad_ to not pay for a small app that really helps. Such releases also may contain malware or are manipulated to redirect the traffic, if you're unsure and you generally download your apk's from such places ensure the sha1 is correct (if you just mirrored the original apk). 

So since I know that the Google Play Store 'protection' is very ineffective and can be bypassed by several 'tools/apks' I ask here how to preventing this?! After some research I've found out that the UnbelovedHosts developer ([defim](http://forum.xda-developers.com/member.php?s=6db3c4348fec5e6617b097788955a4f0&u=4501300)) added an extra protection (that wasn't cracked [yet?]). So I suggest that we maybe contact him and asking him to integrate such protection into the donate key [which will not be open sourced]. Defim seems _the only one_ which integrated an _signature verification_ check, if that is broken/down or manipulated the apps will not be working. Sounds good to me. 

What do you think @ukanth?

**Edit**: I contacted defim via XDA email and asked him in your name ukanth (I hope this wasn't wrong), maybe he will answer me or you (I only can hope!). 
"
ukanth/afwall,closed,Known Widget problems on AFWall+ 2.x+,"[Label(name=""Bug"")]","These are the widget _bugs_ and _glitches_ in AFWall+ on the final 2.0 version.

Reproducible it via:
- Rom doesn't matter it's a software bug.
- Place all three available widgets on the screen.
- Clean install AFWall+ (also wipe all data if present) and not set anything in any preferences. 

1) The widget that shows a quick toggle (the round one to the left on the first screenshot) will always tell something about that the configuration is locked if we're pressing the enable/disable buttons. This is a logic failure since nothing was set (only on clean installation). A workaround is to set 'none' under the preferences, so this will be again accessible. 
2) The two widgets with the question mark in it doesn't allow to lose the focus on touching on an empty field. You must press the return hardware key. 
3) The mentioned widget from 1) isn't on center. The other one is always on center (which seems okay).
4) Widget from 1) isn't displayed correctly since different languages not fit with this. 
5) Reboot you're device and you notice that the two question mark widgets are present, the quick toggle widget needs some time to get the status and is only visible AFTER that. On slower devices you see nothing until it's calculated and it will be visible after all is done. On faster devices this is around ~1 second.
6) The two widgets that contains the question mark are a bit _confusing_, well not for me but they look exactly the same. So I suggest (if someone have an idea, to make a better ones). Maybe the configuration one with a wheel or something that will be seen as 'preferences' and the other one, I don't know ... surprise me. 
7) Possible #424 bug during profile names and not centered display messages. Only with multiple profiles. See 7) for screenshots.
8) The status icon (the small one from 1.) doesn't always show the correct status. This is on some rare conditions, like if you're changed directly the status from e.g. enabled -> to disabled or such.

![screenshot_2015-09-23-13-56-21](https://cloud.githubusercontent.com/assets/727123/10044477/aa75127a-61fb-11e5-976e-1e555b73a7ed.png)
![screenshot_2015-09-23-13-56-54](https://cloud.githubusercontent.com/assets/727123/10044481/ae7c3934-61fb-11e5-8282-64cbb75bbe34.png)

7) [Screenshots original by nutpantz, thanks for reporting]
![1b5dcc00-61cc-11e5-82d2-3aa3084be120](https://cloud.githubusercontent.com/assets/727123/10049849/b93248dc-6219-11e5-864b-5ae28a228791.png)
![5c37a610-61cc-11e5-8242-d7d9bdcbe4cd](https://cloud.githubusercontent.com/assets/727123/10049856/bf5f7ed2-6219-11e5-870e-1957e3aace11.png)
![7b4b4ad4-61cc-11e5-8426-8df6b608cba3](https://cloud.githubusercontent.com/assets/727123/10049862/c547d61e-6219-11e5-8bd4-b9803fcbe1e5.png)
"
ukanth/afwall,open,Provide handy variables to custom scripts,"[Label(name=""Feature""), Label(name=""Low"")]","Hello, I am suggesting to provide some handy variables to custom scripts.

Like ""$IPTABLES"" we could make use of a ""$LAN_IP"" that correspond to the current lan range, ""$LAN_IPV6"" (same for IPv6, not local link) ""$CURRENT_PROFILE"" to gives current AFwall profile ID or name.

Yes, I know IPv6 are internet routable, but you may still want to do stuff specific to the range you own, like deny port 22 if IPv6 isn't from your range.
"
ukanth/afwall,open,Allow background data control,"[Label(name=""Review"")]","It would be great if it were possible to create profiles which also affect an apps ability to use background data.

When I am on certain Wi-Fi networks, I want to whitelist only one or two apps to be able to use background data.  I can use tasker to switch profiles, but the problem is that.AFWall+ doesn't currently seem to have fine grained control over background data usage.
"
ukanth/afwall,closed,Refresh screenshot on readme,[],"Replace old screenshot by screenshot from the latest version of AFwall to reflect GUI change that was made, based on Play Store's provided screenshot
"
ukanth/afwall,open,"Feature request : ""add/remove from to notification filter list"" from firewall log","[Label(name=""Feature""), Label(name=""Low"")]","Hi,

I have been a long time user of AFWall, which is one of the first app I install on every device I can get my hands on. Thanks a lot ! ;-)

I use firewall logging and notification to monitor apps trying access the network, which are both handy features. So far, after I've blocked an app, I add it to the notification filter so that it doesn't bug me (Recurring offenders are KDE Connect (for the moment), SD Maid, and SwiftKey).

However, it would be quicker to do it from the firewall log screen : long-pressing on a row could display an ""add to notification filter list"", so that one doesn't have to go to another screen to add it.
And for already filtered-out apps, long-pressing could display a ""remove from notification filter list"" (also, a small icon could be used to distinguish filtered from non-filtered apps).
"
ukanth/afwall,closed,[2.0.0]Physical menu button doesn't open menu,"[Label(name=""Bug"")]","Pressing the physical menu button doesn't open the menu as it did on previous stable release

```

--------- beginning of /dev/log/main
D/JuiceSSH/ConnectionManagerService(32536): Polling 1 connections for failures
D/JuiceSSH/ConnectionManagerService(32536): Polling 1 connections for failures
D/JuiceSSH/ConnectionManagerService(32536): Polling 1 connections for failures
I/XPrivacy(  541): Get service 1000/Srv_queryIntentActivities(null;null) system=!restricted? (mcached) 3 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted 6 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 1 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy(  541): Get service 1000/Srv_getRecentTasks(null;null) system=!restricted? (mcached) 1 ms
I/XPrivacy/XActivityManager(  541): Get client 1000/Srv_getRecentTasks(null;null) system=!restricted 2 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
D/dalvikvm(  541): GC_FOR_ALLOC freed 2016K, 12% free 21708K/24656K, paused 110ms, total 110ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 1 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
D/JuiceSSH/ConnectionManagerService(32536): Polling 1 connections for failures
--------- beginning of /dev/log/system
W/InputMethodManagerService(  541): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@42fbeaa0 attribute=null, token = android.os.BinderProxy@43194800
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted (cached) 0 ms
I/ActivityManager(  541): START u0 {act=android.intent.action.MAIN cat=[android.intent.category.HOME] flg=0x10200000 cmp=com.cyanogenmod.trebuchet/com.android.launcher3.Launcher} from pid 541
D/JuiceSSH/TransportChain(32536): Transport chain 2000 is now unattached
D/JuiceSSH/LocalTransport(32536): Sending SIGSTOP signal to process
I/XPrivacy(  541): Get service 1000/Srv_queryIntentReceivers(null;null) system=!restricted? (mcached) 1 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentReceivers(null;null) system=!restricted 1 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentReceivers(null;null) system=!restricted (cached) 0 ms
D/dalvikvm(32348): GC_CONCURRENT freed 393K, 8% free 8188K/8868K, paused 8ms+2ms, total 63ms
D/NvOsDebugPrintf( 1229): egl.cfg not found, using default config
I/XPrivacy(  541): Get service 1000/Srv_queryIntentServices(null;null) system=!restricted? (mcached) 2 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentServices(null;null) system=!restricted 2 ms
I/XPrivacy(  541): Get service 10117/Srv_getPackageInfo(com.cyanogenmod.trebuchet;null) system=!restricted? (mcached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 10117/Srv_getPackageInfo(com.cyanogenmod.trebuchet;null) system=!restricted 2 ms
I/XPrivacy(  541): Get setting uid=0 /SafeMode=false 0 ms
I/XPrivacy(  541): Get service 10117/Configuration.MCC(null;null) phone=!restricted? (mcached) 1 ms
I/XPrivacy/XResources(32348): Get client 10117/Configuration.MCC(null;null) phone=restricted 3 ms
I/XPrivacy(32348): Get setting uid=10117 /MCC=001 1 ms
I/XPrivacy(  541): Get service 10117/Configuration.MNC(null;null) phone=!restricted? (mcached) 1 ms
I/XPrivacy/XResources(32348): Get client 10117/Configuration.MNC(null;null) phone=restricted 1 ms
I/XPrivacy(32348): Get setting uid=10117 /MNC=01 1 ms
I/XPrivacy/XResources(32348): Get client 10117/Configuration.MCC(null;null) phone=restricted (cached) 0 ms
I/XPrivacy/XResources(32348): Get client 10117/Configuration.MNC(null;null) phone=restricted (cached) 0 ms
I/XPrivacy(  541): Get service 10117/sh(sh;null) shell=!restricted? (mcached) 1 ms
I/XPrivacy/XRuntime(32348): Get client 10117/sh(sh;null) shell=!restricted 5 ms
I/XPrivacy/XRuntime(32348): Get client 10117/sh(sh;null) shell=!restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/sh(sh;null) shell=!restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/sh(sh;null) shell=!restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/sh(sh;null) shell=!restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/sh(sh;null) shell=!restricted (cached) 0 ms
I/XPrivacy(  541): Get service 10117/su(su;null) shell=!restricted? (mcached) 1 ms
I/XPrivacy/XRuntime(32348): Get client 10117/su(su;null) shell=!restricted 10 ms
I/XPrivacy/XRuntime(32348): Get client 10117/su(su;null) shell=!restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/su(su;null) shell=!restricted (cached) 0 ms
D/dalvikvm( 1229): GC_FOR_ALLOC freed 1642K, 11% free 18509K/20692K, paused 58ms, total 58ms
W/IInputConnectionWrapper(32536): showStatusIcon on inactive InputConnection
D/dalvikvm( 1229): GC_CONCURRENT freed 255K, 12% free 18330K/20692K, paused 3ms+6ms, total 81ms
D/JuiceSSH/ConnectionManagerService(32536): Polling 1 connections for failures
V/RenderScript( 1229): 0x6189dd10 Launching thread(s), CPUs 2
I/Choreographer( 1229): Skipped 33 frames!  The application may be doing too much work on its main thread.
D/dalvikvm(  541): GC_FOR_ALLOC freed 1340K, 13% free 21648K/24656K, paused 102ms, total 102ms
I/XPrivacy/XPackageManager(  541): Get client 10011/Srv_queryIntentActivities(null;null) system=!restricted 1 ms
I/ActivityManager(  541): START u0 {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=dev.ukanth.ufirewall.donate/dev.ukanth.ufirewall.MainActivity} from pid 1229
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentReceivers(null;null) system=!restricted (cached) 0 ms
W/BroadcastQueue(  541): Permission Denial: broadcasting Intent { act=com.android.launcher3.action.LAUNCH flg=0x10 (has extras) } from com.cyanogenmod.trebuchet (pid=1229, uid=10011) requires com.google.android.launcher.permission.RECEIVE_LAUNCH_BROADCASTS due to receiver com.google.android.googlequicksearchbox/com.google.android.search.core.icingsync.ApplicationLaunchReceiver
W/BroadcastQueue(  541): Permission Denial: receiving Intent { act=com.android.launcher3.action.LAUNCH flg=0x10 (has extras) } to com.google.android.googlequicksearchbox/com.google.android.search.core.icingsync.ApplicationLaunchReceiver requires com.android.launcher3.permission.RECEIVE_LAUNCH_BROADCASTS due to sender com.cyanogenmod.trebuchet (uid 10011)
I/XPrivacy/XResources( 2060): Get client 10065/Configuration.MCC(null;null) phone=!restricted 1 ms
I/XPrivacy/XResources( 2060): Get client 10065/Configuration.MNC(null;null) phone=!restricted 1 ms
I/XPrivacy/XResources( 2060): Get client 10065/Configuration.MCC(null;null) phone=!restricted (cached) 0 ms
I/XPrivacy/XResources( 2060): Get client 10065/Configuration.MNC(null;null) phone=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentReceivers(null;null) system=!restricted (cached) 0 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentServices(null;null) system=!restricted (cached) 0 ms
I/XPrivacy(  541): Get service 10117/Srv_getPackageInfo(dev.ukanth.ufirewall.donate;null) system=!restricted? (mcached) 1 ms
I/XPrivacy/XPackageManager(  541): Get client 10117/Srv_getPackageInfo(dev.ukanth.ufirewall.donate;null) system=!restricted 1 ms
I/XPrivacy/XResources(32348): Get client 10117/Configuration.MCC(null;null) phone=restricted (cached) 0 ms
I/XPrivacy/XResources(32348): Get client 10117/Configuration.MNC(null;null) phone=restricted (cached) 0 ms
I/XPrivacy/XResources(32348): Get client 10117/Configuration.MCC(null;null) phone=restricted (cached) 0 ms
I/XPrivacy/XResources(32348): Get client 10117/Configuration.MNC(null;null) phone=restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/sh(sh;null) shell=!restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/sh(sh;null) shell=!restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/sh(sh;null) shell=!restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/sh(sh;null) shell=!restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/sh(sh;null) shell=!restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/sh(sh;null) shell=!restricted (cached) 0 ms
D/dalvikvm(32348): GC_CONCURRENT freed 395K, 8% free 8181K/8868K, paused 3ms+2ms, total 62ms
I/XPrivacy/XRuntime(32348): Get client 10117/su(su;null) shell=!restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/su(su;null) shell=!restricted (cached) 0 ms
I/XPrivacy/XRuntime(32348): Get client 10117/su(su;null) shell=!restricted (cached) 0 ms
I/Choreographer( 2060): Skipped 82 frames!  The application may be doing too much work on its main thread.
W/InputMethodManagerService(  541): Starting input on non-focused client com.android.internal.view.IInputMethodClient$Stub$Proxy@4318ea60 (uid=10011 pid=1229)
E/rsC++   ( 1229): RS Message thread exiting.
D/dalvikvm( 2060): GC_CONCURRENT freed 1252K, 15% free 10422K/12220K, paused 7ms+7ms, total 107ms
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10388426, downTime=10388426, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10388550, downTime=10388426, deviceId=3, source=0x101 }
I/XPrivacy(  541): Get setting uid=0 /PermMan=false 0 ms
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10388819, downTime=10388819, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10388923, downTime=10388819, deviceId=3, source=0x101 }
D/JuiceSSH/ConnectionManagerService(32536): Polling 1 connections for failures
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10389283, downTime=10389283, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10389343, downTime=10389283, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10389470, downTime=10389470, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10389536, downTime=10389470, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10389648, downTime=10389648, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10389700, downTime=10389648, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10389802, downTime=10389802, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10389882, downTime=10389802, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10389957, downTime=10389957, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10390068, downTime=10389957, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10390351, downTime=10390351, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10390443, downTime=10390351, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10390530, downTime=10390530, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10390626, downTime=10390530, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10390709, downTime=10390709, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10390788, downTime=10390709, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10390888, downTime=10390888, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10390955, downTime=10390888, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10391058, downTime=10391058, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10391127, downTime=10391058, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10391224, downTime=10391224, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10391286, downTime=10391224, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10391373, downTime=10391373, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10391485, downTime=10391373, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10391810, downTime=10391810, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10391859, downTime=10391810, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10391973, downTime=10391973, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10392056, downTime=10391973, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10392157, downTime=10392157, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10392219, downTime=10392157, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10392315, downTime=10392315, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10392372, downTime=10392315, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10392655, downTime=10392655, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10392734, downTime=10392655, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_DOWN, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10392818, downTime=10392818, deviceId=3, source=0x101 }
D/KeyActions(  541): execute: KeyEvent { action=ACTION_UP, keyCode=KEYCODE_MENU, scanCode=139, metaState=0, flags=0x8, repeatCount=0, eventTime=10392933, downTime=10392818, deviceId=3, source=0x101 }
D/JuiceSSH/ConnectionManagerService(32536): Polling 1 connections for failures
D/dalvikvm( 1057): GC_CONCURRENT freed 865K, 25% free 11990K/15848K, paused 8ms+7ms, total 86ms
V/PanelView( 1057): animationTick called with dtms=0; nothing to do (h=190.34775 v=983.9153)
I/XPrivacy(  541): Get service 1000/Srv_queryIntentActivities(null;null) system=!restricted? (mcached) 1 ms
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentActivities(null;null) system=!restricted 2 ms
I/XPrivacy(  541): Get setting uid=0 /IntentWall=false 0 ms
I/ActivityManager(  541): START u0 {act=do-not-cache1442435238271 dat=ssh://2000/disconnect flg=0x58000000 cmp=com.sonelli.juicessh/.activities.TerminalEmulatorActivity bnds=[104,153][536,201] (has extras)} from pid -1
V/PanelView( 1057): animationTick called with dtms=0; nothing to do (h=351.0 v=-2000.0)
V/JuiceSSH/BootReceiver(32536): Scheduling background services
I/XPrivacy/XPackageManager(  541): Get client 1000/Srv_queryIntentReceivers(null;null) system=!restricted (cached) 0 ms
W/ResourceType(32536): CREATING STRING CACHE OF 60 bytes
D/JuiceSSH/ConnectionIntentParser(32536): Got a URL: ssh://2000/disconnect
I/WindowManager(  541): Screenshot max retries 4 of Token{433d5ab8 ActivityRecord{433142c0 u0 com.sonelli.juicessh/.activities.TerminalEmulatorActivity t27 f}} appWin=Window{4342ba78 u0 Starting com.sonelli.juicessh} drawState=4
V/JuiceSSH/ConnectionManager(32536): Bound to ConnectionManager service and processing recent ServiceRequests
V/JuiceSSH/ConnectionManager(32536): Bound to ConnectionManager to process pending requests
V/JuiceSSH/ConnectionManager(32536): Processing 0 REGISTERS.
```
"
ukanth/afwall,closed,Fields that got ticked are not shown after app restart,[],"He

I encountered a strange behaviour of your application. I installed it the first time a second ago. I started it up and then began to create the rules ticking the boxes next to each of the listed entries. After that I saved everything and closed the app. I opened it a second time and the selections that I made before were gone. Altough I think the rules are still there and work the ticks do not show up.
Any idea?

All the best
"
ukanth/afwall,open,Doesn't update the list of installed apps,"[Label(name=""Review"")]","For about a two weeks or so, new installed apps haven't been visible in AfWall+. The issue might have started after I enabled ""fix startup data leak"" (now disabled; my HTC One M7 has never been ""S-OFF"") in the experimental settings.
I may have to do a complete reinstall. Manual "" reload"" doesn't solve the problem.

-CyanogenMod 12.1, HTC One M7
AFWall+ 2.0 alpha 2
"
ukanth/afwall,closed,widget is off center and partly cut off,[],"I have a mega i527m running the latest nova launcher  And the latest afwall donate
When using the widget it is off center to the right
And about 20% is cut of making it partly unusable.
If you need any more information you can contact me at my email
"
ukanth/afwall,closed,Multiuser doesn't work on Android 4.4.4,[],"Checking the ""multi user"" checkbox doesn't add any of secondary user UID to the chains.
# 
# IPv4 Rules

Chain INPUT (policy ACCEPT 3278 packets, 844K bytes)
 pkts bytes target     prot opt in     out     source               destination  
 102K  123M bw_INPUT   all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
 102K  123M fw_INPUT   all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 oem_fwd    all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
    0     0 fw_FORWARD  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
    0     0 bw_FORWARD  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
    0     0 natctrl_FORWARD  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
Chain OUTPUT (policy ACCEPT 1118 packets, 113K bytes)
 pkts bytes target     prot opt in     out     source               destination  
 1343  145K afwall     all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
69360 7073K oem_out    all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
69360 7073K fw_OUTPUT  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
69360 7073K bw_OUTPUT  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
Chain afwall (1 references)
 pkts bytes target     prot opt in     out     source               destination  
 1027  102K RETURN     all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            state ESTABLISHED
    0     0 afwall-vpn  all  --  \*      tun+    0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-vpn  all  --  \*      ppp+    0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-vpn  all  --  \*      tap+    0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-vpn  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0           [goto]  mark match 0x3c/0xfffc
    0     0 afwall-vpn  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0           [goto]  mark match 0x40/0xfff8
    0     0 afwall-wifi  all  --  \*      eth+    0.0.0.0/0            0.0.0.0/0  
  227 19323 afwall-wifi  all  --  \*      wlan+   0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-wifi  all  --  \*      tiwlan+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-wifi  all  --  \*      ra+     0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-wifi  all  --  \*      bnep+   0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      rmnet+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      pdp+    0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      uwbr+   0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      wimax+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      vsnet+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      rmnet_sdio+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      ccmni+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      qmi+    0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      svnet0+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      ccemni+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      rmnet_usb+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      wwan+   0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      cdma_rmnet+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      usb+    0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      rmnet_usb+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      clat4+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      cc2mni+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      bond1+  0.0.0.0/0            0.0.0.0/0  
    0     0 afwall-3g  all  --  \*      rmnet_smux+  0.0.0.0/0            0.0.0.0/0  
Chain afwall-3g (19 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 afwall-3g-postcustom  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
Chain afwall-3g-fork (2 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 afwall-3g-home  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
Chain afwall-3g-home (1 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10049
Chain afwall-3g-postcustom (1 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 afwall-3g-fork  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
Chain afwall-3g-roam (0 references)
 pkts bytes target     prot opt in     out     source               destination  
Chain afwall-3g-tether (0 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 afwall-3g-fork  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
Chain afwall-reject (66 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 LOG        all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            limit: avg 1000/min burst 5 LOG flags 8 level 4 prefix ""{AFL}""
    0     0 REJECT     all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable
Chain afwall-vpn (5 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10027
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10031
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10049
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10050
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10113
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10129
Chain afwall-wifi (5 references)
 pkts bytes target     prot opt in     out     source               destination  
  227 19323 afwall-wifi-postcustom  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
Chain afwall-wifi-fork (2 references)
 pkts bytes target     prot opt in     out     source               destination  
   98  6458 afwall-wifi-lan  all  --  \*      \*       0.0.0.0/0            192.168.150.0/24  
   20  1222 afwall-wifi-wan  all  --  \*      \*       0.0.0.0/0           !192.168.150.0/24  
Chain afwall-wifi-lan (1 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10001
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10002
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10015
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10018
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10019
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10020
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10022
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10027
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10029
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10031
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10033
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10037
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10041
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10047
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10050
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10051
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10053
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10054
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10058
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10061
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10062
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10064
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10069
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10070
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10073
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10074
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10075
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10076
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10081
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10090
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10093
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10095
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10096
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10099
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10105
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10109
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10111
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10112
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10113
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10114
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10115
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10116
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10124
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10129
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10130
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10132
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10135
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10137
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10140
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10141
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10142
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10143
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10144
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10145
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10146
Chain afwall-wifi-postcustom (1 references)
 pkts bytes target     prot opt in     out     source               destination  
  118  7680 afwall-wifi-fork  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
Chain afwall-wifi-tether (0 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 afwall-wifi-fork  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
Chain afwall-wifi-wan (1 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10027
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10031
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10049
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10129
Chain bw_FORWARD (1 references)
 pkts bytes target     prot opt in     out     source               destination  
Chain bw_INPUT (1 references)
 pkts bytes target     prot opt in     out     source               destination  
 5102 7239K            all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            ! quota globalAlert: 2097152 bytes 
98149  122M            all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner socket exists
Chain bw_OUTPUT (1 references)
 pkts bytes target     prot opt in     out     source               destination  
 2595  198K            all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            ! quota globalAlert: 2097152 bytes 
68560 6964K            all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner socket exists
Chain bw_costly_shared (0 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 bw_penalty_box  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
Chain bw_happy_box (0 references)
 pkts bytes target     prot opt in     out     source               destination  
Chain bw_penalty_box (1 references)
 pkts bytes target     prot opt in     out     source               destination  
Chain fw_FORWARD (1 references)
 pkts bytes target     prot opt in     out     source               destination  
Chain fw_INPUT (1 references)
 pkts bytes target     prot opt in     out     source               destination  
Chain fw_OUTPUT (1 references)
 pkts bytes target     prot opt in     out     source               destination  
Chain natctrl_FORWARD (1 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 DROP       all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
Chain natctrl_tether_counters (0 references)
 pkts bytes target     prot opt in     out     source               destination  
Chain oem_fwd (1 references)
 pkts bytes target     prot opt in     out     source               destination  
Chain oem_out (1 references)
 pkts bytes target     prot opt in     out     source               destination         
# 
# Network interfaces

lo: unknown
dummy0: unknown
tunl0: VPN
sit0: unknown
ip6tnl0: unknown
wlan0: wifi
# 
# ifconfig

dummy0    Link encap:Ethernet  HWaddr 22:6E:8A:D4:B4:5D  
          BROADCAST NOARP  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
ip6tnl0   Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          NOARP  MTU:1452  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:1457 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1457 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:353580 (345.2 KiB)  TX bytes:353580 (345.2 KiB)
sit0      Link encap:IPv6-in-IPv4  
          NOARP  MTU:1480  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
tunl0     Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          NOARP  MTU:1480  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
wlan0     Link encap:Ethernet  HWaddr ::censored::  
          inet addr:192.168.150.162  Bcast:192.168.150.255  Mask:255.255.255.0
          inet6 addr: ::censored:::3bf7:a70d/64 Scope:Global
          inet6 addr: ::censored:::fead:78b9/64 Scope:Global
          inet6 addr: fe80::646:65ff:fead:78b9/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:136965 errors:0 dropped:3922 overruns:0 frame:0
          TX packets:74246 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:163530926 (155.9 MiB)  TX bytes:8719115 (8.3 MiB)
# 
# System info

Android version: 4.4.4
Manufacturer: asus
Model: Transformer TF101
Build: KTU84Q KatKiss-4.4.4_035
Active interface: wifi
Tether status: no
Roam status: no
IPv4 subnet: 192.168.150.162/24
IPv6 subnet: fe80::646:65ff:fead:78b9/64
/system/bin/su: not present
/system/xbin/su: 75364 bytes
/system/app/Superuser.apk: not present
Superuser: eu.chainfire.supersu v2.46
# 
# Preferences

activeNotification: false
activeRules: true
appVersion: 15208
bb_path: system
disableIcons: false
disableTaskerToast: true
dns_value: auto
enableAdmin: true
enableConfirm: true
enableIPv6: true
enableInbound: true
enableLAN: true
enableLog: true
enableLogService: false
enableRoam: false
enableVPN: true
fixLeak: false
hasRoot: true
ip_path: system
isRootAvail: true
locale: en
logTarget: LOG
multiUser: true
multiUserId: 0
notifyAppInstall: true
passSetting: p1
patternMax: 3
profilePwd: <censored>

pwdEncrypt: true
showFilter: true
showUid: false
sort: s0
storedPosition: 0
sysColor: -10432
# 
# Logcat

23:55:02 Starting root shell...
23:55:02 [libsuperuser] [SU%] START
23:55:03 Root shell is open
23:55:22 isWifiApEnabled is false
00:08:00 Now assuming NO connection (all interfaces down)
00:08:00 CONNECTIVITY_CHANGE: applied rules
00:08:07 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
01:31:09 isWifiApEnabled is false
01:31:09 Now assuming wifi connection
01:31:09 IPv4 LAN netmask on wlan0: 192.168.150.162/24
01:31:09 IPv6 LAN netmask on wlan0: fe80::646:65ff:fead:78b9/64
01:31:10 CONNECTIVITY_CHANGE: applied rules
01:31:14 isWifiApEnabled is false
01:31:14 CONNECTIVITY_CHANGE: interface state has not changed, ignoring
"
ukanth/afwall,closed,Merge change from BETA to v2.0.0,[],
ukanth/afwall,closed,The language selector and the auto language detector are broken,"[Label(name=""Review"")]","When you install for first time Afwall+ or try to change the application language in preferences menu, the language selector and/or the auto language detector don't work. The problems appears using Android 5.1.

Thank you.
"
ukanth/afwall,closed,[WARNING] !!!!!!!! Shadowsocks removed by China police !!!!!!!! ,[],"No, sorry this isn't a joke. Shadowsocks the firewall/SOCKS5 proxy which could bypass the Chinese firewall was just removed (over 10k stars!). GitHub shows now **Removed according to regulations.** The China police asked GitHub to delete it. 

The full story can be read over [here](https://www.reddit.com/r/programming/comments/3hy6f8/shadowsocks_a_socks5_proxy_with_9000_star_was/). 

**What is ShadowSocks?**
Shadowsocks is (was?) a popular SOCKS5 server & client that provides an encrypted tunnel to bypass firewalls/censorship. 
- https://github.com/shadowsocks/shadowsocks  (= server)
- https://github.com/shadowsocks/shadowsocks-windows   (= client for Windows)
- https://github.com/shadowsocks/shadowsocks-iOS   (= client for OS X & non-jailbroken iOS) 

Releases can however still be downloaded: 

Server written in Python, v2.8.2, released 2015-08-10
- https://github.com/shadowsocks/shadowsocks/releases 

Client for Windows, sources+binary, v2.5.6, released 2015-08-20
- https://github.com/shadowsocks/shadowsocks-windows/releases

Client for OS X & non-jailbroken iOS, sources+binary, v2.6.3, released 2015-03-06
- https://github.com/shadowsocks/shadowsocks-iOS/releases 

The Shadowsocks wiki, that contains documentation, is no longer accessible at its original URL: 
- http://github.com/shadowsocks/shadowsocks/wiki/ 

However, the Internet Archive has copies made in April 2015: 
- https://web.archive.org/web/20150418161913/https://github.com/shadowsocks/shadowsocks/wiki

Overall this is just another warning that GitHub censorship (same like China) and we may need to be more carefully what we post or commit over here. Overall this could be affect other projects too (NetSpark/OpenVPN/..). 

I personally see this as attack against our human rights and it's of course not funny why GitHub removed it instead of finding some compromises. 

This message will be automatically closed after some time.

Tags: firewall, shadowsocks, Chinese gov, Chinese, GitHub, socks5, proxy, VPN, iptables
"
ukanth/afwall,closed,about.html credits update,[],"small corrections and credits updates
"
ukanth/afwall,closed,faq.html updates,[],"added init.d FAQ to avoid troubles
cleanups and small changes, all checked against http://www.w3schools.com/html/tryit.asp?filename=tryhtml_intro
"
ukanth/afwall,closed,Problems with Android 5.x,[],"Hi!
I have problems with my Xperia Z1 with CM12.1.
With activated Afwall there are reconnection problems in my wlan. I have to delete and reenter the connection. Otherwise I get the exclamation mark next to the wlan symbol. With deactivated Afwall it works fine as expected. I use the 2.0 alpha version from f-droid. I had the same version and settings in Kitkat without problems.
Can anybody confirm this issue?
"
ukanth/afwall,closed,Material icons.,[],"some icons from https://materialdesignicons.com
"
ukanth/afwall,closed,"Can afwall have second ""non-root edition"" also, which firewalls without root (Even with some known limitations), if user wants so.","[Label(name=""Review"")]","At  https://github.com/ukanth/afwall/wiki/Similar-Firewall-solutions , you have mentioned ""limitations of Non-root Android Firewalls"", but still many people are very happy to use ""non root"" firewall and their usecase is satisfied with those non-root firwall apps and these non-root firewall apps are heavily popular.

Here are four non-root firewall apps:
https://play.google.com/store/apps/details?id=com.lostnet.fw.free&hl=en     ( LostNet NoRoot Firewall )
https://play.google.com/store/apps/details?id=com.jianjia.firewall
https://play.google.com/store/apps/details?id=com.netspark.firewall
https://play.google.com/store/apps/details?id=app.greyshirts.firewall

**All these are ""closed source"" non-root firewall apps.** There is not a single non-root firewall app, which is open source.

---

afwall already has rooted firewall app edition
Now my feature request is that, **can the ""open source"" afwall have a second edition , which works as non-root (even with some known limitations as stated by you)""** That will be really great.
"
ukanth/afwall,closed,"I need add a fire wall in my app,how can do .",[],"some rules i get it from server,so i can not use this .
"
ukanth/afwall,closed,ITFS_3G duplicate removed,[],"duplicate removed
"
ukanth/afwall,closed,Fix afwallstart holes,[],"Removed useless installed/not installed check, for what? This can be done under the GUI or via packageManager. 
Logging option for debugging reasons added, normal users won't recognize this, so everything is okay (own/own6 doesn't need logging because this will show only AFL related stuff if the OS is already booted)
DO NOT allow holes! To ensure that nothing goes trough until AFWall+ was successful started we flush all rules every start (own rules should re-applied under AFWall+ after Android was finally started)
Ensure that port forwarding is enabled, this is not persistent (this would need sysctl) - PF is needed for e.g. NAT, if not you will get error msg's (this is mostly for custom users and some pre-defined rules we use).

What needs to be fixed under AFwall+ itself:
The only problem I found is that we don't normally need a check for the built-in tables, AOSP already includes iptables so we should detect if iptables are present and installing them or not, currently this is broken in AFWall+ because the binaries are always extracted to /data/data/dev.ukanth.ufirewall/app_bin - one goal should be to extract and check them in this script if they are really present and necessary or not, all other methods allow holes on binary switches after a restart.
"
ukanth/afwall,closed,Update strings.xml,[],"Introduce AFWall+ 2.0 ger strings
"
ukanth/afwall,closed,Update about.html,[],"- Chrome offline view fix
- UTF-8 will be used always
- Underline the topics
- Removed some underlined links, only email and external stuff should be underlined
- New table for ""Third-Party Libraries"" section, padding can be adjusted as per need (see GeneratedTable - padding)
- Removed useless validation
"
ukanth/afwall,closed,Update .gitignore,[],"The following is deprecated and not necessary for public repos, since Android Studio/Eclipse will override or automatic generate them (per-user specific settings, please read the Android Studio instruction settings):

.gradle 
.idea
gradle
"
ukanth/afwall,closed,New startup page for AFWall+ via http://<project-username>.github.io/afwall,[],"Hi, I've created a new startup page, maybe we can adopt this, it's the default skin _Cayman theme_ (imho it's the cleanest and looks best with the default Readme.md). An ""Google Analytics"" option is also available to find the project better on the www (of course needs an free ID).

The example can be found over [here](http://chef-koch.github.io/afwall). 

To activate this just go to the ""Settings"" button - scroll down until you see ""GitHub Pages"" and click on the ""launch automatic page generator"", you'll see the default Readme.md, click ""Continue to layout"" and you'll see a skin collection. Click on publish and it's done, the page is now available at <code>http://ukanth.github.io/afwall</code>.

Of course I will update soon or later the Overview for the final 2.x release and add some layout tweaks to it, as always as pull request. 

_Of course other skins are possible._
"
ukanth/afwall,closed,"More info under ""System info""",[],"- added more output to this category
"
ukanth/afwall,closed,afwall-2.0 alpha firewall log,[],"i am really enjoying the multiple profile option, i was wondering if the firewall log could show what profile is in use?
"
ukanth/afwall,closed,Do not break old SU apps,[],"- Versions bump, we are in 2015 now, old stuff removed 
- Do not break old su apps
- Bump final SDK 22 version in order to make it work on Android M
"
ukanth/afwall,closed,Update to support really all su apps,[],"- suPackages updated to support all available root tools
"
ukanth/afwall,closed,[Feature] Enable option to not show disabled apps.,[],"Some people disable some apps (e.g. calculator, default Internet browser on custom ROM, Google+ etc.). Why not have an option to not display those in the list?
"
ukanth/afwall,open,Add a material button to enable/disable the firewall,"[Label(name=""Feature"")]","It would be a nice touch and useful to have that kind of switch on the bottom right (customized for afwall ofc)

![fab](https://cloud.githubusercontent.com/assets/1394130/9112198/79ce655a-3c4d-11e5-857b-fd93d339ce87.png)
"
ukanth/afwall,closed,Is there a way to apply rule only on certain SSID?,[],"For example, I want to apple rule for certain public WiFi but not to my home WiFi. Is there a way to achieve this? 
"
ukanth/afwall,closed,Update gradle-wrapper.properties,[],"Gradle 2.4/2.5 should not be used so we are on 2.3 until 2.6 get the fix
"
ukanth/afwall,closed,AFWall 2.0.0-Beta-2 GUI Crash on maguro w/ 5.1.1,"[Label(name=""Bug""), Label(name=""Duplicate"")]","Hey Ukanth,

Unless the brief logcat provided at the link below highlights something obvious to you, please feel free to rate this as low confidence/priority for now.  I just updated all my devices to the new beta and one of them has the GUI force-closing, though the background process still shows as running in the notification tray.  I won't have any time to debug this on the device until the later part of next week.  That said, the crash occurs on the most ""non-stock"" device I have (Galaxy Nexus/maguro, Android 5.1.1, rooted, XPosed w/ several modules, SELinux in enforcing, etc).  That said, the GUI runs fine on a very similarly configured Nexus 5.  Obviously there are a lot of things I can dial back a bit to see if they are the cause of the crash.  If the logcat doesn't help you figure it out on your own, expect that I will follow-up with add'l testing results next week.  

http://pastebin.com/cH7XHQmC
"
ukanth/afwall,closed,Update build.gradle,[],"- Update to Gradle 1.3.x
"
ukanth/afwall,closed,Update build.gradle,[],"- Updated everything to latest 
- Disabled translations checking because we use Crowdin for this
"
ukanth/afwall,closed,Beta 2 UI Crash,[],"UI crashes on launch

```
08-03 20:05:02.091 E/AndroidRuntime(10894): FATAL EXCEPTION: main
08-03 20:05:02.091 E/AndroidRuntime(10894): Process: dev.ukanth.ufirewall, PID: 10894
08-03 20:05:02.091 E/AndroidRuntime(10894): java.lang.RuntimeException: Unable to start activity ComponentInfo{dev.ukanth.ufirewall/dev.ukanth.ufirewall.MainActivity}: java.lang.IllegalArgumentException: Comparison method violates its general contract!
08-03 20:05:02.091 E/AndroidRuntime(10894):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2356)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2418)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at android.app.ActivityThread.access$900(ActivityThread.java:154)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1321)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at android.os.Handler.dispatchMessage(Handler.java:102)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at android.os.Looper.loop(Looper.java:135)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at android.app.ActivityThread.main(ActivityThread.java:5289)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at java.lang.reflect.Method.invoke(Native Method)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at java.lang.reflect.Method.invoke(Method.java:372)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:904)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:699)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at de.robv.android.xposed.XposedBridge.main(XposedBridge.java:115)
08-03 20:05:02.091 E/AndroidRuntime(10894): Caused by: java.lang.IllegalArgumentException: Comparison method violates its general contract!
08-03 20:05:02.091 E/AndroidRuntime(10894):     at java.util.TimSort.mergeLo(TimSort.java:743)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at java.util.TimSort.mergeAt(TimSort.java:479)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at java.util.TimSort.mergeCollapse(TimSort.java:406)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at java.util.TimSort.sort(TimSort.java:210)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at java.util.TimSort.sort(TimSort.java:169)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at java.util.Arrays.sort(Arrays.java:2010)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at java.util.Collections.sort(Collections.java:1883)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at dev.ukanth.ufirewall.MainActivity.showApplications(MainActivity.java:750)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at dev.ukanth.ufirewall.MainActivity.selectFilterGroup(MainActivity.java:211)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at dev.ukanth.ufirewall.MainActivity.reloadPreferences(MainActivity.java:307)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at dev.ukanth.ufirewall.MainActivity.onStart(MainActivity.java:314)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1236)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at android.app.Activity.performStart(Activity.java:6006)
08-03 20:05:02.091 E/AndroidRuntime(10894):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2319)
08-03 20:05:02.091 E/AndroidRuntime(10894):     ... 11 more
```
"
ukanth/afwall,closed,Another case of loss apps settings,[],"Good day. 

Your AFWall wonderful app. Useful, precise and accurate. But I want to report a small issue.

In the situation move applications to the SD card when the device boots they sometimes for some unknown reason found by the system with some delay (at this time, their labels are inactive and not loaded icons). Not all and not always.

After a while everything returned to normal. BUT AFWall manages to forget their settings. And you have to configure it again.

By the way, it would be nice to have a sort apps by install time.

I hope it will be useful. Good luck and thanks for the app.
"
ukanth/afwall,closed,donation,[],"Not a development issue!
Can't find other way to mention the following though.

On fdroid repository the donate link goes to home page of http://forum.xda-developers.com/
if you want few bucks for your good and appreciated work ...
"
ukanth/afwall,open,Changing order of profiles,"[Label(name=""Feature"")]","I have a lot of profiles and there is no way to neatly arrange the list, so I oftenly have a hard time findng the profiles I'm looking for. I would really like to be able to change the order in which they are displayed and being able to alphabetically sort them would also help a lot.
"
ukanth/afwall,closed,Removing profile corrupts other profiles,"[Label(name=""Bug"")]","I have a list of profiles, lets assume it looks like this:

```
Default



A
B
C
D
E
F
G
H
```

(The empty lines are Profile 1-3, which I could not remove and then renamed to nothing.)

After accidently deleting the profile ""D"", I directly added a new profile and called it ""D"". And now suddenly ""E"" has lost all settings, ""F has got all the setting of ""E"", ""G"" has got all the settings of ""F"", ""H"" has got all the settings of ""G"" and so on. Every profile above ""C"" (including ""C"") is fine and unchanged though.
"
ukanth/afwall,closed,Removing profiles 1-3 not possible,"[Label(name=""Question""), Label(name=""Wont-Fix"")]","It doesn't seem to be possible to remove profile 1, profile 2 and profile 3. 
Why do they exist by default anyway? You could just click on ""Add profile"" if you should need another one..
![screenshot_2015-07-29-10-35-14](https://cloud.githubusercontent.com/assets/3111510/8953426/a5005578-35de-11e5-8dd6-597f74517e1d.png)
![screenshot_2015-07-29-10-44-36](https://cloud.githubusercontent.com/assets/3111510/8953557/b33df98c-35df-11e5-8078-3547b7dab4f2.png)
"
ukanth/afwall,closed,Tasker Plugin - Selecting certain profiles not possible,"[Label(name=""Bug"")]","In the Tasker plugin, where you can select a profile, you cannot scroll down and thus you can't select some profiles, unless you only have 5 or so.. (depending on your screen resolution).
There is also a list display bug, which is probably related to this issue:  
![screenshot_2015-07-29-02-13-54](https://cloud.githubusercontent.com/assets/3111510/8947155/c941f532-3597-11e5-8f98-fbb4c441d5ef.png)
"
ukanth/afwall,closed,Security News: AFWall+ protects against a security hole (MITM) in most newer Samsung-Smartphones,[],"This is just a small notice and will be _automatically closed_ soon. 

AFWall+ can protect you against a major security hole in most (if not all?) Samsung Smartphones. There is a pre-installed keyboard (called SwiftKey) on such stock ROM's that is modded for Samsung's ROM's, it allows to download a .zip archive to update the language packages via non secured http communications, via Man-in-the-Middle it's now possible to intercept in such connection and download malware instead of the real update. It's possible, especially in a widely open environment like open Wifi or public placed to use such a hole. This security hole was original found by myself and I reported this to a security company called NowSecure, they're saying that the Galaxy S4 mini, S5 & S6 are affected by this. Samsung is now trying to release a fix for this, but since it's in there firmware I highly recommend to block such updates via AFWall+ and only download language pack updates in a trusted environment. 

Edit: 
- The normal installation of SwiftKey from Google Play Store is not affected.
"
ukanth/afwall,closed,AFWall+ 2.x RC bugs and glitches ,"[Label(name=""Bug"")]","I removed the previous post since it was highly outdated + the fact some stuff was already fixed but I use this now for giving an detailed overview of AFWall+ 2.0 Beta+ bugs or visual glitches that needs to be fixed before the 2.0 final release could hit the Play Store/F-Droid.

1) SU promt each time you open AFWall+, sometimes it's visible but sometimes not (but in fact it ask every time you open AFWall+ for it [see also SU log that there is a useless request]). - NOT fixed, see also #315.
2) <s>Pressing the left hardware button gives 2 menus, but they're not visible (means no text + font). The main menu is still on the upper right corner with visible text, I guess something is wrong/missing in the layout or menu.</s> Fixed with 762a70cbf367e9438af485caf4e2af3c0cf1941a

![screenshot_2015-08-03-21-00-22](https://cloud.githubusercontent.com/assets/727123/9045521/04a704ce-3a24-11e5-893b-de4bfb59bede.png)

3) <s>On applying the rules you'll see a dialog (.... applying iptables rules...), on touching outside this dialog it disappear without anything. But iptables will be updated (according to the toast) in fact if you want to close AFWall+ you will get the dialog that that there are unsaved changes (but this is wrong).</s> Fixed with da2d7674595bf383eca63be29dbf911000b1d45a
4) <s>Language change glitch, choose another (non system lang) and go back to the main screen. Now close the app and re-open it + rotate you're screen. Close and re-open it again and see that the lang was changed to a mixed one. In some situations it's enough to rotate the screen to see such glitch.</s> Fixed with da2d7674595bf383eca63be29dbf911000b1d45a
5) <s>Crash on on clean/fresh installation. #396  & #399 </s> Fixed in RC, as a _workaround_ simply do a clean installation.
6) The Traffic Details windows use a different (black background), should be the same as the default one (grey).

I guess after this was fixed we can release a new final version to the mass without any negative feedback. Of course as always if this is too much I can help with patches and such stuff. 
"
ukanth/afwall,closed,Script to stop outbound traffic,[],"Guys, I need your help.

I was doing some maintenance on my home router when I found out the following notification:

---

**UDP Flood to Host** 192.168.2.50, 36040->> 93.50.94.24, 61522

---

Where .50 was my android device (4.4.2) and the destination is somewhere in Milan, Italy. Now since these are the days of Galileo's spyware and HT news are all over, I need to:
1. find which app started that flood and
2. block all traffic toward that sub-net
possibly i could be able to do so with the scripting feature of AFWall+, but I don't know how.

I understand this may not be the best place to ask for such advice and I apologize for it, any suggestion or recommendation on where to better post this request for help will be greatly appreciate
"
ukanth/afwall,closed,Include apk in github releases tab,"[Label(name=""General"")]","It would be great to have APK available in releases: https://github.com/ukanth/afwall/releases

Thank you
"
ukanth/afwall,closed,OutofMemory Crash while scrolling through list of apps,"[Label(name=""Bug"")]","Samsung Galaxy S4 Active (i9295), Samsung Stock Android 4.4.2, XPosed installed
AfWall+ Version 2.0.0-ALPHA-2

I start AFWall+ and then _slowly_ (really seems to depend on scrolling speed) scroll through the list of apps (the list where you mark whether you want to whitelist an app or not).
In this scrolling process, AFWall+ occasionally crashes with the following stack:

```
java.lang.RuntimeException: An error occured while executing doInBackground()
    at android.os.AsyncTask$3.done(AsyncTask.java:300)
    at java.util.concurrent.FutureTask.finishCompletion(FutureTask.java:355)
    at java.util.concurrent.FutureTask.setException(FutureTask.java:222)
    at java.util.concurrent.FutureTask.run(FutureTask.java:242)
    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:231)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1112)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:587)
    at java.lang.Thread.run(Thread.java:841)
Caused by: java.lang.OutOfMemoryError
    at android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)
    at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:677)
    at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:507)
    at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:872)
    at android.content.res.Resources.loadDrawable(Resources.java:3024)
    at android.content.res.Resources.getDrawable(Resources.java:1586)
    at android.content.res.XResources.getDrawable(XResources.java:521)
    at android.app.ApplicationPackageManager.getDrawable(ApplicationPackageManager.java:725)
    at android.content.pm.PackageItemInfo.loadIcon(PackageItemInfo.java:161)
    at android.app.ApplicationPackageManager.getApplicationIcon(ApplicationPackageManager.java:788)
    at dev.ukanth.ufirewall.AppListArrayAdapter$LoadIconTask.doInBackground(AppListArrayAdapter.java:225)
    at dev.ukanth.ufirewall.AppListArrayAdapter$LoadIconTask.doInBackground(AppListArrayAdapter.java:217)
    at android.os.AsyncTask$2.call(AsyncTask.java:288)
    at java.util.concurrent.FutureTask.run(FutureTask.java:237)
    ... 4 more
```

Could there be a memory leak in the icon loader?
"
ukanth/afwall,closed,"checking for bogus entries, kernel process logging ",[],"AppID : -11
Application's Name: (Kernel) - Linux kernel
Total Packets Blocked:  86
[ICMPv6]ff02:0000:0000:0000:0000:0001:ffbb:c33e:null(1)
[TCP]23.59.189.99:80(5)
[TCP]185.33.22.13:10156(33)
[ICMPv6]ff02:0000:0000:0000:0000:0000:0000:0002:80(1)
[TCP]198.232.124.196:443(9)
[TCP]194.132.197.147:443(16)
[TCP]216.58.216.132:80(6)
[TCP]185.33.22.21:10156(1)
[TCP]93.184.215.151:80(6)
[TCP]194.132.196.194:443(8)

using afwall from f-droid, latest on rooted hisense tablet, older sero+ , on #android i was told;
05:17:18] <Khaytsus> Two_Dogs: No, you're confused or whatever you're using is confused.  The kernel does not connect or talk to things, period.

thnks in advance.
"
ukanth/afwall,closed,Performance enhancement,[],"  We are working on a project called PersisDroid (http://www.cudroid.com/PersisDroid/) for detecting potential performance issues. Our tool could find performance degradation caused by improper usage of asynchronous executions.
  We find that in some cases your app may suffer a long processing delay.

  Case 1:
  **Related source code** Class: [AppListArrayAdapter](https://github.com/ukanth/afwall/blob/beta/aFWall/src/main/java/dev/ukanth/ufirewall/util/AppListArrayAdapter.java) Method: [getView](https://github.com/ukanth/afwall/blob/beta/aFWall/src/main/java/dev/ukanth/ufirewall/util/AppListArrayAdapter.java#L143)
  **Circumstance** Sometime it takes long to load all the icons of all apps.
  **Problem** _new LoadIconTask().execute(..);_ This line of source code would load multiple icons in sequential in Android version greater than 4.0.
  **Suggested modification** I recommend invoke _executeOnExecutor_ method to load icons in parallel with a thread pool.

  Case 2:
  **Related source code** Class: [MainActivity](https://github.com/ukanth/afwall/blob/beta/aFWall/src/main/java/dev/ukanth/ufirewall/MainActivity.java) Method: [showOrLoadApplications](https://github.com/ukanth/afwall/blob/beta/aFWall/src/main/java/dev/ukanth/ufirewall/MainActivity.java#L533)
  **Circumstance** Sometimes slow on displaying applist. 
  **Problem** Source line: (new GetAppList()).setContext(this).execute(); executes the task of displaying the applist in a default queue. If not all the case 1 mentioned tasks of loading icons are finished, the show applist task should wait in the queue for executing. 
  **Suggested modification**  I recommend invoke _executeOnExecutor_ method to show app list in parallel to the load icons task.
"
ukanth/afwall,closed,allowing forbidden traffic,[],"please forgive no attachments and crude description 

problem is as follows:

application gReader is not allowed to access internet (WiFi) in settings, BUT it is still downloading content from feedly.com

http://imgur.com/2zjeXEk
http://imgur.com/Q5gzKTW

addional details:
gReader was installed before afwall+ and uninstalled (also before). it was never allowed in afwall+. 
afwall+ version is 1.3.4.1 (Google play store) 

need addional details? 
"
ukanth/afwall,closed,unable to refresh app list,"[Label(name=""Bug"")]","AFWall+ 2.0.0-ALPHA-2, using Lollipop 5.1, CM12.

In ALPHA-1, pulling down the app list refreshed it, no longer possible in ALPHA-2.

It's useful when installing/uninstalling apps, one  must now destroy the activity each time to update the app list
"
ukanth/afwall,closed,Doesn't show up in task switcher,[],"AFWall+ 2.0.0-ALPHA-2, using Lollipop 5.1, CM12.

It shows up in task switcher if the activity is on-screen, but once you change to another activity, it disappears from the task switcher view
"
ukanth/afwall,open,FR: Toasters for custom script blocks.,"[Label(name=""Feature"")]","Hi

Currently we have nessagws for app blocks which is great but ot would be extra nice if AF also shows the blocks done by the custom scripts.
"
ukanth/afwall,closed,excluding apps from custom script rules,"[Label(name=""Review"")]","Hi

I am not an advanced iptablws user to know this. it would be nice if one could exclude some apps from the rules from the custom scripts.
"
ukanth/afwall,closed,DNS (port 53) is blocked for Wifi tethering,[],"Hi,

I've got the problem that when using wifi-tethering the clients DNS-requests are blocked.

I use Android 4.2.2 (Fairphone 1), afwall+ in whitelist mode, kernel (-11) and Tehering (-12) are allowed for every kind of connection. 

When I try to connect to any webservice via domain name from my laptop, the DNS-request is blocked by afwall (Log entry: AppID: -11, [UDP]139.7.30.126:53 (which is my carriers DNS-Server), [UDP]8.8.8.8:53 (Google DNS server)). Connecting via IP works though. 

Could anyone help me out with this issue? I tried to find a solution reading any kind of FAQ's, using Google and so on. If the solution is out there and I didn't find it, please forgive me ;-) All the bugs reported so far are different as they concern bluetooth tethering (as far as I know). Thanks a lot!

Edit: disabling afwall makes the connection work, so I think it really is an afwall related problem
"
ukanth/afwall,closed,Android Marshmallow support,[],"After the [current developer preview](http://android-developers.blogspot.de/2015/05/android-m-developer-preview-tools.html) / [Prev3](http://android-developers.blogspot.de/2015/08/m-developer-preview-3-final-sdk.html) which been called Android Marshmallow I announce here some good news, AFWall+ still works, even with this earlier _preview_. 

Since M is not the next _big thing_ there are only small changes which mostly _doesn't affect Android itself_ (except some already known things), the design or iptables stuff. The most important change seems [USB-on-the-go support](http://developer.android.com/preview/behavior-changes.html#behavior-adoptable-storage) which allows to handle external microSDs as internal storage + changed permissions handling which makes XPrivacy and AppOps obsolete (with future builds) - but nothing is final atm and things still can be changed, so this will be automatically closed if all works with the final build too.

Tags: Android M, AFWall+ M, AFWall Android 5.2, AFWall, USB, USBFirewall, Marshmallow, API 23
"
ukanth/afwall,closed,Stuck on applying iptables rules,[],"Hi,
I created a small custom script located in /data/local/afscript.sh:
""# Necessary at the beginning of each script!
IP6TABLES=/system/bin/ip6tables
IPTABLES=/system/bin/iptables
# 

""# Others
$IPTABLES -A ""afwall"" --destination ""23.4.92.33/32""; -j ""afwall-reject"" || exit
$IPTABLES -A ""afwall"" --destination ""23.32.0.0/11""; -j ""afwall-reject"" || exit
$IPTABLES -A ""afwall"" --destination ""23.64.0.0/14""; -j ""afwall-reject"" || exit
$IPTABLES -A ""afwall"" --destination ""23.253.56.120/32""; -j ""afwall-reject"" || exit
$IPTABLES -A ""afwall"" --destination ""64.207.128.0/18""; -j ""afwall-reject"" || exit
$IPTABLES -A ""afwall"" --destination ""68.232.32.0/20""; -j ""afwall-reject"" || exit
$IPTABLES -A ""afwall"" --destination ""91.103.140.0/24""; -j ""afwall-reject"" || exit
$IPTABLES -A ""afwall"" --destination ""104.16.0.0/12""; -j ""afwall-reject"" || exit
$IPTABLES -A ""afwall"" --destination ""104.64.0.0/10""; -j ""afwall-reject"" || exit
$IPTABLES -A ""afwall"" --destination ""116.214.0.0/16""; -j ""afwall-reject"" || exit
$IPTABLES -A ""afwall"" --destination ""118.214.0.0/16""; -j ""afwall-reject"" || exit
$IPTABLES -A ""afwall"" --destination ""198.232.125.88/32""; -j ""afwall-reject"" || exit

(ignore the "" it's just to avoid Github formatting)

I'm using AFWall+ version 2.0.0-ALPHA-2 and AICP CAF rom under Android 5.1.1.
My script afscript.sh has 755 permissions is its patch is entered in AFWall+ => . /data/local/afscript.sh
When I want to apply the new rules I'm stuck on the popup saying 'Applying iptables rules'. I don't see what's wrong with this script so I though it could be an AF+ issue.

Thank you.
"
ukanth/afwall,closed,bluetooth tethering is not working,"[Label(name=""Wont-Fix"")]","The computer and the cellphone are connected via bluetooth. The internet on the computer is only working, when I disable the firewall. When the firewall is enabled, there is a connection, but no web browsing is working. Even ping is not working. I the log of the firewall it show up two processes, but these processes I already enabled for all connections.
"
ukanth/afwall,closed,The second 'useful links' at 'CustomScripts' page is malicious,[],"Please check the second link in 'useful links' section at 'CustomScripts' page. It directs me to a malicious page.
"
ukanth/afwall,closed,[GUI] Help menu back icon not active,"[Label(name=""Bug"")]","My device: Nexus 5 running Android 4.4.4 (AOSP)
App Version: AFWall+ (v2.0.0-ALPHA-2)

Description: When I enter the Help screen from the AFWall main screen menu, I am then unable to return back to the main screen by using the ""back"" icon in the upper left of the Help screen.  I can return back to the main screen using the normal Android ""back"" button on the device.  All other AFWall submenus (i.e. Logs, Preferences, etc) do not exhibit this problem.
"
ukanth/afwall,closed,[Notice] /system/priv-app/ works,[],"Hello, 
a friend asked me if it's possible to integrate AFWall+ into Android's 4.4 (and higher) _/system-priv/_ folder for several reasons (normally only system apps goes in there or apps that hardly needs to be running in the background all the time - **AFWall+ normally does not need that!**).

So this issue report is a only a short message for the search history here on GitHub (and for any other search engine) that it works quite good. There is no negative side-effect I noticed after quite some time testing this scenario. The update via Google Play Store/F-Droid also works with the /system-priv/ method - it also doesn't matter what you call the .apk in that folder (for maybe malware reasons which search against only the apk name trying to disable it).

This notice will be auto-closed _after some time_. Please don't react/answer on it, until it's necessary or really important. 
"
ukanth/afwall,closed,Crash after adding new rule,[],"I installed 2 new apps and allowed connection in AFWall. After hitting Apply crash occured. 
log:

> 04-24 09:23:35.300 E/AndroidRuntime(23724): FATAL EXCEPTION: Thread-2556
> 04-24 09:23:35.300 E/AndroidRuntime(23724): java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()
> 04-24 09:23:35.300 E/AndroidRuntime(23724):  at android.os.Handler.<init>(Handler.java:205)
> 04-24 09:23:35.300 E/AndroidRuntime(23724):  at android.os.Handler.<init>(Handler.java:119)
> 04-24 09:23:35.300 E/AndroidRuntime(23724):  at dev.ukanth.ufirewall.RootShell.showToastUIThread(RootShell.java:382)
> 04-24 09:23:35.300 E/AndroidRuntime(23724):  at dev.ukanth.ufirewall.RootShell.complete(RootShell.java:215)
> 04-24 09:23:35.300 E/AndroidRuntime(23724):  at dev.ukanth.ufirewall.RootShell.access$1000(RootShell.java:42)
> 04-24 09:23:35.300 E/AndroidRuntime(23724):  at dev.ukanth.ufirewall.RootShell$1.onCommandResult(RootShell.java:298)
> 04-24 09:23:35.300 E/AndroidRuntime(23724):  at eu.chainfire.libsuperuser.Shell$Interactive.postCallback(Shell.java:983)
> 04-24 09:23:35.300 E/AndroidRuntime(23724):  at eu.chainfire.libsuperuser.Shell$Interactive.processMarker(Shell.java:903)
> 04-24 09:23:35.300 E/AndroidRuntime(23724):  at eu.chainfire.libsuperuser.Shell$Interactive.access$2100(Shell.java:624)
> 04-24 09:23:35.300 E/AndroidRuntime(23724):  at eu.chainfire.libsuperuser.Shell$Interactive$6.onLine(Shell.java:1056)
> 04-24 09:23:35.300 E/AndroidRuntime(23724):  at eu.chainfire.libsuperuser.StreamGobbler.run(StreamGobbler.java:92)
> 04-24 09:23:35.370 E/AppErrorDialog(578): Failed to get ILowStorageHandle instance
> 04-24 09:23:35.409 I/DEBUG   (628): [OnPurpose Redunant in preset_info] pid: 23724, tid: -1361051648, name: UNKNOWN  >>> dev.ukanth.ufirewall <<<
> 04-24 09:23:36.799 I/Process (23724): Sending signal. PID: 23724 SIG: 9

AFWall 1.3.4.1
device info:

> build.board: lx84
> build.bootloader: unknown
> build.brand: htc
> build.cpu_abi: armeabi-v7a
> build.cpu_abi2: armeabi
> build.device: htc_v1_u
> build.display: 1.00.118.4
> build.fingerprint: htc/tmo_pl/htc_v1_u:4.2.2/JDQ39/1.00.118.4:user/release-keys
> build.hardware: mt6582
> build.host: vBuild1LX88
> build.id: JDQ39
> build.manufacturer: HTC
> build.model: HTC Desire 310
> build.product: tmo_pl
> build.radio: unknown
> build.serial: CC48VWX00649
> build.tags: release-keys
> build.time: 1399464550000
> build.type: user
> build.user: rdadmin
> version.codename: REL
> version.incremental: 1.00.118.4
> version.release: 4.2.2
> version.sdk_int: 17
"
ukanth/afwall,closed,"Incompatible with DNScrypt, connection problems","[Label(name=""Wont-Fix"")]","Tested with: 
Android 5.0.2 and 5.1: Cyanogenmod 12.0 and 12.1 on Galaxy S3 (i9300) and LG G2 (D802), OnePlus (5.0.2)
AFwall: Version 2.0.0-ALPHA-1 and stable 1.3.4.1

Using this DNScrypt script: http://forum.xda-developers.com/attachment.php?attachmentid=3233170&d=1427549179

I can reproduce this issue with many phones, with AFwall disabled DNScrypt is working all the time (no connection loss)

Hello,

I'm using DNScrypt and AFwall together on Cyanogenmod, but have following connection problems (only when AFwall is enabled):
- No connection after restart when AFwall is enabled at boot, there are just exclamation marks over the WIFI and the mobile data icon
- No connection if network is changing (from mobile data do wifi and vice versa)
- DNScrypt is not working when ""enable inbound connections"" is unchecked (no connection at all)

The solution for both problems: Disable AFwall manually and enable it again. This works until the next reboot or the next changing connection.

This is neither a problem with AFwall and disabled DNScrypt, nor with only DNScrypt being enabled and AFwall disabled.

I'd be really happy to see a fix for this as fast as possible. :+1: 
"
ukanth/afwall,closed,Tri-state check boxes,[],"Check boxes on application list items should have the third state: follow the general rule, which is set by default.

General rules here are: Any application, Kernel and Root.

Use case: user allows access to Wi-Fi and denies access to mobile networks for all applications by checking/unchecking corresponding check boxes on ""(Any application)"" list item. Now user can explicitly deny access to Wi-Fi for any selected app, e.g. app with ads. All newly installed apps will follow the general rule, while this one app will be denied from Wi-Fi and mobile network.
"
ukanth/afwall,closed,Please provide a non Gplay donate version,[],"Hi

I do not have Gplay and I want to use the donate version.

thanks
"
ukanth/afwall,closed,Use consistent icon for both launcher and notification bar ,[],"The (shield) icon in the notification bar is very much different than the robot icon in the launcher. Perhaps choose one and use it consistently.

The shield is less common so perhaps use that.
"
ukanth/afwall,closed,VPN problems with AFWall+ 1.3.4.1,[],"Hi there,

I have some problems to get a working VPN-Connection on Android 4.4.4 (OmniROM).

I'm using following custom script:

```
# Flush/Purge all rules expect OUTPUT
$IPTABLES -F INPUT
$IPTABLES -F FORWARD
$IPTABLES -t nat -F
$IPTABLES -t mangle -F
$IP6TABLES -F INPUT
$IP6TABLES -F FORWARD
$IP6TABLES -t nat -F
$IP6TABLES -t mangle -F

# Flush/Purge all chains  
$IPTABLES -X   
$IPTABLES -t nat -X  
$IPTABLES -t mangle -X  
$IP6TABLES -X   
$IP6TABLES -t nat -X  
$IP6TABLES -t mangle -X

####################
# Defaults         #
####################

# IPv4 connections
$IPTABLES -P INPUT   DROP 
$IPTABLES -P FORWARD DROP 
$IPTABLES -P OUTPUT  DROP 

# IPv6 connections  
$IP6TABLES -P INPUT DROP  
$IP6TABLES -P FORWARD DROP  
$IP6TABLES -P OUTPUT DROP

#####################
# Special Rules     #
#####################

# Allow loopback interface lo 
$IPTABLES -A INPUT -i lo -j ACCEPT 
$IPTABLES -A ""afwall"" -o lo -j ACCEPT

# Fix DNS-Server
$IPTABLES -t nat -A OUTPUT -p udp --dport 53 -j DNAT --to-destination x.x.x.x:53
$IPTABLES -t nat -A OUTPUT -p tcp --dport 53 -j DNAT --to-destination x.x.x.x:53

#####################
# Incoming Traffic  #
#####################

# Allow ICMP packets
$IPTABLES -A INPUT -p icmp -m icmp --icmp-type echo-reply -j ACCEPT 
$IPTABLES -A INPUT -p icmp -m icmp --icmp-type echo-request -j ACCEPT 
$IPTABLES -A INPUT -p icmp -m icmp --icmp-type destination-unreachable -j ACCEPT

# VPN
$IPTABLES -A INPUT -p UDP --dport 500 -j ACCEPT
$IPTABLES -A INPUT -p UDP --dport 4500 -j ACCEPT

# Allow all traffic from an established connection
$IPTABLES -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

####################
# Outgoing Traffic #
####################

# VPN
$IPTABLES -A ""afwall"" -p UDP --dport 500 -j ACCEPT
$IPTABLES -A ""afwall"" -p UDP --dport 4500 -j ACCEPT
```

Am I missing something? Firewall log stays empty.
0: (Root) Apps are also allowed in AFWall+ GUI.

Cheers
shellshocker
"
ukanth/afwall,closed,log window: just one or two messages normal?,[],"What is the log screen supposed to look like?

Is only one or two items visible normal?

And nothing changes until one hits ""refresh"".

Then there are just another one or two items there total.

All despite the many messages being flashed in the middle of the screen.

Beta AFwall+ on IceCreamSandwich Android 4.0.4.
"
ukanth/afwall,closed,make sure permanent status bar icon appears starting from boot,[],"Not sure if related to #328 but once one launches afwall (beta or not, Android 4.0.4 IceCreamSandwich) there is no way to exit it to the degree that it will finally leave the status bar.

Disabling all the rules and choosing exit just won't get it out of the status bar. No choice in Preferences seems to help.

Therefore beside ""Exit"" in the menu, perhaps add a ""Really Exit"".
"
ukanth/afwall,closed,Mention zoom on log menu items,"[Label(name=""Review"")]","In the log menu, there are two entries, ""+"", ""-"", which should be relabeled ""+ zoom"" and ""- zoom"", else one might assume they add and remove entries, or turn something on or off etc.
"
ukanth/afwall,open,"Mention on Notification Filter if it ""filters in"" or ""filters out"" items.","[Label(name=""Review"")]","Notification Filter in Log Preferences: mention there if this ""filters in""
or ""filters out"" items.
"
ukanth/afwall,closed,External binaries platform support for x64 only systems,"[Label(name=""Question"")]","Currently AFWall+/iptables/busybox supports:

<code>*\AFWall+\aFWall\src\main\res\raw</code>:
- mips
- arm (no extra armv7 binaries and not always necessary)
- x86

But there is also:
- x64 (aarch64)
- mips64
- arm64

Busybox:
- arm64 daily's/nightly's can be found [here](https://s.basketbuild.com/devs/USBhost/busybox/arm64) (compiled by USBhost from the source)

IPtables:
- I think it's also ready (according to the mailing list)

Klogripper:
- Not ready yet

Nflog:
- Not ready yet

So anything that is related to the last mentioned x64 only stuff, it's problematic on several newer devices and tablets. Well, I know about this for a long time now but the question is to compile the binaries now and add them to the source, or we talking about the necessary of external binaries? - because my standpoint is already clear, imho dropping the internal binary stuff is the only solution to fix several problems and if all was well tested and documented there should be none with our stuff.

So some feedback on this would be nice.
"
ukanth/afwall,closed,Whatsapp Voice calling is blocked,"[Label(name=""Review"")]","The new feature Whatsapp Voice calling is being blocked, Whatsapp calls but the other side don´t get the call.

---

AppID : 10183
Application´s Name: WhatsApp
Total Packets Blocked: 33
[UDP]10.29.114.25:55560(11)
[UDP]10.29.114.25:44806(11)
[UDP]10.29.114.25:43928(11)

Whatsapp on text conversation is ok!

Android version 4.0.3 (rooted)
Model: GT-I9100
"
ukanth/afwall,closed,Update Api.java,[],"Small logic change L543 - L545, changed comments according current coding style guidelines
"
ukanth/afwall,closed,FAQ Updated,[],"- added bug report section
- Icon section improved
- small changes
"
ukanth/afwall,closed,AFWall+ blocking everything even though turned off,"[Label(name=""Review"")]","Good morning @ukanth!

The good thing first: I still **LOVE** your App and the work you're doing here! Sadly, AFWall+ is mocking around lately (it worked before): It blocks everything even though turned off right from starting my phone.

That means, when starting my phone I have to _enable_ and then _disable_ AFWall+ to even get any internet connection. On the other hand, even if I do _not_ restrict anything and just turn AFWall+ on, it still blocks my whole internet connection - no matter if I change the binaries to be used in the settings.

**Technical Details**
- AFWall+ v1.3.4.1
- System: AOKP 4.4.4
- Phone: HTC One
- BusyBox: v1.23.1 in `/system/xbin` via BusyBox Pro

With this Issue, I'd also like to file a request to add some sort of Debugging-Button into the Help-Button of the AFWall+ menu. It will ease the collection of relevant data to solve future Issues of other users.
"
ukanth/afwall,closed,Updated afwallstart script for maximum security,[],"Since we using a _firewall_ we should ensure that we use maximum possible secure settings by default.

In short this means and fix:
- Prevent SYN flood attacks
- Prevent DoubleDirect vulnerability
- Enable IPv6 ""privacy extensions""
- Optional possibility to completely shutdown the annoying IPv6 stuff (just remove the #) 
- Added missing Ipv6 policy (Ipv6 is enabled for all since Android 4.x - or maybe lower .. part of it since 2.3)
- Most stuff includes comments to revert/mod yourself if something is not working, but I tested all params on 5 different smartphones and routers
"
ukanth/afwall,closed,different between mode WL BL,"[Label(name=""Wont-Fix"")]","Hallo,

What is a different between WL/BL mode?
My sugesstion: wl-default-policy=deny instead allow.
Or have I misunderstood something?

details below.

regards Andre.
- testbed
  afwall 1.3.4.1
  filt=""policy|10019|10020""  ## uid
  iptables -L -n -v | egrep ""$filt""
- test 1 WL (allow selected)
  rules wl-mode:
    [ ] 10019
    [x] 10020

root@android:/ # iptables -L -n -v | busybox egrep ""$filt""
Chain INPUT (policy ACCEPT 5 packets, 318 bytes)
Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
Chain OUTPUT (policy ACCEPT 34 packets, 3447 bytes)
- default policy correct?
- missing Allow 10020
- changes:
  - wl-mode -> bl-mode
  - invert ruleset
  - apply
- test 2 BL (block selected)
  [x] 10019
  [ ] 10020

root@android:/ # iptables -L -n -v | busybox egrep ""$filt""
Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
    0     0 afwall-reject  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner UID match 10019
- seems to be correct.
"
ukanth/afwall,closed,detect blocked connection gapps,"[Label(name=""Wont-Fix"")]","Hallo,

Every time i unlock screen i found a connection to 74.125.136.188.5228 on my WLAN-Router.
This user seem to be u0_a19 (gapps).

Now i remove uid 10019 from wl-mode and apply.
But connection  will be NOT blocked.

Whats going wrong?

details below.
afwall 1.3.4.1 on Sam-Tab3/4.2.2

regards Andre

test unlock screen
- router:tcpdump
  17:46:03.898727 IP 10.1.1.16.33270 > 74.125.136.188.5228: Flags [P.], seq 2084:2111, ack 4801, win 409, options [nop,nop,TS val 421855 ecr 2721658101], length 27
  17:46:04.045181 IP 74.125.136.188.5228 > 10.1.1.16.33270: Flags [.], ack 2111, win 442, options [nop,nop,TS val 2722409438 ecr 421855], length 0
  17:46:04.045254 IP 74.125.136.188.5228 > 10.1.1.16.33270: Flags [P.], seq 4801:4830, ack 2111, win 442, options [nop,nop,TS val 2722409446 ecr 421855], length 29
  17:46:04.169410 IP 10.1.1.16.33270 > 74.125.136.188.5228: Flags [.], ack 4830, win 409, options [nop,nop,TS val 421884 ecr 2722409446], length 0
- sh conn, get pid
  root@android:/ # busybox  netstat -anep   | busybox more
  Active Internet connections (servers and established)
  Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
  tcp        0      0 ::ffff:10.1.1.16:45970  ::ffff:74.125.136.95:443 ESTABLISHED 9039/com.google.and
  tcp        0      0 ::ffff:10.1.1.16:33270  ::ffff:74.125.136.188:5228 ESTABLISHED 2646/com.google.pro
  tcp        1      0 ::ffff:10.1.1.16:35730  ::ffff:173.194.113.164:443 CLOSE_WAIT  2646/com.google.pro
  raw        0      0 ::%1:58                 ::%1166480:\*            58          3361/dhcpcd
- get user
  root@android:/ # ps | busybox grep 2646
  u0_a19    2646  1911  587372 16932 ffffffff 4007e15b S com.google.process.gapps
- get uid
  root@android:/ # ls -l acct/uid | busybox grep u0_a19
  drwx------ root     u0_a19            2015-03-06 18:32 10019
"
ukanth/afwall,closed,"[Question] Build: API 17/18 fail, API 19 success",[],"Hi, I am building AFWall with the latest Android SDK on Linux.
When I build with targeted API 17 or 18 like

```
% android update project -p . -s -t 1
% ant debug
```

I see the error like

```
-compile:
    [javac] Compiling 86 source files to /mnt/tmp/android/afwall_build/afwall/bi
n/classes
    [javac] /mnt/tmp/android/afwall_build/afwall/src/dev/ukanth/ufirewall/Api.java:354: error: cannot find symbol
    [javac]                                     if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN_MR2) {
    [javac]                                                                                     ^
    [javac]   symbol:   variable JELLY_BEAN_MR2
    [javac]   location: class VERSION_CODES
    [javac] /mnt/tmp/android/afwall_build/afwall/src/dev/ukanth/ufirewall/Api.java:546: error: cannot find symbol
    [javac]                     if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
    [javac]                                                                     ^
    [javac]   symbol:   variable KITKAT
    [javac]   location: class VERSION_CODES
```

But If I build with API 19, it succeeded.
1. Is it OK to use apk built with API 19 on Android 4.2.2/4.3 ?
2. If not, any advice to solve this error?
"
ukanth/afwall,closed,[Feature Request] seperate profiles wifi networks,[],"Hi,

it would be usefull to set up seperate profiles for different wifi networks.

So I can differ between default, homeWIFI, work, hotspots, ... and so on.

Thanks
"
ukanth/afwall,closed,Feature: Prompt - Allow internet access for X minutes,[],"It would be nice to have a feature to allow certain apps access to internet for X amounts of minutes upon access attempt.
It would almost be like how SuperSU handles root request, I.E. Allow/Deny/Prompt
An extra would be to have a white list of apps that should display prompt request.
Also, to have the number of minutes variable.

Thank you
"
ukanth/afwall,closed,AFWall+ does not work on CM12 (20150219-NIGHTLY) due to non-PIE binaries,"[Label(name=""Feature"")]","Title says it all, really: the iptables and other binaries that come with AFWall+ are not built as PIE executables, so they do not work at all on current CM12 nightlies, which refuse to run non-PIE executables.

PIE executables do not work on ICS apparently, but the Chromium project has a shim that allows them to work, which might be useful:
http://code.metager.de/source/xref/chromium/tools/android/run_pie/run_pie.c

Edit: logcat:
I/AFWall  ( 8461): command '/data/data/dev.ukanth.ufirewall/app_bin/ip6tables -P INPUT ACCEPT' exited with status 1
I/AFWall  ( 8461): Output:
I/AFWall  ( 8461): error: only position independent executables (PIE) are supported.
"
ukanth/afwall,closed,Blocks IPv6 connections,[],"I have an issue where AFWall+ is blocking IPv6 connections when IPv6 is enabled in the preferences.
The App (Conversations) is allowed to access the internet.
The app has the following permissions in AFWall+: LAN, WLAN, Mobile data, Roaming.
Still as soon as the firewall is enabled, the current connection times out and the app is not able to reconnect and all connections time out after 20 seconds.
Disabling the firewall (or disabling IPv6 in the preferences) results in the app working flawlessly again.
"
ukanth/afwall,closed,Update strings.xml  (ja),[],"aFWall/src/main/res/values-ja/strings.xml

Fixed Value.
"
ukanth/afwall,closed,log service not working,[],"I GUESS this happends because the rule uses NFLOG instead of LOG
-A afwall-reject -j NFLOG --nflog-prefix  ""{AFL}"" --nflog-group 40

Therefore there are no {AFL} loggings in the kernel log and /data/data/dev.ukanth.ufirewall/app_bin/klogripper can not get them.

Any ideas?

AFWall+: 1.3.4.1
Android: 4.2.2
Device:  Acer Z160
"
ukanth/afwall,open,Wi-Fi-Hotspot not working while AFWall+ is enabled,"[Label(name=""DNS""), Label(name=""Low"")]","AFWall+ Logs:
AppID : -11
Application's Name: 
Total Packets Blocked:  4
[UDP]10.74.210.211:53(2)
[UDP]10.74.210.210:53(2)

NFLOG:
{AFL} IN= OUT=ccmni0 SRC=10.202.247.168 DST=10.74.210.210 LEN=69 PROTO=UDP SPT=53300 DPT=53 LEN=49 UID=1014
{AFL} IN= OUT=ccmni0 SRC=10.202.247.168 DST=10.74.210.211 LEN=69 PROTO=UDP SPT=53300 DPT=53 LEN=49 UID=1014

Adding a custom script solves the problem:
$IPTABLES -A afwall-3g-tether -p tcp -m owner --uid-owner 1014 -m tcp --dport 53 -j RETURN
$IPTABLES -A afwall-3g-tether -p udp -m owner --uid-owner 1014 -m udp --dport 53 -j RETURN

What do you thing about adding these rules to afwall-3g-tether chain when enabling ""-12:(Tethering) - DHCP+DNS service""?

AFWall+: 1.3.4.1
Android: 4.2.2
Device:  Acer Z160
"
ukanth/afwall,closed,Traffic Details ,[],"hello,

I use AFWall (White list) and use the follow custom script:

IPTABLES=/system/bin/iptables
IP6TABLES=/system/bin/ip6tables 

$IPTABLES -F INPUT
$IPTABLES -F FORWARD
$IPTABLES -t nat -F
$IPTABLES -t mangle -F
$IP6TABLES -F INPUT
$IP6TABLES -F FORWARD
$IP6TABLES -t nat -F
$IP6TABLES -t mangle -F

$IPTABLES -X 
$IPTABLES -t nat -X 
$IPTABLES -t mangle -X 
$IP6TABLES -X 
$IP6TABLES -t nat -X 
$IP6TABLES -t mangle -X

$IP6TABLES -P INPUT DROP  
$IP6TABLES -P FORWARD DROP  
$IP6TABLES -P OUTPUT DROP

But if i look the traffic details from firefox (also other apps) it shows me only uploaded traffics. The traffic of downloads is Zero Bytes. How is this possible? There must be a incoming traffic for firefox, because how comes the content of a page? 

Or it is a issue?
"
ukanth/afwall,open,Firewall disabled if errors in custom script (security issue),"[Label(name=""Feature"")]","Using a custom script that has mistakes produces ""error creating IP table"" and then completely DISABLES AFWall+. This leaves our device unprotected.

If there are errors in the custom script, then it should be the custom script that gets disabled instead of the whole firewall.
"
ukanth/afwall,closed,[Feature Request] Favourite apps,[],"I propose a feature to ""pin"" the app to the top of the list in the GUI - outside of normal alphabetical order. That will make it easier for the user to find his commonly modified apps without needing to scroll for them. It might be implemented as an additional ""Favourite"" button on ""Traffic details"" screen that shows when application name is long-pressed (under ""Open system details"").
"
ukanth/afwall,closed,LAN Broadcast packets go through afwall-wifi-wan like a WAN traffic,"[Label(name=""Wont-Fix"")]","I allow my app to use only LAN Network
But broadcast packages was tropes

AFWall+ Log
AppID : 10110
Application's Name: Qloud Media Free
Total Packets Blocked:  4
[UDP]239.255.255.250:1900(4)

```
---------
```

IPTables Rules
Chain afwall-wifi-fork (2 references)
  pkts bytes target     prot opt in     out     source               destination
  916 29966 afwall-wifi-lan  all  --  \*      \*       0.0.0.0/0            192.168.1.0/24
  3293  380K afwall-wifi-wan  all  --  \*      \*       0.0.0.0/0           !192.168.1.0/24      

Maybe to add rule
  afwall-wifi-lan  all  --  \*      \*       0.0.0.0/0            239.255.255.250
Will resolve issue?
"
ukanth/afwall,closed,"add ""drm"" special Android account",[],"Currently only six of the special Android accounts are supported: root, adb, media, vpn, gps, and shell. This series adds the drm account, and does some code cleanup.
"
ukanth/afwall,closed,Rules of Default profile are not imported,"[Label(name=""Bug"")]","Rules of Default profile are not reestablished when doing an import ""preferences rules and profile settings""
"
ukanth/afwall,closed,Profile description changes are not visible directly ,"[Label(name=""Bug"")]","When changing profile descriptions in settings and navigating back to rues still old descriptions are shown. You have to restart the application to let the changes take affect.
"
ukanth/afwall,closed,Rules of the active profile are not updated during import,"[Label(name=""Bug"")]","When importing ""preferences rules and profile settings"" rules of the active profile are not imported. You have to switch to a not used profile before doing the import to ensure all rules of all profiles are imported properly.
"
ukanth/afwall,closed,Rule changes get lost when switching between profiles,"[Label(name=""Bug"")]","When rule changes are made within a profile changes get lost without warning when switching into an other profile.
"
ukanth/afwall,closed,Feature: allowing incoming connection,"[Label(name=""Question"")]","Some applications (like f-droid) can accept incoming connections and it would be nice to have an option to allow inbound traffic.
"
ukanth/afwall,closed,API 14+ Changes,[],"- New Icon
- Removed ABS/Unified Preference Library etc.,
- API 14+
- Eclipse to Android Studio
"
ukanth/afwall,closed,Tasker integration is gone,"[Label(name=""Bug""), Label(name=""Question"")]","This used to work.  But now when I tap on an AFwall+ task, it says:

Missing app -- To perform this action, the additional _plugin AFwall+ Tasker Plugin_ must be installed.
Clicking ok takes me to the Play Store, where I can either deinstall or open AFwall+.

This is on CM11 and neither Tasker nor AFwall+ have data protection activated.
"
ukanth/afwall,closed,CustomScripts issues,"[Label(name=""General""), Label(name=""Question"")]","Hi,

I'm using AFWall+ v1.3.4.1 on an Android 4.4.2 CyanogenMod. I want to use CustomScripts but have some problems with the provided instructions (https://github.com/ukanth/afwall/wiki/CustomScripts).

You write the following under »Adding custom rules«:

> IMPORTANT: Never manually purge the OUTPUT chain - this will cause AFWall+ rules to be ignored. Use the 'afwall' chain instead.

Later you give some examples »Some examples«:

> # Flush/Purge all rules
> 
> $IPTABLES -F
> $IPTABLES -t nat -F
> $IPTABLES -t mangle -F
> $IP6TABLES -F
> $IP6TABLES -t nat -F
> $IP6TABLES -t mangle -F

Does this makes sense? Will this not delete the OUTPUT chain as well? Furthermore this isn't working. I have to use the following:

> # Flush/Purge all rules
> 
> $IPTABLES -F INPUT

Everything else ends in an error.

So I have two questions:
1. Which chain we should use? OUTPUT or afwall? And what's the difference here?
2. How can I flush / purge all rules? Code example isn't working for the startup script. For shutdown script everything is fine.

Thank you!
shellshocker
"
ukanth/afwall,closed,"add ""drm"" special Android account",[],"Currently only six of the special Android accounts are supported:  root, adb, media, vpn, gps, and shell.  This series adds support for all of the (current) special Android accounts (as listed in [the Android source code](https://android.googlesource.com/platform/system/core.git/+/master/include/private/android_filesystem_config.h)), and does some code cleanup.
"
ukanth/afwall,closed,Error applying iptables rules. No chain/target/match by that name.,"[Label(name=""Bug""), Label(name=""Question"")]","From rules.log Logcat:

```
15:26:12 command '/data/data/dev.ukanth.ufirewall/app_bin/iptables -A afwall-reject -j REJECT' exited with status 1
Output:
iptables: No chain/target/match by that name.
```

This happens everytime when enabling the firewall.

After this, no apps can access the network. It does not matter if they're whitelisted or blacklisted.

This is the rules table after the firewall is enabled:

```
==========
IPv4 Rules
==========

Chain INPUT (policy ACCEPT 1 packets, 633 bytes)
 pkts bytes target     prot opt in     out     source               destination         
Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
Chain OUTPUT (policy DROP 11 packets, 1546 bytes)
 pkts bytes target     prot opt in     out     source               destination         
   11  1546 afwall     all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall (1 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-3g (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 afwall-3g-postcustom  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-3g-fork (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-3g-home (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-3g-postcustom (1 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-3g-roam (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-3g-tether (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-reject (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-vpn (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-wifi (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 afwall-wifi-postcustom  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
Chain afwall-wifi-fork (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-wifi-lan (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-wifi-postcustom (1 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-wifi-tether (0 references)
 pkts bytes target     prot opt in     out     source               destination         
Chain afwall-wifi-wan (0 references)
 pkts bytes target     prot opt in     out     source               destination         
```
"
ukanth/afwall,closed,AFWall constantly running,"[Label(name=""Feature"")]","I've noticed that afwall remains in the background as a service. If I kill it it will eventually respawn itself.

I disabled anything that could need a service in my mind: logging, active rules, lan/vpn/roaming.

I do not have such issue with other droidwall forks, and I can't see a reason why an iptables frontend would need to keep running after applying the rules.

It is an issue on my device because I have very low ram (384MB) and afwall basically wastes ~25MB.

If it's not a bug can someone tell me why it keeps running?

Thanks
"
ukanth/afwall,open,Tethering DNS problem,"[Label(name=""Bug""), Label(name=""DNS""), Label(name=""Duplicate"")]","When AFWALL is enabled, USB tethering DNS resolution does not work. However, browsing sites by ip works, so the only problem is the DNS.

`(Tethering) - DHCP+DNS services` is enabled.
Enabling or disabling `(root) - Applications running as root` or `(Kernel) - Linux Kernel` has no effect.

Versions: AFWall+ (v1.3.4.1), Android 4.4.4 Cyanogenmod 11-20140805-M9-hammerhead, Nexus 5.

There were similar issues before: #178 , #4 

Edit: Using Black list mode solves this, see attached image.
![screenshot_2014-12-07-12-11-30](https://cloud.githubusercontent.com/assets/5030488/5330634/2db14bf2-7e0b-11e4-8c4f-b6366b7163ad.png)
"
ukanth/afwall,closed,Add mDNS support for local networks,"[Label(name=""Feature"")]","When I enable ""LAN control"" on my Android device I cannot send out mDNS requests.  mDNS broadcasts go to 224.0.0.251 on UDP port 5353.  This request stays within the local network and, I believe, should be allowed.  It's useful for printer and device discovery.

My request is that this address range would be allowed/whitelisted when I enable 'LAN communication' for one of my apps.

More info on mDNS can be found at: https://en.wikipedia.org/wiki/Multicast_DNS

Thanks for your time developing this program.
"
ukanth/afwall,closed,Is there a way to show EVERY connection made? Even if it wasn't blocked?,[],"This seem to become more and  more essential.

Today, I found a suspicious IP being initiated by ""0:root"". The IP is 180.76.3.151, it seems very suspicious. But there is no way for me to know what app is requesting that IP.

I managed to find this out by blocking everything and log showed root trying to connect to this IP.
I couldn't have known this if I wasn't looking at an app called SockStat which tipped me off that Root is trying to connect to that.

Is there a way to always log everything for later audit? Like even if ""Google search"" connects to Google's IP we can see that.

PS. I still can't pinpoint what triggered that IP connection.

![_20141105_195147](https://cloud.githubusercontent.com/assets/8726042/4922748/b8f10960-6514-11e4-87a5-adf5beb1fb11.JPG)

How do I know what app triggered this?
"
ukanth/afwall,closed,Is there a way to show EVERY connection made? Even if it wasn't blocked?,[],"I'm awfully sorry about duplicating this by mistake. Don't how to delete this one!
"
ukanth/afwall,closed,assertthat function not found,[],"Hi
I have problem compiling afwall in eclipse.
The error is below:
   The method assertThat(MenuItem) is undefined for the type MenuAssert
Should I import some thing or add a jar file?
Thanks
"
ukanth/afwall,open,Identify active profile in notification ,"[Label(name=""Feature"")]","It would be useful if the notification item generated by the ""Show notification icon"" preference would indicate the active profile. Whereas it now says ""Firewall is running"", it could say ""Firewall is running. Profile: Default""
"
ukanth/afwall,closed,[Ideas needed] USB Firewall - Protection against USB Malware,"[Label(name=""Feature"")]","At the moment there are no USB Firewalls and not any single AV that could scans the USB firmware's directly (since there is no access to it in this level). So the question is how can we prevent a infected usb device/OS from been send any hidden data to the www? Another scenario could be that the infected USB device may change the DNS settings to redirect the whole traffic. 

Now we need some ideas. :8ball: 

Covert Storage Product:
- [How the NSA’s Firmware Hacking Works and Why It’s So Unsettling | Wired.com](http://www.wired.com/2015/02/nsa-firmware-hacking/)

Sources:
- [BadUSB Video Explanation](https://www.youtube.com/watch?v=nuruzFqMgIw)
- [BadUSB on accessories that turn evil | BlackHat.com](https://www.blackhat.com/us-14/briefings.html#badusb-on-accessories-that-turn-evil)
- [The Unpatchable Malware That Infects USB's Is Now on the Loose | Wired.com](http://www.wired.com/2014/10/code-published-for-unfixable-usb-attack/)
- [Turning USB peripherals into BadUSB | srlabs.de](https://srlabs.de/badusb/)
- [Phison 2251-03 (2303) Custom Firmware & Existing Firmware Patches | GitHub.com](https://github.com/adamcaudill/Psychson)
- [G Data USB Keyboard Guard for Windows | GData-Software.com](https://www.gdata-software.com/en-usb-keyboard-guard)
- [usbhost.h](https://android.googlesource.com/platform/system/core/+/master/include/usbhost/usbhost.h)
- [New USB-C Standard Can Help Fight USB Malware](http://news.softpedia.com/news/new-usb-c-standard-can-help-fight-usb-malware-503087.shtml)
- [USB ransomeware ZCryptor](https://blogs.technet.microsoft.com/mmpc/2016/05/26/link-lnk-to-ransom/)

Tests:
- [srlabs.de Proof-of-Concept - BadAndroid-v0.1.zip](https://srlabs.de/blog/wp-content/uploads/2014/07/BadAndroid-v0.1.zip)
- https://hakshop.myshopify.com/products/usb-rubber-ducky-deluxe
- https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payloads
- https://wiki.debian.org/HowToIdentifyADevice/USB
- http://www.amazon.com/SanDisk-Android-Smartphone-Tablet-SDDD-064G-G46/dp/B00HR7J3CA/?ie=UTF8&qid=1444146308&sr=8-1&keywords=SANDISK+Ultra+Dual+OTG+On+The+Go

```
/* Callback for notification when new USB devices are attached.
* Return true to exit from usb_host_run.
*/
typedef int (* usb_device_added_cb)(const char *dev_name, void *client_data);


/* Callback for notification when USB devices are removed.
* Return true to exit from usb_host_run.
*/
typedef int (* usb_device_removed_cb)(const char *dev_name, void *client_data);

.......
.....
....
..
```
"
ukanth/afwall,closed,Accessing AFWall from recents menu does not require password,"[Label(name=""Bug"")]","I noticed recently that if I've been using AFWall and subsequently access it from the recents menu it does not request my password. It seems like it should always request the password, no matter how I access it.
"
ukanth/afwall,closed,Turn on log service causes some kind of an endless loop,"[Label(name=""Bug"")]","When I turn on the log service, I get - for example with the app audials - some kind of an endless loop. Results are a black screen and one message, that the connection is blocked after another, while the app is trying to connect again and again. When I turn off the log service, blocking works fine for me.
Enabled firewall logs works fine, too.
"
ukanth/afwall,open,Show host names in log view,"[Label(name=""Feature"")]","Would make it easier to judge what apps are doing.
"
ukanth/afwall,closed,Not filtering any more,"[Label(name=""Question"")]","Hi,
I have a note 3 (SN-N9005) rooted by toowelroot on Rom stock XXUGN1.
The first time i've installed AFWALL+ (from playstore ,version 1.3.4.1), it worked fine but after a reboot, it's not filtering any more. And now, even a desinstallation, a reboot and reinstallation,no more filtering.
Was Anything missing in what i did during installation process ?
thank you
"
ukanth/afwall,open,Is it possible for other apps to leverage AFwall+ as an iptables API?,"[Label(name=""Feature"")]","New to android development, and trying to wrap my head around intents. Browsing the code, I'm unsure whether something like this is implemented.

Thanks!
"
ukanth/afwall,closed,"Spawns a lot of 'su' processes, even with system busybox","[Label(name=""Bug"")]","I saw in a recent development thread post that work is being done to fix the problem with 'su' processes, so I am glad for this.  I also saw someone say that selecting the 'system' busybox works perfectly.  This is not the case for me and if it helps at all, it doesn't help much.

EDIT: Log link: https://github.com/80tf3262p8/attached/blob/master/rules.log

![sususususu](https://cloud.githubusercontent.com/assets/7275539/4299117/8e97d96e-3e31-11e4-96d9-7a1e0a31d837.png)
"
ukanth/afwall,closed,Update strings.xml,[],"Added untranslated strings; fixed some grammar.
"
ukanth/afwall,closed,Blocking WLAN doesnt work ,[],"I'm using a Samsung Galaxy S3 with the latest nightly Cyanogenmod Version and blocking network access over WLAN does not work.
"
ukanth/afwall,open,Non-root VPN backend,"[Label(name=""Feature"")]","Would you be up for considering another provider backend using VPN for those who aren't rooted? The approach that mobiwol has taken seems interesting:
https://play.google.com/store/apps/details?id=com.netspark.firewall

---

A little context, in case it helps: I'm trying to get some activist friends using better privacy tools. These tools tend to rely on dependable data if they have any hope of providing message reliability comparable to traditional, insecure voice and sms. I'm hoping to coach them to use AFWall instead of the more obvious mobile data toggling that they're used to using, leaving the device accessible for their highly-available communication apps (like Redphone and TextSecure). I'm really hoping there's a solution that doesn't involve me individually rooting phones :)
"
ukanth/afwall,closed,One app is not blocked,"[Label(name=""Bug"")]","Thanks for this app!

Device: Samsung Galaxy Mega 6.3 w/ Android 4.4.2 (just upgraded)
AFWall+ (v1.3.4.1)
Not using XPrivacy, antivirus, etc.

Internet restriction works for most of my apps. One app still show ads.
## What I have tested:
- Enabled log in AFWall+, it shows AppID 10023, total packets blocked 43... and list of IPs.
- App still shows ads.
- Started to capture network packets via my router, and router shows traffic for the same IPs, that are supposedly blocked.
- Looked at the Firewall rules / IPTables Rules... AppID 10023 not found. This is ok I suppose.
- This all happens on WiFi. Just tested, on 3G also.
- DroidWall worked on 4.1.2 or 4.2.2 but on 4.4.2 the same problem as with AFWall+, one app is not blocked.

I can provide more debug info if needed. Your app looks promising, so want the fix :)
"
ukanth/afwall,closed,various bug fixes and FC issues and translations,[],
ukanth/afwall,closed,/etc/init.d/afwallstart not world readable,"[Label(name=""Bug"")]","AFWall's ""Fix startup data leak"" option installes the file /etc/init.d/afwallstart with permissions 0700, while the other files in that directory are 0755. Not a security issue, but it mandates root to read this file, which the stock files don't need.
"
ukanth/afwall,closed,Update AndroidManifest.xml,[],"- code cleaning
- removed unused stuff
- Added Samsung multi window support
"
ukanth/afwall,closed,Please vote: Backward compatibility vs. Api level in AFWall+,[],"I started this topic for people which don't like/use social media platforms (like me) to get the change for a vote on a may coming design/api change.

[Ukanth already wrote on XDA](http://forum.xda-developers.com/showpost.php?p=54790398&postcount=2179) that we may increase the api level to a higher number (actual we use _minSdkVersion=""8""_) which means that if we change that we drop the support for older devices. For example, setting this value to ""11"" or higher allows the system to apply a new default theme (Holo) to your app when running on Android 3.0 or higher and also disables screen compatibility mode when running on larger screens (because support for API level 11 implicitly supports larger screens).

Personal I prefer to set the Api Level default to **15** (or better **17** _but I know some people crying with this decision_). 

Here are some reasons (from me) to change the level:
- Most people (according Google statistics) use 4.x 
- _AFWall+ is a security app_, and that means you should update your OS to latest (if possible) to get some benefits from it e.g. more security, new designs, new kernel and such things... 
- Other apps already use a higher Api level, like XPrivacy (15). 
- Remember: AFWall is open source it means you still can change it back yourself (but it will maybe break things in the future).
- If you stock OS don't get an update you still can use a AOSP (CyanogenMod) which almost have updates for every devices. 
- Higher api level also means new designs and more compatibility for newer devices.
- It's the same way like windows, everything has an ending, yes XP is dead my friends, accept it! Or do you still use XP without service packs (which means no usb 2.0/3.0) support? :game_die: 

Some cons would be:
- Backward compatibility will be broken on some older devices, e.g. Android 2.x / Android 3.x
-  AFWall+ lose some users 

Now it's your turn, we hear your voice, please leave a comment/feedback with some explanation.
**This thread will be closed if there is a final conclusion.**

Some useful links:
- [uses-sdk](https://developer.android.com/guide/topics/manifest/uses-sdk-element.html)
- [XDA AFWall+ thread](http://forum.xda-developers.com/showthread.php?t=1957231)
"
ukanth/afwall,closed,password protection fails after 2. try,"[Label(name=""Bug"")]","after setting a password, afwall ask for it at the next start, BUT if the entert password is wrong it ask again and then the wrong password lets you in - no matter what was typed in.
installed version 1.3.4., last version same problem
"
ukanth/afwall,closed,Gitter chat support,[],"Hey,
after some talk here on Github and on XDA I realized that we may need a chat room to talk about AFWall+ and the problems, wishes, off-topic, or whatever and I found a good solution. It's called [Gitter.im](https://gitter.im/).

Some benefits are:
- It provides a chat platform 
- Get some notifications (if you wish) if there is a new talker online 
- Archive, edit your own messages 
- It's free and also works on other platforms like Bitbucket and such 
- Create own channels (maybe soon pass protected, Gitter is still beta some features coming)
- Easy to use

Click on the link, authorizes Gitter.im to your Github account and that's it. You can now join / see the conversations if you click on the AFWall+ Gitter button (need to implement into the Readme.md like Travis that we already have).

This need to be added into our Readme.md (I'll make a pull request if ukanth agree soon):
Button:
<code><a href=""https://gitter.im/ukanth/afwall""><img src=""https://badges.gitter.im/ukanth/afwall.png""/></a></code>

I don't see anything which speaks against this, everyone can use or not use it, it's free for all Github users and feedback is always welcome I think. 
"
ukanth/afwall,open,Some patches ,"[Label(name=""Feature"")]","Hey,
I've created some patches (can't open pull request atm, so I must post this as internal bug report - damn tortoisegit, sorry!), what they do:
- Removed the Todo section from the README.md into the TODO.md (since it's very big - because it also includes the already fixed section)
- added lint language tools, _/tools/some_scripts.sh_ You neet to set the $path and click on one of the scripts (what they do is written down within the scripts as comment - it's merged from F-Droid)
- fixed resource translations, do not hardcode it into the xml files, for these we have the values.xml, which means that we change it there, and not need to change it twice (will also fix that if you change your language to non-english it will in rare situation change back to eng.)

![patches zip](https://cloud.githubusercontent.com/assets/727123/3866687/37ba9214-1fdf-11e4-952a-17dc5769cd06.jpg)

Mirror:
http://www52.zippyshare.com/v/92835292/file.html

**Remove .jpg extension to see _patches.zip_!**

**Update1:**
I also added the missing .settings folder + eclipse files, now people can import the project in eclipse/android studio. Make sure you not included this file in the .gitignore and upload it in all trees. Don't worry about the XposedBridgeApi and android-support-v13 it also works without Xposed support atm. I changed v4 to v14 since it offers some more features.

http://www59.zippyshare.com/v/320189/file.html

I will re-upload all things if all is done, working on something...
"
ukanth/afwall,closed,Update about.html,[],"~ small resource update
"
ukanth/afwall,open,[Bug?]SwiftKey is not blockable,"[Label(name=""Question"")]","I set up AFWall+ to block SwiftKey by NOT putting it on the whitelist. Interestingly SwiftKey shows up in the ""Firewall Logs"" (Total Packets Blocked: 17, [TCP] 54.(230|246|72)._._) but in BetterBatteryStats under ""Network"" SwiftKey still shows up as ""com.touchtype.swiftkey.SwiftKey"" 10098 (Mobile), 1.0 MBytes.

What can I do to help debugging this problem?
I would like to completely block SwiftKey from accessing the Internet.

Thank you!
"
ukanth/afwall,closed,Changes for 1.3.4 from beta,[],
ukanth/afwall,closed,Changelog update,[],"Some fixes like typos and such
Now we have categories -> [Bugs], [Enhancements], [Features] & [Translations] for a clean and fresh look
"
ukanth/afwall,open,FR Longer Custom Script Window,"[Label(name=""Feature"")]","Hi

The script window is so short that it makes it hard to edit and copy paste. I realize that it is recommended to use custom scripts. however having a taller window would not hurt.

thanks
"
ukanth/afwall,closed,faq.html update,[],"~ faq added 
~ some small changes
"
ukanth/afwall,closed,about.html update,[],"~ Alphabetically order under the language section
~ Credits updated
~ Missing used 3rd Party Libraries added
"
ukanth/afwall,closed,Update Readme.md,[],"- added Translations section 

~ changed outdated NDK to latest (10), same with GCC [they are both backwards compatible]

~ smaller changes like typos and spelling

~ added missing projects alphabetically under Acknowledgements

~ Todo list updated and now it's a already done and todo list  -> x = already done [ ] todo (better look I think)

@ukanth please also update the readme's in the donate/master branches (thanks)
"
ukanth/afwall,closed,rules.log stores both IPv4/IPv6 in the same file name,"[Label(name=""Bug"")]","This is a low prio enhancement but should be easy to fix.

If Ipv6 is enabled and we export the firewall log to _/sdcard/afwall/_ it export the default log <code>rules.log</code>. Now if we switch to IPv6 it will export the rules with the same name, which means the rules.log will be overwritten!

I think we should add a check if IPv6 is enabled and we exporting the log file that it should named as _IPv4rules.log_ and for IPv6 _IPv6rules.log_ , or we general separate the log into IPv4rules.log/IPv6.rules.log to not confusing the people. 

If it's not fixed in the next beta version I'll make a pull request. :boom:
"
ukanth/afwall,closed,Add Support for Tinc,"[Label(name=""Feature""), Label(name=""Wont-Fix"")]","I'm using Tinc VPN on my Mobil device Samsung Galaxy S2.
Could you Please add Support for the VPN this Program create? 

Android-client: https://github.com/Vilbrekin/tinc_gui
Background: http://www.tinc-vpn.org/

Thanks.
"
ukanth/afwall,open,nftables support,"[Label(name=""Feature"")]","I know, AFWall+ and no other firewall current supports the new [nftables](http://www.netfilter.org/projects/nftables/index.html), so I started this feature request from now (no one has started a ticket atm).
## Some important infos:
- Since Linux 3.13/3.14/3.15 [Kernel](http://git.kernel.org/cgit/linux/kernel/git/pablo/nftables.git) (since 2009)
- [Main differences with iptables](http://wiki.nftables.org/wiki-nftables/index.php/Main_differences_with_iptables)
- [Building nftables](http://wiki.nftables.org/wiki-nftables/index.php/Building_and_installing_nftables_from_sources)
- With this we also should drop the support for _older devices_, you know AFWall+ is more or less a security feature (well only a gui but contain it's own iptables/busybox and such) and that means user always should use the latest possible software, so I guess 4.x (and higher) if you asking me. Did anyone still use 2.3? Or 3? Not what I know, most users hanging on AOSP/OMNI/AOKP or Stock which also gets more or less up-2-date updates regular. 
- This will be a huge change, binaries, code and scripts need a change for it, but bigger changes always needs this to be done. 
- [nftables Wiki](http://wiki.nftables.org/wiki-nftables/index.php/Main_Page)
- Build from the same iptable guys Patrick McHardy and Pablo Neira Ayuso (I already wrote an email to Pablo Neira Ayuso to help me with this).
- [Xtables2 vs. nftables](http://lwn.net/Articles/531752/) also reveal some interesting info. 
- Example Android M script (works for IPv4/Ipv6), is avaible over [here](https://gist.github.com/CHEF-KOCH/6844205cbcf772db19aa)
- iptables 1.6+ will be able to import nftables exported stuff (now yet released)
- nftables 0.3/4+ can export rulesets to simplify things and backward compatibility 
"
ukanth/afwall,open,[Request] Reapply current profile via Tasker,"[Label(name=""Feature"")]","Currently it is only possible to reapply a predefined profile via Tasker. There are circumstances where the current profile (whichever is active) needs to be reapplied.
Therefore a request to either:
1. Ability to query the currently active profile
Or
2. Plugin option 'reapply current profile'
"
ukanth/afwall,closed,Update README.md,[],"- added Index for a better view and quicker access to the categories
- added Features
- added Limitations
- added Compatibility
- added Upgrading
- added Permissions
  ~ separated ToDo and already done (updated already done)
  ~ changed Compile AFWall+ text, some spelling corrections and the fellas should always use a recent software build (e.g. latest javac is 1.9 unstable) so I changed it to 1.8 stable 
- we should always mention that newer api's and versions are 99% backwards compatible ... so no need to hang on outdated stuff
"
ukanth/afwall,closed,"Branches mixup - beta is not beta, master is not up to date","[Label(name=""General"")]","The branches are mixed up.
On http://forum.xda-developers.com/showthread.php?t=1957231 you say by yourself, that there is no beta at the moment. So most recent software should be in master. But master is not been updated for months and the recent 1.3.3 should be in master and not (any more) in beta.

PS: Thanks for the great software!
"
ukanth/afwall,open,dnsmasq problem,"[Label(name=""Question"")]","I'm running dnsmasq for ad-blocking purposes on my phone as user -11.
Now I'm running into the issue that the firewall blocks dnsmasq  traffic, but the tethering option for dns & root apps is ticked.

I copied the content of rules.log into this gist: 
https://gist.github.com/icaruseffect/1a018c27a2b4d67826eb 

The firewall log gives me the following output:

AppID : -11 
Application's Name: 
Total Packets Blocked: 5 
[UDP]208.67.222.222:53(3) 
[UDP]8.8.8.8:53(2)

Any help would be appreciated
"
ukanth/afwall,closed,Torify button,"[Label(name=""Feature""), Label(name=""Wont-Fix"")]","Hello,

It would be really nice to be able to reproduce my [ iptables](https://github.com/EthACKdotOrg/nexus4-iptables) script in AFWall. In order to do that, AFWall would need to:
- set DROP policy for INPUT, OUTPUT and FORWARD chains (with some rules in order to let some internal stuff work, like lo interface of course)
- add, for each selected app, a rule allowing it to access Orbot ports (TransProxy, Polipo, SOCKS) in nat table

This, in conjunction with the ""whitelist"" and ""prevent leak"" init-script provided by AFWall, would just be _the_ thing. Really.

Would it be possible? I really don't think it would be that hard…

Cheers,

C.
"
ukanth/afwall,closed,[Request] Ability to define different custom scripts based on different profiles,[],
ukanth/afwall,closed,Update about.html,[],"TYPO fixed
"
ukanth/afwall,closed,FAQ - selective host blocking,"[Label(name=""General""), Label(name=""Question"")]","I've read the [XDA post](http://forum.xda-developers.com/showthread.php?t=1957231) and [the FAQ](https://github.com/ukanth/afwall/wiki/FAQ) but can't tell before installing the app if it can block or allow access to specific hosts. For instance, I'd like to allow an SMS app to only access my mobile provider's SMS center, but nothing else like phoning home or an ad network.

Please add whether this is possible to the FAQ and the XDA post. Thanks!
"
ukanth/afwall,closed,Add some URL to the GitHub Repo URL,"[Label(name=""General"")]","Such one that directs to the XDA forum, http://tinyurl.com/AFWall

![image](https://cloud.githubusercontent.com/assets/33569/3548952/77888092-08bd-11e4-9a8b-b8428c749368.png)
"
ukanth/afwall,closed,Can you please clarify custom script path issue in the document?,"[Label(name=""General""), Label(name=""Howtos"")]","Hi

The document says that one can define a script and put the path in there with the dot convention however  the document is not clear about the nature of the path. Is this an absolute path or relative to the users home folder etc?

thanks
"
ukanth/afwall,closed,"AFWall show ""No root acccess"" error, when try to apply Anti-Spoof iptables","[Label(name=""Bug"")]","How to:
$IPTABLES -I INPUT --source ""0.0.0.0/8"" -j DROP
$IPTABLES -I INPUT --source ""10.0.0.0/8"" -j DROP
$IPTABLES -I INPUT --source ""169.254.0.0/16"" -j DROP
$IPTABLES -I INPUT --source ""172.16.0.0/20"" -j DROP
$IPTABLES -I INPUT --source ""192.168.0.0/16"" -j DROP
$IPTABLES -I INPUT --source ""224.0.0.0/4"" -j DROP
$IPTABLES -I INPUT --source ""240.0.0.0/5"" -j DROP
$IPTABLES -I INPUT --source ""255.255.255.255/32"" -j DROP
$IPTABLES -I INPUT --destination ""0.0.0.0/8"" -j DROP
$IPTABLES -I INPUT --destination ""10.0.0.0/8"" -j DROP
$IPTABLES -I INPUT --destination ""169.254.0.0/16"" -j DROP
$IPTABLES -I INPUT --destination ""172.16.0.0/20"" -j DROP
$IPTABLES -I INPUT --destination ""192.168.0.0/16"" -j DROP
$IPTABLES -I INPUT --destination ""224.0.0.0/4"" -j DROP
$IPTABLES -I INPUT --destination ""239.255.255.0/24"" -j DROP
$IPTABLES -I INPUT --destination ""240.0.0.0/5"" -j DROP
$IPTABLES -I INPUT --destination ""255.255.255.255/32"" -j DROP

Paste them to ""Set Custom Script"". Try to apply it.

Result:
Fail to apply iptables. AFwall says no root access error.

Expected:
Let me apply these rules in order to block Spoof attack.
"
ukanth/afwall,closed,"[Bug] AFWall can't handle ""!"" (negative) flag","[Label(name=""Bug"")]","Cyanogenmod 10.1 / Android 4.x device

Problem:
Can't apply this iptables (error):
$IPTABLES -A ""afwall"" -p UDP --dport 123 ! --destination ""10.20.30.40"" -j ""afwall-reject""

(Meaning: Block NTP only if destination is NOT 10.20.30.40)

I tried:
- Change ""--destination"" to ""-d 10.20.30.40/32"".

Settings:
IPTables binary: Auto
Busybox: BuiltIn
DNSProxy: Auto
Version: v1.3.2
"
ukanth/afwall,open,VPN networking require root apps to work (v1.3.2 from FDroid),"[Label(name=""Bug"")]","## [ - ] ... Not checked / [V] ... Checked

3G, Wifi
[[ - ](root) Apps running as root
[[ V ]VPN Networking
[[ - ] Linux Kernel
## Result: can NOT connect to L2TP VPN

3G, Wifi
[[V](root) Apps running as root
[[V]VPN Networking
[[ - ] Linux Kernel
## Result: can connect to L2TP VPN

Why should I allow root apps in order to connect VPN?
"
ukanth/afwall,closed,Question about AFWall guide,"[Label(name=""Question"")]","https://github.com/ukanth/afwall/wiki/CustomScripts

> afwall - This is the main AFWall+ chain. All OUTPUT packets will pass through it.
> Block all connections in the TCP port 80 (http) 
> $IPTABLES -A ""afwall-web"" -p TCP --dport 80 -j ""afwall-reject""

Q1: What is ""afwall-web""? Isn't it ""afwall""?
Q2: And what if I'm using VPN? Is there something like ""afwall-vpn""?
Q3: Below is what I want to do: is my script correct?
Q4: Does AFWall block all incoming packet BY DEFAULT? If not, what should I do to block them?
Q5: What is [128]? (My android block this connection... 6.28.154.204 is a goverment... WTF!)
""[128]6.28.154.204:80(2)"" <--- from log

// I want to allow 1.2.3.4/TCP80,8080
// I want to allow 10.20.30.40/vpn, 10.20.30.100/vpn
// Drop other packet hardly (can I also use INVALID?)
# 

$IPTABLES -A ""afwall"" -p TCP --destination ""1.2.3.4"" --dport 80 -j RETURN
$IPTABLES -A ""afwall"" -p TCP --destination ""1.2.3.4"" --dport 8080 -j RETURN

$IPTABLES -A ""afwall"" -p UDP --destination ""10.20.30.40"" --dport 500 -j RETURN
$IPTABLES -A ""afwall"" -p UDP --destination ""10.20.30.40"" --dport 4500 -j RETURN
$IPTABLES -A ""afwall"" -p UDP --destination ""10.20.30.100"" --dport 500 -j RETURN
$IPTABLES -A ""afwall"" -p UDP --destination ""10.20.30.100"" --dport 4500 -j RETURN

$IPTABLES -A ""afwall"" -p TCP -j ""afwall-reject""
$IPTABLES -A ""afwall"" -p UDP -j ""afwall-reject""
$IPTABLES -A ""afwall"" -p ICMP -j ""afwall-reject""
# $IPTABLES -A ""afwall"" -m state --state INVALID -j ""afwall-reject""

---

Thank you for your kind answer :)
"
ukanth/afwall,open,feature request: 2 logging improvements,"[Label(name=""Feature"")]","1 add option to trace incoming traffic besides outgoing in logging function.
2 Add possibility to trace accepted connections as well as refused ones (only the later are logged)
"
ukanth/afwall,closed,logging notifications always on or no logging,"[Label(name=""Bug"")]","With ""Enable firewall log"" option ON, the notifications keep showing on the screen for each blocked application attempt to connect, even with 1- ""turn on log service"" set on OFF or 2- if application attempting connection is in ""filter application"" list. Expected behavior is that no notifications appear (not at all case 1, only for application  selected case2) BUT this activity should be accessible through reading afwall log.
"
ukanth/afwall,closed,Tag new release to fix klogripper issues upstream,[],"Could you please tag a new release so the klogripper fix trickles through f-droid?
"
ukanth/afwall,closed,LAN rule is not set/remembered,"[Label(name=""Bug"")]","I am using 1.3.1.1 from FDroid on Android 2.3.3.

I am connected to a wireless LAN.
I open AFWall+ and allow ""LAN"" access for an application (I use a whitelist).
I apply the firewall rules.
I run the app, it does NOT get network access.
If I ""reload applications"" in AFWall then the check mark on the box has gone.

This worked correctly in the previous version.
"
ukanth/afwall,closed,Linux kernel & root apps,[],"Hello,
I'm using AFWall+ v.1.3.1.1 with CyanogenMod Version 11 with Android 4.4.2.
I have to say that I'm a little irritated using White-list mode.

I have NOT allowed Linux kernel or root apps to access any interface. But with Network Log I can see that many packets pass the firewall (Kernel -1) and (root 0). In root 0 mostly DNS UDP (Port 53) packets. But in Kernel -1 also HTTPS (Port 443) connections to different IPs. How is this possible if I don't whitelist root apps or linux kernel? Does this filter options really makes sense?

Thanks.
Markus
"
ukanth/afwall,closed,Block a specific app but re-installing unblocks it.,"[Label(name=""Wont-Fix"")]","I want to block one specific app, so I use 'blacklist' mode and select that app. But when it is uninstalled and re-installed, it is unchecked; apparently AFWall+ does not remember it as being the same app.

So I tried the whitelist mode, and selected all items in the list, excluding the app I want to block. I assume that any newly installed apps will automatically be blocked in whitelist mode. But AFWall+ does not block the un-selected app in whitelist mode.

I am using Samsung Galaxy Fame Duos (GT-6812) running Android 4.1.2 and kernel 3.0.15-1078189.

Can anyone help?
"
ukanth/afwall,closed,latest update repeatedly asks for root and fails,"[Label(name=""Bug"")]","I had to restore a titanium backup of older version of afwall.

Newest version on  my Galaxy Note 2 with JediX ROM keeps asking for root privileges and fails.  Its annoying.  I am using SuperSU paid version.  I never had this problem during the last year.

I read your explanation and its very confusing.  Seems like you are asking every Android developer to follow certain ""correct"" secure protocol?  Thats like asking everyone who drives a car to never drive over the speed limit.

I wont be updating or donating until this is fixed.
"
ukanth/afwall,open,RETURN target ignores Multiuser rules in 1.2.9,"[Label(name=""Bug"")]","Running KK 4.4.2 ; testing AFWall+ experimental Multiuser functionality in version 1.2.9 (due to issue #270, unable to test in 1.3.0.2).

Apparently, AFWall+ uses the **_RETURN_** target instead of **_ACCEPT_** when setting up rules (is this related to whitelist/blacklist functionality ?).

While this works for single-user setups, it appears to fail for multiuser, as qualifying packets in the secondary users chains are never ACCEPTed, but are subsequently REJECTed in the next user chain ?
#### Example :

A packet for application 1010061 (userid=10) matches in _afwall10-wifi-wan#9_.
It is my impression it then RETURNs, is matched again by _afwall0-wifi-wan#31_ (it should never enter the afwall0 target in the first place, as it is already matched in afwall10), and is subsequently REJECTed in _afwall0-reject#2_.

**_Manually changing the target in afwall10-wifi-wan#9 from RETURN to ACCEPT allows the packet to traverse, as intended._**

```
Chain OUTPUT (policy ACCEPT 111 packets, 9659 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1      223 16427 afwall10   all  --  *      *       0.0.0.0/0            0.0.0.0/0           
2      627 52147 afwall0    all  --  *      *       0.0.0.0/0            0.0.0.0/0           
3    41929 2400K afwall     all  --  *      *       0.0.0.0/0            0.0.0.0/0           
```

```
Chain afwall10-wifi-wan (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1        5   331 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 0
...
9       32  1920 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 1010061
...
12      80  4848 afwall10-reject  all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 0-999999999
```

```
Chain afwall0 (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1        0     0 afwall0-wifi  all  --  *      eth+    0.0.0.0/0            0.0.0.0/0           
2      233 16482 afwall0-wifi  all  --  *      wlan+   0.0.0.0/0            0.0.0.0/0           
...
```

```
Chain afwall0-wifi (5 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      233 16482 afwall0-wifi-postcustom  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
```

```
Chain afwall0-wifi-postcustom (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1        0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 1014
2        0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 1010
3      203 14167 afwall0-wifi-fork  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
```

```
Chain afwall0-wifi-fork (2 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      202 14107 afwall0-wifi-wan  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
```

```
Chain afwall0-wifi-wan (1 references)
...
31     145  8732 afwall0-reject  all  --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 0-999999999
```

```
Chain afwall0-reject (5 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      120  7232 LOG        all  --  *      *       0.0.0.0/0            0.0.0.0/0            limit: avg 1000/min burst 5 LOG flags 8 level 4 prefix ""{AFL}""
2      145  8732 REJECT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable
```
"
ukanth/afwall,closed,FC when accessing Experimental Settings in 1.3.0.2,"[Label(name=""Bug"")]","Running KK 4.4.2 ; removed AFWall+ 1.2.9 en clean-installed 1.3.0.2.

When opening Preferences > Experimental Settings, AFWall+ crashes : 

```
I/ActivityManager(  449): START u0 {cmp=dev.ukanth.ufirewall/.preferences.PreferencesActivity} from pid 3772
D/dalvikvm( 3772): GC_CONCURRENT freed 700K, 53% free 10099K/21240K, paused 6ms+8ms, total 84ms
I/ActivityManager(  449): Displayed dev.ukanth.ufirewall/.preferences.PreferencesActivity: +536ms
D/AndroidRuntime( 3772): Shutting down VM
W/dalvikvm( 3772): threadid=1: thread exiting with uncaught exception (group=0x41bd7ba8)
E/AndroidRuntime( 3772): FATAL EXCEPTION: main
E/AndroidRuntime( 3772): Process: dev.ukanth.ufirewall, PID: 3772
E/AndroidRuntime( 3772): java.lang.IllegalStateException: Dependency ""enableLog"" not found for preference ""enableLogService"" (title: ""Turn on log service""
E/AndroidRuntime( 3772):    at android.preference.Preference.registerDependency(Preference.java:1163)
E/AndroidRuntime( 3772):    at android.preference.Preference.onAttachedToActivity(Preference.java:1152)
E/AndroidRuntime( 3772):    at android.preference.PreferenceGroup.onAttachedToActivity(PreferenceGroup.java:277)
E/AndroidRuntime( 3772):    at android.preference.PreferenceScreen.bind(PreferenceScreen.java:147)
E/AndroidRuntime( 3772):    at android.preference.PreferenceFragment.bindPreferences(PreferenceFragment.java:330)
E/AndroidRuntime( 3772):    at android.preference.PreferenceFragment.onActivityCreated(PreferenceFragment.java:171)
E/AndroidRuntime( 3772):    at android.app.Fragment.performActivityCreated(Fragment.java:1708)
E/AndroidRuntime( 3772):    at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:908)
E/AndroidRuntime( 3772):    at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:1062)
E/AndroidRuntime( 3772):    at android.app.BackStackRecord.run(BackStackRecord.java:684)
E/AndroidRuntime( 3772):    at android.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1447)
E/AndroidRuntime( 3772):    at android.app.FragmentManagerImpl$1.run(FragmentManager.java:443)
E/AndroidRuntime( 3772):    at android.os.Handler.handleCallback(Handler.java:733)
E/AndroidRuntime( 3772):    at android.os.Handler.dispatchMessage(Handler.java:95)
E/AndroidRuntime( 3772):    at android.os.Looper.loop(Looper.java:136)
E/AndroidRuntime( 3772):    at android.app.ActivityThread.main(ActivityThread.java:5017)
E/AndroidRuntime( 3772):    at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime( 3772):    at java.lang.reflect.Method.invoke(Method.java:515)
E/AndroidRuntime( 3772):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:779)
E/AndroidRuntime( 3772):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:595)
E/AndroidRuntime( 3772):    at de.robv.android.xposed.XposedBridge.main(XposedBridge.java:132)
E/AndroidRuntime( 3772):    at dalvik.system.NativeStart.main(Native Method)
W/ActivityManager(  449):   Force finishing activity dev.ukanth.ufirewall/.preferences.PreferencesActivity
W/ActivityManager(  449): Activity pause timeout for ActivityRecord{432585b8 u0 dev.ukanth.ufirewall/.preferences.PreferencesActivity t3 f}
D/dalvikvm( 1897): GC_CONCURRENT freed 493K, 68% free 5381K/16320K, paused 5ms+3ms, total 36ms
```
"
ukanth/afwall,closed,Connection confirm dialog - feature proposal,"[Label(name=""Feature"")]","Hi,

thanks for great project.
Anyway, I'd be willing to implement this, just wanted to start wider discussion.

I really like Little Snitch user-flow feature, which creates rules per application (by it's path), user id (by process identifier) and per connection (each time application requests to open connection, it will lookup in white/black-list, and without rule applicable to current situation, will throw user dialog to confirm what to do.

To illustrate the situation, i include few screenshots of LS3

![Standard dialog](https://cloud.githubusercontent.com/assets/384824/2626617/bbb7d03e-bdda-11e3-8299-a4eb9cea63ae.png)
![Time based rules](https://cloud.githubusercontent.com/assets/384824/2626616/bbb6a498-bdda-11e3-9848-6755da0c2b4f.png)
![Domain / Port based rules](https://cloud.githubusercontent.com/assets/384824/2626615/bbb613ac-bdda-11e3-9b64-b21ce0e7665f.png)

It would be really handy to get confirmation dialog on each connection, where rules are made per application uid/guid

Rules (per app)
- URL + PORT
- DOMAIN + PORT
- PORT (any url/domain)
- URL (any port)
- DOMAIN (any port)
- Anything (any domain/url/port, the app is fully trusted then)

Time based
- Once
- Time interval (5,10,15,30,60 minutes)
- Until process is killed (if possible)
- Until device is restarted
- Forever

Application should then provide permanent service notification, where the user could quickly access list of allowed/denied connections (eg. over last 15 minutes) and rules editor, where you could review and debug requests made by application (some short backlog) and see what rules are denying those requests, to easily fix wrongly set rules.

Possibly could be extended by accepting URL patterns similar to AdAway/AdBlock,
white/black-listing allowed underlying network type (cellular,wireless,tethered,vpn,...) and (which is really crazy detailed option) for HTTP requests types (such as GET,PUT,POST,DELETE,UPDATE,...)

So if you please could discuss over this proposal, what would fit your idea, as I said, I'm willing to implement this in open-source, because it would be really good privacy feature, which could possibly replace various adblock solutions and if divided into profiles (home,work,traveling) and user account specific (for multi-user android devices), make really solid user-friendly firewalling solution.
"
ukanth/afwall,closed,[Request] some user friendly option,"[Label(name=""Feature"")]","in option
1. allow system app automatically and hide in list
2. skip block message for same app in (1-10) minutes.
"
ukanth/afwall,closed,Migrating settings/profiles/rules from free to donated app,"[Label(name=""Feature""), Label(name=""Question"")]","I think its about time i finally  donate for this fantastic app,  its one of the good ones, thanks so much for your work in its continuation.

The only thing is, i thought it might be a ""license"" donation,  turns out its another copy of the app,  so my question is,  is there a simple fast way to copy the data entirely from the free app to the donation one,  like settings/profiles/rules?
"
ukanth/afwall,closed,Widget icon not refreshing,"[Label(name=""Bug"")]","Hi,
at first, thanks for your great work!

I've upgraded to the new version and the new widget doesn't change its color - after disabling FW it remains green.

And in general, I'am not happy with new widget. It extends the enabling/disabling process by two extra steps. I don't use profiles.
Sure, for most it is a nice improvement, but I belive that I'am not alone, who likes to just tap on an icon and thats all.
Please, would it be possible to preserve the old qick widget too?

Thanks and have a nice day,
Froggiewalker
Motorola Defy+, Android 2.3.4
"
ukanth/afwall,closed,Widget display,"[Label(name=""Bug"")]","Is the widget supposed to look like this?

https://mega.co.nz/#!YpxGiKbb!_sFv1sGFLKe_vj8qsVktorTHS-hU8ISmFohjS7bgEk8

OmniRom 4.4.2 on Galaxy Note II
"
ukanth/afwall,closed,Slow operations in UI thread,[],"Dear developers,

I am analyzing AFWall+ using a static code checker. I found some potential slow operations in AFWall+'s UI thread.

Android documentation says this: 
http://developer.android.com/training/articles/perf-anr.html

""Any method that runs in the UI thread should do as little work as possible on that thread. In particular, activities should do as little as possible in key life-cycle methods such as onCreate(). Potentially long running operations such as network or database operations should be done in a worker thread (e.g., via AsyncTask).""

I found the following event handlers transitively performing heavy operations:

dev.ukanth.ufirewall.LogActivity.onCreate() which calls File IO operations.

The call hierarchy is shown below:
dev.ukanth.ufirewall.Api.parseLog(Landroid/content/Context;Ljava/lang/String;)Ljava/lang/String;
dev.ukanth.ufirewall.LogActivity.parseAndSet(Landroid/content/Context;Ljava/lang/String;)V
dev.ukanth.ufirewall.LogActivity.populateData(Landroid/content/Context;)V
dev.ukanth.ufirewall.DataDumpActivity.onCreate(Landroid/os/Bundle;)V
dev.ukanth.ufirewall.LogActivity.onCreate(Landroid/os/Bundle;)V

Do you think these operations affect AFWall+'s performance? If yes, perhaps moving these actions to a separate thread can help make AFWall+ super smooth in user interaction. Looking forward to your reply and hope I can help improve AFWall+.
"
ukanth/afwall,closed, Afwall Load up speed 1.2.9,"[Label(name=""Bug"")]","Afwall  1.2.9
HTC explorer android 4.1 cm 
# After updating afwall to the latest version, the load up speed is reduced significantly.
# The application takes too much time with ""Retrieving installed application list""
# I have approximately 350+ applications

£ It would be better, if the application used a cached copy of the application list, -given the fact that it already detects installation/uninstallation of any application.  
OR/AND
£ A cached copy of application list may be shown  directly after opening the application. Mean while ""Retrieving installed application list""can run in the background for further changes, which if present can be displayed the next time the application opens. 

Expecting your expert opinion on the subject and a possible fix. 
"
ukanth/afwall,closed,[Feature Request] Allow only specific IPs/Ports by App,"[Label(name=""Feature"")]","First of All, thanks for that nice App for Android.

One thing I currently miss at most is the possiblity to allow a specific app only to connect to a specific IP/Port. For example if I got a FTP client, which should only connect to ftp.mydomain.com, but not to a other domains/IPs. 

This would also be usefull to get rid of the fact, that much apps talking home. So to stick with the explaination above, we can be somewhat safer, that their isn´t any other connection from the app, which might smuggling any data to any other servers. This could really fight the fact that there are currently to much apps in the android ecosystem which are doing this.

For me it is really one of the most important feature for a firewall.

Thanks forward.
"
ukanth/afwall,closed,No GPS after installing AFWall+,"[Label(name=""Bug"")]","Hello,

I have a:
- Samsung Galaxy 3 I5800
- [ROM][2.3.7] CyanogenMod 7.2 (Alpha9 - 10/03/2013)
- AFWall+ (Android Firewall +) v1.2.9

If I start ""GPS Status & Toolbox"" (or Navigon) I:
- can see the GPS indicator icon in the toolbar
- status notifications from ""GPS Status & Toolbox""
- have a GPS lock

After installing AFWall+ and restart my phone (with or without activating the firewall), GPS isn't working anymore:
- No GPS icon
- no status notification from ""GPS Status & Toolbox""
- no GPS lock

This doesn't happen if I install the old DroidWall or ""Android Firewall"". Only with AFWall+.
"
ukanth/afwall,closed,German Translation Update,[],"Improved / corrected translation.
"
ukanth/afwall,closed,Restrict multi-user mode configuration to owner account,"[Label(name=""Bug"")]","I can't get multi-user mode to work reliably on my tablet with a custom Cyanogenmod 10.2 ROM. I suspect it's because of conflicting options or iptable rules when two instances of afwall are run by the owner and another user (u10, u11, etc).

I believe the problem can be fixed by changes to the afwall UI that will either (1) restrict iptables administration to the owner; or (2) allow other users to configure only User apps enabled for their accounts (no Core or System apps).

Under my first suggestion (1), only the owner account can enable, disable or otherwise configure afwall. When started by another user, afwall can display a warning like ""Switch to owner account to configure afwall"".

Only the owner will be allowed to whitelist or blacklist apps, including apps enabled for other users. This will make the list of installed apps longer for systems with multiple users. However, a filter can be added to show or hide apps installed for other users. Such apps can also be ""tagged"" by user name. For example, the Firefox app installed for user Alice (user 10) can be shown in the list of installed apps as ""Firefox (Alice)"" or ""Firefox (u10)"".

Alternatively, afwall can provide a separate list of User apps for each user. Apps installed for users other than the owner account will be grouped together in a separate window or tab with the corresponding user label (Alice's apps will appear under the Alice tab, Bob's apps under the Bob tab, etc).
"
ukanth/afwall,closed,"Rules work for Wifi, don't work for Data: Nexus 4, SimKat RC3 4.4.2","[Label(name=""Bug"")]","I just installed SlimKat RC3 4.4.2 on my Nexus 4 and I thought Afwall+ was broken because it didn't block anything. So I tried turning on wifi just to check and then Afwall+ worked normally.

Previously I had PAC 4.3 and it worked, as well as working on every other device I've owned.  I do nothing but install it, set the app rules and hit Start.

As a secondary bug, I tried to ""Send Error Report"" through the Firewall Rules page and I would get the a ""Gmail has suddenly closed"" error.
"
ukanth/afwall,open,USB/Bluetooth Tethering fails on CM11 mako,"[Label(name=""Bug""), Label(name=""DNS"")]","With AFWall (latest 1.2.9) turned on, the DHCP Service of the Android Device is blocked. Tethering is possible with static address. Incoming DHCP requests reach dnsmasq on Android, but the answer is blocked (Information collected with logcat and dhcpdump). Tethering, kernel, root apps and adb is turned on. 

Interface tethering (Android): usb0
Interface inet (Android): wlan0

In AFWall Log it says during trying dhcp, that it blocked Packages to AppID:0 (Root), but this category is allowed for both wifi and 3g (Does it maybe need to be allowed for usb0 , which is not in the gui?).

Output of ""iptables -L"" for no firewall (working (iptnfw)) and with afwall turned on (not working (iptfw)) is presented.

**iptnfw:**

```
root@mako:/ # iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination
bw_INPUT   all  --  anywhere             anywhere
fw_INPUT   all  --  anywhere             anywhere

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination
oem_fwd    all  --  anywhere             anywhere
fw_FORWARD  all  --  anywhere             anywhere
bw_FORWARD  all  --  anywhere             anywhere
natctrl_FORWARD  all  --  anywhere             anywhere         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
oem_out    all  --  anywhere             anywhere
fw_OUTPUT  all  --  anywhere             anywhere
bw_OUTPUT  all  --  anywhere             anywhere
st_filter_OUTPUT  all  --  anywhere             anywhere        

Chain bw_FORWARD (1 references)
target     prot opt source               destination
           all  --  anywhere             anywhere             ! quota globalAlert: 2097152 bytes

Chain bw_INPUT (1 references)
target     prot opt source               destination
           all  --  anywhere             anywhere             ! quota globalAlert: 2097152 bytes
           all  --  anywhere             anywhere             owner socket exists

Chain bw_OUTPUT (1 references)
target     prot opt source               destination
           all  --  anywhere             anywhere             ! quota globalAlert: 2097152 bytes
           all  --  anywhere             anywhere             owner socket exists

Chain bw_costly_shared (0 references)
target     prot opt source               destination
bw_penalty_box  all  --  anywhere             anywhere          

Chain bw_happy_box (0 references)
target     prot opt source               destination

Chain bw_penalty_box (1 references)
target     prot opt source               destination

Chain fw_FORWARD (1 references)
target     prot opt source               destination

Chain fw_INPUT (1 references)
target     prot opt source               destination

Chain fw_OUTPUT (1 references)
target     prot opt source               destination

Chain natctrl_FORWARD (1 references)
target     prot opt source               destination
natctrl_tether_counters  all  --  anywhere             anywhere            [goto]  state RELATED,ESTABLISHED
DROP       all  --  anywhere             anywhere             state INVALID
natctrl_tether_counters  all  --  anywhere             anywhere            [goto]
DROP       all  --  anywhere             anywhere

Chain natctrl_tether_counters (2 references)
target     prot opt source               destination
RETURN     all  --  anywhere             anywhere             counter usb0_wlan0: 0 bytes
RETURN     all  --  anywhere             anywhere             counter wlan0_usb0: 0 bytes

Chain oem_fwd (1 references)
target     prot opt source               destination

Chain oem_out (1 references)
target     prot opt source               destination

Chain st_filter_OUTPUT (1 references)
target     prot opt source               destination

**iptfw:**
root@mako:/ # iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination
bw_INPUT   all  --  anywhere             anywhere
fw_INPUT   all  --  anywhere             anywhere

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination
oem_fwd    all  --  anywhere             anywhere
fw_FORWARD  all  --  anywhere             anywhere
bw_FORWARD  all  --  anywhere             anywhere
natctrl_FORWARD  all  --  anywhere             anywhere         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
afwall     all  --  anywhere             anywhere
oem_out    all  --  anywhere             anywhere
fw_OUTPUT  all  --  anywhere             anywhere
bw_OUTPUT  all  --  anywhere             anywhere
st_filter_OUTPUT  all  --  anywhere             anywhere        

Chain afwall (1 references)
target     prot opt source               destination
afwall-wifi  all  --  anywhere             anywhere
afwall-wifi  all  --  anywhere             anywhere
afwall-wifi  all  --  anywhere             anywhere
afwall-wifi  all  --  anywhere             anywhere
afwall-wifi  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere
afwall-3g  all  --  anywhere             anywhere

Chain afwall-3g (13 references)
target     prot opt source               destination
afwall-3g-postcustom  all  --  anywhere             anywhere    

Chain afwall-3g-fork (2 references)
target     prot opt source               destination
afwall-3g-home  all  --  anywhere             anywhere          

Chain afwall-3g-home (1 references)
target     prot opt source               destination
afwall-reject  all  --  anywhere             anywhere           

Chain afwall-3g-postcustom (1 references)
target     prot opt source               destination
afwall-3g-fork  all  --  anywhere             anywhere          

Chain afwall-3g-roam (0 references)
target     prot opt source               destination
afwall-reject  all  --  anywhere             anywhere           

Chain afwall-3g-tether (0 references)
target     prot opt source               destination
RETURN     udp  --  anywhere             anywhere             owner UID match root udp dpt:domain
RETURN     udp  --  anywhere             anywhere             owner UID match nobody udp dpt:domain
RETURN     tcp  --  anywhere             anywhere             owner UID match root tcp dpt:domain
RETURN     tcp  --  anywhere             anywhere             owner UID match nobody tcp dpt:domain
afwall-3g-fork  all  --  anywhere             anywhere          

Chain afwall-reject (5 references)
target     prot opt source               destination
NFLOG      all  --  anywhere             anywhere             nflog-prefix  ""{AFL}"" nflog-group 40
REJECT     all  --  anywhere             anywhere             reject-with icmp-port-unreachable

Chain afwall-vpn (0 references)
target     prot opt source               destination
afwall-reject  all  --  anywhere             anywhere           

Chain afwall-wifi (5 references)
target     prot opt source               destination
afwall-wifi-postcustom  all  --  anywhere             anywhere  

Chain afwall-wifi-fork (2 references)
target     prot opt source               destination
afwall-wifi-lan  all  --  anywhere             192.168.5.0/24   
afwall-wifi-wan  all  --  anywhere            !192.168.5.0/24   

Chain afwall-wifi-lan (1 references)
target     prot opt source               destination
RETURN     udp  --  anywhere             anywhere             udp dpt:domain
RETURN     all  --  anywhere             anywhere             owner UID match root
RETURN     all  --  anywhere             anywhere             owner UID match system
RETURN     all  --  anywhere             anywhere             owner UID match bluetooth
RETURN     all  --  anywhere             anywhere             owner UID match adb
RETURN     all  --  anywhere             anywhere             owner UID match media
RETURN     all  --  anywhere             anywhere             owner UID match gps
RETURN     all  --  anywhere             anywhere             owner UID match shell
RETURN     all  --  anywhere             anywhere             owner UID match u0_a0
RETURN     all  --  anywhere             anywhere             owner UID match u0_a4
RETURN     all  --  anywhere             anywhere             owner UID match u0_a7
RETURN     all  --  anywhere             anywhere             owner UID match u0_a19
RETURN     all  --  anywhere             anywhere             owner UID match u0_a20
RETURN     all  --  anywhere             anywhere             owner UID match u0_a21
RETURN     all  --  anywhere             anywhere             owner UID match u0_a29
RETURN     all  --  anywhere             anywhere             owner UID match u0_a44
RETURN     all  --  anywhere             anywhere             owner UID match u0_a54
RETURN     all  --  anywhere             anywhere             owner UID match u0_a57
RETURN     all  --  anywhere             anywhere             owner UID match u0_a63
RETURN     all  --  anywhere             anywhere             owner UID match u0_a64
RETURN     all  --  anywhere             anywhere             owner UID match u0_a65
RETURN     all  --  anywhere             anywhere             owner UID match u0_a66
RETURN     all  --  anywhere             anywhere             owner UID match u0_a67
RETURN     all  --  anywhere             anywhere             owner UID match u0_a68
RETURN     all  --  anywhere             anywhere             owner UID match u0_a72
RETURN     all  --  anywhere             anywhere             owner UID match u0_a75
RETURN     all  --  anywhere             anywhere             owner UID match u0_a77
RETURN     all  --  anywhere             anywhere             owner UID match u0_a78
RETURN     all  --  anywhere             anywhere             owner UID match u0_a79
RETURN     all  --  anywhere             anywhere             owner UID match u0_a81
RETURN     all  --  anywhere             anywhere             owner UID match u0_a83
RETURN     all  --  anywhere             anywhere             owner UID match u0_a84
RETURN     all  --  anywhere             anywhere             owner UID match u0_a86
RETURN     udp  --  anywhere             anywhere             udp dpt:domain owner UID match root
RETURN     udp  --  anywhere             anywhere             udp dpt:ntp owner UID match system
afwall-reject  all  --  anywhere             anywhere             owner UID match 0-999999999

Chain afwall-wifi-postcustom (1 references)
target     prot opt source               destination
RETURN     all  --  anywhere             anywhere             owner UID match dhcp
RETURN     all  --  anywhere             anywhere             owner UID match wifi
afwall-wifi-fork  all  --  anywhere             anywhere        

Chain afwall-wifi-tether (0 references)
target     prot opt source               destination
RETURN     udp  --  anywhere             anywhere             owner UID match root udp spt:bootps dpt:bootpc
RETURN     udp  --  anywhere             anywhere             owner UID match nobody udp spt:bootps dpt:bootpc
RETURN     udp  --  anywhere             anywhere             owner UID match root udp spt:domain
RETURN     udp  --  anywhere             anywhere             owner UID match nobody udp spt:domain
RETURN     tcp  --  anywhere             anywhere             owner UID match root tcp spt:domain
RETURN     tcp  --  anywhere             anywhere             owner UID match nobody tcp spt:domain
afwall-wifi-fork  all  --  anywhere             anywhere        

Chain afwall-wifi-wan (1 references)
target     prot opt source               destination
RETURN     all  --  anywhere             anywhere             owner UID match root
RETURN     all  --  anywhere             anywhere             owner UID match system
RETURN     all  --  anywhere             anywhere             owner UID match bluetooth
RETURN     all  --  anywhere             anywhere             owner UID match adb
RETURN     all  --  anywhere             anywhere             owner UID match media
RETURN     all  --  anywhere             anywhere             owner UID match gps
RETURN     all  --  anywhere             anywhere             owner UID match shell
RETURN     all  --  anywhere             anywhere             owner UID match u0_a4
RETURN     all  --  anywhere             anywhere             owner UID match u0_a19
RETURN     all  --  anywhere             anywhere             owner UID match u0_a20
RETURN     all  --  anywhere             anywhere             owner UID match u0_a21
RETURN     all  --  anywhere             anywhere             owner UID match u0_a29
RETURN     all  --  anywhere             anywhere             owner UID match u0_a44
RETURN     all  --  anywhere             anywhere             owner UID match u0_a54
RETURN     all  --  anywhere             anywhere             owner UID match u0_a57
RETURN     all  --  anywhere             anywhere             owner UID match u0_a63
RETURN     all  --  anywhere             anywhere             owner UID match u0_a64
RETURN     all  --  anywhere             anywhere             owner UID match u0_a65
RETURN     all  --  anywhere             anywhere             owner UID match u0_a66
RETURN     all  --  anywhere             anywhere             owner UID match u0_a67
RETURN     all  --  anywhere             anywhere             owner UID match u0_a68
RETURN     all  --  anywhere             anywhere             owner UID match u0_a72
RETURN     all  --  anywhere             anywhere             owner UID match u0_a75
RETURN     all  --  anywhere             anywhere             owner UID match u0_a77
RETURN     all  --  anywhere             anywhere             owner UID match u0_a78
RETURN     all  --  anywhere             anywhere             owner UID match u0_a81
RETURN     all  --  anywhere             anywhere             owner UID match u0_a83
RETURN     all  --  anywhere             anywhere             owner UID match u0_a84
RETURN     all  --  anywhere             anywhere             owner UID match u0_a86
RETURN     udp  --  anywhere             anywhere             udp dpt:domain owner UID match root
RETURN     udp  --  anywhere             anywhere             udp dpt:ntp owner UID match system
afwall-reject  all  --  anywhere             anywhere             owner UID match 0-999999999

Chain bw_FORWARD (1 references)
target     prot opt source               destination
           all  --  anywhere             anywhere             ! quota globalAlert: 2097152 bytes

Chain bw_INPUT (1 references)
target     prot opt source               destination
           all  --  anywhere             anywhere             ! quota globalAlert: 2097152 bytes
           all  --  anywhere             anywhere             owner socket exists

Chain bw_OUTPUT (1 references)
target     prot opt source               destination
           all  --  anywhere             anywhere             ! quota globalAlert: 2097152 bytes
           all  --  anywhere             anywhere             owner socket exists

Chain bw_costly_shared (0 references)
target     prot opt source               destination
bw_penalty_box  all  --  anywhere             anywhere          

Chain bw_happy_box (0 references)
target     prot opt source               destination

Chain bw_penalty_box (1 references)
target     prot opt source               destination

Chain fw_FORWARD (1 references)
target     prot opt source               destination

Chain fw_INPUT (1 references)
target     prot opt source               destination

Chain fw_OUTPUT (1 references)
target     prot opt source               destination

Chain natctrl_FORWARD (1 references)
target     prot opt source               destination
natctrl_tether_counters  all  --  anywhere             anywhere            [goto]  state RELATED,ESTABLISHED
DROP       all  --  anywhere             anywhere             state INVALID
natctrl_tether_counters  all  --  anywhere             anywhere            [goto]
DROP       all  --  anywhere             anywhere

Chain natctrl_tether_counters (2 references)
target     prot opt source               destination
RETURN     all  --  anywhere             anywhere             counter usb0_wlan0: 0 bytes
RETURN     all  --  anywhere             anywhere             counter wlan0_usb0: 0 bytes

Chain oem_fwd (1 references)
target     prot opt source               destination

Chain oem_out (1 references)
target     prot opt source               destination

Chain st_filter_OUTPUT (1 references)
target     prot opt source               destination
```
"
ukanth/afwall,closed,not internet connecton with afwall activated,"[Label(name=""Bug"")]","Hi,

today I have no internet connection if afwall+ is activated.

I granted all applications internet access, but nothing, only if I deactivate afwall.

firewall rules: http://pastebin.com/Djdnueux

It is the current afwall+ stable version 1.2.9 from play store.

Firewall logs are still empty.
I deleted app settings, but same problem as before.

Where can I find a current beta version?
"
ukanth/afwall,open,IPSec / L2TP connections broken,"[Label(name=""Bug"")]","I'm using OmniROM (4.4.2) nightlies. Either the OmniROM kernel does not support UDP connection tracking, AFWAll is failing to use connection tracking, or the default ruleset is breaking UDP connection tracking.

Enabling the ""inbound"" option in Preferences has no effect. AFWall has to be completely disabled to use the native VPN support.

In watching packet captures, I see that my device is returning ICMP unreachable when return packets arrive. The native Android client is using tunneled IPSec (4500/udp) as is common practice.
"
ukanth/afwall,closed,Merge Beta to Master - Prepare for 1.2.9,[],
ukanth/afwall,closed,Fixes for DataDumpActivity and FireReceiver,[],
ukanth/afwall,closed,Feature Request: A UI for rules editing. ,"[Label(name=""Feature"")]","What I miss most on this app is a User-interface (UI) to add/edit/remove custom rules.
If done well it would also eliminate errors like illegal chars.

I imagine the UI to be like this or or similar:

<ol>
    <li><em><b>Multi-view</b></em> of current rules:<ol>
        <li>A view like it is now, listing all apps.</li>
        <li>A view per chain.</li>
        <li>A view per application (user id)</li>
    </ol></li>
    <li><em><b>Short tap</b></em> on an entry:<br />
        Current functionality to view the log entries related to the one tapped.<br />
        Or switch to view-mode (1.iii)</li>
    <li><em><b>Long tap</b></em> on entry:<br />
        In all views except the overview mentioned in (1.i) view-mode.<br />
        A pop up with edit/remove option for the entry.</li>
    <li><em><b>Edit/Add entry</b></em> mode:<ol>
        <li>Checkbox + listbox with UID's available on the device.<br />
            When the checkbox is selected, the entry will only apply to the UID selected in the listbox.<br />
            The listbox should be automatically populated with the current available UID's on the device and it's entries accompanied with the description of the corresponding application for visual ease.</li>
        <li><em><b>Input part</b></em> of rule.<ol>
            <li>A listbox to select the protocol type,  like ANY/TCP/UDP/ICMP etc.</li>
            <li>A textbox to enter the <b>source</b> address in <a href=""https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing"" title=""Classless Inter-Domain Routing"">CIDR</a> format.</li>
        </ol></li>
        <li><em><b>Output part</b></em> of rule.<ol>
            <li>A listbox to select the protocol type,  like ANY/TCP/UDP/ICMP etc.</li>
            <li>A textbox to enter the <b>destination</b> address in <a href=""https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing"" title=""Classless Inter-Domain Routing"">CIDR</a> format.</li>
        </ol></li>
        <li><em><b>Target part</b></em> of rule.<ol>
            <li>A radio selection to select the jump target of the rule, to select either:<ol>
                <li>Build-in targets like REJECT/DROP/etc.</li>
                <li>Chain names that are available.</li>
            </ol></li>
            <li>A listbox to select from, the automatically populated, entries of the choice of the radio selection.</li>
        </ol></li>
        <li>A <em><b>commit button</b></em> ofcourse.</li>
    </ol></li>
</ol>


Feel free to comment, im sure there is more that can be added that i forgot now :)
"
ukanth/afwall,closed,"Error applying iptable rules (occasionally, not with ipv6)","[Label(name=""Bug"")]","I am occasionally getting a notifaction that says error applying iptable rules and then when I go into AFWall it shows that it's not enabled. I thought I had this problem: https://github.com/ukanth/afwall/issues/227. But I do not have IPv6 enabled.

Most of the time it works fine, but once every few days I get this message and have to reenable the firewell. I had this problem a while ago with a much older version of AFWall and it seemed to be fixed later. But now with 1.2.7 the problem has apparently returned.

After I have the problem sometimes there is nothing in the log for AFWall, other times it just shows something like:

12-23 15:02:56.284 D/AFWall (15738): Starting root shell...
12-23 15:02:56.435 D/AFWall (15738): Root shell is open
"
ukanth/afwall,closed,Tablets without GSM / hide mobile data,"[Label(name=""Feature"")]","Please add a checkbox to hide the ""mobile data"" column, it's not needed for devices without GSM module.
It could be done like the LAN- or VPN Control checkboxes. Or additionally automatic disabled if no GSM is detected
"
ukanth/afwall,closed,Merge Beta to Master - Prepare for 1.2.9,[],
ukanth/afwall,closed,Off-topic question about use of iptables from this repo,[],"I used the iptables binaries generated from this repo in Network Log (com.googlecode.networklog) but when the app tries to start logging there's a dialogue saying 'Error:no valid subcommand given . Valid subcommands: \* iptables, main4, iptables-save etc etc'. I reused the arm binary in res/raw/iptables_armv7.zip, but I get the same problem on an armv6 device. The recipe is horrendous but I think it's OK: https://gitorious.org/asdgasd/my-fdroiddata/source/e059822eeaf8e3d8da85e991a7ab776987217de7:metadata/com.googlecode.networklog.txt .The prebuilt binaries work OK. More generally, is it Ok to use iptables from here in other Android apps?
"
ukanth/afwall,closed,Merge beta to donate.,[],
ukanth/afwall,closed,Merge Beta to Master - Prepare for 1.2.8,[],
ukanth/afwall,closed,Trying to add these rules disables Afwall,"[Label(name=""Question"")]","Hi

I am trying to apply bunch of rules, including blocking some google ranges. When I apply them, Afwall disables itselfs. However I can pick one or two from the list below and apply them no problem. I am not sure if this is a problem with the number of rules or some ip. Since the custom script menu is very narrow it makes it hard to debug for me.

iptables -A INPUT -s 128.113.53.134 -j DROP
iptables -A INPUT -s 173.194.0.0/16 -j DROP
iptables -A INPUT -s 173.194.46.68 -j DROP
iptables -A INPUT -s 173.194.46.99  -j DROP
iptables -A INPUT -s 173.94.0.0/16 -j DROP
iptables -A INPUT -s 204.202.20.53  -j DROP
iptables -A INPUT -s 5.135.86.61 -j DROP
iptables -A INPUT -s 50.115.125.93 -j DROP
iptables -A INPUT -s 54.200.106.164 -j DROP
iptables -A INPUT -s 63.240.161.99 -j DROP
iptables -A INPUT -s 72.14.0.0/16 -j DROP
iptables -A INPUT -s 74.125.0.0/16 -j DROP
iptables -A INPUT -s 74.125.227.198  -j DROP
iptables -A INPUT -s 8.8.0.0/16 -j DROP
iptables -A INPUT -s 81.7.11.70 -j DROP

iptables -A OUTPUT -s 128.113.53.134 -j DROP
iptables -A OUTPUT -s 173.194.0.0/16 -j DROP
iptables -A OUTPUT -s 173.194.46.68 -j DROP
iptables -A OUTPUT -s 173.194.46.99  -j DROP
iptables -A OUTPUT -s 173.94.0.0/16 -j DROP
iptables -A OUTPUT -s 204.202.20.53  -j DROP
iptables -A OUTPUT -s 50.115.125.93 -j DROP
iptables -A OUTPUT -s 54.200.106.164 -j DROP
iptables -A OUTPUT -s 54.243.170.179 -j DROP
iptables -A OUTPUT -s 63.240.161.99 -j DROP
iptables -A OUTPUT -s 72.14.0.0/16 -j DROP
iptables -A OUTPUT -s 74.125.0.0/16 -j DROP
iptables -A OUTPUT -s 74.125.227.198  -j DROP
iptables -A OUTPUT -s 8.8.0.0/16 -j DROP
iptables -A OUTPUT -s 81.7.11.70 -j DROP
iptables -A OUTPUT -s 5.135.86.61 -j DROP
"
ukanth/afwall,closed,Problem with iptables (Android 4.0.4),"[Label(name=""DNS""), Label(name=""Question""), Label(name=""Wont-Fix"")]","OS: Android 4.0.4 + root
AFWall+: v 1.2.7

AFWall+ displays iptables error on switching firewall ON.

By the way, another firewalls for android didn't work too:
""Android Firewall"" doesn't block anything, but can turn ON\OFF, apllies rules and config changes.
""Root Firewall"" displays error on applying any rule:

""Error applying iptables rules. Exit code: 2
iptables v1.4.10: can't initialize iptables table 'filter': Table does not exist (do you need to insmod?)
Perhaps iptables or your kernel needs to be upgraded.""

It's a problem in OS Android on my device? Please, explain how can I fix it?

best regards, Kartataigoo.
(sorry for my bad english)
"
ukanth/afwall,closed,Option convert to /system app,"[Label(name=""Feature"")]","Create an option to convert AFWall to a system app. This should give AFWall better protection by being on a read-only sytem.

Once installed as a system app, add an option to install a backup script to /system/addon.d/ to protect both /system/app/AFWall and /system/etc/init.d/afwallstart to automatically restore AFWall and afwallstart after a ROM flash that supports it (like CM and derivatives).

Back up script: http://forum.xda-developers.com/showpost.php?p=49230936&postcount=1657
"
ukanth/afwall,closed,Fix KitKat VPN; update libsuperuser,[],"The libsuperuser ""dead shell"" fix is still pending upstream.
"
ukanth/afwall,closed,Can you please update the build instructions?,"[Label(name=""Howtos""), Label(name=""Question""), Label(name=""Wont-Fix"")]","I have been trying to build afwall with eclipse, android-studio and command line way and I cannot get it to work. On top of it there are lines like 

https://github.com/ukanth/afwall/wiki/HOWTO-Compile-AFWall

""
git clone git://github.com//.git foo
cp -r foo/library/
cd
""
I do not even know why such instruction is in the build page. What is the purpose of cloning a foo into the build dir?

I havethe ndk, jdk and sdk under linux and still cannot get it to build anything. I followed the instructions

Her is what I get under Eclipse

Description Resource    Path    Location    Type
error: No resource identifier found for attribute 'title' in package 'dev.ukanth.ufirewall' unified_preferences_headers.xml /AFWall/res/xml line 8  Android AAPT Problem
error: No resource identifier found for attribute 'title' in package 'dev.ukanth.ufirewall' unified_preferences_headers.xml /AFWall/res/xml line 12 Android AAPT Problem
error: No resource identifier found for attribute 'title' in package 'dev.ukanth.ufirewall' unified_preferences_headers.xml /AFWall/res/xml line 17 Android AAPT Problem
error: Error: No resource found that matches the given name (at 'background' with value '@color/abs__background_holo_dark').    app_detail.xml  /AFWall/res/layout  line 2  Android AAPT Problem
error: No resource identifier found for attribute 'title' in package 'dev.ukanth.ufirewall' unified_preferences_headers.xml /AFWall/res/xml line 22 Android AAPT Problem
error: Error: No resource found that matches the given name (at 'paddingTop' with value '?actionBarSize').  rules.xml   /AFWall/res/layout  line 9  Android AAPT Problem
error: No resource identifier found for attribute 'title' in package 'dev.ukanth.ufirewall' unified_preferences_headers.xml /AFWall/res/xml line 4  Android AAPT Problem
error: Error: No resource found that matches the given name (at 'icon' with value '@drawable/abs__ic_menu_moreoverflow_normal_holo_dark').  menu_bar.xml    /AFWall/res/menu    line 8  Android AAPT Problem
error: Error: No resource found that matches the given name (at 'icon' with value '@drawable/abs__ic_search').  menu_bar.xml    /AFWall/res/menu    line 4  Android AAPT Problem

Here is what I get with command line

[getbuildtools] Using latest Build Tools: 19.0.1
     [echo] Resolving Build Target for AFWall...
[gettarget] Project Target:   Android 4.3
[gettarget] API level:        18
     [echo] ----------
     [echo] Creating output directories if needed...
    [mkdir] Created dir: /_BUILD/afwall/bin/rsObj
    [mkdir] Created dir: /_BUILD/afwall/bin/rsLibs
    [mkdir] Created dir: /_BUILD/afwall/bin/dexedLibs
     [echo] ----------
     [echo] Resolving Dependencies for AFWall...
[dependency] Library dependencies:
[dependency] 
[dependency] ------------------
[dependency] Ordered libraries:
[dependency] 
[dependency] ------------------
[dependency] Found 2 versions of android-support-v4.jar in the dependency list,
[dependency] but not all the versions are identical (check is based on SHA-1 only at this time).
[dependency] All versions of the libraries must be the same at this time.
[dependency] Versions found are:
[dependency] Path: /_BUILD/afwall/submodules/ActionBarSherlock/actionbarsherlock/libs/android-support-v4.jar
[dependency]    Length: 556198
[dependency]    SHA-1: 4a6be13368bb64c5a0b0460632d228a1a915f58f
[dependency] Path: /_BUILD/afwall/libs/android-support-v4.jar
[dependency]    Length: 621451
[dependency]    SHA-1: 5896b0a4e377ac4242eb2bc785220c1c4fc052f4

BUILD FAILED
/DEV/ANDROID/adt-bundle-linux-x86_64-20131030/sdk/tools/ant/build.xml:577: Jar mismatch! Fix your dependencies
"
ukanth/afwall,closed,google play is blocked,"[Label(name=""Question""), Label(name=""Wont-Fix"")]","Hi,
I am running Android 4.3 and installed the newest afwall version. Right now I am looking for a minimal rights management to be able to download apps from google play:
Here my configuration that does not work yet.
Downloads...
Google Play Store
Media server

What program am I missing to give permission for connecting the internet? 

Thanks 
ZMKLER
"
ukanth/afwall,closed,No change of Connection,"[Label(name=""General""), Label(name=""Question"")]","Hello, 
my Device is Samsung Galaxy S3mini with CM11.0

The last Version of Afwall which works perfect is 1.2.5.2. Every newer Version breaks at change the Connection Wifi / G3. The Rules cannot be activated for the new Connection.

Do you know this issue?
Daniel
"
ukanth/afwall,closed,Not picking up tun0 as active vpn connection on Android 4.4,"[Label(name=""Bug"")]","AFWall switches between wifi or 3G even after a vpn connection is established (tun0).
also, firewall rules show that tun0 is recognized as vpn
can provide logs but don't know what to look for.
"
ukanth/afwall,closed,Build afwall inside AOSP,"[Label(name=""Feature"")]","(NOT FINISHED YET)

afwall still cannot be build inside an AOSP tree. This is required if you want to directly include afwall in a clean way into a ROM. (Droidwall supported this)
There are several reasons why this is not working, some I tried to already fix in this PR.

fix provided (but not tested):
- All strings need to be localized
- There are some unknown resources when building inside AOSP
- Additional settings required in `Android.mk`

not fixed:
- Include ActionBarSherlock in a way that does not require a submodule (not sure how this is done cleanly), or be independend from it

Currently, after manually checking out the submodule, the build fails with the following message:

```
make: *** No rule to make target `/home/vagrant/cyanogen/out/target/common/obj/JAVA_LIBRARIES/ActionBarSherlock_intermediates/javalib.jar', needed by `/home/vagrant/cyanogen/out/target/common/obj/APPS/afwall_intermediates/classes-full-debug.jar'.  Stop.
```

Any thoughts or additional ideas?
"
ukanth/afwall,closed,VPN connection PPTP type manual configuration in Android 4.4,[],"ukanth chose to ignore this issue.
"
ukanth/afwall,closed,[BUG] Fix Startup Data Leak doesn't work,"[Label(name=""Feature"")]","I've already discussed this with cernekee. Possible workaround is an Xposed module since stock SM-N9005 doesn't support init.d natively and the playstore init.d enablers caused me to lose root and/or ran late on boot leaving me at least 10 seconds to access internet before being blocked. Not planning to jump to a custom rom just yet.
"
ukanth/afwall,closed,Merge beta to donate.,[],
ukanth/afwall,closed,Add superuser info to error reports; fix Eclipse builds,[],
ukanth/afwall,closed,Make chain names reflect network type rather than service mode,"[Label(name=""Wont-Fix"")]","Related to #229, the afwall-3g-\* chain names would be better named after the network type rather than the service mode. Something like afwall-celldata-\* would be a better suited naming convention. Of course special care will need to be taken to address compatibility issues with custom scripts which rely on the existing ""3g"" names.
"
ukanth/afwall,closed,Firewall rules not cleared when IPv6 support is disabled,"[Label(name=""Bug"")]","IPv6 rules are not cleared when IPv6 support is disabled from the firewall.  When IPv6 support is turned off, the user can no longer see/affect the IPv6 configuration through AFWall+, but the IPv6 rules previously put in place remain in effect.  The IPv6 configuration is only cleared on reboot.
"
ukanth/afwall,closed,Firewall rules viewer line wrapping,"[Label(name=""Feature"")]","Because of line wrapping, it is very difficult to analyze the firewall rules in the rules viewer.  It would be useful if the font size could be changed so more characters could fit on one line, and/or have the ability to disable line wrapping in favor of horizontal scrolling instead.
"
ukanth/afwall,closed,Update icon to reflect any cell data mode,"[Label(name=""Feature"")]","Currently the icon for the cell data control column shows as ""3G"".  This may lead the user to understand that the firewall only works with 3G data, not 4G/LTE, or even 2G data.  I would suggest removing the 3G symbol from the icon, and/or replacing it with a simple cellular bar graph instead.
"
ukanth/afwall,closed,Improve UI to reduce confusion about Firewall state,"[Label(name=""Feature"")]","Enhancement suggestion:

Instead of using only an icon to indicate the firewall state on the main screen, add the caption ""Enabled"" or ""Disabled""  to clearly indicate the current firewall state.  For example:  ""AFWall+ Enabled"" or ""AFWall+ Disabled""

Also, the menu option to enable or disable the firewall should indicate the action to be taken rather than the current state of the firewall.  For example: ""Enable Firewall"" (if currently disabled), or ""Disable Firewall"" (if currently enabled).
"
ukanth/afwall,closed,"""Error applying iptables rules"" on AFWall+ 1.2.6 (and higher) with IPv6 enabled","[Label(name=""Feature"")]","Since AFWall v1.2.6, I get ""Error applying iptables rules"" when I enable IPv6 support.  The following failure is shown in the logs:

```
======
Logcat
======

17:11:11 binary installation for armeabi-v7a succeeded
17:11:11 Starting root shell...
17:11:18 Root shell is open
17:11:55 logging using LOG target
17:11:55 command 'ip6tables -A afwall-reject -m limit --limit 1000/min -j LOG --log-prefix ""{AFL}"" --log-level 4 --log-uid' exited with status 1
Output:
ip6tables: No chain/target/match by that name.

17:34:15 command '/data/data/dev.ukanth.ufirewall/app_bin/ip6tables -A afwall-reject -m limit --limit 1000/min -j LOG --log-prefix ""{AFL}"" --log-level 4 --log-uid' exited with status 1
Output:
ip6tables: No chain/target/match by that name.
```

NOTE: When the error occurs, the AFWall+ icon indicates that the firewall is disabled, although the IPv4 rules did apply successfully.  
I have tried 1.2.6, 1.2.6.1, 1.2.7, and all exhibit the same error above;  version 1.2.5 does not present any errors.

Phone: Droid Razr Maxx XT912
ROM: CM10.1.3
"
ukanth/afwall,closed,beta to donate merge,[],
ukanth/afwall,closed,Api: Default to builtin ip6tables binary,[],"As documented in bug #215, ip6tables from AOSP uses an incorrect exit
status code if the kernel returns EAGAIN, making it impossible to
differentiate between a hard failure and a transient failure.  Users on
v1.2.7 are still running into this because the system ip6tables binary
is still used by default.

So, in the default configuration (""auto"" mode), let's switch over to our
builtin ip6tables binary.  Users can still force the use of all system
binaries, or all builtin binaries, through Preferences.
"
ukanth/afwall,closed,Blacklisting for wifi & Whitelisting for data,"[Label(name=""Feature"")]","I mostly just block a few apps on wifi, and allow a few on data. However there isn't any easy way to do this at the moment. If I choose whitelisting, I have to check all but a few apps on wifi, and that takes time.

I would suggest a mode allowing blacklisting on wifi and whitelisting on data connections. That would reduce the number of checkboxes I'd have to check.
"
ukanth/afwall,closed,Feature Request: Blocking Ads with various block list!!! ,"[Label(name=""Feature""), Label(name=""Wont-Fix"")]","Please add system wide ads BLOCKING featured using:
01. ADS Blocklist (adblock plus or fan boy's list) 
02. IP range blocklist (blockpost etc) 
03. Please see Outpost4 firewall's plug in features

It's critical that these things become part of Firewall instead of some browser extensions like this 
https://github.com/Gemorroj/noads-advanced

You should also get inspired by Ghostery plug in here
https://addons.opera.com/en-gb/extensions/details/ghostery/?display=en
"
ukanth/afwall,closed,Console command to enable or disable AFWall+,"[Label(name=""Question"")]","This is not an issue, but a query.

I would like to remotely enable or disable AFWall+ as I use it primarily to block just one application. I have installed a SSH server and can access the target device remotely.

I tried to search in Github, http://crowdin.net/project/afwall as well as the XDA-Dev support forums; but with no success (I probably don't know what to search for).

Is there a shell command to enable or disable AFWall+ or even to enable or disable a blacklist rule?

Thank you
"
ukanth/afwall,closed,Merge Master to beta,[],
ukanth/afwall,closed,Help needed please!,"[Label(name=""Question"")]","Is it possible to use afwall when tethering and also having a vpn running to forward the the tethering through the vpn?  So the devices that are connected via tether would be connected to vpn.
"
ukanth/afwall,closed,CM 7 AFWall+ can not apply IP table rules,"[Label(name=""Bug""), Label(name=""DNS""), Label(name=""Wont-Fix"")]","Hi,

I use the cm-7-20130301-NIGHTLY-cooper.zip Image from
http://download.cyanogenmod.com/?device=cooper&type=nightly

AFwall+ can not get root access, it is no request in the superuser log.

ka
"
ukanth/afwall,closed,Prepare for 1.2.7 release - Including debug information,[],
ukanth/afwall,closed,Feature request:  input chain,"[Label(name=""Feature"")]","Please add a separate ""input chain"" to AFWall+, because just only ""all input allowed from lan"" is like doors wide open and IMHO to insecure. Thanks.
"
ukanth/afwall,closed,Deug build for tether + ip6tables issue + more information while sending email,[],
ukanth/afwall,closed,afwall+ sometimes can't reapply rules (probably after reconnection from mobile to wifi network),"[Label(name=""Bug"")]","it happened 2 times in 3 days that i found that afwall+ is off. the second time there was also an error message in status bar. i quickly got the logcat, hoping that it captured this error.

(link removed)

i then manualy turned on afwall+ without problem.
"
ukanth/afwall,closed,CM 10.2 20131027 Nightly breaks AFWall,"[Label(name=""Bug"")]","Installed the CM 10.2 20131027 Nightly this morning on my Nexus 4. 
No more Internet connectivity via GSM. Disabling AFWall gets me net access again.
On WiFi AFWall seems to work just fine.

Running adb logcat while toggling AFWall doesn't show me anything about it, I guess I am using the wrong options?
"
ukanth/afwall,closed,iptables segfault on HTC One SV,[],"The ""hostname"" argument to getaddrinfo() is allowed to be NULL:

```
int
getaddrinfo(const char *hostname, const char *servname,
    const struct addrinfo *hints, struct addrinfo **res)
{
    struct addrinfo sentinel;
    struct addrinfo *cur;
    int error = 0;
    struct addrinfo ai;
    struct addrinfo ai0;
    struct addrinfo *pai;
    const struct explore *ex;

    /* hostname is allowed to be NULL */
    /* servname is allowed to be NULL */
    /* hints is allowed to be NULL */
    assert(res != NULL);

    memset(&sentinel, 0, sizeof(sentinel));
```

Stock iptables passes in a NULL hostname when it just wants to look up a port (service) number:

```
/**
 * @name:   port name, or number as a string (e.g. ""http"" or ""80"")
 *
 * Resolve a port name to a number. Returns the port number in integral
 * form on success, or <0 on error. (errno will not be set.)
 */
static int xtables_getportbyname(const char *name)
{
    struct addrinfo *res = NULL, *p;
    int ret;

    ret = getaddrinfo(NULL, name, NULL, &res);
```

However, the fork of Bionic on the HTC One SV ROM, JB 4.1.2, erroneously calls strlen() on this argument without ensuring that it isn't NULL:

```
00033640 <getaddrinfo>:
   33640:       e92d 4ff0       stmdb   sp!, {r4, r5, r6, r7, r8, r9, sl, fp, lr}
   33644:       b0e9            sub     sp, #420
   33646:       4617            mov     r7, r2          ; r7 = hints
   33648:       4688            mov     r8, r1          ; r8 = servname
   3364a:       9309            str     r3, [sp, #36]   ; sp+36 = res
   3364c:       4605            mov     r5, r0          ; r5 = hostname
   3364e:       f8df 3864       ldr.w   r3, [pc, #2148]
   33652:       9909            ldr     r1, [sp, #36]
   33654:       447b            add     r3, pc
   33656:       681b            ldr     r3, [r3, #0]
   33658:       930c            str     r3, [sp, #48]
   3365a:       681a            ldr     r2, [r3, #0]
   3365c:       9267            str     r2, [sp, #412]
   3365e:       b931            cbnz    r1, 3366e       ; taken if res != NULL (true in this case)

[snip]

   3366e:       f7e3 ee8c       blx     17388 <strlen>  ; strlen(hostname)
```

This causes a segfault when AFWall tries to add a rule involving a port number, e.g.

```
iptables -A OUTPUT -p udp --dport 53 -j RETURN
```

We can work around this by passing in a dummy hostname from our builtin iptables binary.  (The system iptables binary will still crash, so it can't be used on a device with this bug.)

Note that this pull request includes a couple of other fixes too, for Travis builds and for the Bug #212.
"
ukanth/afwall,closed,afwall+ doesn't append attachments if using kaiten mail (k9),"[Label(name=""Bug"")]","i tried to submit afwall+ errors but nothing got attached when using kaiten mail. had to download and install gmail app.
"
ukanth/afwall,closed,Clean up scripted builds,[],"This patch set is intended to address a couple of items:
- F-Droid and others having trouble building native binaries from source (bug #208, bug #66, bug #180, bug #181)
- Fix ""ant"" builds from the command line (bug #65)
- Implement a more robust scheme for updating binaries and preferences after an AFWall upgrade (bug #204)
- Allow ICS+ users to fall back to the builtin iptables binaries, if their system binaries are unusable (bug #210)
- Remove hardcoded paths from the busybox builds, and eliminate the timestamp so that the output binary is (hopefully) deterministic
- README updates for build info and general readability
- Update to the latest iptables release, and split the Android deltas into discrete patches so it's easy to take new updates.  The new binaries have been lightly tested on JB 4.2.2 and GB 2.3.7.
- Add builtin ip6tables binaries; lightly tested on JB 4.2.2
- Add x86 and MIPS binaries; these still need to be tested

Side note: it looks like this project may have been registered at travis-ci.org a long time ago, but that is no longer the case.  Is it worth restarting these builds?
"
ukanth/afwall,closed,error applying iptables,"[Label(name=""DNS"")]","I'm having the iptables issue when trying to apply rules/enable afwall, as well. I'm not able to get any version from F-Droid to work, either. I can post anything asked for, but will probably require the steps of how to do it, as I'm not proficient in these things.
"
ukanth/afwall,open,bluetooth tethering borked as well,"[Label(name=""Bug"")]","Same problem with bluetooth tethering on latest cm10.2 builds...

Logs say appid -1
"
ukanth/afwall,closed,Use submodules/ActionBarSherlock,[],
ukanth/afwall,closed,Debug build + tether and superuser exit-3 error,[],
ukanth/afwall,closed,DNS Requests fail,"[Label(name=""General"")]","At the moment, I have two instances where I'd need DNS requests to work when AFWall+ seems to prevent them.

One is within the custom rules of AFWall+ itself: I'd like to use a DNS name instead of an IP for --destination. The reason for is: my destination IP is my home server which gets its IP dynamically and has a dyndns entry.

The other one is: Connectbot is reconnecting on BroadcastReceiver network state changes. I'd like to reconnect to my home server as soon as a network is available, which sometimes works but sometimes doesn't.

Looking at Api.java, I think the reason for my issue is setting the OUTPUT chain policy to drop before applying the rules (and to accept after). If a DNS request happens during the application of the rules which is also triggered by a network state the DNS responds fail---understandably.

I understand why it is a good idea to set the OUTPUT chain policy to drop before rules are reapplied, but can any of the developers envision a scheme with which I could have DNS requests work while reconfiguration happens?

I'm just guessing now: Set only afwall chain policy to drop before reapplying the rules and insert an optional DNS accept rule (ok, it could be for other ""permanent"" rules as well, maybe a script) in the OUTPUT chain _before_ the afwall chain?
"
ukanth/afwall,closed,Can you please update the wiki about the right way to apply custom scripts in the latest version?,"[Label(name=""Feature""), Label(name=""Question"")]","Hi 
It seems like there are couple ways to apply the custom scripts?

For example

""$IPTABLES -A INPUT -s 65.55.44.100 -p tcp --destination-port 25 -j DROP""

or

""iptables -I INPUT -s 1.2.3.4 -j DROP"" 

As you see these t methods are distinct, as the second one is the standard linux way. Can you please make clear about what the right usage is?

thanks
"
ukanth/afwall,closed,"Toast: ""AFWall+: Binary files installed!"" not suppressable","[Label(name=""DNS""), Label(name=""Wont-Fix"")]","Hello
I disabled Tasker Toasts (""Disable Tasker Toasts"") and Notifications (""Enable Notifications"") but still I get a toast with:

""AFWall+: Binary files installed!"" 

each time, my WiFi connection changes.
I think this should be not showing up or it should be possible to deactivate.

frank

My System:

AFWall+ 1.2.6.1 
Samsung Galaxy S2 
OS 4.1.2 (Goatrip v7.0)
"
ukanth/afwall,closed,"Use ""git submodule"" to refer external libraries",[],"Use ""git submodule"" to refer the external libraries and update android-lockpattern to latest version
"
ukanth/afwall,closed, Can't open root shell: exitCode -3,"[Label(name=""Bug"")]","Multiple users reporting this issue.

```
==========
IPv4 Rules
==========

==================
Network interfaces
==================

ccmni2: 3G
ccmni1: 3G
ccmni0: 3G
lo: unknown
p2p0: unknown
ifb1: unknown
ifb0: unknown
sit0: unknown
tunl0: VPN
wlan0: wifi
ip6tnl0: unknown

========
ifconfig
========

===========
System info
===========

Android version: 4.1.1
Active interface: mobile
Tether status: no
Roam status: no
IPv4 subnet: 
IPv6 subnet:

===========
Preferences
===========

activeRules: true
bb_path: 2
disableIcons: true
enableAdmin: true
enableLog: true
enableRoam: true
enableVPN: true
ip_path: 2
locale: de
notifyAppInstall: true
showUid: true
storedPosition: 0
usePatterns: true

======
Logcat
======

23:39:02 [libsuperuser][SU%] START
23:39:02 Can't open root shell: exitCode -3
23:40:37 Starting root shell...
23:40:37 [libsuperuser][SU%] START
23:40:37 Can't open root shell: exitCode -3
23:41:22 Starting root shell...
23:41:22 [libsuperuser][SU%] START
23:41:22 Can't open root shell: exitCode -3
23:41:26 Starting root shell...
23:41:26 [libsuperuser][SU%] START
23:41:26 Can't open root shell: exitCode -3
23:41:45 Starting root shell...
23:41:45 [libsuperuser][SU%] START
23:41:45 Can't open root shell: exitCode -3
23:42:04 Starting root shell...
23:42:04 [libsuperuser][SU%] START
23:42:04 Can't open root shell: exitCode -3
23:42:07 Starting root shell...
23:42:07 [libsuperuser][SU%] START
23:42:07 Can't open root shell: exitCode -3
23:42:12 Starting root shell...
23:42:12 [libsuperuser][SU%] START
23:42:12 Can't open root shell: exitCode -3
23:42:16 Starting root shell...
23:42:16 [libsuperuser][SU%] START
23:42:16 Can't open root shell: exitCode -3
23:42:25 Starting root shell...
23:42:25 [libsuperuser][SU%] START
23:42:25 Can't open root shell: exitCode -3
23:42:25 Starting root shell...
23:42:25 [libsuperuser][SU%] START
23:42:25 Can't open root shell: exitCode -3

ENTER PROBLEM DESCRIPTION HERE:
```
"
ukanth/afwall,closed,purgeRules will put OUTPUT chain to ACCEPT state,[],
ukanth/afwall,closed,Master,[],
ukanth/afwall,closed,Firewall Log self-reset,"[Label(name=""Bug"")]","Hi,

I found another problem. 

The firewall log resets by himself, but I did not checked out when it happens.

Regards,
ka
"
ukanth/afwall,closed,NFLOG fixes,[],"This is intended to address the most common NFLOG-related issues seen to date.

Error handling still isn't fantastic.  e.g. if the nflog program dies on its own, or fails to start, NflogService doesn't do a very good job reporting the error or restarting the daemon.  If users start seeing these problems it's probably worth revisiting.

Getting the exit code from libsuperuser may require library modifications, as setting up an onCommandResultListener callback causes it to log every output line:

```
                        if (command.onCommandResultListener != null) {
                            // no reason to store the output if we don't have an OnCommandResultListener 
                            // user should catch the output with an OnLineListener in this case
                            buffer = Collections.synchronizedList(new ArrayList<String>());                         
                        }
[...]
        private synchronized void addBuffer(String line) {
            if (buffer != null) {           
                buffer.add(line);
            }
        }
```

On a long-lived nflog session with many violations, this could consume a great deal of memory.
"
ukanth/afwall,closed,Doesn't block 3g traffics on some devices,"[Label(name=""Bug"")]","I'm using Samsung Galaxy Tab(SHW-m180L, Korean CDMA EV-DO variation).

My device uses ppp for 3g connection, so I had to add following script:

> $IPTABLES -A ""afwall"" -o ppp+ -j ""afwall-3g"" || exit

Found [this](https://github.com/skullone/android_firewall/issues/37) from skullone's repository. It seems Samsung Epic 4g also uses ppp.

If ppp should remain in VPN chain, I think some detection codes or at least warning message is essential for end users.
"
ukanth/afwall,closed,Merge Beta to Master Branch,[],"- Special UID for DNS and NTP
- Fixed issues with Android 4.3 - Allow DNS/NTP from application list - Only for 4.3 users !
- Rewritten logic to detect LOG chain
- Better Tether status
- New option for Beta testers to send error logs
- Fix watchdog RootShell timeout
- Backward compatible custom rules (from 1.2.5.2)
- Removed alternate startup service from experimental- It works without it.
- Improved Caching Logic, Uninstall apps will now remove cache along with rules.
- Reload applications will remove unused cache.
- New Help page.
- Fixed too many prompts when password is enabled.
"
ukanth/afwall,closed,Services to capture NFLOG packets and keep the RootShell alive.,[],"Patch by cernekee
"
ukanth/afwall,closed,Firewall Log not working - very buggy!,"[Label(name=""Bug"")]","3 ISSUES

Firewall Log not working

1) Logs do not seem to maintain much history. Can only see the last 2 -3 log entries

2) Logs Auto Clear themselves for no reason

3) Logs do not show any Pass packet entries only Blocked. Why ??
"
ukanth/afwall,closed,Firewall Log not responding,[],"Hi,

if I choose firewall log, the app is going black and is not responding, the android pop up is coming after some time ... :(

It is the same problem if I activate/deactivate logging.

Tablet: Odys Xeno 10 /Xelio 10 Pro
Android: 4.1.x
Kernel: 3.0.8+
AFWall+: 1.2.6 (play store version)

and why is AFWall requesting super user rights when it is off/in background for a while. Su is still only needed for changing ip tables?

Please help, thanks!
"
ukanth/afwall,closed,Work around intermittent iptables exit status 4 errors,[],"See also: ukanth/afwall#179

Various users have reported intermittent problems in which iptables returns exit status 4 (iptables: Try again).  This can happen if the Android system is updating the ""filter"" table (any chain) at the same time we are.  These updates generally aren't modifying the same chain or rules, so they shouldn't conflict with each other in any other way.

The problem can be reproduced by applying the AFWall rules while running this loop in another root shell:

```
    iptables -N foobar
    while :; do iptables -A foobar -d 1.2.3.4 -j ACCEPT ; \
        iptables -D foobar -d 1.2.3.4 -j ACCEPT ; done
```

We will retry these transactions up to 10 times.
"
ukanth/afwall,closed,Impossible to switch whitelist/blacklist mode with keyboard,"[Label(name=""Feature"")]","Hello, in version 1.2.6 it is impossible to switch from blacklist to white list on the main screen using only the physical keyboard while all the rest can be accessed from arrows and/or tab.
"
ukanth/afwall,closed,Trust/Untrusted network category,"[Label(name=""Feature"")]","Hello, we have somewhat a nice number of categories now on afwall, vpn, 3g, roaming etc, but what about some more paranoid stuff ? 
I'm talkin about networks you trust, trust is important, and apps that allow this kind of configuration are rare : NOT SYNCING/CONNECTING IF NOT ON A TRUSTED NETWORK !

The best example i'm able to share with you is FolderSync that will initiate a sync only if connected to a trusted wifi network if you wish to do so.

The category would show by a checkbox for both trusted/untrusted networks.

How trusted network should work :

When using afwll in blacklist mode (checked stuff are blocked) checking the box will block the app if you are not connected to a trusted network.

When using afwall in whitelist mode (checked stuff are allowed) checking the bow will allow the app to connect even if the network is not trusted.

A ""trusted network"" menu should be added where the user can add networks based on SSID names and/or mac adress (most paranoid users should be able to use a combinaison of both)

A more advanced version of the trusted network, if some devs got time for it, would be to add ip and host field, and consider the network trusted if the public ip/host match. (this should be usable in combinaison of mac adress SSID  ip host for most paranoid users)

Another option would be to ignore or not the untrusted status of a network if connected to a VPN (and if there's a courageous dev for this, if connected to a trusted VPN, but i may be way too paranoid there ?)

The checkbox for this should only be shown when this option is activated because some devices screen are small and there would be way too much checkboxes. Or the trust network system should have it's own list (if it's the case i will come up with more crazy idea for paranoid people)

While it's not totally afwall role's, we could add the possibility to disable android's sync toggle when not connected to a trusted network.

Best regards, Magissia
"
ukanth/afwall,closed,Reports 1.2.6.1,"[Label(name=""Bug"")]","Here is the consolidate log reports from users on 1.2.6.1
"
ukanth/afwall,closed,Debug 1.2.6.1 build ,[],"Debug build for users having issues with 1.2.6.1
"
ukanth/afwall,closed,Merge master to beta,[],
ukanth/afwall,closed,Custom Script woes,"[Label(name=""Bug"")]","On two devices, I have the following AFWall+ 1.2.6 issues:

Tablet running Ice Cream Sandwich:

Custom scripts don't seem to work at all.
I tried inserting the rules directly into the custom script dialog and I tried sourcing the rules using "". /data/local/afwall.sh"". In both ways the rules didn't show up in ""iptables -L -v"". However, when I first wrote ""$IPTABLES"" instead of ""iptables"" into my ""afwall.sh"" script, I received an error:

I/AFWall  (12409): command '. /data/local/afwall.sh' exited with status 127
I/AFWall  (12409): Output:
I/AFWall  (12409): sh: /data/local/afwall.sh[2]: -A: not found
I/AFWall  (12409): sh: /data/local/afwall.sh[3]: -A: not found

which tells me the script is executed.

Phone running Jelly Bean 4.3:

The above rules work but
- ""afwall-wifi"" doesn't seem to get cleared as stated in 
  https://github.com/ukanth/afwall/wiki/CustomScripts
  so I had to use: ""iptables -I"" instead of ""iptables -A""
- in ""afwall"" I have my rule twice. Once at the beginning (which suggests that ""afwall"" gets cleared) and once depending on whether I specified ""-A"" or ""-I"" at the end or at the beginning, respectively.

My phone issues are minor and I worked around them but the tablet issue is a showstopper for me.
"
ukanth/afwall,closed,Firewall v1.2.6 unexpectedly found Disabled for days (very intermittent),[],"[Samsung Galaxy Note 2 GT-N7100, stock v4.1.2, SuperSU rooted, LCD_DENSITY=240, no CSC or Xposed mods, no BusyBox added, no auto task-killers.]

Coincidental with the manual Play Store update from v1.2.5.2 to v1.2.6, the firewall is intermittently found to be in a Disabled state. The app's pulldown menu has a red button at the top of the list which says Disabled. (May be pedantic to state this, but since the button logic is reversed for the rules logging state.)

Apps which have not been granted explicit internet permission are suddenly found able to connect. Usually, days may have passed before this condition is noticed. There is no persistent notification to warn of this condition, nor why Enabled got changed to Disabled unexpectedly.

Closer observation suggests that sometimes when the device reassociates to the Wi-Fi router, a pop-up toast message may complain about being unable to set the iptable rules. This message displays for only 1-2 seconds. It may not be noticed amidst all the other toast messages, if any. It will certainly not be seen if gaze is momentarily distracted or if screen is off. (Is there a Notifications History twin for toast messages?)

This problem does not occur frequently enough to attempt to obtain a logcat.

My memory may be incorrect on this, but I think the toast message may have said something about failing to obtain root privileges. I have only glimpsed the toast message once or twice and never finished reading it before it disappeared.

I notice that sometimes this device takes a long while to start an app from any launcher or task switcher. Could it be that SuperSU does not get to service AFWall's escalation request and there is some timeout waiting for it?

For preventing unexpected leaks, please provide a preference setting to block everything when it fails. If this is not possible, could it keep retrying instead of giving up, so the open time window is not indefinite? Also, posting a notification entry would help. From a user perspective, it is bewildering to eventually launch the UI for unrelated reasons, only to see the firewall state changed to Disabled. And for it to continue to remain so, when it is possible to manually change it back to Enabled from the menu. 
"
ukanth/afwall,closed,"Re-apply application rules, and a question","[Label(name=""Feature"")]","At present, AFWall+ doesn't appear to have any way to remember what applications have been installed. If I need to remove or freeze an application, then add it back to the active applications list, AFWall+ blocks the application by default... although it doesn't put it at the top of the list, with the other ""new"" applications. Having some sort of memory for previously-installed applications would be great.

Separately, a question: I've seen a couple of references that indicate that having AdBlock Plus installed may subvert AFWall+'s security. What's the status on this? Do AFWall+ and ABP work well together, or should ABP _not_ be installed in order to be secure?

Thanks!
"
ukanth/afwall,closed,1.2.6 and applying custom scripts,"[Label(name=""Bug"")]","Hi
After upgrading to 1.2.6 I am unable to use my ucstom script (one line only). Afwall disables itself when I add a custom script that was working fine in the prev version.

```
$IPTABLES -A ""afwall"" --destination ""xxx.xxx.xxx.xxx"" -j RETURN
```

thanks
"
ukanth/afwall,closed,Wifi blocked completely,"[Label(name=""Bug"")]","Every time I change from 3g to wifi connection, my wifi connection is blocked completely. When I click on Apply or disable and enable afwall again, it works.
Is there any fix at the moment?
Device: Huawei Honor (ICS 4.0.3)
"
ukanth/afwall,closed,Error applying iptables rules - 1.2.6 and several previous versions,"[Label(name=""Bug"")]","LG LS670 
Dante ROM 2.3.3
AFWall+ 1.2.6

it looks like the most comprehensive FW out there, but i can never get it to apply the rules (Error applying iptables rules)

i've tried dumping the iptables rules, rebooting, using the system binaries instead of the built-in, but i just can't get it to work for the last several builds (it used to work on 2.3.3 a few months ago)

DroidWall works fine, and i think at least 1 other one as well

```
iptables -L -t nat
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination
```

TOMBSTONES - looks like a dump is created every time i try to apply rules...

```
Build fingerprint: 'sprint/LGE/thunderc:2.3.3/GRI40/ZVJ.47B56B46.lge:user/release-keys'
pid: 18842, tid: 18842  >>> /data/data/dev.ukanth.ufirewall/app_bin/iptables_armv5 <<<
signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 00013cd8
 r0 b00094c4  r1 2a000134  r2 b0006b34  r3 00013cd8
 r4 b00099d0  r5 70000001  r6 000000ea  r7 b0009acc
 r8 00000000  r9 00000000  10 00000000  fp 00000000
 ip b0009ac8  sp befefb88  lr b0005283  pc b0004d3e  cpsr 00000030
 d0  0000000000000000  d1  0000000000000000
 d2  0000000000000000  d3  0000000000000000
 d4  0000000000000000  d5  0000000000000000
 d6  0000000000000000  d7  0000000000000000
 d8  0000000000000000  d9  0000000000000000
 d10 0000000000000000  d11 0000000000000000
 d12 0000000000000000  d13 0000000000000000
 d14 0000000000000000  d15 0000000000000000
 scr 00000000

         #00  pc b0004d3e  /system/bin/linker
         #01  lr b0005283  /system/bin/linker

code around pc:
b0004d1c 378c1c27 683d685e e0031975 31dc1c21 
b0004d2c 08ad685d 3308600d 4a63e003 447a4863 
b0004d3c 68194478 d0002900 1c20e777 680330ac 
b0004d4c d0042b00 31b01c21 2a00680a 4b5cd10c 
b0004d5c 4a5d485c 27f2495d 00fe447b 447a4478 

code around lr:
b0005260 4287eef8 f7fbd109 1c05eee4 ef00f7fb 
b0005270 d1024285 f7ff9803 1c20f933 f7ff2100 
b0005280 2800fc61 4924d019 ae074c24 22184479 
b0005290 1c30447c efccf7fb f0001c20 1c21ed2e 
b00052a0 20021c02 ef14f7fb 1c312002 f7fb2218 

stack:
    befefb48  00000000  
    befefb4c  00000000  
    befefb50  00000000  
    befefb54  00000000  
    befefb58  00000000  
    befefb5c  00000000  
    befefb60  00000000  
    befefb64  00000000  
    befefb68  00000000  
    befefb6c  00000000  
    befefb70  00000000  
    befefb74  00000000  
    befefb78  00000000  
    befefb7c  00000000  
    befefb80  df002777  
    befefb84  e3a070ad  
#00 befefb88  b000758a  /system/bin/linker
    befefb8c  b0011250  
    befefb90  befefba4  
    befefb94  b000504b  /system/bin/linker
    befefb98  b0007593  /system/bin/linker
    befefb9c  00000017  
    befefba0  b0005ae5  /system/bin/linker
    befefba4  00000000  
    befefba8  befefcf0  
    befefbac  b00099d0  
    befefbb0  00000000  
    befefbb4  00000000  
    befefbb8  00000001  
    befefbbc  b0005283  /system/bin/linker
    befefbc0  b0009468  
    befefbc4  befefc64  
    befefbc8  b00094c4  
    befefbcc  00000000  
```
"
ukanth/afwall,closed,Problems building busbox,"[Label(name=""Bug"")]","I followed the README, but get 
`  GEN     util-linux/Config.in
  GEN     util-linux/volume_id/Kbuild
  HOSTCC  scripts/basic/fixdep
  HOSTCC  scripts/basic/split-include
  HOSTCC  scripts/basic/docproc
  HOSTCC  scripts/kconfig/conf.o
  HOSTCC  scripts/kconfig/kxgettext.o
  HOSTCC  scripts/kconfig/mconf.o
  SHIPPED scripts/kconfig/zconf.tab.c
  SHIPPED scripts/kconfig/lex.zconf.c
  SHIPPED scripts/kconfig/zconf.hash.c
  HOSTCC  scripts/kconfig/zconf.tab.o
  HOSTLD  scripts/kconfig/conf
scripts/kconfig/conf -s Config.in

using defaults found in .config

  SPLIT   include/autoconf.h -> include/config/*
  GEN     include/bbconfigopts.h
  HOSTCC  applets/usage
  GEN     include/usage_compressed.h
  HOSTCC  applets/applet_tables
  GEN     include/applet_tables.h
  CC      applets/applets.o
In file included from /home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/syslimits.h:7,
                 from /home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/limits.h:11,
                 from include/platform.h:138,
                 from include/libbb.h:13,
                 from include/busybox.h:8,
                 from applets/applets.c:9:
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/limits.h:122:61: error: no include path in which to search for limits.h
In file included from include/libbb.h:13,
                 from include/busybox.h:8,
                 from applets/applets.c:9:
include/platform.h:149:23: error: byteswap.h: No such file or directory
include/platform.h:150:21: error: endian.h: No such file or directory
include/platform.h:175:3: error: #error ""Can't determine endianness""
include/platform.h:183:5: warning: ""BB_BIG_ENDIAN"" is not defined
include/platform.h:206:20: error: stdint.h: No such file or directory
In file included from include/libbb.h:13,
                 from include/busybox.h:8,
                 from applets/applets.c:9:
include/platform.h:209: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'bb__aliased_uint16_t'
include/platform.h:210: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'bb__aliased_uint32_t'
include/platform.h:286:20: error: unistd.h: No such file or directory
In file included from include/platform.h:508,
                 from include/libbb.h:13,
                 from include/busybox.h:8,
                 from applets/applets.c:9:
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/stdio.h:50:23: error: sys/cdefs.h: No such file or directory
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/stdio.h:51:23: error: sys/types.h: No such file or directory
In file included from include/platform.h:508,
                 from include/libbb.h:13,
                 from include/busybox.h:8,
                 from applets/applets.c:9:
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/stdio.h:66: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'fpos_t'
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/stdio.h:120: error: expected specifier-qualifier-list before 'fpos_t'
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/stdio.h:142: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'extern'
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/stdio.h:211: error: expected '=', ',', ';', 'asm' or '**attribute**' before '**BEGIN_DECLS'
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/stdio.h:218: error: expected declaration specifiers or '...' before 'fpos_t'
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/stdio.h:228: error: expected declaration specifiers or '...' before 'off_t'
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/stdio.h:229: error: expected ';', ',' or ')' before '*' token
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/stdio.h:231: error: expected '=', ',', ';', 'asm' or '__attribute**' before 'ftello'
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/stdio.h:361: error: expected '=', ',', ';', 'asm' or '**attribute**' before '**BEGIN_DECLS'
/home/gerry/android-ndk-r8e/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/../lib/gcc/arm-linux-androideabi/4.4.3/include-fixed/stdio.h:372: error: expected '=', ',', ';', 'asm' or '__attribute**' before 'static'
In file included from include/libbb.h:13,
                 from include/busybox.h:8,
                 from applets/applets.c:9:
include/platform.h:510: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'getline'
In file included from include/busybox.h:8,
                 from applets/applets.c:9:
include/libbb.h:15:19: error: ctype.h: No such file or directory
include/libbb.h:16:20: error: dirent.h: No such file or directory
include/libbb.h:17:19: error: errno.h: No such file or directory
include/libbb.h:18:19: error: fcntl.h: No such file or directory
include/libbb.h:19:22: error: inttypes.h: No such file or directory
include/libbb.h:20:19: error: netdb.h: No such file or directory
include/libbb.h:21:20: error: setjmp.h: No such file or directory
include/libbb.h:22:20: error: signal.h: No such file or directory
include/libbb.h:31:20: error: stdlib.h: No such file or directory
include/libbb.h:34:20: error: string.h: No such file or directory
include/libbb.h:37:43: error: libgen.h: No such file or directory
include/libbb.h:40:22: error: sys/poll.h: No such file or directory
include/libbb.h:41:23: error: sys/ioctl.h: No such file or directory
include/libbb.h:42:22: error: sys/mman.h: No such file or directory
include/libbb.h:43:24: error: sys/socket.h: No such file or directory
include/libbb.h:44:22: error: sys/stat.h: No such file or directory
include/libbb.h:45:22: error: sys/time.h: No such file or directory
include/libbb.h:48:28: error: sys/sysmacros.h: No such file or directory
include/libbb.h:50:22: error: sys/wait.h: No such file or directory
include/libbb.h:51:21: error: termios.h: No such file or directory
include/libbb.h:52:18: error: time.h: No such file or directory
include/libbb.h:53:23: error: sys/param.h: No such file or directory
include/libbb.h:54:17: error: pwd.h: No such file or directory
include/libbb.h:55:17: error: grp.h: No such file or directory
include/libbb.h:69:21: error: mntent.h: No such file or directory
include/libbb.h:72:25: error: sys/statfs.h: No such file or directory
include/libbb.h:116:24: error: arpa/inet.h: No such file or directory
In file included from include/busybox.h:8,
                 from applets/applets.c:9:
include/libbb.h:256: error: 'off_t' undeclared here (not in a function)
include/libbb.h:303: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'bb_bswap_64'
include/libbb.h:320: error: expected ')' before 'mode'
include/libbb.h:355: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'recurse_flags_t'
include/libbb.h:357: warning: 'struct stat' declared inside parameter list
include/libbb.h:357: warning: its scope is only this definition or declaration, which is probably not what you want
include/libbb.h:358: warning: 'struct stat' declared inside parameter list
include/libbb.h:367: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'bb_copyfd_eof'
include/libbb.h:368: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'bb_copyfd_size'
include/libbb.h:369: error: expected declaration specifiers or '...' before 'off_t'
include/libbb.h:372: error: expected ')' before 'sz'
include/libbb.h:397: error: expected '=', ',', ';', 'asm' or '**attribute**' before '_' token
include/libbb.h:398: error: expected '=', ',', ';', 'asm' or '**attribute**' before '_' token
include/libbb.h:425: error: 'SIGHUP' undeclared here (not in a function)
include/libbb.h:426: error: 'SIGINT' undeclared here (not in a function)
include/libbb.h:427: error: 'SIGTERM' undeclared here (not in a function)
include/libbb.h:428: error: 'SIGPIPE' undeclared here (not in a function)
include/libbb.h:429: error: 'SIGQUIT' undeclared here (not in a function)
include/libbb.h:430: error: 'SIGABRT' undeclared here (not in a function)
include/libbb.h:431: error: 'SIGALRM' undeclared here (not in a function)
include/libbb.h:432: error: 'SIGVTALRM' undeclared here (not in a function)
include/libbb.h:433: error: 'SIGXCPU' undeclared here (not in a function)
include/libbb.h:434: error: 'SIGXFSZ' undeclared here (not in a function)
include/libbb.h:435: error: 'SIGUSR1' undeclared here (not in a function)
include/libbb.h:436: error: 'SIGUSR2' undeclared here (not in a function)
include/libbb.h:453: warning: 'struct sigaction' declared inside parameter list
include/libbb.h:461: error: expected ')' before 'gid'
include/libbb.h:462: error: expected ')' before 'uid'
include/libbb.h:469: warning: 'struct stat' declared inside parameter list
include/libbb.h:470: warning: 'struct stat' declared inside parameter list
include/libbb.h:480: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'xlseek'
include/libbb.h:482: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'fdlength'
include/libbb.h:496: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'socktype_t'
include/libbb.h:497: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'family_t'
include/libbb.h:500: error: 'SOCK_STREAM' undeclared here (not in a function)
include/libbb.h:501: error: 'SOCK_DGRAM' undeclared here (not in a function)
include/libbb.h:502: error: 'SOCK_RDM' undeclared here (not in a function)
include/libbb.h:503: error: 'SOCK_SEQPACKET' undeclared here (not in a function)
include/libbb.h:504: error: 'SOCK_RAW' undeclared here (not in a function)
include/libbb.h:507: error: 'AF_UNSPEC' undeclared here (not in a function)
include/libbb.h:508: error: 'AF_INET' undeclared here (not in a function)
include/libbb.h:509: error: 'AF_INET6' undeclared here (not in a function)
include/libbb.h:510: error: 'AF_UNIX' undeclared here (not in a function)
include/libbb.h:523: warning: 'struct tm' declared inside parameter list
include/libbb.h:524: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'validate_tm_time'
include/libbb.h:528: warning: 'struct sockaddr' declared inside parameter list
include/libbb.h:530: warning: 'struct sockaddr' declared inside parameter list
include/libbb.h:531: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'xsendto'
include/libbb.h:547: error: field 'sa' has incomplete type
include/libbb.h:548: error: field 'sin' has incomplete type
include/libbb.h:550: error: field 'sin6' has incomplete type
include/libbb.h:558: error: field 'sa' has incomplete type
include/libbb.h:559: error: field 'sin' has incomplete type
include/libbb.h:561: error: field 'sin6' has incomplete type
include/libbb.h:606: error: expected declaration specifiers or '...' before 'sa_family_t'
include/libbb.h:607: error: expected declaration specifiers or '...' before 'sa_family_t'
include/libbb.h:632: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'send_to_from'
include/libbb.h:636: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'recv_from_to'
include/libbb.h:641: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'inet_cksum'
include/libbb.h:698: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'safe_read'
include/libbb.h:699: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'nonblock_immune_read'
include/libbb.h:702: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'full_read'
include/libbb.h:705: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'read_close'
include/libbb.h:706: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'open_read_close'
include/libbb.h:736: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'safe_write'
include/libbb.h:739: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'full_write'
include/libbb.h:742: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'full_write1_str'
include/libbb.h:743: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'full_write2_str'
include/libbb.h:796: error: expected declaration specifiers or '...' before 'nfds_t'
include/libbb.h:796: warning: 'struct pollfd' declared inside parameter list
include/libbb.h:826: error: expected ')' before '_' token
In file included from include/libbb.h:833,
                 from include/busybox.h:8,
                 from applets/applets.c:9:
include/xatonum.h:104: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'BUG_xatou32_unimplemented'
include/xatonum.h:105: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'xatou32'
include/xatonum.h:161: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'BUG_bb_strtou32_unimplemented'
include/xatonum.h:163: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'bb_strtou32'
include/xatonum.h:172: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'bb_strtoi32'
In file included from include/busybox.h:8,
                 from applets/applets.c:9:
include/libbb.h:846: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'xatou16'
include/libbb.h:858: error: expected specifier-qualifier-list before 'uid_t'
include/libbb.h:869: error: expected ')' before 'uid'
include/libbb.h:870: error: expected ')' before 'gid'
include/libbb.h:871: error: expected ')' before 'uid'
include/libbb.h:872: error: expected ')' before 'gid'
include/libbb.h:873: error: expected ')' before 'uid'
include/libbb.h:874: error: expected ')' before 'gid'
include/libbb.h:875: error: expected ')' before 'uid'
include/libbb.h:876: error: expected ')' before 'gid'
include/libbb.h:878: error: expected ')' before 'uid'
include/libbb.h:879: error: expected ')' before 'gid'
include/libbb.h:882: error: 'uid_t' undeclared here (not in a function)
include/libbb.h:929: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'xfork'
include/libbb.h:933: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'spawn'
include/libbb.h:934: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'xspawn'
include/libbb.h:936: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'safe_waitpid'
include/libbb.h:937: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'wait_any_nohang'
include/libbb.h:946: error: expected ')' before 'pid'
include/libbb.h:1017: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'option_mask32'
include/libbb.h:1018: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'getopt32'
include/libbb.h:1062: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'xfunc_error_retval'
include/libbb.h:1063: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'die_jmp'
include/libbb.h:1159: warning: 'struct mntent' declared inside parameter list
include/libbb.h:1163: error: expected ')' before 'speed'
include/libbb.h:1164: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'tty_value_to_baud'
include/libbb.h:1186: error: expected declaration specifiers or '...' before 'mode_t'
In file included from include/busybox.h:8,
                 from applets/applets.c:9:
include/libbb.h:1335: warning: 'struct termios' declared inside parameter list
include/libbb.h:1352: warning: 'struct stat' declared inside parameter list
include/libbb.h:1353: warning: 'struct stat' declared inside parameter list
include/libbb.h:1429: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'read_key'
include/libbb.h:1518: error: expected ')' before 'pid'
include/libbb.h:1522: error: expected specifier-qualifier-list before 'DIR'
include/libbb.h:1600: error: expected '=', ',', ';', 'asm' or '**attribute**' before '_' token
include/libbb.h:1601: error: expected '=', ',', ';', 'asm' or '**attribute**' before '_' token
include/libbb.h:1627: error: expected specifier-qualifier-list before 'uint8_t'
include/libbb.h:1635: error: expected specifier-qualifier-list before 'uint64_t'
include/libbb.h:1640: error: expected specifier-qualifier-list before 'uint64_t'
include/libbb.h:1659: error: expected '=', ',', ';', 'asm' or '**attribute**' before '_' token
include/libbb.h:1660: error: expected '=', ',', ';', 'asm' or '**attribute**' before '_' token
include/libbb.h:1661: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'crc32_block_endian1'
include/libbb.h:1662: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'crc32_block_endian0'
In file included from applets/applets.c:9:
include/busybox.h:18: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'applet_nameofs'
include/busybox.h:19: error: expected '=', ',', ';', 'asm' or '**attribute**' before 'applet_install_loc'
make[1]: *_\* [applets/applets.o] Error 1
make: **\* [applets_dir] Error 2
`
If I force platform-9 i.ie`make CONFIG_SYSROOT=""$$NDK$$/platforms/android-9/arch-arm"" ARCH=arm ANDROID_NDK=$$NDK$$` it works. BTW I get the funny wordlist error building iptables that will happen if there is something wrong with the AndroidManifest.xml, because the manifest is written in DOS mode. Also another note about iptables , is that the fixextensions patch doesn't seem to work with NDK-r9 even (legacy toolchains installed).
"
ukanth/afwall,closed,AFWall 1.2.6 issues,"[Label(name=""Bug"")]","Here are the collection of issues reported and devices
- Network blocked completly ( because of OUTPUT DROP)
- Error applying rules ( N4 / S3 / Xperia )
"
ukanth/afwall,closed,Tethering,"[Label(name=""Bug"")]","Hi,

After the last update if I wanna to use tethering I have to disable AFWall.
Is other option for tethering about I don't know or it's a bug?

Thank you!
"
ukanth/afwall,closed,Enabling LAN will let any app access the Internet,"[Label(name=""Bug"")]","Hello!

When I enable LAN and then apply the rules, any app - even though they are not enabled on any control - can access the outside world.

This happens every time, so it's reproducible. It does not matter if I enable LAN only, or along with any of the other controls. The communication however seems to happen only over WiFi.
- AFWall+ Mode (whitelist/blacklist):
  Whitelist
- What steps will reproduce the problem?
  Enabling LAN Control in Preferences and then apply the rules.
- What is the expected output?
  The expected output is to enable communication behind the firewall, but not let anything else through to the outside world.
- What do you see instead?
  Instead this seem to break all rules. I enable LAN, and then apply the rules. But even if only one or even no apps are selected, AFWall+ will let anything through a WiFi-connection.
- What version of the product are you using? On what operating system?
  AFWall+ v1.2.5.2 - Android v4.2.2 - Samsung Galaxy S3.

Best regards!
"
ukanth/afwall,closed,can not apply rules after updating to 1.2.6 sgs3 4.1.2,"[Label(name=""Bug"")]","After updating AFW+to 1.2.6 each time I try to enable fw I get an error, and all the traffic gets blocked until reboot. Rolling back to 1.2.5.x solves the issue. I use stock rooted sgs3.  update via Play store. tia
"
ukanth/afwall,closed,Merge beta to master for 1.2.6 ,[],
ukanth/afwall,closed,Ports forwarding GUI,"[Label(name=""Feature"")]","Hello, since AFwall+ is a firewall settings editor, wouldn't it be a logical thing to be able to do port forwarding with it ? 

For example, redirecting external port 22 to internal 2200, redirecting port 5000 to another ipadress etc.

I know i can use the custom script part, but we can also all create iptable rules from terminal, we're here because we want a GUI to make life simplier (because you don't know iptable commands by heart or whatever)

Every parts of my suggestion should be in a ""port forwarding"" page user could acces from menu > Ports forwarding and stuff would be shown as a table.

When creating a new rule, not writing destination ipadress would mean redirecting the port but keeping it on the device. (to not force user to write ::1 all the time)

I know it may sound crazy, but android isn't only used on phones, and even with that, it's clearly possible to recycle old phones as web servers, storage servers etc because today's phone are just isanly powerfull.

Regards
"
ukanth/afwall,closed,Afwall is blocking openvpn,[],"Hi
I installed openvpn and settings on my and 4.2.2 it wprks fine when Afwall is disabled. Afwall does not list the Openvpn binary so i am unable to enable it. I am not sure about how to unblock it.

Is it possible to reveal the binary so i can enable it

Thanks
"
ukanth/afwall,closed,„Android System“ etc. leaking background data?,[],"Hello and thanks for the wonderful AFWall+!

I'm on CM10 (Android 4.1.1), I don't have a Google Account/Play Store (so no Sync, Backup or anything), Background Data is disabled and only a very few Apps are allowed with AFW+ (Tint, FDroid etc.).

Still Data Usage shows 9mb Background data for „Android System“ for the last month. I ran Network Log and it says that lots of processes use data (pretty minimal eg. 1.9K per 5 minutes or so) which shouldn't be able to: Android System, Defy Settings, FMRadio Service, HWA Settings, Input Devices, Theme Chooser, Kernel etc. none of which are allowed in AWF+

Any idea why this might be happening / what I could do?

Thanks a lot in advance!
"
ukanth/afwall,closed,RootShell: Fix missing BUSY state transition,[],"Reported in bug #167:

> On CM7.2, Rules are not applied on boot and when I tried to view the rules, it was showing the previous rules. The issue might be because of sdcard scanning at the beginning. We need to check this.

I was able to reproduce this; it showed up on maybe one out of every 5-10 boots on my Nexus S.  The issue is that we're missing a state transition in RootShell.java, so if the relative timing of the BOOT_COMPLETED intent, the CONNECTIVITY CHANGE intent, and the wifi IP change is just right, RootShell will try to run two command lists in parallel instead of sequentially.

In <a href=""http://pastebin.com/2vNTETQ9"">this log</a> you can see a ""-F afwall-3g"" from the fastApply sequence pop up right in the middle of a regular applyIptablesRulesImpl() sequence.  If this happens before the ""afwall-3g"" chain is created, the user will see an error notification; if not, it may cause incorrect rules to be applied.

My proposed fix survived 20 reboots on the same CM7.2 device.  It was lightly tested on JB as well.
"
ukanth/afwall,closed,Refactor multi-profile code,[],"Consolidate the redundant preference checks and switch statements into
G.java.  Revert back to the Default profile when multi-profile is
disabled.  Fix a couple of instances where the active profile UID lists
got out of sync with the current profile selection.
"
ukanth/afwall,closed,"After reboot, no internet connection until I click Apply in AFWall",[],"I've described my problems with AFWall here: http://android.stackexchange.com/questions/48932/afwall-is-not-blocking-apps

Version: AFWall+ (Donate) 1.2.5.2

Mode: Blacklist, Roaming control enabled, VPN and LAN control disabled, ipv6 disabled, Fix Startup Data Leak enabled, Fix Device Start Rules disabled (...oh wait is that the problem?)

Hardware: HTC Vision/G2 

OS: CM7.2.0 Android 2.3.7 which apparently uses an older version of iptables that doesn't work well with AFWall?

I seem to have made the blocking work, but the repeatable problem right now is that every time I reboot, the internet stops working for all apps on both Wi-Fi and data.  I have to go into the AFWall app (which says ""Enabled"" and has the green shield icon) and press Apply, and then the internet starts working again, and blocking seems to work correctly.
"
ukanth/afwall,closed,"On Custom Gingerbread ROM, ApplyRules fail","[Label(name=""Bug"")]","``` bash
D/su      ( 1168): 10031 dev.ukanth.ufirewall executing 0 /system/bin/sh using shell /system/bin/sh : sh
D/AFWall  (  483): applyRules: failed
```

This error crops up on GB 2.3.7, running 
- AFWall 1.2.5.2
- iptables v1.3.7
- BusyBox v1.19.1-t0mm13bROM bionic (2011-09-01 04:24 +0200) multi-call binary.
- ChainsDD superuser
  - su binary 3.0.3.2
  - SuperUser APK v 3.0.4 (38)

Have applied the rules, but a toast pops up saying `Error in applying iptables rules. Exit code 1`.
"
ukanth/afwall,closed,Async v3,[],
ukanth/afwall,closed,added Google Play Store link,[],"added GPS link to free version
"
ukanth/afwall,closed,IPV6 rules for Kernel break GPS on cm10.1,"[Label(name=""Bug""), Label(name=""Duplicate"")]","cm10.1 stable - lg 4x hd - afwall+ 1.2.5.2

gps needs kernel calling ff02:0000:0000:0000:0000:0000:0000:0002(2) to get fix .
Blocking Internet access for kernel with IPV6 enabled breaks therefore GPS.
Therefore, in afwall you have to either disable IPV6 rules or give kernel full internet access. 

There should be a better way.

BTW, ukanth, thanks for your great work.
"
ukanth/afwall,closed,rules changing randomly,"[Label(name=""Bug""), Label(name=""Wont-Fix"")]","after several enable/disable of afwall and several install/uninstall events, afwall seems to mess up with the ruleset and it will allow ALL application (e.g. ALL applications will be suddenly ""checked ""in the afwall UI), aside from ALL apps, several (unchecked before) random apps are also marked allowed.
"
ukanth/afwall,closed,Acknowledgements change,[],"better view and easier to add new project (if needed)
"
ukanth/afwall,closed,htc device admin fix in manfifest,[],"something it does not show
"
ukanth/afwall,closed,Update AndroidManifest.xml,[],"- Enabling the Android Move To SD Card Feature
"
ukanth/afwall,closed,Update AndroidManifest.xml,[],"fix htc quickboot boot receiver not work (fastboot) (next step fix in code)
android.permission.DUMP added
"
ukanth/afwall,closed,Update toggle_widget.xml,[],"small change 
new interface since we have an ui that is almost useless
we does not need an 1x1 widget without feedback (text), we should use an widget with 4x1 or 4x2 with all features (multi profile(on/off) and text 
<appwidget-provider ends up with /> and not /appwidget>
this also fix update period after widget toogle

We should also remove one of this toggle_widget.xml or onoff_widget.xml. It makes no sense for me to keep them both. Best solution is to use 4x1 or 4x2 widget with text and feedback. 
"
ukanth/afwall,closed,Update onoff_widget.xml,[],"small change 
new interface since we have an ui that is almost useless
we does not need an 1x1 widget without feedback (text), we should use an widget with 4x1 or 4x2 with all features (multi profile(on/off) and text 
this also fix update period after widget toogle
"
ukanth/afwall,closed,Add separate rule(s) for enabling NTP and therefore GPS ,"[Label(name=""Feature"")]","On my Samsung Galaxy S2 (tested with cyanogenmod 10.0 and 10.1-nightly, i.e. android 4.2.2) I'm experiencing the following issue:
Although ""GPS Status"" (or any other App for displaying GPS information) shows satellite signals being received, it never gets a fix - even with 9 or 11 satellite signals coming in.
Deleting / refetching the AGPS data doesn't help.

When I deactivate iptables and reboot, it works.

I'm no expert. I know that for a quick gps fix a good time reference is needed, otherwise a GPS device has to refer to the GPS signals in order to get the exact time, which can take several minutes (though, even trying for half an hour, it never got a fix...).
Android uses NTP (network time protocol) which usually uses UDP Port 123.

How about adding a separate (easily accessible) rule that allows UDP Packets from and to port 123?
"
ukanth/afwall,closed,Update polish strings.xml,[],"Small punctuation changes in polish translation.
"
ukanth/afwall,closed,Feature request - additional column for wimax interface,"[Label(name=""Feature"")]","May be late to the game but one of my dealbreakers in not using AFWall+ is the missing column for '4G', specifically the wimax interface for my Epic 4G Touch. If possible, please implement this.

At the moment, I am still running GB 2.3.6 on my phone.
"
ukanth/afwall,closed,iprules not activated after boot + language setting doesn't stick,"[Label(name=""Bug""), Label(name=""Wont-Fix"")]","After boot, traffic of unchecked whitelist apps is not blocked. Iprules will become active as intended after pressing Apply in AFWall+ menu, will stay active even after fastboots. 
After regular (slow)boot iprules are again inactive.
Tested with versions 1.2.4 and 1.2.5.1 on HTC Desire S (android 2.3.5)

logcat and iprules are submitted in post #1088 on XDA forum:
logcat:     http://forum.xda-developers.com/attachment.php?attachmentid=1998539&d=1369756770
iptables:   http://forum.xda-developers.com/attachment.php?attachmentid=1998535&d=1369756675

Language: default device language setting is used instead of language selected in app. Selecting preferences menu in AFWall+ and toggling random item will change language to selected one, will stick until reboot, fast reboot or kill/restart app.
"
ukanth/afwall,closed,Roaming don't works anymore,"[Label(name=""Bug"")]","Since the last update 1.2.4 the firewall from the roaming doesn't work anymore.
I hoped it was fixed in version 1.2.5 but is still not working.
Please can you make this work again.

Thanks in advance.
Claudio
"
ukanth/afwall,closed,Wi-Fi traffic suddenly cutoff until LAN Control ticked.,"[Label(name=""Bug"")]","Wi-Fi traffic was suddenly cutoff for all whitelisted apps. Tried Dolphin Browser, stock Internet browser, Fing network tool. Could not access internet nor even local home network. But Wi-Fi radio could successfully associate and connect to two different routers. Other devices without AFWall+ were unaffected. Also, 3G was unaffected. Safe Mode of Android was not affected either.

Tried turning Wi-Fi off/on. Also tried disabling/enabling firewall (with Wi-Fi temporarily off). Tried turning device off/on.

In Preferences, Enable Roaming Control and Enable VPN Control were ticked. LAN Control was not ticked. In the whitelist, Kernel was ticked. But Root and Tether were both not ticked. Android System was also not ticked.

When LAN Control was then ticked in Preferences, and Android System app ID was also whitelisted, suddenly all Wi-Fi traffic resumed per whitelist criteria. Now, with Android System unticked, Wi-Fi traffic continues to flow.

Using AFWall+ (donate) v1.2.5.1 from Play Store. Samsung Galaxy Note 2 with rooted stock ROM N7100XXDMC3 on Android 4.1.2 . Omly other iptables-using app which added on is Network Log v2.18.0 but logging was already turned off prior to the sudden cutoff.
"
ukanth/afwall,closed,Hiding roaming controls blocks everything,[],"On my Galaxy Nexus running Xylon 2.7, I got tired of seeing 3 columns in the app list, so I disabled roaming control. After this, nothing can access the internet via WiFi. I have not tested mobile data. Using version 1.2.5.1, but this has been happening since a much earlier version (since roaming control was introduced, I think). Whitelist mode.
"
ukanth/afwall,closed,Not blocking anything due to empty afwall-reject chain when logging is disabled,[],"Install v1.2.5 from Market. Disable firewall logging. Create a profile in whitelist mode with nothing allowed. The reject chain is empty, everything passes.

Enable firewall logging. Apply rules.

```
shell@android:/ # iptables -vL afwall-reject                                   
Chain afwall-reject (3 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 REJECT     all  --  any    any     anywhere             anywhere             reject-with icmp-port-unreachable
    0     0 LOG        all  --  any    any     anywhere             anywhere             limit: avg 1000/min burst 5 LOG level warning uid prefix ""{AFL}""
```

Disable firewall logging. Apply rules.

```
shell@android:/ # iptables -vL afwall-reject                                   
Chain afwall-reject (3 references)
 pkts bytes target     prot opt in     out     source               destination         
```
"
ukanth/afwall,closed,Droidwall Rules Not Imported,"[Label(name=""Bug"")]","Using AFWall+ 1.2.5, Import DW Rules doesn't import any rules at all.  It says ""Imported successfully from /mnt/sdcard/afwall"" which is an empty directory. This might be related to issue #103, but I suspect it's separate since no rules are imported.
"
ukanth/afwall,closed,Reduce size of .apk using ProGuard ,"[Label(name=""Feature"")]","### Problem

Well we have a problem each release become more and more complex. More features language packs and other thinks. This is not a problem this is good but the size of the .apk file getting bigger and bigger. This will costs more and more ram and space on our android device. And of course people like me with a slow internet connection on the smartphone have to download more MB if there is an update available on google play. 
### Solution

We should optimize our build option with:
- [ProGuard](http://proguard.sourceforge.net/)
- [zipalign](http://developer.android.com/tools/help/zipalign.html)

I already made some test with it and it shrinks the .apk size about ~240 kb. (Tested with 1.2.5) The positive side-effect are that the .apk loads a bit faster. 

More Info:
- [ProGuard Tutorial on Android Developers](http://developer.android.com/tools/help/proguard.html)
- [Tips to redue .apk size](http://developer.sonymobile.com/2012/01/31/tips-for-reducing-apk-file-size/)

The only negative side-effect that i could see in ProGuard are that it may change the application behavior. But we need to test it before we release it to Google Play Store. 

Maybe we can also start using [Android Studio IDE](http://developer.android.com/sdk/installing/studio.html) or [Beacon Mountain](http://software.intel.com/en-us/vcsource/tools/beaconmountain) since it comes with JetBrains IntelliJ which is really good and have more options for real android developers. Because I'm not a fan of the Eclipse ADT Bundle. Eclipse become more and more bloody and slower with tons of plugins you need if you want to work with. So why not using tools that are made for android itself? 
"
ukanth/afwall,closed,clean-up in lp,[],"- now we have two categories 'main' and 'Advanced Seetings' 
  -> main are for afwall+ itself and advanced for the settings e.g. experimental ... ui and others
- typo fixed 
- removed useless white spaces
- always use <!--  --> for comments
"
ukanth/afwall,closed,Rules not created after save tick box array,"[Label(name=""DNS""), Label(name=""Question""), Label(name=""Wont-Fix"")]","Droid wall is installed but disabled to compare ruleset.

Ginger bread, motorola droid x, afw v 1241 F-droid build, app granted root

Reproduce

Using default profile, another profile or another profile renamed

Save
View firewall rules

No rules.

Purge rules
Save
View

No rules.

Cycle enable disable enable
Save
View  

No rules

:(
"
ukanth/afwall,closed,FR: Backup API for settings/iptables config,"[Label(name=""Feature"")]","**_Problem**_
We already have an option to backup our iptables manually on our sdcard/intern but that's maybe not an good idea if we forgot to backup it before we upgrade our rom (full wipe. Whoops!)

**_Possible solution**_
Google have an backup api for that to store settings or user data after you connect to play store again e.g. after you boot the new rom we only have to [integrate it](http://developer.android.com/training/cloudsync/backupapi.html). Data Backup is supported from Android 2.2 (API Level 8 /Froyo/) onwards.

Next let’s add Data Backup support. The first things that we need to do is register for an [API key](http://code.google.com/android/backup/signup.html), and add this to our Manifest.

The only think i would admit is that we have an extra option to [NOT automatically restore the settings](http://developer.android.com/guide/topics/data/backup.html) (disabled by default). 

I know that is not an real-time data cloud backup solution and it only works on the same device but it's better than nothing and make our life a bit easier. :palm_tree: 
"
ukanth/afwall,closed,tombstones,"[Label(name=""Bug"")]","getting allot of these trace files in /tombstones...

pid: 1241, tid: 1241  >>> /data/data/dev.ukanth.ufirewall/app_bin/busybox_g1 <<<
signal 4 (SIGILL), code 1 (ILL_ILLOPC), fault addr 0000c616

if someone can tell me what additional info is needed i'll try to be more helpful
"
ukanth/afwall,closed,Pull request for multiple afwall tickets,[],
ukanth/afwall,closed,"Clean up various compile warnings, Log TAGs, dead code",[],"I will provide patches.
"
ukanth/afwall,closed,Separate wifi permissions for LAN and WAN,[],"One of the outstanding items on the TODO list is to allow LAN and WAN access to be controlled separately.  Plausible use cases include:
- Granting LAN access to ""file explorer"" applications and media players so they can access local content, but denying WAN access so they cannot transmit usage stats or other personal data to third parties.
- Granting WAN access to multiplayer games, but denying LAN access so they cannot easily snoop around the user's home (or work) network.
- Granting WAN access to web browsers, but denying LAN access to guard against malicious scripts and various UPnP / XSS / home router exploits.

I have a preliminary implementation up and running, but it involves numerous changes to the AFWall+ codebase and I am not 100% confident that all of the bugs have been worked out.  It would be helpful to get some test coverage and code review feedback.

Here is the binary I am currently testing:

https://www.dropbox.com/s/7enu2ign4p6l5k9/AFWall-lan.apk

Installation:

1) export rules to SD card
2) adb uninstall dev.ukanth.ufirewall
3) adb install -r AFWall-lan.apk
4) re-import rules from SD card
"
ukanth/afwall,closed,UI reports success even if iptables command fails,[],"Api.java (and in fact, SU.run()) do not check for a nonzero exit status from the iptables command list, resulting in a false positive if the command fails (e.g. due to missing kernel support or invalid flags).

I will submit a patch for this.
"
ukanth/afwall,closed,small changes in Readme,[],"- FAQ added
- already done (Milestone) added
- typo fixes
  ~ improved bug reporting
"
ukanth/afwall,closed,Minimum password length,"[Label(name=""Feature"")]","We already have an password option to prevent some users to change settings via the app itself, that's okay but we have three big problems.
- Minimum password length that contain a letter, numerical digit and a specia symbol (we can actually set only an ""a"" and it works - thats not okay we should use six characters or more)
- setPasswordExpirationTimeout is not set, so we have every time the same pass
- We can edit the configuration via Explorer/Editor apps with root access, maybe we need to encrypt the files.  

More infos for [passwort length](http://tinyurl.com/PASSWORD-QUALITY-COMPLEX).

Infos about [encryption and expiration timeout](http://tinyurl.com/DevicePolicyManager).
"
ukanth/afwall,closed,"SHUTDOWN- auto WIFI, MOBILE DATA OFF| init. D alternatives. ",[],"Since most stock Roms don't have init.d script executing properly and I personally find the IPtables buggy at boot , I would prefer a extra experimental option to automatically switch off mobile data and WiFi during shutdown by using  a shutdown receiver.
And re-enable it after execution of the firewalls after boot. 
Alternatively, 
I would also request an option to execute mobile data off during init.d - possibly by writing secure settings to change mobile apn and Wi-Fi settings- and restoring to normal after executing firewalls after boot. TO PREVENT LEAKAGE
"
ukanth/afwall,closed,Init.d script,[],"Init.d scripts are not executed at boot properly.

Init d script here:
# !/system/bin/sh

if [ -e /data/data/dev.ukanth.ufirewall/app_bin/iptables_armv5 ]; then
    path=""dev.ukanth.ufirewall""
elif [ -e /data/data/dev.ukanth.ufirewall.donate/app_bin/iptables_armv5 ]; then
    path=""dev.ukanth.ufirewall.donate""
else
    log -p i -t afwall ""AFWall doesn't seem to be installed.""
    exit
fi;

/data/data/$path/app_bin/iptables_armv5 -P INPUT DROP
/data/data/$path/app_bin/iptables_armv5 -P OUTPUT DROP
/data/data/$path/app_bin/iptables_armv5 -P FORWARD DROP

Executed in fx file manager, output gives 

Process output: /etc/init.d/afwallstart
Exit status: 1
[No Output]
Error Output:

/etc/init.d/afwallstart: line 2: 
: command not found
/etc/init.d/afwallstart: line 5: syntax error near unexpected token `elif'
/etc/init.d/afwallstart: line 5:`elif [ -e /data/data/dev.ukanth.ufirewall.donate/app_bin/iptables_armv5 ]; then
'
-about  carriage returns being inserted when the original afwallstart (res/raw/afwallstart) contains none-
HTC explorer a310e
Cyanogen jb
"
ukanth/afwall,closed,FR: Systeminfo + debug ,"[Label(name=""Feature"")]","I think this would help us to get useful information.

An option to show all important thinks like:
- Installed Afwall+ version
- Mode: black-/whitelist
- installed iptables version 
- android version (rom)
- Kernel version
- Interfaces e.g. wlan0 .... 
- Link to inbuild logs (save log to sd-card)

-> Debug option (report/send crashes or make a .txt generated file with the above infos and an share option so send it via email ... or whatever ... )

Please see also #129 
Cheers :v:
"
ukanth/afwall,closed,Firewallrules will be changed when I use tethering,"[Label(name=""Bug"")]","I have some problems with afwall and WLAN-tethering. If I activate tethering and also if I deactivate it, the iptable-rules will be changed. Especially the outputchain will be buypassed. Then my phone has full access to internet. And I want also to filter tethering, but in this case I have no chance to do that.

Both times, at activating and deactivation the ruleset of iptables will be changed. Is there any possibility to avoid that? For me this bug seems critical, because it bypasses the complete firewall.

I found for droidwall some issue, which look very similar. 
https://github.com/peterhoeg/droidwall/issues/18
http://code.google.com/p/droidwall/issues/detail?id=123 

Sorry, that I post so much information, but I hope, this will help you to find a solution.
### The beginning

My iptable-ruleset:
        # iptables --list
        Chain INPUT (policy ACCEPT)
        target     prot opt source               destination

```
    Chain FORWARD (policy DROP)
    target     prot opt source               destination

    Chain OUTPUT (policy ACCEPT)
    target     prot opt source               destination
    afwall     all  --  anywhere             anywhere

    Chain afwall (1 references)
    target     prot opt source               destination
    RETURN     udp  --  anywhere             anywhere            owner UID match root udp dpt:domain
    RETURN     tcp  --  anywhere             183.82.53.166       tcp dpt:www owner UID match app_25
    .
    .
    .
```
### Now I activate tethering.

The iptable-list looks like this:
        # iptables --list
        Chain INPUT (policy ACCEPT)
        target     prot opt source               destination

```
    Chain FORWARD (policy DROP)
    target     prot opt source               destination
    ACCEPT     all  --  anywhere             anywhere            state RELATED,ESTABLISHED
    ACCEPT     all  --  anywhere             anywhere

    Chain OUTPUT (policy ACCEPT)
    target     prot opt source               destination
    afwall     all  --  anywhere             anywhere

    Chain afwall (1 references)
    target     prot opt source               destination
    RETURN     udp  --  anywhere             anywhere            owner UID match root udp dpt:domain
    RETURN     tcp  --  anywhere             183.82.53.166       tcp dpt:www owner UID match app_25
    .
    .
    .
```

Logcate gives me something like this:
        --------- beginning of /dev/log/system
        W/InputManagerService( 2060): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@406fc630
        I/ActivityManager( 2060): Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10100000 cmp=com.android.settings/.Settings bnds=[655,403][753,476] } from pid 2060
        I/ActivityManager( 2060): Starting: Intent { act=android.intent.action.MAIN cmp=com.android.settings/.TetherSettings } from pid 11355
        --------- beginning of /dev/log/main
        D/ViewConsistency(11355): AbsListView android.widget.ListView@4055d4c0 enabled= false
        D/ViewConsistency(11355): AbsListView android.widget.ListView@4055d4c0 enabled= false
        I/ActivityManager( 2060): Displayed com.android.settings/.TetherSettings: +238ms
        D/BluetoothNetworkService( 2060): updating tether state
        D/BluetoothNetworkService( 2060): interface tiap0
        D/Tethering( 2060): sendTetherStateChangedBroadcast 1, 0, 0
        D/Tethering( 2060): interfaceAdded :tiap0
        D/CommandListener( 1476): Setting iface cfg
        D/Tethering( 2060): Tethering tiap0
        D/Tethering( 2060): InitialState.processMessage what=2
        D/NetworkManagmentService( 2060): rsp <213 00:00:00:00:00:00 0.0.0.0 0.0.0.0 [down broadcast multicast]>
        D/NetworkManagmentService( 2060): flags <[down broadcast multicast]>
        D/Tethering( 2060): sendTetherStateChangedBroadcast 0, 0, 0
        D/BluetoothNetworkService( 2060): updating tether state
        D/Tethering( 2060): Tethered tiap0
        D/BluetoothNetworkService( 2060): updating tether state
        D/Tethering( 2060): sendTetherStateChangedBroadcast 0, 1, 0
        I/ActivityManager( 2060): Start proc com.cyanogenmod.cmparts for broadcast com.cyanogenmod.cmparts/.intents.LEDNotificationReceiver: pid=15574 uid=1000 gids={1015, 3002, 3001, 3003}
        D/Tethering( 2060): MasterInitialState.processMessage what=1
        E/dalvikvm(15574): could not disable core file generation for pid 15574: Operation not permitted
        D/Tethering( 2060): Tether Mode requested by tiap0 - TetheredState - Tethered - lastError =0
        D/Tethering( 2060): chooseUpstreamType(false),  dunRequired =false, iface=rmnet0
        D/Tethering( 2060): checking if hipri brought us this connection
        D/Tethering( 2060): notifying tethered with iface =rmnet0
        D/TetherController( 1476): Setting IP forward enable = 1
        D/NetworkManagmentService( 2060): rsp <213 00:00:00:00:00:00 10.240.55.234 255.0.0.0 [up running]>
        D/NetworkManagmentService( 2060): flags <[up running]>
        D/TetherController( 1476): Starting tethering services
        D/TetherController( 1476): Tethering services running
        D/TetherController( 1476): setDnsForwarders(0 = '8.8.8.8')
        D/TetherController( 1476): setDnsForwarders(1 = '4.2.2.2')
        D/TetherController( 1476): Sending update msg to dnsmasq [update_dns:8.8.8.8:4.2.2.2]
        D/Tethering( 2060): TetheredState.processMessage what=12
        I/dnsmasq (15576): started, version 2.51 cachesize 150
        I/dnsmasq (15576): compile time options: no-IPv6 GNU-getopt no-DBus no-I18N DHCP no-scripts no-TFTP
        W/dnsmasq (15576): warning: no upstream servers configured
        I/dnsmasq (15576): DHCP, IP range 192.168.43.2 -- 192.168.43.254, lease time 1h
        I/dnsmasq (15576): DHCP, IP range 192.168.42.2 -- 192.168.42.254, lease time 1h
        D/szipinf (15574): Initializing inflate state
        I/tiap_loader(15572): Set property wlan.ap.driver.status = ok - Ok
        I/ActivityThread(15574): Pub com.cyanogenmod.cmparts.provider.Settings: com.cyanogenmod.cmparts.provider.SettingsProvider
        I//system/bin/iptables( 1476): ACCEPT  all opt -- in rmnet0 out tiap0  0.0.0.0/0  -> 0.0.0.0/0  state RELATED,ESTABLISHED
        I//system/bin/iptables( 1476): ACCEPT  all opt -- in tiap0 out rmnet0  0.0.0.0/0  -> 0.0.0.0/0 
        I//system/bin/iptables( 1476): MASQUERADE  all opt -- in \* out rmnet0  0.0.0.0/0  -> 0.0.0.0/0 
        I/ActivityManager( 2060): Process android.process.media (pid 11750) has died.
        I/dnsmasq (15576): read /etc/hosts - 22032 addresses
        I/dnsmasq (15576): using nameserver 4.2.2.2#53
        I/dnsmasq (15576): using nameserver 8.8.8.8#53
        D/SoftapController( 1476): Softap driver start: 0
        I/hostap  (15712): Configuration file: /data/misc/wifi/hostapd.conf
        I/hostap  (15712): *************_hostapd_init_iface**_***********
        I/hostap  (15712): ctrl_interface_group=0
        I/hostap  (15712): HAPDTI wilink_init: enter
        I/hostap  (15712): BSS count 1, BSSID mask ff:ff:ff:ff:ff:ff (0 bits)
        I/hostap  (15712): HAPDTI wilink_wireless_event_init: enter
        I/hostap  (15712): HAPDTI wilink_get_we_version: enter
        I/hostap  (15712): SIOCGIWRANGE: WE(compiled)=22 WE(source)=19 enc_capa=0xf
        I/hostap  (15712): regulatory_build_hw_capability: Country=TI indx=4
        I/hostap  (15712): RATE[0] rate=10 flags=0x152
        I/hostap  (15712): RATE[1] rate=20 flags=0x152
        I/hostap  (15712): RATE[2] rate=55 flags=0x152
        I/hostap  (15712): RATE[3] rate=110 flags=0x152
        I/hostap  (15712): RATE[4] rate=60 flags=0x150
        I/hostap  (15712): RATE[5] rate=90 flags=0x150
        I/hostap  (15712): RATE[6] rate=120 flags=0x150
        I/hostap  (15712): RATE[7] rate=180 flags=0x150
        I/hostap  (15712): RATE[8] rate=240 flags=0x150
        I/hostap  (15712): RATE[9] rate=360 flags=0x150
        I/hostap  (15712): RATE[10] rate=480 flags=0x150
        I/hostap  (15712): RATE[11] rate=540 flags=0x150
        I/hostap  (15712): Passive scanning not supported
        I/hostap  (15712): Flushing old station entries
        I/hostap  (15712): Deauthenticate all stations
        I/hostap  (15712): HAPDTI wilink_sta_deauth: enter
        I/hostap  (15712):  HAPDTI wilink_send_mgmt_frame: sending 26 byte MGMT frame to ff:ff:ff:ff:ff:ff
        I/hostap  (15712): MGMT - hexdump(len=26): c0 00 00 00 ff ff ff ff ff ff a4 ed 4e fd 5d b0 a4 ed 4e fd 5d b0 00 00 02 00
        I/hostap  (15712): l2_packet_send - sendto: Network is down
        I/hostap  (15712): Mode: IEEE 802.11g  Channel: 11  Frequency: 2462 MHz
        I/hostap  (15712): Using interface tiap0 with hwaddr a4:ed:4e:fd:5d:b0 and ssid 'AndroidAP'
        I/hostap  (15712): SSID - hexdump_ascii(len=9):
        I/hostap  (15712): PSK (ASCII passphrase) - hexdump_ascii(len=12):
        I/hostap  (15712): WPA: group state machine entering state GTK_INIT (VLAN-ID 0)
        I/hostap  (15712): GMK - hexdump(len=32): [REMOVED]
        I/hostap  (15712): GTK - hexdump(len=16): [REMOVED]
        I/hostap  (15712): WPA: group state machine entering state SETKEYSDONE (VLAN-ID 0)
        I/hostap  (15712): Using existing control interface directory.
        I/hostap  (15712): HAPDTI wilink_commit: COMMIT
        I/hostap  (15712): tiap0: Setup of interface done.
        I/hostap  (15712): l2_packet_receive - recvfrom: Network is down
        I/hostap  (15712): l2_packet_receive - recvfrom: Network is down
        D/SoftapController( 1476): Softap startap - Ok
        I/hostap  (15712): RX ctrl_iface - hexdump_ascii(len=4):
        I/hostap  (15712):      50 49 4e 47                                       PING  
        D/SoftapController( 1476): tiwlan0 - tiap0 - AndroidAP - wpa2-psk -  (null)
        I/hostap  (15712): HAPDTI wilink_wireless_event_receive: enter
        I/hostap  (15712): HAPDTI wilink_wireless_event_rtm_newlink: enter
        I/hostap  (15712): HAPDTI wilink_wireless_event_receive: enter
        I/hostap  (15712): HAPDTI wilink_wireless_event_rtm_newlink: enter
        I/hostap  (15712): RX ctrl_iface - hexdump_ascii(len=8):
        I/hostap  (15712):      52 45 43 4f 4e 46 49 47                           RECONFIG  
        I/hostap  (15712): **********_hostapd_reconfig_iface**_*****
        I/hostap  (15712): Flushing old station entries
        I/hostap  (15712): Deauthenticate all stations
        I/hostap  (15712): HAPDTI wilink_sta_deauth: enter
        I/hostap  (15712):  HAPDTI wilink_send_mgmt_frame: sending 26 byte MGMT frame to ff:ff:ff:ff:ff:ff
        I/hostap  (15712): MGMT - hexdump(len=26): c0 00 00 00 ff ff ff ff ff ff a4 ed 4e fd 5d b0 a4 ed 4e fd 5d b0 00 00 02 00
        I/ActivityManager( 2060): Process dev.ukanth.ufirewall (pid 7465) has died.
        I/WindowManager( 2060): WIN DEATH: Window{40806ec8 dev.ukanth.ufirewall/dev.ukanth.ufirewall.MainActivity paused=false}
        I/hostap  (15712): *************_hostapd_deinit_iface**_***********
        I/hostap  (15712): Control interface directory not empty - leaving it behind
        I/hostap  (15712): HAPDTI wilink_wireless_event_deinit: enter
        I/hostap  (15712): HAPDTI wilink_deinit: enter
        I/hostap  (15712): *************_hostapd_init_iface**_***********
        I/hostap  (15712): ctrl_interface_group=0
        I/hostap  (15712): HAPDTI wilink_init: enter
        I/hostap  (15712): BSS count 1, BSSID mask ff:ff:ff:ff:ff:ff (0 bits)
        I/hostap  (15712): HAPDTI wilink_wireless_event_init: enter
        I/hostap  (15712): HAPDTI wilink_get_we_version: enter
        I/hostap  (15712): SIOCGIWRANGE: WE(compiled)=22 WE(source)=19 enc_capa=0xf
        I/hostap  (15712): regulatory_build_hw_capability: Country=TI indx=4
        I/hostap  (15712): RATE[0] rate=10 flags=0x152
        I/hostap  (15712): RATE[1] rate=20 flags=0x152
        I/hostap  (15712): RATE[2] rate=55 flags=0x152
        I/hostap  (15712): RATE[3] rate=110 flags=0x152
        I/hostap  (15712): RATE[4] rate=60 flags=0x150
        I/hostap  (15712): RATE[5] rate=90 flags=0x150
        I/hostap  (15712): RATE[6] rate=120 flags=0x150
        I/hostap  (15712): RATE[7] rate=180 flags=0x150
        I/hostap  (15712): RATE[8] rate=240 flags=0x150
        I/hostap  (15712): RATE[9] rate=360 flags=0x150
        I/hostap  (15712): RATE[10] rate=480 flags=0x150
        I/hostap  (15712): RATE[11] rate=540 flags=0x150
        I/hostap  (15712): Passive scanning not supported
        I/hostap  (15712): Flushing old station entries
        I/hostap  (15712): Deauthenticate all stations
        I/hostap  (15712): HAPDTI wilink_sta_deauth: enter
        I/hostap  (15712):  HAPDTI wilink_send_mgmt_frame: sending 26 byte MGMT frame to ff:ff:ff:ff:ff:ff
        I/hostap  (15712): MGMT - hexdump(len=26): c0 00 00 00 ff ff ff ff ff ff a4 ed 4e fd 5d b0 a4 ed 4e fd 5d b0 00 00 02 00
        I/hostap  (15712): Mode: IEEE 802.11g  Channel: 11  Frequency: 2462 MHz
        I/hostap  (15712): Using interface tiap0 with hwaddr a4:ed:4e:fd:5d:b0 and ssid 'AndroidAP'
        I/hostap  (15712): SSID - hexdump_ascii(len=9):
        I/hostap  (15712): PSK (ASCII passphrase) - hexdump_ascii(len=12):
        I/hostap  (15712): WPA: group state machine entering state GTK_INIT (VLAN-ID 0)
        I/hostap  (15712): GMK - hexdump(len=32): [REMOVED]
        I/hostap  (15712): GTK - hexdump(len=16): [REMOVED]
        I/hostap  (15712): WPA: group state machine entering state SETKEYSDONE (VLAN-ID 0)
        I/hostap  (15712): Using existing control interface directory.
        I/hostap  (15712): HAPDTI wilink_commit: COMMIT
        I/hostap  (15712): tiap0: Setup of interface done.
        I/hostap  (15712): HAPDTI wilink_wireless_event_receive: enter
        I/hostap  (15712): HAPDTI wilink_wireless_event_rtm_newlink: enter
        D/SoftapController( 1476): Softap set - Ok
        D/dalvikvm( 6715): GC_EXPLICIT freed 492K, 53% free 2884K/6087K, external 0K/0K, paused 42ms
        D/dalvikvm( 2060): GC_EXTERNAL_ALLOC freed 1307K, 43% free 5788K/10055K, external 3780K/3809K, paused 163ms
        I/ActivityManager( 2060): Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10100000 cmp=org.jtb.alogcat/.LogActivity } from pid 2060
        D/dalvikvm(11355): GC_EXPLICIT freed 79K, 46% free 3089K/5703K, external 0K/0K, paused 902ms
        I/hostap  (15712): wilink_rx_mgmt: received MGMT with len 281 from c0:25:06:7c:c4:ce
        I/hostap  (15712): MGMT - hexdump(len=283): 00 00 80 00 00 00 ff ff ff ff ff ff c0 25 06 7c c4 ce c0 25 06 7c c4 ce 20 39 a0 09 d5 b0 22 02 00 00 64 00 31 04 00 11 46 52 49 54 5a 21 42 6f 78 20 37 33 33 30 20 53 4c 01 08 82 84 8b 96 0c 12 18 24 03 01 0b 05 04 00 01 00 00 07 06 44 45 20 01 0d 14 2a 01 00 30 14 01 00 00 0f ac 02 01 00 00 0f ac 04 01 00 00 0f ac 02 00 00 32 04 30 48 60 6c 2d 1a ee 11 1b ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 3d 16 0b 07 11 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 dd 16 00 50 f2 01 01 00 00 50 f2 02 01 00 00 50 f2 02 01 00 00 50 f2 02 dd 18 00 50 f2 02 01 01 01 00 03 a4 00 00 27 a4 00 00 42 43 5e 00 62 32 2f 00 dd 09 00 03 7f 01 01 00 00 ff 7f dd 0c 00 04 0e 01 01 02 01 00 00 00 00 00 dd 27 00 50 f2 04 10 4a 00 01 10 10 44 00 01 02 10 47 00 10 77 a0 81 04 7f e0 4a 63 81 b1 c0 25 06 7c c4 10 10 3c 00 01 03
        I/hostap  (15712): HAPDTI wilink_rx_mgmt: processing management frame
        I/hostap  (15712): station is not foundc0:25:06:7c:c4:ce
        .
        .
        .

Especially the following entries look bad to me:
        I//system/bin/iptables( 1476): ACCEPT  all opt -- in rmnet0 out tiap0  0.0.0.0/0  -> 0.0.0.0/0  state RELATED,ESTABLISHED
        I//system/bin/iptables( 1476): ACCEPT  all opt -- in tiap0 out rmnet0  0.0.0.0/0  -> 0.0.0.0/0 
        I//system/bin/iptables( 1476): MASQUERADE  all opt -- in \* out rmnet0  0.0.0.0/0  -> 0.0.0.0/0 
### Now I will deactivate the WLAN Tethering:

The iptable-list looks like this:
        # iptables --list
        Chain INPUT (policy ACCEPT)
        target     prot opt source               destination

```
    Chain FORWARD (policy DROP)
    target     prot opt source               destination

    Chain OUTPUT (policy ACCEPT)
    target     prot opt source               destination

    Chain afwall (0 references)
    target     prot opt source               destination
    RETURN     udp  --  anywhere             anywhere            owner UID match root udp dpt:domain
    RETURN     tcp  --  anywhere             183.82.53.166       tcp dpt:www owner UID match app_25
    .
    .
    .
```

Logcate gives me something like this:
        I/hostap  (15712): wilink_rx_mgmt: received MGMT with len 281 from c0:25:06:7c:c4:ce
        I/hostap  (15712): MGMT - hexdump(len=283): 00 00 80 00 00 00 ff ff ff ff ff ff c0 25 06 7c c4 ce c0 25 06 7c c4 ce 00 42 4b c2 af b1 22 02 00 00 64 00 31 04 00 11 46 52 49 54 5a 21 42 6f 78 20 37 33 33 30 20 53 4c 01 08 82 84 8b 96 0c 12 18 24 03 01 0b 05 04 00 01 00 00 07 06 44 45 20 01 0d 14 2a 01 00 30 14 01 00 00 0f ac 02 01 00 00 0f ac 04 01 00 00 0f ac 02 00 00 32 04 30 48 60 6c 2d 1a ee 11 1b ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 3d 16 0b 07 11 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 dd 16 00 50 f2 01 01 00 00 50 f2 02 01 00 00 50 f2 02 01 00 00 50 f2 02 dd 18 00 50 f2 02 01 01 01 00 03 a4 00 00 27 a4 00 00 42 43 5e 00 62 32 2f 00 dd 09 00 03 7f 01 01 00 00 ff 7f dd 0c 00 04 0e 01 01 02 01 00 00 00 00 00 dd 27 00 50 f2 04 10 4a 00 01 10 10 44 00 01 02 10 47 00 10 77 a0 81 04 7f e0 4a 63 81 b1 c0 25 06 7c c4 10 10 3c 00 01 03
        I/hostap  (15712): HAPDTI wilink_rx_mgmt: processing management frame
        I/hostap  (15712): station is not foundc0:25:06:7c:c4:ce
        I/ActivityManager( 2060): Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10100000 cmp=com.android.settings/.Settings bnds=[655,403][753,476] } from pid 2060
        W/InputManagerService( 2060): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@406d5eb0
        D/dalvikvm( 6715): GC_CONCURRENT freed 245K, 51% free 3024K/6087K, external 0K/0K, paused 39ms+7ms
        D/Tethering( 2060): TetheredState.processMessage what=4
        I//system/bin/iptables( 1476): Flushing chain `INPUT'
        I//system/bin/iptables( 1476): Flushing chain`OUTPUT'
        I//system/bin/iptables( 1476): Flushing chain `FORWARD'
        I//system/bin/iptables( 1476): Flushing chain`PREROUTING'
        I//system/bin/iptables( 1476): Flushing chain `POSTROUTING'
        I//system/bin/iptables( 1476): Flushing chain`OUTPUT'
        D/Tethering( 2060): Untethered tiap0
        D/BluetoothNetworkService( 2060): updating tether state
        D/Tethering( 2060): sendTetherStateChangedBroadcast 0, 0, 0
        D/Tethering( 2060): TetherModeAliveState.processMessage what=2
        D/TetherController( 1476): Stopping tethering services
        I/dnsmasq (15576): exiting on receipt of SIGTERM
        D/TetherController( 1476): Tethering services stopped
        D/TetherController( 1476): Setting IP forward enable = 0
        D/Tethering( 2060): notifying tethered with iface =null
        D/dalvikvm( 2060): GC_EXTERNAL_ALLOC freed 1360K, 43% free 5771K/10055K, external 4223K/4252K, paused 124ms
        I/ActivityManager( 2060): Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10100000 cmp=org.jtb.alogcat/.LogActivity } from pid 2060
        D/dalvikvm( 6715): GC_CONCURRENT freed 371K, 50% free 3051K/6087K, external 0K/0K, paused 18ms+4ms

And here bother me especially the following lines:
        I//system/bin/iptables( 1476): Flushing chain `INPUT'
        I//system/bin/iptables( 1476): Flushing chain`OUTPUT'
        I//system/bin/iptables( 1476): Flushing chain `FORWARD'
        I//system/bin/iptables( 1476): Flushing chain`PREROUTING'
        I//system/bin/iptables( 1476): Flushing chain `POSTROUTING'
        I//system/bin/iptables( 1476): Flushing chain`OUTPUT'
### My System:

```
Afwall 1.2.4.1
iptables 1.4.10
Android 2.3.7
Kernel 2.6.32.9
Mod CyanogenMod-7.2.0-umts_sholes GWK74
```
### Network-interfaces:

```
ip6tnl0
lo
muxtest_net
psd_data10
psd_data6
psd_data7
psd_data8
psd_data9
rmnet0
sit0
usb0
usb1
```
"
ukanth/afwall,closed,"Password prompt, overly protective","[Label(name=""Bug"")]","I have enabled the password protection for AFWall+, but it seems to continually ask me for it.

I open the app, it asks. I go into settings, it asks. I come out of settings, it asks. I change something and apply, it asks. I go into help, it asks. Will it ever end..........lol

A bit of a nightmare really.
"
ukanth/afwall,open,FR: Per-App Data usage via Actionbar,"[Label(name=""Feature"")]","Another good idea (i think) whould an option to show the current traffic (per app) in the actionbar. Well i know this would be an big project, but it would be nice to see what app use what kind of traffic. 
- Option to show generally all traffic 
- Option to show only (via select app) the per-app data usage
- Show interface sio0, wlan0 etc. separate to show what traffic using over which adapter

Thanks.
"
ukanth/afwall,closed,Bug: Widget does not display the widget name ,"[Label(name=""Bug"")]","Another bug report from me,
the widget that comes with AFWall+  (two) does not display any names.

Open Widgets, choose AFWall+ and only the icons are displayed.

Small bug but important because the users does not know for what are the widgets for. Thanks.
"
ukanth/afwall,closed,Bug: Seach filter not working correct,"[Label(name=""Bug"")]","Onother bugreport from me, i found that the search filter not working correct, here are the steps to reproduce the problem:
- Search for an app (type only 3 letters) and the app show all apps .. but it should only be display the apps that contain this letters
- If you press enter you can type in an second line, this should be disabled, because it`s not necessary 
- If we type more than 5 letters all apps are showing ....
"
ukanth/afwall,closed,FR: Show App-Info,"[Label(name=""Feature"")]","Hey,
another FR (maybe important for ""power users""). We should have an option to press long to the icons or the name, to show app-infos via android. 
"
ukanth/afwall,closed,FR: Enable Firewall after Restart Option,"[Label(name=""Feature""), Label(name=""Wont-Fix"")]","Hey,
another feature request, i think this is very important because some users don`t want to enable the firewall manually every boot.

An Option like ""Enable AFWall+ after restart automatically"" or somethink like that would be nice.

Or we become an Option to disable the Firewall like this:
- Disable AFWall+ (Automatically restart after boot)
- Disable 10 Minutes (automatically restart after the time)
  Disable 5 Minutes

This important because if the user forgot to re-enable the wall we have an security issues!
"
ukanth/afwall,closed,Bug: Apply rules does not hide (if afwall are disabled),"[Label(name=""Bug"")]","- Apply experimental functions (both, start fix and device fix) under options.
- Than disable the firewall. Restart the device ... now we can see that in the actionbar afwall shows me ""apply rules"" ... 
- But the firewall are disabled and this make only sence if the firewall are enabled and working. I think we should remove this notifications if the firewall are disabled.
"
ukanth/afwall,closed,FR: Translation changer,"[Label(name=""Question"")]","This also would be an nice feature, some other apps already have it and i think it`s important for translators (like me).

We should are able to change the language per afwall+. 
- System default language
- English
- German 
- other langs .....

Thanks. 
"
ukanth/afwall,closed,FR: In-App Donate ,"[Label(name=""Feature"")]","This is not an important feature request, but i don`t want to miss this option to donate via in-app purchase. 
Maybe we become an option to donate via afwall via in-app, this would be nice. Maybe we can also upgrade afwall to donate version without downloading the whole package again.
"
ukanth/afwall,closed,Special apps are not colored properly in the list,"[Label(name=""Bug""), Label(name=""Feature"")]","Scrolling through the list, the ""special apps"" (kernel, Linux shell, ADB, etc.) sometimes show up in red and sometimes show up in white:

https://www.dropbox.com/s/9md7v9zpao1vpka/appcolor-1.png
https://www.dropbox.com/s/892lbavrqtn197o/appcolor-2.png
https://www.dropbox.com/s/ubxd1ykyu32alz0/appcolor-3.png

https://www.dropbox.com/s/87gk6kkovninjx9/appcolor-4.png
https://www.dropbox.com/s/z1r0rr7cpvhhntv/appcolor-5.png

Since there is no appinfo entry for the special apps, setTextColor() is never called for them, and so the new view may inherit the wrong color from the existing data stored in convertView.

I will submit a patch to call setTextColor() unconditionally on each line.  This also includes a few cleanups in the nearby icon logic.
"
ukanth/afwall,closed,Cerberus issue ,"[Label(name=""Question"")]","Installing cerberus from https://www.cerberusapp.com/download/cerberus_disguised-ICS.zip

The app is unable to connect to the internet and nothing relevant exists on the logs. 

CM 10.1 on nexus 4.
"
ukanth/afwall,closed,Fix summary + defaults for color picker and language prefs,"[Label(name=""Bug""), Label(name=""Feature"")]","In my testing I discovered three issues with the current head of tree:

1) On a fresh install, the default color for system apps is red (correct) but in the preferences it shows up as black.  Also, the summary text, which was painstakingly translated into ~20 languages, is missing:

https://www.dropbox.com/s/zeushvz0p11k4z8/prefs-1.png

2) On a fresh install, the default locale is ""en"", but the radio button for English is not active:

https://www.dropbox.com/s/3mowdmaw0i0celr/prefs-2.png

3) After overriding the system app color, the summary text gets changed to a negative integer (as this ColorPicker package stores the ARGB value as an int: 0xAARRGGBB):

https://www.dropbox.com/s/loefrhicy152q3t/prefs-3.png

I will push fixes for these bugs to cernekee/afwall in the prefs-v1 branch.
"
ukanth/afwall,closed,Feature Request: Allow apps to access internet at timed intervals,"[Label(name=""Feature""), Label(name=""Wont-Fix"")]","In order to save battery life it would be useful to have a feature in the firewall that allows say the E-mail app to check mail only once or twice a day instead of every minute in this way it's blocked only when you need it. 

This feature could of course be used on any app and have two options:
On-Time (x minute intervals or specific start time)
Off-Time (Time to stop or not receive data.)
This is close to the --timestart --timestop IPTables Patch-O-Matic:
http://www.cyberciti.biz/tips/iptables-for-restricting-access-by-time-of-day.html
"
ukanth/afwall,closed,Italian translation,[],"Some phrases rephrased for better grammar and user experience

I hope it will be integrated soon in the next release
"
ukanth/afwall,closed,icon enhancement,"[Label(name=""Feature"")]","would like to request that the app icon color be changed based on status (red=disabled, green=enabled)
"
ukanth/afwall,closed,nothing is blocked (1.2.4 and 1.2.4.1),"[Label(name=""Bug"")]","LG Optimus S (ZVJ)
DanteRom (Gingerbread 2.3.3, Hydro 2.6.35.7)
AFWall+ 1.2.4.1 (F-Droid)

AFWall is enabled and all apps unchecked, set to use whitelist, and nothing is blocked or logged

when i first installed AFWall 1.2.4 it was working, but at some point it got 'strange' and stopped working:
- when entering the GUI there was no list (just a mostly black screen)
- returning to desktop and re-opening the GUI restored the list, but not the app icons
- one more cycle made the icons appear

i haven't had this happen in 1.2.4.1 - it seems to work fine, except nothing is blocked :)

i'm seeing a ""binary files installed"" when the GUI is accessed and each time the firewall is enabled/disabled (i assume this is expected?)

saving rules give a success message

i'm only just starting with nix, but would be more than happy to help debug and provide more info if someone can tell me how
"
ukanth/afwall,closed,bug: firewall rules are not deleted,[],"iptables rules are not deleted when disabling the firewall, the superuser/supersu app does not show any log of the deletion attempt too.
"
ukanth/afwall,closed,"Remove ""Enable"" / ""Disable"" parts from settings","[Label(name=""Feature"")]","For example:

```
<string name=""ipv6_title"">Enable IPv6 Support</string>
<string name=""ipv6_summary"">This will enable support for ipv6</string>
```

This ""enable"" part is obvious because of using CheckBox s

```
<string name=""ipv6_title"">IPv6 Support</string>
<string name=""ipv6_summary"">Enable support for IPv6</string>
```

^-- looks more clear and simple :)
"
ukanth/afwall,closed,enhancement: allow using the system iptables,[],"No need. Noticed there is a device admin option.
"
ukanth/afwall,open,Virtual entry (global rules),"[Label(name=""Feature"")]","Enhancement:
It would be great to have the ability to create a 'virtual entry' that allows (by dialog) to fill-in some iptables parameters to a template $IPTABLES command-line to create global rules (add/block, ports/IPs/subnets).

Templates:
1) Ports (allow): $IPTABLES -I ""afwall"" -p ??? --dport ??? -j RETURN || exit
2) Ports (block): $IPTABLES -I ""afwall"" -p ??? --dport ??? -j ""afwall-reject"" || exit
3) IP/Subnet (allow): $IPTABLES -I ""afwall"" --destination ??? -j RETURN || exit
4) IP/Subnet (block): $IPTABLES -I ""afwall"" --destination ??? -j ""afwall-reject"" || exit
"
ukanth/afwall,closed,Wifi Direct - Superbeam app not working in whitelist mode ,"[Label(name=""Bug"")]","Superbeam will fail if the sending device has AFWall+ installed and is in White list mode.

How to replicate:
1) Set whitelist mode in firewall
2) Select all checkboxes; in theory it should allow all apps
3) Share a file with Superbeam to trigger wifi direct.
4) Superbeam will fail to send any selected file.

My workaround:
1) Set to blacklist mode in firewall
2) Either leave all unchecked or just check your blacklist apps; in my case, I reversed the checkboxes from my whitelist mode.
3) Share a file with Superbeam to trigger wifi direct.
4) Superbeam will successfully send the selected file.

OR

1) Disable firewall.
2) Follow steps 3-4 from above.
"
ukanth/afwall,closed,More detail in firewall logs,"[Label(name=""Feature"")]","It would be useful to see destination port and protocol for dropped packets. In the attached screenshot, I assume the kernel packets are DNS and the G+ is https...

![screenshot](https://f.cloud.github.com/assets/1131751/336428/0f65edd4-9ca7-11e2-99b9-14dc359d4c0e.png)
"
ukanth/afwall,closed,Can AFWALL block incoming SMS??,"[Label(name=""DNS""), Label(name=""Wont-Fix"")]","Hey,

at first - thank you to provide this great app!
Currently i own an Motorola Razr I and have now a strange issue.
Some SMS didnt arrive my phone - or in fact the sms app. 
At first it thought it could be a provider prolem or some other issue with the rom.
Sometimes the sms arrives and sometimes i never receive sms or even receipt notification for an sent SMS.
So i decided to Wipe the device and tested again plus, changed the Provider from O2 to an Telekom Plan.
First day everything goes fine, but after installing AFWALL+ i again missed some SMS and the receipt notification... 
Is it possible that AFWALL(iptables) blocks such a low level traffic??
To be clean - i dont mean MMS just plain textmessages (SMS).

Best regards and keep up the good work.
"
ukanth/afwall,closed,Feature Request: Open keyboard when requesting password,"[Label(name=""Feature"")]","It would be great if AFWall automatically opened the keyboard, when it's set to require a password. Given that one is necessarily going to need the keyboard to enter a password, this would eliminate the unnecessary extra step of clicking on the text field in the password popup to get the keyboard to open. Thanks.
"
ukanth/afwall,closed,Default behavior on chains,"[Label(name=""Feature"")]","I would like to see an option to change the default behavior on chains.

Personally I've added to the custom scipts the following:

$IPTABLES -P INPUT DROP
$IPTABLES -P FORWARD  DROP
$IPTABLES -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

Maybe a GUI for such essential iptables options would be useful for paranoid users.
"
ukanth/afwall,closed,Ipv6 support,"[Label(name=""Feature"")]","IPv6 is being used today and ip6tables command is there for us to use it.

Perhaps a checkbox inside the application called ""apply the rules to v6 too"" will provide IPv6 support as the command syntax is the same.

The logging should be separate tho.
"
ukanth/afwall,closed,"Fixed strings.xml typos, modified init.d script.",[],
ukanth/afwall,closed,Fails when building in AOSP,"[Label(name=""Question"")]","I'm trying to include the in my rom at compile time but it's failing... 

I'm not much of a java dev, so hopefully you can make sense of this:

```
target R.java/Manifest.java: afwall (out/target/common/obj/APPS/afwall_intermediates/src/R.stamp)
W/ResourceType(11574): Bad XML block: header size 21892 or total size 164856416 is larger than data size 0
aapt: warning: string 'notify_pref_summary' has no default translation in packages/apps/AFWall/res; found: es nl ru
aapt: warning: string 'toast_pref_title' has no default translation in packages/apps/AFWall/res; found: es nl ru
packages/apps/AFWall/res/layout/dialog_color_picker.xml:34: error: Error: This attribute must be localized. (at 'text' with value 'Press on Color to apply').
packages/apps/AFWall/res/layout/dialog_color_picker.xml:59: error: Error: This attribute must be localized. (at 'text' with value '→').
packages/apps/AFWall/res/layout/rules.xml:9: error: Error: No resource found that matches the given name (at 'paddingTop' with value '?actionBarSize').
packages/apps/AFWall/res/xml/unified_preferences_headers.xml:4: error: No resource identifier found for attribute 'title' in package 'dev.ukanth.ufirewall' 
packages/apps/AFWall/res/xml/unified_preferences_headers.xml:8: error: No resource identifier found for attribute 'title' in package 'dev.ukanth.ufirewall'
packages/apps/AFWall/res/xml/unified_preferences_headers.xml:12: error: No resource identifier found for attribute 'title' in package 'dev.ukanth.ufirewall'
packages/apps/AFWall/res/xml/unified_preferences_headers.xml:17: error: No resource identifier found for attribute 'title' in package 'dev.ukanth.ufirewall'
packages/apps/AFWall/res/menu/menu_bar.xml:4: error: Error: No resource found that matches the given name (at 'icon' with value '@drawable/abs__ic_search').
packages/apps/AFWall/res/menu/menu_bar.xml:8: error: Error: No resource found that matches the given name (at 'icon' with value '@drawable/abs__ic_menu_moreoverflow_normal_holo_dark').
make: *** [out/target/common/obj/APPS/afwall_intermediates/src/R.stamp] Error 1
make: Leaving directory `/home/n4/build
```
"
ukanth/afwall,closed,Galaxy S3 blocks and need reboot,"[Label(name=""Bug"")]","I rooted my S3 with  Framaroot_v1.2. Then i installed afwall+ (donate) from play store.
All ok.
After cange any rule and activate or deactivate my mobile is blocked.
I must reboot it.
"
ukanth/afwall,closed,Certain Google apps have no network connection in 1.2.0 (tested on 4.2.2),[],"I'm using afwall 1.2.0 on Jellybean 4.2.2, in whitelist mode. It works fine for the majority of apps, but doesn't work at all for certain Google apps. They still can't access the Internet.

More specifically:
-Youtube when whitelisted will allow you to browse the videos, but will not play them when you click play. It will show a ""Connection to server lost"" message.
-Upon launch, Gmail remains stuck in ""Waiting for sync"".
-Google Play didn't work, however I solved this by also whitelisting the Google Play Services process.

For the first two, it's not clear at all what else I should whitelist to make them work. I tried enabling logs to see what accesses the Internet when Gmail is launched, but logging doesn't work, it's always empty even when enabled.

Let me know if I should provide additional info.
"
ukanth/afwall,closed,Not all DroidWall rules imported by donate version,"[Label(name=""Bug"")]","I just installed the donate version and it did not completey import rules from DroidWall. It imported rules for regular apps. But background service type rules were not imported.

It did not import rules for:

(root) - Applications running as root
10010: Download Manager, Downloads, DRM...
10046: Google Play services, Google Services Framework...
1013: Media server
"
ukanth/afwall,closed,Feature Request: MiFi,"[Label(name=""Feature"")]","I'd like to request an additional selection criteria of 'Mifi' as although my home and office wifis are unmetered, my mifi is not, hence I'd like to prevent data heavy apps (podcatchers, google play etc) from utilizing the wifi whilst on mifi. Some of these apps have a control that restricts them from heavy downloads whilst not on wifi, but they cannot tell the difference between broadband wifi and mifi.  

 I'd suggest performing a scan of the wifi SSID to see if it contains the string 'mifi', or allow the user to type in specific SSIDs.   I'm not sure this can be done at the firewall, but I thought I'd try suggesting it.  

I'm currently using profiles and tasker to achieve the same result.
"
ukanth/afwall,closed,Issue with profiles after restart,"[Label(name=""Bug"")]","To reproduce:
(effects users with preferences/Enable Multiple Profiles and more than one profile)

1) Load any profile except the first (default profile). 
2) menu / Apply
3) menu / Exit
4) Restart App

Now, whilst the pulldown next to the AfWall+ icon in the top left remembers the last profile set, as does the next line down (Mode:WhiteList (allow selected) | profile,  the actual checkboxes next to the list of apps are from the default profile, NOT the currently set one.
"
ukanth/afwall,closed,Doesn't block connections when GSM (2G) is selected from networks modes.,"[Label(name=""General"")]","The application works when WCDMA (3G) network mode is selected but doesn't block the connections when GSM (2G) mode is selected

I am using SE Xperia mini and ICS 4.0.4.
"
ukanth/afwall,closed,Wifi doesn't work after Reboot.. - Have to apply rules again,"[Label(name=""Bug"")]","Hi Ukanth,

I really love your App and it's amazing. I'm using the whitelist mode. For wifi I've selected (All Apps). But since the latest update (v1.1.9) I can't surf with wifi after reboots. So I have to open AFWall+ and press the Apply button. Then I have to turn wifi off and then on again. I also cleared the data but it didn't fix it. :(
Could you please fix this issue.
It's very annoying cz I'm a developer so I've to reboot my phone very often..

Phone: Samsung Galaxy Nexus
Android Version: 4.2.1 (Jelly Bean)

I hope you'll fix this soon. You're App is great!!! Keep it up!
"
ukanth/afwall,closed,Radio streams are not working,"[Label(name=""Bug"")]","When I use ServeStream or AndroRadio with afwall enabled, the stream can't be loaded/started. If I turn off the firewall, everything is working fine.
"
ukanth/afwall,closed,Razr i,"[Label(name=""DNS""), Label(name=""Wont-Fix"")]","Hey! I habe a Problem with my razr i. I can install the app, Set rules and make it aktive (it also asks for root access) but it doesn't block anything. Wifi, 3g,whitelist,Blacklist everytime the Same result, everytime app can use the Internet.... 

I habe root Access, iptables install, busybox... And i'm using jelly bean 
"
ukanth/afwall,closed,Log always empty.,"[Label(name=""Bug"")]","Hello,

I've found AFWall+ log always empty. I've tested by blocking app and lets it use network and it's failed but no log could be found in AFWall+.

My previous device (LG P698f) work perfectly but my new device (HUAWEI G300) always got an empty log.

This could be nice if you can fix this issues. I'm using AFWall+ (Donate).

Please feel free to contact me any time if you need more information to solve this issue i.e. app log, device info.

Regards,
Nirun Mankong
"
ukanth/afwall,closed,feature request: automatically detect an app requesting connection,"[Label(name=""Feature"")]","In windows, when a program requests internet connection, windows will prompt you for permission to enable it in firewall.  I want the same thing for Afwall.  When I look at the list of app in Afwall, I sometimes just don't know which one need connection which one does not.  

I know that this require Afwall to run all the time, so you can add a setting to turn it off.

Thanks.
"
ukanth/afwall,closed,it's impossible to download any apps from google play,"[Label(name=""DNS"")]","it's impossible to download any apps from google play when the firewall is enabled although google play is selected as allowed to wifi, only disabling the firewall the apps begin to download.

thanks
"
ukanth/afwall,closed,Feature Request: per-app option to block traffic on all interfaces,"[Label(name=""Feature"")]","Some apps just shouldn't communicate, regardless over which interface. If a device has additional interfaces, like bluetooth PAN or ethernet, they are not controlled by AFWall + nor any other Firewall-App I know. So this would be a nice, outstanding feature ;)

I suggest a fourth checkbox for every app to block communication by the afwall-chain on all interfaces.
"
ukanth/afwall,closed,No blocking at all / error code when disabling,"[Label(name=""DNS""), Label(name=""Wont-Fix"")]","When I enable AFWall in whitelist mode with nothing ticked, no app should be able to connect to the internet. But every app I test is able to do so.
I am rooted, allowed it for AFWall, and I get the notification that it has been granted root, also that the rules have been applied.
Blocking with blacklist mode also doesn't work.

Additionally, when I disable AFWall, sometimes it says rules applied (+ Superuser notification), sometimes it says
Fehler beim Säubern der iptables. Fehlercode:-1
(Error while cleaning iptables. Error code:-1)
and there seems to be no SU-Notification.

Version 1.1.5

![SC20121229-145455](https://f.cloud.github.com/assets/3148313/35234/f02e330e-51bf-11e2-886b-a0180bf6c719.png)
![SC20121229-145458](https://f.cloud.github.com/assets/3148313/35235/f03efa54-51bf-11e2-900b-52b94a881d75.png)
![SC20121229-145558](https://f.cloud.github.com/assets/3148313/35237/f07fc278-51bf-11e2-8783-778f8e9fc2c7.png)
![SC20121229-145556](https://f.cloud.github.com/assets/3148313/35236/f0567a44-51bf-11e2-9daf-dab50ee3c983.png)
"
ukanth/afwall,closed,Rules not applying after startup,"[Label(name=""Bug"")]","The iptables are in default state after startup of my device, but I can see the toast message that afwall+ gained root access, but no firewall rules are applied. I have the problem with 1.1.3 as well as with 1.1.4. I uninstalled and reinstalled the app but nothing changes. If I apply the rules manually everything works fine. My device is a Nexus 4 with the latest CyanogenMod 10.1 nightly running.
"
ukanth/afwall,closed,USB tethering not working unless....,"[Label(name=""Bug"")]","phone: galaxy nexus
OS version: 4.21 JB
setup: USB tethering with Windows 8 pro
setup: nexus connectivity  by  wifi or by  3G = same results
setup: AFwall+ version 1.1.3
setup: AFwall+ in whitelist mode

whitelisting ""applications as root"" or ""kernel"" or any other DOES NOT work
enabling ""alternate rules for ICS/JB"" DOES NOT work
enabling/disabling ""disable 3G rules on wired USB"" DOES NOT change misbehavior (forgot to mention this on earlier post)

LOG reports this for : ""ping www.google.com""

---

AppID : -1
Application Name:
Total Packets Blocked: 1
216.218.29.11(1)

---

LOG reports this for : click on a link from a 'pre-loaded' google results page

---

AppID : -1
Application Name:
Total Packets Blocked: 2
216.218.29.11(2)

---

misbehavior goes away if ( laptop gains internet connectivity: ping + web browsing)

AFwall+ disabled
OR
whitelist ""all applications"" in Afwall+

notice that in the log extracts that ""Application Name:""   is empty...
having the FULL LOG would be very helpful
"
ukanth/afwall,closed,custom script: on enable custom script is loaded *after* the afwall-* chain,"[Label(name=""Bug"")]","The on start custom script is loaded _after_ the afwall chain. This can introduce some issues on some rules that is independent on user id. For example, if I put outgoing ICMP echo request to be allowed by default, it will then be blocked because the afwall chain is loaded before my ICMP rule. On previous AFWall versions, on start custom script is loaded before any afwall chain on OUTPUT chain.
"
ukanth/afwall,closed,Widget Icon Wrong,"[Label(name=""Bug"")]","The widget icon on the Galaxy Nexus is the wrong size.

Screenshot: http://picasaweb.google.com/m/zoom?uname=117826577716285067392&aid=5822615108691380705&id=5822615145786634738&viewportWidth=320&viewportHeight=416

OS: 4.2.1
"
ukanth/afwall,closed,Hide space when hiding icons,"[Label(name=""Feature"")]","When hiding the app icons, the space should be collapsed.
"
ukanth/afwall,closed,Option to bring back UID display,"[Label(name=""Feature"")]","The UID before the application name in DroidWall was quite useful especially when writing custom scripts.

There should be an option to turn it back on in the preferences.
"
ukanth/afwall,closed,Probs at view and delete logging ,"[Label(name=""Bug""), Label(name=""Feature"")]","Steps:
- strong rules
- enable Log
- forget it
- remember a few days later
- want to view log ... smartphone hangs
- want to delete log ... no way, because delete at log viewer

log file to large?

Wish:
- Check size of log before view
- limit size
- make log delete function outside viewer

Please tell me location of log file for deletion with root explorer.
Clear app data don´t help.
"
ukanth/afwall,open,"Provide Option to Show All, Passed, and/or Blocked Network Traffic in Log","[Label(name=""Feature"")]","I would like to be see an enhancement in the log functionality and get a good idea of what apps that are whitelisted are pushing traffic and how much.  Currently I believe you only see blacklisted app traffic in the log (at least in my case).
"
ukanth/afwall,closed,Cannot Open Log Files with AFWall+ 1.1.0,"[Label(name=""Bug"")]","I am using AFWall+ 1.1.0 on my GT-N7000 with the ParanoidAndroid 2.55 build ([a fork of CM10 nightly builds, Android 4.1.2 with other custom features](http://forum.xda-developers.com/showthread.php?t=1871713)).  Tried this awesome new app after reading on XDA.  I having it functioning identically, if not better than, Droidwall. Problem is I cannot read the firewall log.
1. Restart phone
2. Open AFWall+
3. Open Preferences.
4. Confirm Enable Firewall Logs is checked and enabled.
5. Use different white-listed and black-listed applications.
6. Open AFWall+ again.
7. Open More > Firewall Logs.
8. I get the typical Working ... Please wait pop-up (see [screenshot](https://www.box.com/s/25d6898ln13ualjj0ln7)).
9. Log file never opens.

This is a brand new install, but I (like others) had use DroidWall before and disabled it (no uninstall yet; cleared all rules and disabled it; advise if that is the issue).  The only options enabled in Preferences:
- Enable Firewall Logs
- Notify on new installs

I will work on posting a logcat when I have some time today.  
"
ukanth/afwall,closed,Force close after device restart,"[Label(name=""Bug"")]","I'm getting an app  force close everytime I restart the phone and about half a minute after phone screen unlock. Apparently, the FC occurs without any self-initiated actions (i.e. at this point I did not yet have started an app).

I run an ADB logcat with the following output (excerpt):

```
I/ActivityManager( 3113): Start proc dev.ukanth.ufirewall for broadcast dev.ukanth.ufirewall/.BootBroadcast: pid=10624 uid=10095 gids={1015, 1028}

E/Trace   (10624): error opening trace file: No such file or directory (2)

I/System.out(10624): tainted command part 0: su

I/System.out(10624): Now test tainted command: su

I/Missing SU(10624): Missed

W/dalvikvm(10624): threadid=11: thread exiting with uncaught exception (group=0x41cd3300)

E/AndroidRuntime(10624): FATAL EXCEPTION: Thread-115

E/AndroidRuntime(10624): java.lang.NoSuchMethodError: Thread.destroy()

E/AndroidRuntime(10624):    at java.lang.Thread.destroy(Thread.java)

E/AndroidRuntime(10624):    at dev.ukanth.ufirewall.Api.runScript(Api.java:1034)

E/AndroidRuntime(10624):    at dev.ukanth.ufirewall.Api.runScriptAsRoot(Api.java:1049)

E/AndroidRuntime(10624):    at dev.ukanth.ufirewall.Api.runScriptAsRoot(Api.java:1061)

E/AndroidRuntime(10624):    at dev.ukanth.ufirewall.Api.applyIptablesRulesImpl(Api.java:428)

E/AndroidRuntime(10624):    at dev.ukanth.ufirewall.Api.applySavedIptablesRules(Api.java:521)

E/AndroidRuntime(10624):    at dev.ukanth.ufirewall.BootBroadcast$2.run(BootBroadcast.java:53)

I/SystemProperties(10432): Allowed Package: -com.android.vending- accessing networkinfo.

I/SystemProperties(10432): Allowed Package: -com.android.vending- accessing networkinfo.

I/Process (10624): Sending signal. PID: 10624 SIG: 9

I/ActivityManager( 3113): Process dev.ukanth.ufirewall (pid 10624) has died.

```

---

AFWall+ version: [1.1.0](https://github.com/ukanth/afwall/downloads)

Phone name/model: Samsung GALAXY S II (GT-I9100)
Android version: 4.1.2 (Jelly Bean)
Kernel version: 3.1.0-R54-Siyah-Dorimanx-V7.29-ICS-JB-SG2-PWR-CORE
ROM: CyanogenMod CM10-20121208-NIGHTLY-i9100
"
ukanth/afwall,closed,Addtitional verification step for deactivating/disabling the firewall,"[Label(name=""Feature"")]","Is it possible to implement an additional verification/conformation step after pressing the ""firewall disable"" button? 

Sometimes, when I am going to apply new rules, sometimes I press accidentally the ""firewall disable"" button due to the close local arrangement of the two buttons. And then, the firewall stops immediately. With an additional verification/conformation step (Do you really want to disable the firewall --> yes or no) one could cancel these incorrect input.
"
ukanth/afwall,closed,Custom script: IPTABLES variable lost during disable,"[Label(name=""Bug"")]","In the disable custom script I put this custom rules:

$IPTABLES -F
$IPTABLES -X afwall
$IPTABLES -X afwall-3g
$IPTABLES -X afwall-wifi
$IPTABLES -X afwall-reject
$IPTABLES -P INPUT ACCEPT
$IPTABLES -P FORWARD ACCEPT
$IPTABLES -P OUTPUT ACCEPT

sh: <stdin>[6]: -F: not found
sh: <stdin>[7]: -X: not found
sh: <stdin>[8]: -X: not found
sh: <stdin>[9]: -X: not found
sh: <stdin>[10]: -X: not found
sh: <stdin>[11]: -P: not found
sh: <stdin>[12]: -P: not found
sh: <stdin>[13]: -P: not found

The variable IPTABLES is okay during enable.

As a workaround (and to avoid further long type on the screen), I just use the built in iptables.

E.g.

/system/bin/iptables -F
"
ukanth/afwall,closed,custom scripts,"[Label(name=""Bug""), Label(name=""Wont-Fix"")]","Hi, I'm having problems getting custom scripts to work.
I've placed 2 scripts in /data/data/dev.ukanth.ufirewall/scripts
enable.sh:
$IPTABLES -P INPUT ACCEPT
$IPTABLES -P OUTPUT ACCEPT 
$IPTABLES -P FORWARD ACCEPT 

and shutdown script disable.sh:
$IPTABLES -P INPUT DROP
$IPTABLES -P OUTPUT DROP
$IPTABLES -P FORWARD DROP

fwiw, I've also have an init.d script:
/etc/init.d/00iptables
# !/system/bin/sh

IPTABLES=/system/bin/iptables
$IPTABLES -F
$IPTABLES -P INPUT DROP
$IPTABLES -P OUTPUT DROP
$IPTABLES -P FORWARD DROP

this setup worked great in droidwall but with AFWall rules just doesn't seem to get applied, nothing fancy in logcat neither. tried it w/ cm7 and stock rooted ics 4.0.4 for I9100. On ICS rom it even freezes/crashes AFWall.
"
ukanth/afwall,closed,rename and switch profiles,"[Label(name=""Feature"")]","please consider for future versions: 
- rename function for profiles
- switch profiles on desktop by a widget 
- donation version should read and use rules from free version
"
ukanth/afwall,closed,Doesn't block mobile data on SGS2 Epic 4g Touch stock JellyBean,"[Label(name=""Bug"")]","I am able to block wifi, but not 3g data. I have been using DroidWall and couldn't get it to work so I uninstalled that and installed AFWall. What is weird is that somewhere the system seems to be setting the iptables rules every boot. I was able to export them below. AFWall is able to write rules, but something that the system is doing seems to be making it so mobile data isn't blocked by the normal means. I tried the checkbox in settings to use the workaround and that didn't work, etiher.

Chain INPUT (policy ACCEPT 237 packets, 180K bytes)
 pkts bytes target     prot opt in     out     source               destination  
  237  180K bw_INPUT   all  --  \*      \*       0.0.0.0/0            0.0.0.0/0           

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 bw_FORWARD  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
    0     0 natctrl_FORWARD  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0           

Chain OUTPUT (policy ACCEPT 220 packets, 25051 bytes)
 pkts bytes target     prot opt in     out     source               destination  
  220 25051 samsung_market_policy-output  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0  
  220 25051 bw_OUTPUT  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0           

Chain bw_FORWARD (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain bw_INPUT (1 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0            all  --  !lo+   \*       0.0.0.0/0            0.0.0.0/0            ! quota globalAlert: 2097152 bytes 
   18  1340 RETURN     all  --  lo     \*       0.0.0.0/0            0.0.0.0/0  
  200  178K            all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner socket exists

Chain bw_OUTPUT (1 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0            all  --  \*      !lo+    0.0.0.0/0            0.0.0.0/0            ! quota globalAlert: 2097152 bytes 
   18  1340 RETURN     all  --  \*      lo      0.0.0.0/0            0.0.0.0/0  
  197 23451            all  --  \*      \*       0.0.0.0/0            0.0.0.0/0            owner socket exists

Chain costly_shared (0 references)
 pkts bytes target     prot opt in     out     source               destination  
    0     0 penalty_box  all  --  \*      \*       0.0.0.0/0            0.0.0.0/0           

Chain natctrl_FORWARD (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain penalty_box (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain samsung_market_policy-output (1 references)
 pkts bytes target     prot opt in     out     source               destination   
"
ukanth/afwall,closed,"White list ""Any Application"" does not seem to work",[],"Running AFWall+ 1.0.5a on a Motorola Droid 2, Android version 2.3.4 (rooted)

I have a limited data plan, so I'm attempting to set it up to allow any application over Wifi, but a select few applications over 3G.  When I configure AFWall+ to allow ""Any Application"" over Wifi in white list mode, the applications are still blocked.  However, if I individually select an application for Wifi use, that one application will work.

Not sure if this helps, but below is the output of the rules log.  Please let me know if I can supply anything else that will be helpful.  Thanks for this great application.  I've had so much trouble with Droidwall allowing apps to bypass it.

```
Chain INPUT (policy ACCEPT 1006 packets, 327K bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain OUTPUT (policy ACCEPT 814 packets, 158K bytes)
 pkts bytes target     prot opt in     out     source               destination         
 1197  191K afwall     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain afwall (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 afwall-3g  all  --  *      rmnet+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      ppp+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      pdp+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      pnp+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      rmnet_sdio+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      uwbr+   0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      wimax+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      vsnet+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      ccmni+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      rmnet1+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      rmnet_sdio1+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      qmi+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      wwan0+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      svnet0+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      rmnet_sdio0+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-3g  all  --  *      usb+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-wifi  all  --  *      eth+    0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-wifi  all  --  *      wlan+   0.0.0.0/0            0.0.0.0/0           
  822  150K afwall-wifi  all  --  *      tiwlan+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-wifi  all  --  *      athwlan+  0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-wifi  all  --  *      ra+     0.0.0.0/0            0.0.0.0/0           
    0     0 afwall-wifi  all  --  *      wlan0+  0.0.0.0/0            0.0.0.0/0           

Chain afwall-3g (16 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           owner UID match 10152 
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           owner UID match 10018 
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           owner UID match 10087 
    0     0 afwall-reject  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain afwall-reject (2 references)
 pkts bytes target     prot opt in     out     source               destination         
  326 19599 LOG        all  --  *      *       0.0.0.0/0            0.0.0.0/0           LOG flags 8 level 4 prefix `[AFWALL] ' 
  326 19599 REJECT     all  --  *      *       0.0.0.0/0            0.0.0.0/0           reject-with icmp-port-unreachable 

Chain afwall-wifi (6 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           owner UID match 1014 
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           owner UID match 1010 
  491  130K RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           owner UID match 10110 
  326 19599 afwall-reject  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
```
"
ukanth/afwall,closed,Support for 4.2 multi user ,"[Label(name=""Feature"")]","support android 4.2 multi user for afwall ! simple workaround would be export the rules and import back for other user.
"
ukanth/afwall,closed,Update res/values/strings.xml,[],"- CustomScripts -> wiki
"
ukanth/afwall,closed,Update README.md,[],"- added Acknowledgements 
- added travis support (build status)
- added Screenshot (but we should better use internal pictures with [[our_picture.jpg]]
- re-added ToDo-List, i think it's better for all if we show on what problems we are working & what's already done .... to avoid multiple questions on xda/wiki
"
ukanth/afwall,closed,similar project,[],"There is a similar project. Maybe you both can work together and create one wonderful firewall...
https://github.com/skullone/android_firewall
"
ukanth/afwall,closed,More Android 4.2 MR1 support ,[],"More Android 4.2 (API Level 17)
"
ukanth/afwall,closed,Android 4.2 MR1 support and target project,[],"- Android 4.2 MR1
"
ukanth/afwall,closed,Last commit 1.0.5a -> something went terribly wrong,[],"Hey,
after the last commit some things are missing ... :flushed:
- :de: Translation?
- Main-Page ToDo?
- My Changes for Tasker/Locale Plugin
- API.java some code thinks are missing, i wondering why you commit it out?
- Still no access to the Wiki :lock:

Seems something goes horrible go wrong here. :worried:
"
ukanth/afwall,closed,Workaround for DNS check ,[],"- Small workaround for our DNS problem
"
ukanth/afwall,closed,Integrate build.xml and ant.properties ,[],"Hi, this is an <b>feature request</b> from me. I want that we include the ant.properties and build.xml in our afwall repro. 

The source code:
[ant.properties](https://gist.github.com/4050988) (Configure the Android build script to automatically sign and align your application package - need for a Google Play release in the future)
[build.xml](https://gist.github.com/4051001) (The default filename for a Ant build file is build.xml.)

A  description is in the code itself. This also fix some problems with ant building and you get an error message if there is an problem with your sdk and fix also the usage off an automated build system (ant). 
"
ukanth/afwall,closed,Source for iptables armv5 and busybox,"[Label(name=""Question"")]","I submitted this app to the F-droid.org repository, but for some reason I didn't notice that there were binaries in the source code: maybe I had looked at the source before they were included. Everything in F-droid.org should be built by the stock SDK  , NDK , make etc, so I hope the same can happen here. If not then maybe you can provide a branch that doesn't include these. I'm not sure how to handle busybox - we don't have any apps that use source built busybox but I hope it's not impossible. For the moment , I will add a note to the AFWall description that it is not entirely built from source. 
"
ukanth/afwall,closed,Build problem at 1.0.5a,"[Label(name=""Question"")]","Using ant from oct 11, platform tools 14, ABS 4.1.0

-`compile:
    [javac] Compiling 21 source files to /home/gerry/dev.ukanth.ufirewall/bin/classes
    [javac] /home/gerry/dev.ukanth.ufirewall/src/dev/ukanth/ufirewall/MainActivity.java:559: cannot find symbol
    [javac] symbol  : variable abs__ic_search
    [javac] location: class dev.ukanth.ufirewall.R.drawable
    [javac]                 .setIcon(R.drawable.abs__ic_search)
    [javac]                                    ^
    [javac] Note: Some input files use or override a deprecated API.
    [javac] Note: Recompile with -Xlint:deprecation for details.
    [javac] 1 error
`
"
ukanth/afwall,closed,Update res/values/strings.xml,[],"- afwall+ name fix
- formatting problem corrected 
- Copyright added
"
ukanth/afwall,closed,[1.0.4a] Crash Logging/Show rules/set password,"[Label(name=""Bug"")]","### What steps will reproduce the problem?
1. Update AFWall+ from version 1.0.3a to 1.0.4a (with your rules)
2. Open AFWall+ (logging disabled) 
3. Try to set a Password, or view the Logs or show the rules options
4. APP force closes
### What is the expected output? What do you see instead?

AFWall+ should work normal without any FC (as in 1.0.3a).
### What version of the product are you using? On what operating system?

1.0.4a on CM10 (08.11.12) with SGSII on Dorimanx kernel v 7.12 (Android logging disabled)
### Please provide any additional information below.

I added logcats which show exceptions 

<code>
W/00:56:53.226 ActivityManager( 4309)
  Force finishing activity dev.ukanth.ufirewall/.MainActivity
E/00:56:53.221 AndroidRuntime(29845)
    at dalvik.system.NativeStart.main(Native Method)
E/00:56:53.221 AndroidRuntime(29845)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
E/00:56:53.221 AndroidRuntime(29845)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
E/00:56:53.221 AndroidRuntime(29845)
    at java.lang.reflect.Method.invoke(Method.java:511)
E/00:56:53.221 AndroidRuntime(29845)
    at java.lang.reflect.Method.invokeNative(Native Method)
E/00:56:53.221 AndroidRuntime(29845)
    at android.app.ActivityThread.main(ActivityThread.java:4931)
E/00:56:53.221 AndroidRuntime(29845)
    at android.os.Looper.loop(Looper.java:137)
E/00:56:53.221 AndroidRuntime(29845)
    at android.os.Handler.dispatchMessage(Handler.java:99)
E/00:56:53.221 AndroidRuntime(29845)
    at dev.ukanth.ufirewall.MainActivity$10.handleMessage(MainActivity.java:867)
E/00:56:53.221 AndroidRuntime(29845)
    at android.app.ContextImpl.startActivity(ContextImpl.java:912)
E/00:56:53.221 AndroidRuntime(29845)
    at android.app.ContextImpl.startActivity(ContextImpl.java:923)
E/00:56:53.221 AndroidRuntime(29845)
    at android.app.Instrumentation.execStartActivity(Instrumentation.java:1416)
E/00:56:53.221 AndroidRuntime(29845)
    at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1541)
E/00:56:53.221 AndroidRuntime(29845)
android.content.ActivityNotFoundException: Unable to find explicit activity class {dev.ukanth.ufirewall/dev.ukanth.ufirewall.Rules}; have you declared this activity in your AndroidManifest.xml?
E/00:56:53.221 AndroidRuntime(29845)
FATAL EXCEPTION: main
I/00:56:53.221 ActivityManager( 4309)
START {flg=0x10000000 cmp=dev.ukanth.ufirewall/.Rules (has extras) u=0} from pid 29845
W/00:56:53.221 dalvikvm(29845)
threadid=1: thread exiting with uncaught exception (group=0x4192a300)
D/00:56:53.221 AndroidRuntime(29845)
</code>

Here are more logs:
http://www17.zippyshare.com/v/43020539/file.html

Seems the bug is not fully fixed in 1.0.4.1a.
"
ukanth/afwall,closed,Device Administration to stop app been uninstalled without password confirmation,"[Label(name=""Feature"")]","If you gonna try uninstall/reinstall AFWall+ the normal password protection seems useless, i think we need an additional protection to force the app from been uninstalled it should be only uninstall if you type the right password [before the uninstall process started]. Some AV Apps use this, Avast, Kaspersky, Nod32.

But i don't know how to implement this, because this seems undocumented, the only thing i found is to implement an BroadCastReceiver listen 
[ACTION_PACKAGE_REMOVED](https://developer.android.com/reference/android/content/Intent.html#ACTION_PACKAGE_REMOVED) and [Device Administration](https://developer.android.com/guide/topics/admin/device-admin.html)
to catch if you gonna uninstall the app. 

This could be an separate feature request but it have todo with the password thing, so i posted it here, i hope this was the right place.  
"
ukanth/afwall,closed,Update project.properties,[],"- Added android.library=false, converts Android Library into Android Application project
- More Local lib support
"
ukanth/afwall,closed,Prepare Locale/Tasker support,[],"- Added Locale plugin to AndroidManifest.xml
- For more Info please look here [com.twofortyfouram.locale.intent.action.FIRE_SETTING](http://www.twofortyfouram.com/developer.html)
"
ukanth/afwall,closed,Make sure widgets gets updated,[],"- Make sure widgets gets updated 
- Added Log to see what's going on
- Status update fix
- need some tests but should work a lot of better
"
ukanth/afwall,closed,Add Confirm password dialog ,"[Label(name=""Feature"")]","Requested in xda. 
"
ukanth/afwall,closed,Extremely slow internet,"[Label(name=""Bug"")]","What steps will reproduce the problem?
1. apply rules (i.e. block some apps for wifi)
2. open browser/dolphin/playstore

What is the expected output? What do you see instead?
Normal load speeds.
Superslow loading. 

What version of the product are you using? On what operating system?
latest to date 06.11.2012, Android 4.1.2, GT-i9000

(let me know if you need a logcat -didn't see anything special in in, could make a new one though!)
"
ukanth/afwall,closed,Does not fully disable internet,"[Label(name=""Bug"")]","[quote from droidwall]

What steps will reproduce the problem?
1. just tick browser for data on whitelist
2. check money
3. open a free webpage
4. go to data usage in settings -> (AndroidOS!!!!!! <- not disableable!)
5. disable data and check money

What is the expected output? What do you see instead?
no money lost because the page is free. AndroidOS downloading stuff -> losing money. 

What version of the product are you using? On what operating system?
latest to date 06.11.2012, Android 4.1.2, GT-i9000

Please provide any additional information below.

Please make the option to block AndroidOS from using mobile data! Android System has nothing checked on the white list for me but I still lose money through AndroidOS!....

(let me know if you need a logcat -didn't see anything special in in, could make a new one though!)
"
ukanth/afwall,closed,Missing iptables_n1 in raw folder (needed for ARMv6() patch),"[Label(name=""Bug""), Label(name=""Wont-Fix"")]","It's easy to fix, the iptables_n1 is missing in <code>/res/raw</code> folder. We need this for our [ARMv6() patch](https://github.com/ukanth/afwall/pull/54).

<code>final String myiptables = dir + (isARMv6() ? ""/iptables_g1"" : ""/iptables_n1"");</code>

I add this file [here](http://www17.zippyshare.com/v/11145090/file.html).

Btw. we should use [iptables](http://www.netfilter.org/projects/iptables/downloads.html), [busybox](http://www.busybox.net/) in the future from the external sources, because different roms seems have different rules and some of the hard coded seems to not working anymore. 
"
ukanth/afwall,closed,Update src/dev/ukanth/ufirewall/Api.java,[],"- folders must always be chmod 755 because some cgi-bin folders and scripts inside may not work correct
- Fixed isARMv6() on emulator
"
ukanth/afwall,closed,Update README.md,[],"- Small text formatting issues fixed
- Added new thing on the todo by a [request](http://forum.xda-developers.com/showpost.php?p=33770086&postcount=97). Make sense ... (imho)
"
ukanth/afwall,closed,Update src/dev/ukanth/ufirewall/Api.java,[],"- added missing rmnet_sdio1, qmi, wwan0+
- typo fix
"
ukanth/afwall,closed,In white list mode all apps bypass blocking if openvpn is active,"[Label(name=""Bug"")]","### What steps will reproduce the problem?
1. Set white list mode.
2. Allow either openvpn/DroidVPN-settings or vpn networking ( if using cyanogen mod openvpn/DroidVPN option under Settings -> Wireles and network -> VPN settings ) and root apps if the former is used.
3. Test any blocked apps, e.g., the Browser, before connecting your openvpn/DroidVPN.
4. Create your vpn tunnel.
5. Test the previously chosen blocked apps again. Although it uses your vpn to connect to the internet, it is not blocked anymore.
### What is the expected output? What do you see instead?

In AFWall+ you can see that the usually blocked thus logged applications do appear there anymore, obviously because they are not blocked.
### What version of the product are you using? On what operating system?

AFWall+ (all versions) on a standard Samsung Galaxy S2 
Tested with Cyanogen Mod 10 (doesn't matter which version)

openvpn 2.3.1 from openvpn-installer
openvpn 2.3.1 from cyanogen mod
[DroidVPN](https://play.google.com/store/apps/details?id=com.aed.droidvpn)
LBE Privacy guard have the same issues
### Please provide any additional information below.

Like I said, the apps can only freely use the openvpn tunnel in the AFwall+ white list mode.
I am not very familiar with iptables and openvpn/DroidVPN binaries yet so I didn't create a custom configuration solve this issue yet.
Whether the owner matches don't work with RETURN as the target as desired of something else is missing.
### Workaround

Set a custom script and paste the following in the top box:
<code>$IPTABLES -A ""droidwall"" -o tun+ -j ""droidwall-wifi""</code>
You now have a vpn access that do not let every app go through on wifi.

Tested and improved from [this](http://code.google.com/p/droidwall/issues/detail?id=230) Thread.
"
ukanth/afwall,closed,Update README.md,[],"- Changed name from Backlog to ToDo 
- About AFWall+ dialog changed
- License fix (because Android Color Picker) is under AL 2.0
- Droidwall, Locale & Tasker link fix (so everyone can read what it does)
- Text format related changes (looks better i think ?!)
"
ukanth/afwall,closed,Scrolldown force close the application - RejectedExecutionException,"[Label(name=""Bug"")]","This issue happening with AsyncTask being exceeding limit for icon cache.
"
ukanth/afwall,closed,Update res/values/arrays.xml,[],"- Copyright update 
- More i18n support
"
ukanth/afwall,closed,Update res/xml/pref.xml,[],"- Small changes for i18n and theme
- need some tests ...
"
ukanth/afwall,closed,Update project.properties,[],"- Indicates whether an apk should be generated for each density
"
ukanth/afwall,closed,Howto report a bug,"[Label(name=""Howtos"")]","###### You should NOT
- You should NOT contact the carrier or the store in which you purchase the phone. They can not help you. Any Application developers support their own applications.
- You should NOT use the comment section in the Android Market to report issues. The comment section is a peer-to-peer channel in which consumers can leave messages and ratings. This should be used to recommend or not recommend the application. Developers can not respond to these comments. If you are NOT a paid customer, developers can not access your email address to contact you about your concerns directly. Often developers get unusable comments in the Android Market (ie This app does not work!!). Without contacting the developer directly, there is nothing that can be done and your comment can be marked as SPAM.
- You should NOT report bugs in forums. The developers may never see the messages in forums. Report the bug to people who can fix them (ie on [Issues Tracker](https://github.com/ukanth/afwall/issues))
- DO NOT set a milestone unless you are a developer and expect to fix the bug yourself.
###### Before contacting support
- Ask yourself is your issue reproducible?
- Can you document the steps to reproduce it so that it happens every time?
- Search and browse current tickets to make sure someone hasn't already reported your issue.
- Make sure you have the latest version of the application/source. This can be done by checking the Android Market for updates or push the latest source.
- Make sure you have the latest Android OS updates. This can be done in Settings on the phone.
- Make sure you know the version of Android you are running on your phone. This can be found in the Setting under About Phone.
###### How do I capture my logcat?
- This is VERY important especially for any crashes. To do this I recommend an application like ['aLogCat'](https://play.google.com/store/apps/details?id=org.jtb.alogcat&hl=de) which is free in the Android Market. The most important part of the logcat are when plex first starts and logs around the time when your problem occurred. Generally it's a good idea to just capture the whole thing and attach that as discussed when reporting your issue. The logcat is only 64k big - so you have to act quickly after a problem occurs - this is a google Android not Plex limitation. 
###### Sending bug report
- Create a new ticket. (""New Issues"")
- Make sure you include Phone Name and Model (ie Samsung Galaxy SII I-9100)
- Make sure you include version of Android (ie 2.2)
- Make sure you include your problem description. Your problem description should be a step-by-step way to reproduce your problem. Details are very important! Without any information it does not help the developers to find the problem and fix them.
- Upload any sample files if necessary (i.e. if Plex crashes when play a video, upload a sample that causes crash)
- Please also run <code>""adb logcat > logcat.txt""</code> or <code>logcat > /sdcard/logfile.txt</code>  via Terminal and archive the output.
###### After sending the report
- Be open to work with the developer to help them resolve the problem. [AFWall+](https://github.com/ukanth/afwall) is free!!
###### Useful Links
- [Report Bugs | Source Android](https://source.android.com/source/report-bugs.html)
- [Adding a Bug Reporter / Suggestion Box To Your Android App | dreamincode](http://www.dreamincode.net/forums/topic/244932-adding-a-bug-reporter-suggestion-box-to-your-android-app/)
- [androidlogcatviewer | Googlecode](https://code.google.com/p/androidlogcatviewer/downloads/list)
- [All about Log | Android Developers](https://developer.android.com/reference/android/util/Log.html)
"
ukanth/afwall,closed,Howto compile AFWall+,"[Label(name=""Howtos"")]","I migrated [this post](http://forum.xda-developers.com/showpost.php?p=33660282&postcount=65) from [welle12](http://forum.xda-developers.com/member.php?u=2508838) and improved the howto. 

I think the best way to handle all the docs is that we create a separate folder called ""docs"" and integrate the Changelog, Howto compile and other text thinks in this folder. And after that we can link the docs folder with all the documents into the Readme, that will be the best solution and the most comprehensive to handle all these files. 
I like it clear on the Readme. Everything else is too confusing for other peoples.

OR we place it into our Wiki?!
## HOWTO compile AFWall+

Software we need:
- [7-Zip](http://7-zip.org/) to extract Eclipse/Android SDK
- [Eclipse Classic](http://www.eclipse.org/downloads/) (Google recommendation) 
- [AndroidSDK](http://developer.android.com/sdk/index.html) [here](http://developer.android.com/sdk/installing.html) is an self explanatory to install AndroidSDK and Emulator
- [Java JDK](http://java.sun.com/javase/downloads/index.jsp)
- [ADT for Eclipse](http://developer.android.com/sdk/installing/installing-adt.html) or get the Plugin via <code>https://dl-ssl.google.com/android/eclipse/</code> in Eclipse ""Install New Software""
- If you know nothing about Compiler, Android you better read this [here](http://www.vogella.com/articles/Android/article.html) first

Advanced users can build the latest APK from the [Command Line](https://developer.android.com/tools/building/building-cmdline.html) or see the next steps.
### Via Command Line

Choose the Android list targets - lists all your installed Adroid target e.g. API level 16 for the latest Android Version.

Select:
""id: 4 or ""Google Inc.:Google APIs:16""
Name: Google APIs
Type: Add-On
Vendor: Google Inc. .... ""

You also can use the ""-t 4"" argument

After this we set our JAVA_HOME path:
# path to your java jdk dir

export ANDROID_JAVA_HOME=""/opt/sun-jdk-1.6.0.37""

mkdir build_folder
cd build_folder
git clone git://github.com/<your github name>/<folder name>.git foo
cp -r foo/library/ <your folder>
cd <your folder>
android update project -t 4 --path .
cd ..
git clone git://github.com/ukanth/afwall.git
cd afwall
android update project -t 4 --path .
ant debug

This build the .apk and place it in ./bin/<your folder name>-debug.apk
#### Via GUI
- [Here](https://www.xda-developers.com/xda-tv-2/how-to-build-an-android-app-part-1-setting-up-eclipse-and-android-sdk-xda-tv/) is a Video Tutorial from a xda member for those users who want to use the GUI method. 
  The tutorial is based on the needed software explained above. 
- [Here](https://developer.android.com/training/basics/firstapp/index.html) you get the official buld instruction
## For experts user only!
###### Create unsigned APK

use apkbuilder

apkbuilder  ${output.apk.file} -u -z  ${packagedresource.file} -f  ${dex.file}
###### Sign APK

use jarsigner

jarsigner  -keystore ${keystore} -storepass  ${keystore.password} -keypass ${keypass} -signedjar ${signed.apkfile} ${unsigned.apkfile} ${keyalias}
###### Publish the latest APK file

use adb
adb -d install -r ${signed.apk}
## Useful Links
- [List of Sample Apps | Android Developers](http://developer.android.com/intl/zh-CN/resources/samples/index.html)
- [Installing the SDK  |Android Developers](https://developer.android.com/sdk/installing/index.html)
"
ukanth/afwall,closed,Update src/net/margaritov/preference/colorpicker/AlphaPatternDrawable.ja...,[],"- Removed Bitmap support
- Implementing drawing directly on canvas
- Fixed possible freeze on some devices
- Android 4.0.3 render fix
"
ukanth/afwall,closed,Update AndroidManifest.xml,[],"- Removed already used permission ""BOOT_COMPLETED"" (because it's already on the top)
- ufirewall name fix
"
ukanth/afwall,closed,Update src/dev/ukanth/ufirewall/StatusWidget.java,[],"- Copyright update 
"
ukanth/afwall,closed,Update src/dev/ukanth/ufirewall/MainActivity.java,[],"- Copyright update
- vpn added
- javadoc fix
"
ukanth/afwall,closed,Update src/dev/ukanth/ufirewall/Api.java,[],"- Copyright update
- added vpn 
- Javadoc fixed*
- some other small changes
"
ukanth/afwall,closed,Update res/layout/main.xml,[],"- Copyright updated 
- vpn added
"
ukanth/afwall,closed,Update res/layout/listitem.xml,[],"- Copyright update 
- added vpn
"
ukanth/afwall,closed,Support for xhdpi (320 dpi) icons,[],"Hey, i converted the icons to fit the tablet size -> xhdpi (320 dpi) [96 x 96 px](https://developer.android.com/guide/practices/ui_guidelines/icon_design_launcher.html#size).

Here is the link to the icons:
http://www64.zippyshare.com/v/37615617/file.html

If anyone is interested i can make some new icons.
"
ukanth/afwall,closed,Update res/layout/main.xml,[],"- Copyright update
- Code format change
- Not ""dip"" ... it's called ""dp"" ...
- Default orientation for a LinearLayout is horizontal.
"
ukanth/afwall,closed,Update res/xml/pref.xml,[],"- Copyright update
"
ukanth/afwall,closed,Update res/values/strings.xml,[],"- Copyright updated
- Added xmlns:xliff XML attribute, it's not necessary if you don't use XLIFF, but if you do look (here)[https://www.oasis-open.org/committees/xliff/faq.php] for more information It could help us in the future for our localisation/translation support
"
ukanth/afwall,closed,Update res/values/arrays.xml,[],"- Copyright updated
- Added xmlns:xliff XML attribute, it's not necessary if you don't use XLIFF, but if you do look (here)[https://www.oasis-open.org/committees/xliff/faq.php] for more information
  It could help us in the future for our localisation/translation support
"
ukanth/afwall,closed,Update Changelog.md,[],"- moved download links from xda to github
- Droidwall link insert (credits)
- v1.0.0a was initial version (i think) so why nobody tell us that in our changelog? ;)
- typo fix
"
ukanth/afwall,closed,Update AndroidManifest.xml,[],"- prepare in-app changelog feature (needs some more changes, but better than nothing)
- changes for android 4.0+
- minsdk is now 8 because only android 2.2+ (froyo) supports all features (hardwareacc etc.)
- Copyright update (fixed also javadoc)
- (workaround) fixed permission change network state (android 4.0)
- permission WRITE_EXTERNAL_STORAGE for future release (read/write log file to sd-card)
- added more infos for other users
- changed actions android:name from com.google.xxx to android.ufwall
"
ukanth/afwall,closed,Update Android.mk,[],"copyright update (please give always credits)
LOCAL_PACKAGE_NAME changed to afwall
change for detect all makefiles
"
ukanth/afwall,closed,Changelog into a separat file,[],"Hey,
can we move the changelog from the readme into a separat file (maybe Changelog or Changes)? Because the file size and the look. If we have many changes, it's awfull to read the whole readme. 

git://gist.github.com/4001397.git
"
ukanth/afwall,closed,Update .gitignore,[],"small changes for Eclipse/IntelliJ IDE
"
ukanth/afwall,closed,manifest update ,[],"manifest update
"
ukanth/afwall,closed,improved readme,[],"improved readme
maybe we can merge the changelog to an separate file called ""changelog"" (because in the future this will be grown up)
"
ukanth/afwall,closed,small change for 4.0+,[],"small change for 4.0+
"
ukanth/afwall,closed,small changes for android 4.0+,[],"For more information about widget size in android 4.0 please look [here](https://developer.android.com/guide/practices/ui_guidelines/widget_design.html#anatomy_determining_size)

Also set the update rate to 1 day (this doesn't drain our battery to much) ... but we can maybe set in future release the rate manual
"
ukanth/afwall,closed,Not working on ICS/JB with mobile data limit,"[Label(name=""Bug"")]","See here for details: http://code.google.com/p/droidwall/issues/detail?id=222

Droidwall with the problem:

`~ # iptables --list OUTPUT --verbose
Chain OUTPUT (policy ACCEPT 990 packets, 94201 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    2  1264            all  --  any    !lo+    anywhere             anywhere             ! quota globalAlert: 2097152 bytes 
 1155 83106 ACCEPT     all  --  any    lo      anywhere             anywhere            
 9361 1042K            all  --  any    any     anywhere             anywhere             owner socket exists
 9570 1044K droidwall  all  --  any    any     anywhere             anywhere`

afwall with the problem:

`~ # iptables --list OUTPUT --verbose
Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    0     0            all  --  any    !lo+    anywhere             anywhere             ! quota globalAlert: 2097152 bytes 
   68  4808 ACCEPT     all  --  any    lo      anywhere             anywhere            
  426 97915            all  --  any    any     anywhere             anywhere             owner socket exists
    0     0 afwall     all  --  any    any     anywhere             anywhere`

Desired:

`~ # iptables --list OUTPUT --verbose
Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    0     0            all  --  any    !lo+    anywhere             anywhere             ! quota globalAlert: 2097152 bytes 
    0     0 afwall     all  --  any    any     anywhere             anywhere            
   77  5624 ACCEPT     all  --  any    lo      anywhere             anywhere            
  435 98479            all  --  any    any     anywhere             anywhere             owner socket exists`
"
ukanth/afwall,closed,After I upgraded from 1.0.1a to 1.0.2a all iptables rules are lost,"[Label(name=""Wont-Fix"")]","#### What steps will reproduce the problem?

1) Install 1.0.1a 
2) apply some iptables rules
3) Download/Install 1.0.2a 
4) Open 1.0.2a
5) You see no rules 
### What is the expected output? What do you see instead?

After we upgrade afwall+ we should show our iptables rules. 
### What version of the product are you using? On what operating system?

Android JB 4.1.2 (CM10)
1.0.2a

I don't know if that is really a bug, maybe it's by afwall+ design, but it would be better after we upgrade to a newer version that we see our rules without make an backup/import manually. 
"
ukanth/afwall,closed,implemented since 1.0.2,[],"use ~~ for thinks that are already done
better look to our todo list 
"
ukanth/afwall,closed,Added download link,[],"provide a download link 
xda, wiki (fore more information)
"
ukanth/afwall,closed,UDP 53 bypass because logging & whitelisting are enabled,"[Label(name=""Bug"")]","### If we look at Api.java@246-249 we see that some apps can ""bypass"" the firewall by just using UDP port 53

<code>if (whitelist && logenabled) {
    script.append(""# Allow DNS lookups on white-list for a better logging (ignore errors)\n"");
    script.append(""$IPTABLES -A droidwall -p udp --dport 53 -j RETURN\n"");
}</code>
### the problem

The logging feature was not designed to be always enabled.
### possible fix

Most users use whitelisting and logging enabled, so we need an extra option to block UDP 53 even when the log is enabled, or we get an timeout. 
### workaround

Disable logging.
"
ukanth/afwall,closed,Update src/dev/ukanth/ufirewall/StatusWidget.java,[],"enable/disable widget fix
"
ukanth/afwall,closed,"""Reload Applications"" seems to not working","[Label(name=""Bug"")]","#### What steps will reproduce the problem?

Open AFwall+ - press ""Reload Applications"" nothing happens
#### What is the expected output? What do you see instead?

A refresh dialog or or something similar.
#### What version of the product are you using? On what operating system?

JB with version afwall+1.0.1.a
"
ukanth/afwall,open,Per-app address filtering,"[Label(name=""Feature"")]","Make it possible to filter traffic by address/subnet on a per-application basis without using scripts. Will probably require creating a dialog to enter addresses permitted for the application and marking such application with an icon in the application list.
"
ukanth/afwall,closed,Application silently applies rules for 3G network to a wired USB connection,"[Label(name=""Bug"")]","## What steps will reproduce the problem?
1. Setup a whitelist configuration which enables some apps to go through WiFi interfaces only (don't allow 3G networking to any app)
2. Enable firewall
3. Connect USB cable and set to use internet over usb
## What is the expected output? What do you see instead?

No app is able to access network with ICMP Port Unreachable result. As long as WiFi is obviously a less expensive way of internet access, it implies USB networking to be definitely free. So why is it applied with rules from a more restricted communications channel?
## Please provide any additional information below.

I'd better suggest to add a third column of checkboxes for USB connection or at least add a switch into settings so the user be able to select which bearer's rules are to be aplied to USB conenction

Migrated from http://code.google.com/p/droidwall/issues/detail?id=223
"
ukanth/afwall,closed,Option to copy/move the log and rules ,"[Label(name=""Feature"")]","A little enhancement for some users.
I would like to see an option to copy or move the log and rules to another place, because the show log/rules option is good but i can't copy them or move them to another place i want. I think this would be good if you like to report the logs to the forum.

Here are some ideas from me
- If you are on tapatalk or an browser, the copy option from clipboard would also be helpful, because nobody wan't to write all the entries with the hand down.
- Copy it to clipboard by holding your fingers over the show log dialog.
- Or we have such an option to open the folder with an external app like solid explorer so that we can see the files.
"
ukanth/afwall,closed,Jelly Bean and data connection e.g. Wifi,"[Label(name=""Bug"")]","It seems that  _this [bug from droidwall](https://code.google.com/p/droidwall/issues/detail?id=264)_ was not fixed presently.

I tested it with USB-Tethering under JB 4.1.2. and it seems to work. But not with Wifi. The Workaround to activate the logging function did the trick (for me).

The strange thing is that wifi works without logging function enabled on my other device. So i don't know if this is really a bug or it have todo with the rom. Because on my sgs 2 i use cm10 and on my sgs3 i use stock samsung rom. 
"
ukanth/afwall,open,Per application data usage limits,"[Label(name=""Feature"")]","Limit data usage per application (i.e. no more than 10mb per day/month). If it's possible. 

This is useful, because android itself can only disable the whole network after xyz mb/gb are reached. 
"
ukanth/afwall,open,A popup when an external app requests network data,"[Label(name=""Feature"")]","When a program asks for network access, a popup dialogue allow or deny should be shown. 

This answer should be added to the whitelist or blacklist, depending on which the user last selected.
"
ukanth/afwall,closed,Cut/splitt the log after xyz mb file size,"[Label(name=""Feature"")]","This would also be helpful to save space, an option to cut or splitt the logfile size. Maybe after 2MB. After the limit are reached afwall+ can create another logfile. 

The whole thing should be done to prevent large log files. 
"
ukanth/afwall,closed,Tasker/Locale Integration,"[Label(name=""Feature"")]","A Tasker/Locale Integration would be nice to start some actions e.g. backup the current profile or restore rules, delete rules, switch some settings ... 

Here are the links to the Plugins
https://play.google.com/store/apps/details?id=net.dinglisch.android.taskerm
https://play.google.com/store/apps/details?id=com.twofortyfouram.locale&feature=search_result

But i think this isn't possible without spend money for the apps and there rights, so that we can use it in our afwall+ plugin. 

---

Here is an Tasker support example (tested) by [Alte.78](http://forum.xda-developers.com/member.php?u=2806029) migrated from [this thread](http://forum.xda-developers.com/showpost.php?p=33409329&postcount=38).

shell script:

<code>
file=""/data/data/com.googlecode.droidwall.free/shared_prefs/DroidWallPrefs.xml""

cat $file | grep Enabled | grep true  > /dev/null 2>&1
if [ ""$?"" -ne ""0"" ]; then
    echo -n Disabled
else
    echo -n Enabled
fi
</code>

and the following Tasker task calling shell script in A1 and returning output to %DROIDWALL Tasker variable

<code>
Task: Manage - DroidWall (126)
    A1: Secure Settings [ Configuration:droidwall (Root) Package:com.intangibleobject.securesettings.plugin Name:Secure Settings ] 
    A2: Wait [ MS:0 Seconds:5 Minutes:0 Hours:0 Days:0 ] 
    A3: If [ %DROIDWALL ~ Enabled\* ]
    A4: Variable Set [ Name:%DROIDWALL To:Enabled Do Maths:eek:ff Append:eek:ff ] 
    A5: Else 
    A6: Variable Set [ Name:%DROIDWALL To:Disabled Do Maths:eek:ff Append:eek:ff ] 
    A7: End If 
    A8: Return [ Value:%DROIDWALL Stop:eek:n ] If [ %par1 ~ check ]
    A9: Send Intent [ Action:com.googlecode.droidwall.intent.action.TOGGLE_REQUEST Cat:None Mime Type: Data: Extra: Extra: Package: Class: Target:Broadcast Receiver ] If [ %DROIDWALL %par1 ~ Disabled enable/Enabled disable ]
    A10: Notify Cancel [ Title:Firewall Disabled Warn Not Exist:eek:ff ] If [ %par1 ~ enable ]
</code>

to archive Tasker and afwall+ integration. 
"
ukanth/afwall,closed,Apps can bypass droidwalls whitelist if started before afwall upon boot,"[Label(name=""Bug"")]","What steps will reproduce the problem?
Apps can bypass the whitelist before android booted fully up. It takes some time that superuser ask for su rights, only after that AFWall+ rules seems to work. 

What is the expected output?
It would be nice if all network data is blocked or something like that, before AFWALL+ is loaded. 

Here is an better explanation about this problem:
[Lookout opens unwanted data connections all by itself and punches holes in DroidWall](http://androidunderground.blogspot.de/2011/06/lookout-opens-unwanted-data-connections_19.html)
"
ukanth/afwall,closed,Translation support ,"[Label(name=""Feature"")]","[Translation support](https://developer.android.com/training/basics/supporting-devices/languages.html) would be very good for people in other country's. 

The app must detect the installed os languages and use them automatically. 
"
ukanth/afwall,closed,Backup and restore rules option,"[Label(name=""Feature"")]","I think this would be a very  useful feature, saving iprules to a file (e.g. texfile or database) with further possibility to restore it from there.

Imho a database for that would be the best solution, because of the file size. And we also can protect them with an encryption or something else.

Maybe an option to store that on internal memory card or external SD-card also would be very helpful.
"
ukanth/afwall,closed,"Tethering (WIFI/USB) not working without ""applications running as root"" rule","[Label(name=""Bug"")]","- Start a WIFI- or USB-Tethering session
- Open a Browser e.g. stock browser or any other and go to any url
- Noting happens

What is the expected output? What do you see instead?
Without manually setting a rule it should work instantly.

Solution:
Go into AFWALL+ and tick ""applications running as root"", after that the connection seems to work correct. 
"
ukanth/afwall,closed,Saving  and loading (multiple) profiles,"[Label(name=""Feature"")]","This would be great feature if we were able to have profiles. 
- specific apps whitelist for general use, or 3G only, Wifi only
- specific whitelist specifying Orbot app only (to ensure all apps use Tor network) 
- specific white-/baclklist for VPN controll (Apps that using vpc network e.g. mediaserver)
"
ukanth/afwall,closed,Widget need too much space,"[Label(name=""Bug"")]","The Widget need to much space (for nothing to show).

Here are the steps to reproduce the problem:

1) Place the widgets on a empty homescreen
2) Place another widget and or folders/icons on the screen
3) You will see that AFWALL+ shows a widget icon that need 4x1 space, but it only need e.g.  2x2 

For a screenshot please look at this post:
http://forum.xda-developers.com/showpost.php?p=33335686&postcount=9
"
ukanth/afwall,closed,"""unsaved changes"" dialog wont work","[Label(name=""Bug"")]","http://forum.xda-developers.com/showpost.php?p=33369376&postcount=28

I post this again in here so everyone can read it. It's helpful for other peoples following this github project.

Here are the steps to reproduce the bug:

1) Open AFWall+
2) change some rules via gui
3) don't apply, press the return/go back button on your phone
4) a popup show ""unsaved changes""
5) press ""discard""
6) press the go back button again
7) the unsaved changes dialog comes back
.... and it begins again
5) ....
6) ...
"
